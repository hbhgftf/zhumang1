{"version":3,"file":"message-rating-star.js","sources":["pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/message-rating/message-rating-star.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovSkFWQUVFL215ZmxpZXMvdW5pYXBwLWFwcC91bmlhcHAvcGFnZXMtYWktZGVzay9haS1kZXNrLWN1c3RvbWVyLXVuaWFwcC9jb21wb25lbnRzL0N1c3RvbWVyU2VydmljZUNoYXQvbWVzc2FnZS1saXN0L21lc3NhZ2UtZWxlbWVudHMvbWVzc2FnZS1kZXNrL21lc3NhZ2UtZGVzay1lbGVtZW50cy9tZXNzYWdlLXJhdGluZy9tZXNzYWdlLXJhdGluZy1zdGFyLnZ1ZQ"],"sourcesContent":["<template>\n  <div class=\"message-rating-star\">\n    <p class=\"rating-head\">\n      {{ props.ratingTemplate.head }}\n    </p>\n    <div class=\"rating-card\">\n      <span class=\"card-title\">{{ TUITranslateService.t(\"AIDesk.请对本次服务进行评价\") }}</span>\n      <div class=\"card-wrapper\">\n        <div style=\"max-width: 200px\">\n          <div\n            v-for=\"(item, index) in starList\"\n            :key=\"index\"\n            style=\"display: inline-block\"\n            @click=\"setValue(index)\"\n            @mouseenter=\"setHoverValue(index)\"\n            @mouseleave=\"setHoverValue(-1)\"\n          >\n            <Icon\n              v-if=\"item === 1\"\n              :src=\"star\"\n              width=\"25px\"\n              height=\"25px\"\n            />\n            <Icon\n              v-else\n              :src=\"starLine\"\n              width=\"25px\"\n              height=\"25px\"\n            />\n          </div>\n        </div>\n      </div>\n      <div :style=\"{ marginTop: 10 + 'px', marginBottom: 10 + 'px', wordBreak: 'normal'  }\">\n        {{\n          hoverValue === -1\n            ? value === -1\n              ? TUITranslateService.t(\"AIDesk.如果满意请给好评哦～\")\n              : desc[value]\n            : desc[hoverValue]\n        }}\n      </div>\n      <button\n        class=\"submit-button\"\n        :disabled=\"hasReply || hasExpire\"\n        @click=\"submitRatingStar\"\n      >\n        {{ TUITranslateService.t(\"AIDesk.提交评价\") }}\n      </button>\n    </div>\n    <p\n      v-if=\"hasReply\"\n      class=\"rating-tail\"\n      :style=\"{\n        marginTop: 20 + 'px',\n      }\"\n    >\n      {{ props.ratingTemplate.tail }}\n    </p>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport vue from '../../../../../../../adapter-vue';\nimport { CUSTOM_MESSAGE_SRC } from '../../../../../../../constant';\nimport { ratingTemplateType } from '../../../../../../../interface';\nimport star from '../../../../../../../assets/star.png';\nimport starLine from '../../../../../../../assets/starLine.png';\nimport Icon from '../customer-icon.vue';\nimport { TUITranslateService } from '@tencentcloud/chat-uikit-engine';\nconst { computed, ref, watchEffect } = vue;\n\ninterface Props {\n  ratingTemplate: ratingTemplateType;\n}\n\nexport default {\n  components: {\n    Icon,\n  },\n  props: {\n    ratingTemplate: {\n      type: Object as () => ratingTemplateType,\n      default: () => ({}),\n    },\n  },\n  emits: ['sendMessage'],\n  setup(props: Props, { emit }) {\n    const hasReply = ref<boolean>(false);\n    const sessionId = ref<string>('');\n    const value = ref<number>(-1);\n    const hoverValue = ref<number>(-1);\n    const hasExpire = ref<boolean>(false);\n\n    watchEffect(() => {\n      sessionId.value = props.ratingTemplate.sessionId || '';\n      if (props.ratingTemplate.selected != undefined) {\n        for (let i = 0; i < props.ratingTemplate.menu.length; i++) {\n          if (props.ratingTemplate.menu[i].id == props.ratingTemplate.selected.id) {\n            hasReply.value = true;\n            value.value = i;\n            break;\n          }\n        }\n      }\n      const timestamp = Math.floor(new Date().getTime() / 1000);\n      if (timestamp > props.ratingTemplate.expireTime) {\n        hasExpire.value = true;\n      }\n    });\n\n    const desc = computed(() => {\n      return props.ratingTemplate?.menu.map((item) => {\n        return item.content;\n      });\n    });\n\n    const starList = computed(() => {\n      return props.ratingTemplate?.menu.map((item, index) => {\n        if (hoverValue.value !== -1) {\n          return index <= hoverValue.value ? 1 : 0;\n        } else {\n          return index <= value.value ? 1 : 0;\n        }\n      });\n    });\n\n    const setValue = (val: number) => {\n      if (hasReply.value) {\n        return;\n      }\n      value.value = val;\n    };\n\n    const setHoverValue = (value: number) => {\n      if (hasReply.value) {\n        return;\n      }\n      hoverValue.value = value;\n    };\n\n    const submitRatingStar = async () => {\n      if (value.value < 0) {\n        return;\n      }\n      const submitData = {\n        data: JSON.stringify({\n          src: CUSTOM_MESSAGE_SRC.MENU_SELECTED,\n          menuSelected: {\n            id: props.ratingTemplate.menu[value.value].id,\n            content: props.ratingTemplate.menu[value.value].content,\n            sessionId: sessionId.value,\n          },\n          customerServicePlugin: 0,\n        }),\n      };\n      hasReply.value = true;\n      emit('sendMessage', submitData);\n    };\n    return {\n      props,\n      hasReply,\n      sessionId,\n      value,\n      hoverValue,\n      hasExpire,\n      desc,\n      starList,\n      setValue,\n      setHoverValue,\n      submitRatingStar,\n      star,\n      starLine,\n      TUITranslateService\n    };\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.rating-head {\n  font-size: 14px;\n  font-weight: 400;\n  color: #999;\n}\n\n.rating-tail {\n  font-size: 14px;\n  font-weight: 400;\n  color: #999;\n}\n\n.card-title {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.rating-card {\n  min-width: 250px;\n  background: #fbfbfb;\n  border-radius: 20px;\n  border: 0;\n  margin-top: 10px;\n  padding-top: 20px;\n  padding-bottom: 20px;\n}\n\n.message-rating-star {\n  text-align: center;\n  display: flex;\n  flex-flow: column wrap;\n  justify-content: center;\n\n  align-items: center;\n}\n\n.card-wrapper {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  padding-top: 10px;\n}\n\n.submit-button {\n  height: 35px;\n  background-color: #1c66e5;\n  font-size: 14px;\n  font-weight: 400;\n  color: white;\n  border: 0;\n  border-radius: 8px;\n  cursor: pointer;\n  width: 62%;\n}\n\nuni-button[disabled] {\n  background-color: #d8d8d8 !important;\n  color: white !important;\n}\n\nuni-button:after {\n  border: none !important;\n}\n\n</style>\n","import Component from 'D:/JAVAEE/myflies/uniapp-app/uniapp/pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/message-rating/message-rating-star.vue'\nwx.createComponent(Component)"],"names":["vue","value","CUSTOM_MESSAGE_SRC","star","starLine","TUITranslateService"],"mappings":";;;;;AAmEA,MAAA,OAAiB,MAAA;AAEjB,MAAM,EAAE,UAAU,KAAK,YAAA,IAAgBA,4CAAAA;AAMvC,MAAe,YAAA;AAAA,EACb,YAAY;AAAA,IACV;AAAA,EACF;AAAA,EACA,OAAO;AAAA,IACL,gBAAgB;AAAA,MACd,MAAM;AAAA,MACN,SAAS,OAAO,CAAA;AAAA,IAClB;AAAA,EACF;AAAA,EACA,OAAO,CAAC,aAAa;AAAA,EACrB,MAAM,OAAc,EAAE,QAAQ;AACtB,UAAA,WAAW,IAAa,KAAK;AAC7B,UAAA,YAAY,IAAY,EAAE;AAC1B,UAAA,QAAQ,IAAY,EAAE;AACtB,UAAA,aAAa,IAAY,EAAE;AAC3B,UAAA,YAAY,IAAa,KAAK;AAEpC,gBAAY,MAAM;AACN,gBAAA,QAAQ,MAAM,eAAe,aAAa;AAChD,UAAA,MAAM,eAAe,YAAY,QAAW;AAC9C,iBAAS,IAAI,GAAG,IAAI,MAAM,eAAe,KAAK,QAAQ,KAAK;AACrD,cAAA,MAAM,eAAe,KAAK,CAAC,EAAE,MAAM,MAAM,eAAe,SAAS,IAAI;AACvE,qBAAS,QAAQ;AACjB,kBAAM,QAAQ;AACd;AAAA,UACF;AAAA,QACF;AAAA,MACF;AACM,YAAA,YAAY,KAAK,OAAM,oBAAI,QAAO,YAAY,GAAI;AACpD,UAAA,YAAY,MAAM,eAAe,YAAY;AAC/C,kBAAU,QAAQ;AAAA,MACpB;AAAA,IAAA,CACD;AAEK,UAAA,OAAO,SAAS,MAAM;;AAC1B,cAAO,WAAM,mBAAN,mBAAsB,KAAK,IAAI,CAAC,SAAS;AAC9C,eAAO,KAAK;AAAA,MAAA;AAAA,IACb,CACF;AAEK,UAAA,WAAW,SAAS,MAAM;;AAC9B,cAAO,WAAM,mBAAN,mBAAsB,KAAK,IAAI,CAAC,MAAM,UAAU;AACjD,YAAA,WAAW,UAAU,IAAI;AACpB,iBAAA,SAAS,WAAW,QAAQ,IAAI;AAAA,QAAA,OAClC;AACE,iBAAA,SAAS,MAAM,QAAQ,IAAI;AAAA,QACpC;AAAA,MAAA;AAAA,IACD,CACF;AAEK,UAAA,WAAW,CAAC,QAAgB;AAChC,UAAI,SAAS,OAAO;AAClB;AAAA,MACF;AACA,YAAM,QAAQ;AAAA,IAAA;AAGV,UAAA,gBAAgB,CAACC,WAAkB;AACvC,UAAI,SAAS,OAAO;AAClB;AAAA,MACF;AACA,iBAAW,QAAQA;AAAAA,IAAA;AAGrB,UAAM,mBAAmB,YAAY;AAC/B,UAAA,MAAM,QAAQ,GAAG;AACnB;AAAA,MACF;AACA,YAAM,aAAa;AAAA,QACjB,MAAM,KAAK,UAAU;AAAA,UACnB,KAAKC,0CAAmB,mBAAA;AAAA,UACxB,cAAc;AAAA,YACZ,IAAI,MAAM,eAAe,KAAK,MAAM,KAAK,EAAE;AAAA,YAC3C,SAAS,MAAM,eAAe,KAAK,MAAM,KAAK,EAAE;AAAA,YAChD,WAAW,UAAU;AAAA,UACvB;AAAA,UACA,uBAAuB;AAAA,QAAA,CACxB;AAAA,MAAA;AAEH,eAAS,QAAQ;AACjB,WAAK,eAAe,UAAU;AAAA,IAAA;AAEzB,WAAA;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MAAA,MACAC,cAAA;AAAA,MAAA,UACAC,cAAA;AAAA,MAAA,qBACAC,cAAA;AAAA,IAAA;AAAA,EAEJ;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9KA,GAAG,gBAAgB,SAAS;"}