{"version":3,"file":"message-rating-number.js","sources":["pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/message-rating/message-rating-number.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovSkFWQUVFL215ZmxpZXMvdW5pYXBwLWFwcC91bmlhcHAvcGFnZXMtYWktZGVzay9haS1kZXNrLWN1c3RvbWVyLXVuaWFwcC9jb21wb25lbnRzL0N1c3RvbWVyU2VydmljZUNoYXQvbWVzc2FnZS1saXN0L21lc3NhZ2UtZWxlbWVudHMvbWVzc2FnZS1kZXNrL21lc3NhZ2UtZGVzay1lbGVtZW50cy9tZXNzYWdlLXJhdGluZy9tZXNzYWdlLXJhdGluZy1udW1iZXIudnVl"],"sourcesContent":["<template>\n  <div class=\"message-rating-star\">\n    <p class=\"rating-head\">\n      {{ props.ratingTemplate.head }}\n    </p>\n\n    <div class=\"rating-card\">\n      <span class=\"card-title\">{{ TUITranslateService.t(\"AIDesk.请对本次服务进行评价\") }}</span>\n      <div class=\"card-wrapper\">\n        <div style=\"max-width: 250px\">\n          <div\n            v-for=\"(item, index) in numberList\"\n            :key=\"index\"\n            :class=\"{\n              'active': !(index !== selectValue && index !== hoverValue),\n              'de-active': index !== selectValue && index !== hoverValue,\n            }\"\n            :style=\"{\n              marginLeft: index === 0 ? 0 + 'px' : 20 + 'px',\n              margin: 5 + 'px',\n            }\"\n            @click=\"setValue(index)\"\n            @mouseenter=\"setHoverValue(index)\"\n            @mouseleave=\"setHoverValue(-1)\"\n          >\n            {{ item + 1 }}\n          </div>\n        </div>\n      </div>\n      <div :style=\"{ marginTop: 10 + 'px', marginBottom: 10 + 'px', wordBreak: 'normal' }\">\n        {{\n          hoverValue === -1\n            ? selectValue === -1\n              ? TUITranslateService.t(\"AIDesk.如果满意请给好评哦～\")\n              : desc[selectValue]\n            : desc[hoverValue]\n        }}\n      </div>\n      <button\n        class=\"submit-button\"\n        :disabled=\"hasReply || hasExpire\"\n        @click=\"submitRatingStar\"\n      >\n        {{ TUITranslateService.t(\"AIDesk.提交评价\") }}\n      </button>\n    </div>\n    <p\n      v-if=\"hasReply\"\n      class=\"rating-tail\"\n      :style=\"{\n        marginTop: 20 + 'px',\n      }\"\n    >\n      {{ props.ratingTemplate.tail }}\n    </p>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport vue from '../../../../../../../adapter-vue';\nimport { CUSTOM_MESSAGE_SRC } from '../../../../../../../constant';\nimport { ratingTemplateType } from '../../../../../../../interface';\nimport { TUITranslateService } from '@tencentcloud/chat-uikit-engine';\nconst { computed, ref, watchEffect } = vue;\n\ninterface Props {\n  ratingTemplate: ratingTemplateType;\n}\n\nexport default {\n  props: {\n    ratingTemplate: {\n      type: Object as () => ratingTemplateType,\n      default: () => ({}),\n    },\n  },\n  emits: ['sendMessage'],\n  setup(props: Props, { emit }) {\n    const hasReply = ref<boolean>(false);\n    const sessionId = ref<string>('');\n    const selectValue = ref<number>(-1);\n    const hoverValue = ref<number>(-1);\n    const hasExpire = ref<boolean>(false);\n\n    const desc = computed(() => {\n      return props.ratingTemplate?.menu.map(item => item.content);\n    });\n\n    const numberList = computed(() => {\n      return props.ratingTemplate?.menu.map((item, index) => index);\n    });\n\n    watchEffect(() => {\n      sessionId.value = props.ratingTemplate.sessionId || '';\n      if (props.ratingTemplate.selected != undefined) {\n        for (let i = 0; i < props.ratingTemplate.menu.length; i++) {\n          if (props.ratingTemplate.menu[i].id == props.ratingTemplate.selected.id) {\n            hasReply.value = true;\n            selectValue.value = i;\n            break;\n          }\n        }\n      }\n      const timestamp = Math.floor(new Date().getTime() / 1000);\n      if (timestamp > props.ratingTemplate.expireTime) {\n        hasExpire.value = true;\n      }\n    });\n\n    const setValue = (val: number) => {\n      if (!hasReply.value) {\n        selectValue.value = val;\n      }\n    };\n\n    const setHoverValue = (value: number) => {\n      if (!hasReply.value) {\n        hoverValue.value = value;\n      }\n    };\n\n    const submitRatingStar = () => {\n      if (selectValue.value >= 0) {\n        const submitData = {\n          data: JSON.stringify({\n            src: CUSTOM_MESSAGE_SRC.MENU_SELECTED,\n            menuSelected: {\n              id: props.ratingTemplate.menu[selectValue.value].id,\n              content: props.ratingTemplate.menu[selectValue.value].content,\n              sessionId: sessionId.value,\n            },\n            customerServicePlugin: 0,\n          }),\n        };\n        hasReply.value = true;\n        emit('sendMessage', submitData);\n      }\n    };\n\n    return {\n      props,\n      hasReply,\n      sessionId,\n      selectValue,\n      hoverValue,\n      hasExpire,\n      desc,\n      numberList,\n      setValue,\n      setHoverValue,\n      submitRatingStar,\n      TUITranslateService\n    };\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.rating-head {\n  font-size: 14px;\n  font-weight: 400;\n  color: #999;\n}\n\n.rating-tail {\n  font-size: 14px;\n  font-weight: 400;\n  color: #999;\n}\n\n.card-title {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.rating-card {\n  min-width: 270px;\n  background: #fbfbfb;\n  border-radius: 20px;\n  border: 0;\n  margin-top: 10px;\n  padding-top: 20px;\n  padding-bottom: 20px;\n}\n\n.message-rating-star {\n  text-align: center;\n  display: flex;\n  flex-flow: column wrap;\n  justify-content: center;\n  padding-bottom: 30px;\n  align-items: center;\n}\n\n.card-wrapper {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  padding-top: 10px;\n}\n\n.submit-button {\n  height: 35px;\n  background-color: #1c66e5;\n  font-size: 14px;\n  font-weight: 400;\n  color: white;\n  border: 0;\n  border-radius: 8px;\n  cursor: pointer;\n  width: 62%;\n}\n\nuni-button[disabled] {\n  background-color: #d8d8d8 !important;\n  color: white !important;\n}\n\nuni-button:after {\n  border: none !important;\n}\n\n.de-active {\n  height: 34px;\n  width: 34px;\n  display: inline-block;\n  border: 0 solid #006eff0d;\n  border-radius: 5px;\n  color: #006eff;\n  font-weight: 400;\n  font-size: 16px;\n  text-align: center;\n  line-height: 34px;\n  background: #006eff0d;\n}\n\n.active {\n  width: 34px;\n  height: 34px;\n  display: inline-block;\n  background: linear-gradient(\n    136.96deg,\n    rgba(10, 124, 255, 0.3) -39.64%,\n    #0a7cff 131.39%\n  );\n  border-radius: 5px;\n  color: white;\n  font-weight: 400;\n  font-size: 16px;\n  border: 0 solid #0a7cff;\n  text-align: center;\n  line-height: 34px;\n}\n</style>\n","import Component from 'D:/JAVAEE/myflies/uniapp-app/uniapp/pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/message-rating/message-rating-number.vue'\nwx.createComponent(Component)"],"names":["vue","CUSTOM_MESSAGE_SRC","TUITranslateService"],"mappings":";;;;AA+DA,MAAM,EAAE,UAAU,KAAK,YAAA,IAAgBA,4CAAAA;AAMvC,MAAe,YAAA;AAAA,EACb,OAAO;AAAA,IACL,gBAAgB;AAAA,MACd,MAAM;AAAA,MACN,SAAS,OAAO,CAAA;AAAA,IAClB;AAAA,EACF;AAAA,EACA,OAAO,CAAC,aAAa;AAAA,EACrB,MAAM,OAAc,EAAE,QAAQ;AACtB,UAAA,WAAW,IAAa,KAAK;AAC7B,UAAA,YAAY,IAAY,EAAE;AAC1B,UAAA,cAAc,IAAY,EAAE;AAC5B,UAAA,aAAa,IAAY,EAAE;AAC3B,UAAA,YAAY,IAAa,KAAK;AAE9B,UAAA,OAAO,SAAS,MAAM;;AAC1B,cAAO,WAAM,mBAAN,mBAAsB,KAAK,IAAI,CAAA,SAAQ,KAAK;AAAA,IAAO,CAC3D;AAEK,UAAA,aAAa,SAAS,MAAM;;AAChC,cAAO,WAAM,mBAAN,mBAAsB,KAAK,IAAI,CAAC,MAAM,UAAU;AAAA,IAAK,CAC7D;AAED,gBAAY,MAAM;AACN,gBAAA,QAAQ,MAAM,eAAe,aAAa;AAChD,UAAA,MAAM,eAAe,YAAY,QAAW;AAC9C,iBAAS,IAAI,GAAG,IAAI,MAAM,eAAe,KAAK,QAAQ,KAAK;AACrD,cAAA,MAAM,eAAe,KAAK,CAAC,EAAE,MAAM,MAAM,eAAe,SAAS,IAAI;AACvE,qBAAS,QAAQ;AACjB,wBAAY,QAAQ;AACpB;AAAA,UACF;AAAA,QACF;AAAA,MACF;AACM,YAAA,YAAY,KAAK,OAAM,oBAAI,QAAO,YAAY,GAAI;AACpD,UAAA,YAAY,MAAM,eAAe,YAAY;AAC/C,kBAAU,QAAQ;AAAA,MACpB;AAAA,IAAA,CACD;AAEK,UAAA,WAAW,CAAC,QAAgB;AAC5B,UAAA,CAAC,SAAS,OAAO;AACnB,oBAAY,QAAQ;AAAA,MACtB;AAAA,IAAA;AAGI,UAAA,gBAAgB,CAAC,UAAkB;AACnC,UAAA,CAAC,SAAS,OAAO;AACnB,mBAAW,QAAQ;AAAA,MACrB;AAAA,IAAA;AAGF,UAAM,mBAAmB,MAAM;AACzB,UAAA,YAAY,SAAS,GAAG;AAC1B,cAAM,aAAa;AAAA,UACjB,MAAM,KAAK,UAAU;AAAA,YACnB,KAAKC,0CAAmB,mBAAA;AAAA,YACxB,cAAc;AAAA,cACZ,IAAI,MAAM,eAAe,KAAK,YAAY,KAAK,EAAE;AAAA,cACjD,SAAS,MAAM,eAAe,KAAK,YAAY,KAAK,EAAE;AAAA,cACtD,WAAW,UAAU;AAAA,YACvB;AAAA,YACA,uBAAuB;AAAA,UAAA,CACxB;AAAA,QAAA;AAEH,iBAAS,QAAQ;AACjB,aAAK,eAAe,UAAU;AAAA,MAChC;AAAA,IAAA;AAGK,WAAA;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MAAA,qBACAC,cAAA;AAAA,IAAA;AAAA,EAEJ;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzJA,GAAG,gBAAgB,SAAS;"}