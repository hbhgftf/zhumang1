{"version":3,"file":"message-file.js","sources":["pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovSkFWQUVFL215ZmxpZXMvdW5pYXBwLWFwcC91bmlhcHAvcGFnZXMtYWktZGVzay9haS1kZXNrLWN1c3RvbWVyLXVuaWFwcC9jb21wb25lbnRzL0N1c3RvbWVyU2VydmljZUNoYXQvbWVzc2FnZS1saXN0L21lc3NhZ2UtZWxlbWVudHMvbWVzc2FnZS1maWxlLnZ1ZQ"],"sourcesContent":["<template>\n  <div\n    :class=\"['file-message-montainer',messageItem.flow === 'in'?'file-in' :'']\"\n    :title=\"TUITranslateService.t('TUIChat.单击下载')\"\n    @click=\"download\"\n  >\n    <Icon\n      :file=\"files\"\n      class=\"file-icon\"\n    />\n    <div>\n      <div>{{ props.content.name }}</div>\n      <div>{{ props.content.size }}</div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport vue from '../../../../adapter-vue';\nimport {\n  TUITranslateService,\n  IMessageModel,\n} from '@tencentcloud/chat-uikit-engine';\nimport Icon from '../../../common/Icon.vue';\nimport files from '../../../../assets/files.svg';\nimport { isUniFrameWork,isWeChat } from '../../../../utils/env';\nimport type { IFileMessageContent } from '../../../../interface';\nconst { withDefaults } = vue;\n\nconst props = withDefaults(\n  defineProps<{\n    content: IFileMessageContent;\n    messageItem: IMessageModel;\n  }>(),\n  {\n    content: () => ({} as IFileMessageContent),\n    messageItem: () => ({} as IMessageModel),\n  },\n);\n\nconst download = () => {\n  if (props.messageItem.hasRiskContent || props.messageItem.flow === 'out') {\n    return;\n  }\n\n  if(isWeChat){\n    uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:47',\"isWechat\",props.content.url)\n\n    wx.downloadFile({\n      url: props.content.url,\n      filePath: wx.env.USER_DATA_PATH + '/' + props.content.name,\n      success: function (res) {\n        var filePath = res.filePath;\n        const lastIndex = filePath.lastIndexOf('.');\n        const fileType = filePath.substring(lastIndex + 1);\n        uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:56',fileType)\n        wx.openDocument({\n          filePath: filePath,\n          showMenu:true,\n          fileType:fileType,\n          success: function (res) {\n            uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:62','打开文档成功');\n          },\n          fail:function(){\n            uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:65',\"fail\")\n          }\n        });\n      }\n    });\n  }else if(isUniFrameWork){\n    const lastIndex = props.content.url.lastIndexOf('.');\n    const fileType = props.content.url.substring(lastIndex + 1);\n    uni.downloadFile({\n      url:props.content.url,\n      success:function(res){\n        if(res.statusCode == 200){\n          uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:77',res)\n          const tempFilePaths = res.tempFilePath;\n          uni.showToast({\n            title: '下载成功'+tempFilePaths,\n            icon: 'success',\n            duration: 2000\n          });\n          uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:84',tempFilePaths);\n          uni.openDocument({\n            filePath: tempFilePaths,\n            fileType: fileType,\n            success: function () {\n                uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:89','打开文档成功');\n            },\n            fail: function () {\n                uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:92','打开文档失败');\n            }\n          });\n        }\n      }\n    });\n    // uni.openDocument({\n    //     filePath: tempFilePaths[0],\n    //     fileType: 'pdf',\n    //     success: function () {\n    //         uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:102','打开文档成功');\n    //     },\n    //     fail: function () {\n    //         uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:105','打开文档失败');\n    //     }\n    // });\n  }\n\n  else {\n    uni.__f__('log','at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:111',\"no window here\")\n    const a = document.createElement('a');\n    a.href = props.content.url;\n    a.target = '_blank';\n    a.download = props.content.name;\n    a.click();\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n@import \"../../style/common\";\n.file-in{\n  cursor: pointer;\n}\n.file-message-montainer {\n  display: flex;\n  flex-direction: row;\n\n\n  .file-icon {\n    margin: auto 8px;\n  }\n}\n</style>\n","import Component from 'D:/JAVAEE/myflies/uniapp-app/uniapp/pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue'\nwx.createComponent(Component)"],"names":["isWeChat","uni","wx","res","isUniFrameWork"],"mappings":";;;;;;;;AAuBA,MAAA,OAAiB,MAAA;;;;;;;;AAMjB,UAAM,QAAQ;AAWd,UAAM,WAAW,MAAM;AACrB,UAAI,MAAM,YAAY,kBAAkB,MAAM,YAAY,SAAS,OAAO;AACxE;AAAA,MACF;AAEA,UAAGA,qDAAS;AACVC,4BAAI,MAAM,OAAM,6HAA4H,YAAW,MAAM,QAAQ,GAAG;AAExKC,sBAAAA,KAAG,aAAa;AAAA,UACd,KAAK,MAAM,QAAQ;AAAA,UACnB,UAAUA,cAAG,KAAA,IAAI,iBAAiB,MAAM,MAAM,QAAQ;AAAA,UACtD,SAAS,SAAU,KAAK;AACtB,gBAAI,WAAW,IAAI;AACb,kBAAA,YAAY,SAAS,YAAY,GAAG;AAC1C,kBAAM,WAAW,SAAS,UAAU,YAAY,CAAC;AAC7CD,0BAAAA,MAAA,MAAM,OAAM,6HAA4H,QAAQ;AACpJC,0BAAAA,KAAG,aAAa;AAAA,cACd;AAAA,cACA,UAAS;AAAA,cACT;AAAA,cACA,SAAS,SAAUC,MAAK;AAClBF,8BAAAA,MAAA,MAAM,OAAM,6HAA4H,QAAQ;AAAA,cACtJ;AAAA,cACA,MAAK,WAAU;AACTA,8BAAAA,MAAA,MAAM,OAAM,6HAA4H,MAAM;AAAA,cACpJ;AAAA,YAAA,CACD;AAAA,UACH;AAAA,QAAA,CACD;AAAA,iBACMG,2CAAAA,gBAAe;AACtB,cAAM,YAAY,MAAM,QAAQ,IAAI,YAAY,GAAG;AACnD,cAAM,WAAW,MAAM,QAAQ,IAAI,UAAU,YAAY,CAAC;AAC1DH,sBAAAA,MAAI,aAAa;AAAA,UACf,KAAI,MAAM,QAAQ;AAAA,UAClB,SAAQ,SAAS,KAAI;AAChB,gBAAA,IAAI,cAAc,KAAI;AACnBA,4BAAAA,MAAA,MAAM,OAAM,6HAA4H,GAAG;AAC/I,oBAAM,gBAAgB,IAAI;AAC1BA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO,SAAO;AAAA,gBACd,MAAM;AAAA,gBACN,UAAU;AAAA,cAAA,CACX;AACGA,4BAAAA,MAAA,MAAM,OAAM,6HAA4H,aAAa;AACzJA,4BAAAA,MAAI,aAAa;AAAA,gBACf,UAAU;AAAA,gBACV;AAAA,gBACA,SAAS,WAAY;AACbA,gCAAAA,MAAA,MAAM,OAAM,6HAA4H,QAAQ;AAAA,gBACxJ;AAAA,gBACA,MAAM,WAAY;AACVA,gCAAAA,MAAA,MAAM,OAAM,6HAA4H,QAAQ;AAAA,gBACxJ;AAAA,cAAA,CACD;AAAA,YACH;AAAA,UACF;AAAA,QAAA,CACD;AAAA,MAAA,OAaE;AACCA,sBAAAA,MAAA,MAAM,OAAM,8HAA6H,gBAAgB;AACvJ,cAAA,IAAI,SAAS,cAAc,GAAG;AAClC,UAAA,OAAO,MAAM,QAAQ;AACvB,UAAE,SAAS;AACT,UAAA,WAAW,MAAM,QAAQ;AAC3B,UAAE,MAAM;AAAA,MACV;AAAA,IAAA;;;;;;;;;;;;;;;;ACnHF,GAAG,gBAAgB,SAAS;"}