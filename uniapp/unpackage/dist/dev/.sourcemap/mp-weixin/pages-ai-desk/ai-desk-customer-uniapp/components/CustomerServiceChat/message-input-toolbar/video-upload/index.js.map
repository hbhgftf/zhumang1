{"version":3,"file":"index.js","sources":["pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-input-toolbar/video-upload/index.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovSkFWQUVFL215ZmxpZXMvdW5pYXBwLWFwcC91bmlhcHAvcGFnZXMtYWktZGVzay9haS1kZXNrLWN1c3RvbWVyLXVuaWFwcC9jb21wb25lbnRzL0N1c3RvbWVyU2VydmljZUNoYXQvbWVzc2FnZS1pbnB1dC10b29sYmFyL3ZpZGVvLXVwbG9hZC9pbmRleC52dWU"],"sourcesContent":["<template>\n  <ToolbarItemContainer\n    :iconFile=\"handleIcon()\"\n    :title=\"handleTitle()\"\n    :needDialog=\"false\"\n    :iconWidth=\"isUniFrameWork ? '32px' : '21px'\"\n    :iconHeight=\"\n      isUniFrameWork\n        ? props.videoSourceType === 'album'\n          ? '20px'\n          : '25px'\n        : '18px'\n    \"\n    @onIconClick=\"onIconClick\"\n  >\n    <div :class=\"['video-upload', 'video-upload-h5']\">\n      <input\n        ref=\"inputRef\"\n        :title=\"TUITranslateService.t('视频')\"\n        type=\"file\"\n        data-type=\"video\"\n        accept=\"video/*\"\n        @change=\"sendVideoInWeb\"\n      >\n    </div>\n  </ToolbarItemContainer>\n</template>\n<script lang=\"ts\" setup>\nimport {\n  TUIChatService,\n  TUIStore,\n  StoreName,\n  IConversationModel,\n  SendMessageParams,\n  SendMessageOptions,\n  TUITranslateService,\n} from '@tencentcloud/chat-uikit-engine';\nimport { TUIGlobal } from '@tencentcloud/universal-api';\nimport vue from '../../../../adapter-vue';\nimport { isWeChat, isUniFrameWork } from '../../../../utils/env';\nimport ToolbarItemContainer from '../toolbar-item-container/index.vue';\nimport videoUniIcon from '../../../../assets/video-uni.png';\nimport cameraUniIcon from '../../../../assets/camera-uni.png';\nimport { isEnabledMessageReadReceiptGlobal } from '../../../../utils/utils';\nconst { ref } = vue;\n\nconst props = defineProps({\n  // Video source, only valid for uni-app version, web version only supports selecting videos from files\n  // album: Select from files\n  // camera: Take a video using the camera\n  videoSourceType: {\n    type: String,\n    default: 'album',\n  },\n});\n\nconst inputRef = ref();\nconst currentConversation = ref<IConversationModel>();\n\nTUIStore.watch(StoreName.CONV, {\n  currentConversation: (conversation: IConversationModel) => {\n    currentConversation.value = conversation;\n  },\n});\n\nconst handleIcon = (): string => {\n    switch (props.videoSourceType) {\n      case 'album':\n        return videoUniIcon;\n      case 'camera':\n        return cameraUniIcon;\n      default:\n        return videoUniIcon;\n    }\n\n};\n\nconst handleTitle = (): string => {\n  if (props.videoSourceType === 'camera') {\n    return TUITranslateService.t('录制');\n  } else {\n    return TUITranslateService.t('视频');\n  }\n};\n\nconst onIconClick = () => {\n  // uni-app send video\n  if (isWeChat && TUIGlobal?.chooseMedia) {\n    TUIGlobal?.chooseMedia({\n      mediaType: ['video'],\n      count: 1,\n      sourceType: [props.videoSourceType],\n      maxDuration: 60,\n      success: function (res: any) {\n        sendVideoMessage(res);\n      },\n    });\n  } else {\n    TUIGlobal?.chooseVideo({\n      count: 1,\n      sourceType: [props.videoSourceType],\n      compressed: false,\n      success: function (res: any) {\n        sendVideoMessage(res);\n      },\n    });\n  }\n\n};\n\nconst sendVideoInWeb = (e: any) => {\n  if (e?.target?.files?.length <= 0) {\n    return;\n  }\n  sendVideoMessage(e?.target);\n  e.target.value = '';\n};\n\nconst sendVideoMessage = (file: any) => {\n  if (!file) {\n    return;\n  }\n  const options = {\n    to:\n      currentConversation?.value?.groupProfile?.groupID\n      || currentConversation?.value?.userProfile?.userID,\n    conversationType: currentConversation?.value?.type,\n    payload: {\n      file,\n    },\n    needReadReceipt: isEnabledMessageReadReceiptGlobal(),\n  } as SendMessageParams;\n  const sendMessageOptions: SendMessageOptions = {};\n  TUIChatService.sendVideoMessage(options, sendMessageOptions);\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../../style/common\";\n</style>\n","import Component from 'D:/JAVAEE/myflies/uniapp-app/uniapp/pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-input-toolbar/video-upload/index.vue'\nwx.createComponent(Component)"],"names":["vue","TUIStore","StoreName","videoUniIcon","cameraUniIcon","TUITranslateService","isWeChat","TUIGlobal","isEnabledMessageReadReceiptGlobal","TUIChatService"],"mappings":";;;;;;;;;AAwCA,MAAA,uBAAiC,MAAA;;;;;;;;;;;;;AAI3B,UAAA,EAAE,IAAQ,IAAAA;AAEhB,UAAM,QAAQ;AAUG,QAAI;AACrB,UAAM,sBAAsB;AAEnBC,qBAAA,MAAMC,kBAAU,MAAM;AAAA,MAC7B,qBAAqB,CAAC,iBAAqC;AACzD,4BAAoB,QAAQ;AAAA,MAC9B;AAAA,IAAA,CACD;AAED,UAAM,aAAa,MAAc;AAC7B,cAAQ,MAAM,iBAAiB;AAAA,QAC7B,KAAK;AACI,iBAAAC;QACT,KAAK;AACI,iBAAAC;QACT;AACS,iBAAAD;MACX;AAAA,IAAA;AAIJ,UAAM,cAAc,MAAc;AAC5B,UAAA,MAAM,oBAAoB,UAAU;AAC/B,eAAAE,cAAA,GAAoB,EAAE,IAAI;AAAA,MAAA,OAC5B;AACE,eAAAA,cAAA,GAAoB,EAAE,IAAI;AAAA,MACnC;AAAA,IAAA;AAGF,UAAM,cAAc,MAAM;;AAEpB,UAAAC,2CAAA,cAAYC,yBAAAA,mBAAW,cAAa;AACtCA,4BAAAA,MAAAA,mBAAW,YAAY;AAAA,UACrB,WAAW,CAAC,OAAO;AAAA,UACnB,OAAO;AAAA,UACP,YAAY,CAAC,MAAM,eAAe;AAAA,UAClC,aAAa;AAAA,UACb,SAAS,SAAU,KAAU;AAC3B,6BAAiB,GAAG;AAAA,UACtB;AAAA,QAAA;AAAA,MACD,OACI;AACLA,4BAAAA,MAAAA,mBAAW,YAAY;AAAA,UACrB,OAAO;AAAA,UACP,YAAY,CAAC,MAAM,eAAe;AAAA,UAClC,YAAY;AAAA,UACZ,SAAS,SAAU,KAAU;AAC3B,6BAAiB,GAAG;AAAA,UACtB;AAAA,QAAA;AAAA,MAEJ;AAAA,IAAA;AAII,UAAA,iBAAiB,CAAC,MAAW;;AACjC,YAAI,kCAAG,WAAH,mBAAW,UAAX,mBAAkB,WAAU,GAAG;AACjC;AAAA,MACF;AACA,uBAAiB,uBAAG,MAAM;AAC1B,QAAE,OAAO,QAAQ;AAAA,IAAA;AAGb,UAAA,mBAAmB,CAAC,SAAc;;AACtC,UAAI,CAAC,MAAM;AACT;AAAA,MACF;AACA,YAAM,UAAU;AAAA,QACd,MACE,sEAAqB,UAArB,mBAA4B,iBAA5B,mBAA0C,cACvC,sEAAqB,UAArB,mBAA4B,gBAA5B,mBAAyC;AAAA,QAC9C,mBAAkB,gEAAqB,UAArB,mBAA4B;AAAA,QAC9C,SAAS;AAAA,UACP;AAAA,QACF;AAAA,QACA,iBAAiBC,6CAAAA,kCAAkC;AAAA,MAAA;AAErD,YAAM,qBAAyC,CAAA;AAChCC,oBAAAA,GAAA,iBAAiB,SAAS,kBAAkB;AAAA,IAAA;;;;;;;;;;;;;;;;;;ACpI7D,GAAG,gBAAgB,SAAS;"}