{"version":3,"file":"index.js","sources":["pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-input-toolbar/image-upload/index.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovSkFWQUVFL215ZmxpZXMvdW5pYXBwLWFwcC91bmlhcHAvcGFnZXMtYWktZGVzay9haS1kZXNrLWN1c3RvbWVyLXVuaWFwcC9jb21wb25lbnRzL0N1c3RvbWVyU2VydmljZUNoYXQvbWVzc2FnZS1pbnB1dC10b29sYmFyL2ltYWdlLXVwbG9hZC9pbmRleC52dWU"],"sourcesContent":["<template>\n  <ToolbarItemContainer\n    :iconFile=\"imageToolbarForShow.icon\"\n    :title=\"imageToolbarForShow.title\"\n    :iconWidth=\"isUniFrameWork ? '32px' : '21px'\"\n    :iconHeight=\"isUniFrameWork ? '25px' : '18px'\"\n    :needDialog=\"false\"\n    @onIconClick=\"onIconClick\"\n    :isH5ToolShow=\"isH5ToolShow\"\n  >\n  </ToolbarItemContainer>\n</template>\n<script lang=\"ts\" setup>\nimport {\n  TUIChatService,\n  TUIStore,\n  StoreName,\n  IConversationModel,\n  SendMessageParams,\n  SendMessageOptions,\n  TUITranslateService,\n} from '@tencentcloud/chat-uikit-engine';\nimport { TUIGlobal } from '@tencentcloud/universal-api';\nimport vue from '../../../../adapter-vue';\nimport { isH5,isWeChat, isUniFrameWork } from '../../../../utils/env';\nimport ToolbarItemContainer from '../toolbar-item-container/index.vue';\nimport imageUniIcon from '../../../../assets/image-uni.png';\nimport cameraUniIcon from '../../../../assets/camera-uni.png';\nimport { isEnabledMessageReadReceiptGlobal } from '../../../../utils/utils';\nconst { ref, computed } = vue;\n\nconst props = defineProps({\n  // Image source: only valid for uni-app version, web version only supports selecting images from the album.\n  // album: Select from album\n  // camera: Take a photo using the camera\n  imageSourceType: {\n    type: String,\n    default: 'album',\n  },\n  isH5ToolShow:{\n    type:Boolean,\n    default:false,\n  }\n});\n\nconst inputRef = ref();\nconst currentConversation = ref<IConversationModel>();\nconst IMAGE_TOOLBAR_SHOW_MAP = {\n  uni_album: {\n    icon: imageUniIcon,\n    title: TUITranslateService.t(\"图片\"),\n  },\n  uni_camera: {\n    icon: cameraUniIcon,\n    title: TUITranslateService.t(\"拍照\"),\n  },\n};\n\nTUIStore.watch(StoreName.CONV, {\n  currentConversation: (conversation: IConversationModel) => {\n    currentConversation.value = conversation;\n  },\n});\n\nconst imageToolbarForShow = computed((): { icon: string; title: string } => {\n    return props.imageSourceType === 'camera'\n      ? IMAGE_TOOLBAR_SHOW_MAP['uni_camera']\n      : IMAGE_TOOLBAR_SHOW_MAP['uni_album'];\n});\n\nconst onIconClick = () => {\n  // uni-app send image\n  if (isWeChat && TUIGlobal?.chooseMedia) {\n    TUIGlobal?.chooseMedia({\n      count: 1,\n      mediaType: ['image','video'],\n      sizeType: ['original', 'compressed'],\n      sourceType: [props.imageSourceType], // Use camera or select from album.\n      success: function (res: any) {\n        if(res.tempFiles[0].fileType == 'image'){\n          sendImageMessage(res);\n        } else if(res.tempFiles[0].fileType == 'video'){\n          sendVideoMessage(res);\n        }\n      },\n    });\n  } else {\n    // uni-app H5/App send image\n    TUIGlobal?.chooseImage({\n      count: 1,\n      sourceType: [props.imageSourceType], // Use camera or select from album.\n      success: function (res) {\n        sendImageMessage(res);\n      },\n    });\n  }\n\n};\n\nconst sendImageMessage = (files: any) => {\n  if (!files) {\n    return;\n  }\n  const options = {\n    to:\n      currentConversation?.value?.groupProfile?.groupID\n      || currentConversation?.value?.userProfile?.userID,\n    conversationType: currentConversation?.value?.type,\n    payload: {\n      file: files,\n    },\n    needReadReceipt: isEnabledMessageReadReceiptGlobal(),\n  } as SendMessageParams;\n  const sendMessageOptions: SendMessageOptions = {};\n  TUIChatService.sendImageMessage(options, sendMessageOptions);\n};\nconst sendVideoMessage = (file: any) => {\n  if (!file) {\n    return;\n  }\n  const options = {\n    to:\n      currentConversation?.value?.groupProfile?.groupID\n      || currentConversation?.value?.userProfile?.userID,\n    conversationType: currentConversation?.value?.type,\n    payload: {\n      file,\n    },\n    needReadReceipt: isEnabledMessageReadReceiptGlobal(),\n  } as SendMessageParams;\n  const sendMessageOptions: SendMessageOptions = {};\n  TUIChatService.sendVideoMessage(options, sendMessageOptions);\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../../style/common\";\n</style>\n","import Component from 'D:/JAVAEE/myflies/uniapp-app/uniapp/pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-input-toolbar/image-upload/index.vue'\nwx.createComponent(Component)"],"names":["vue","imageUniIcon","TUITranslateService","cameraUniIcon","TUIStore","StoreName","isWeChat","TUIGlobal","isEnabledMessageReadReceiptGlobal","TUIChatService"],"mappings":";;;;;;;;;AAyBA,MAAA,uBAAiC,MAAA;;;;;;;;;;;;;;;;;AAI3B,UAAA,EAAE,KAAK,SAAa,IAAAA;AAE1B,UAAM,QAAQ;AAcG,QAAI;AACrB,UAAM,sBAAsB;AAC5B,UAAM,yBAAyB;AAAA,MAC7B,WAAW;AAAA,QACT,MAAMC,cAAA;AAAA,QACN,OAAOC,cAAAA,GAAoB,EAAE,IAAI;AAAA,MACnC;AAAA,MACA,YAAY;AAAA,QACV,MAAMC,cAAA;AAAA,QACN,OAAOD,cAAAA,GAAoB,EAAE,IAAI;AAAA,MACnC;AAAA,IAAA;AAGOE,qBAAA,MAAMC,kBAAU,MAAM;AAAA,MAC7B,qBAAqB,CAAC,iBAAqC;AACzD,4BAAoB,QAAQ;AAAA,MAC9B;AAAA,IAAA,CACD;AAEK,UAAA,sBAAsB,SAAS,MAAuC;AACxE,aAAO,MAAM,oBAAoB,WAC7B,uBAAuB,YAAY,IACnC,uBAAuB,WAAW;AAAA,IAAA,CACzC;AAED,UAAM,cAAc,MAAM;;AAEpB,UAAAC,2CAAA,cAAYC,yBAAAA,mBAAW,cAAa;AACtCA,4BAAAA,MAAAA,mBAAW,YAAY;AAAA,UACrB,OAAO;AAAA,UACP,WAAW,CAAC,SAAQ,OAAO;AAAA,UAC3B,UAAU,CAAC,YAAY,YAAY;AAAA,UACnC,YAAY,CAAC,MAAM,eAAe;AAAA;AAAA,UAClC,SAAS,SAAU,KAAU;AAC3B,gBAAG,IAAI,UAAU,CAAC,EAAE,YAAY,SAAQ;AACtC,+BAAiB,GAAG;AAAA,YAAA,WACZ,IAAI,UAAU,CAAC,EAAE,YAAY,SAAQ;AAC7C,+BAAiB,GAAG;AAAA,YACtB;AAAA,UACF;AAAA,QAAA;AAAA,MACD,OACI;AAELA,4BAAAA,MAAAA,mBAAW,YAAY;AAAA,UACrB,OAAO;AAAA,UACP,YAAY,CAAC,MAAM,eAAe;AAAA;AAAA,UAClC,SAAS,SAAU,KAAK;AACtB,6BAAiB,GAAG;AAAA,UACtB;AAAA,QAAA;AAAA,MAEJ;AAAA,IAAA;AAII,UAAA,mBAAmB,CAAC,UAAe;;AACvC,UAAI,CAAC,OAAO;AACV;AAAA,MACF;AACA,YAAM,UAAU;AAAA,QACd,MACE,sEAAqB,UAArB,mBAA4B,iBAA5B,mBAA0C,cACvC,sEAAqB,UAArB,mBAA4B,gBAA5B,mBAAyC;AAAA,QAC9C,mBAAkB,gEAAqB,UAArB,mBAA4B;AAAA,QAC9C,SAAS;AAAA,UACP,MAAM;AAAA,QACR;AAAA,QACA,iBAAiBC,6CAAAA,kCAAkC;AAAA,MAAA;AAErD,YAAM,qBAAyC,CAAA;AAChCC,oBAAAA,GAAA,iBAAiB,SAAS,kBAAkB;AAAA,IAAA;AAEvD,UAAA,mBAAmB,CAAC,SAAc;;AACtC,UAAI,CAAC,MAAM;AACT;AAAA,MACF;AACA,YAAM,UAAU;AAAA,QACd,MACE,sEAAqB,UAArB,mBAA4B,iBAA5B,mBAA0C,cACvC,sEAAqB,UAArB,mBAA4B,gBAA5B,mBAAyC;AAAA,QAC9C,mBAAkB,gEAAqB,UAArB,mBAA4B;AAAA,QAC9C,SAAS;AAAA,UACP;AAAA,QACF;AAAA,QACA,iBAAiBD,6CAAAA,kCAAkC;AAAA,MAAA;AAErD,YAAM,qBAAyC,CAAA;AAChCC,oBAAAA,GAAA,iBAAiB,SAAS,kBAAkB;AAAA,IAAA;;;;;;;;;;;;;;;;;AClI7D,GAAG,gBAAgB,SAAS;"}