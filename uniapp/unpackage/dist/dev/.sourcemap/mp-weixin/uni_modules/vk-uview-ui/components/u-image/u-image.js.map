{"version":3,"file":"u-image.js","sources":["uni_modules/vk-uview-ui/components/u-image/u-image.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovSkFWQUVFL215ZmxpZXMvdW5pYXBwLWFwcC91bmlhcHAvdW5pX21vZHVsZXMvdmstdXZpZXctdWkvY29tcG9uZW50cy91LWltYWdlL3UtaW1hZ2UudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"u-image\" @tap=\"onClick\" :style=\"[wrapStyle, backgroundStyle]\">\r\n\t\t<image\r\n\t\t\tv-if=\"!isError\"\r\n\t\t\t:src=\"src\"\r\n\t\t\t:mode=\"mode\"\r\n\t\t\t@error=\"onErrorHandler\"\r\n\t\t\t@load=\"onLoadHandler\"\r\n\t\t\t:lazy-load=\"lazyLoad\"\r\n\t\t\tclass=\"u-image__image\"\r\n\t\t\t:show-menu-by-longpress=\"showMenuByLongpress\"\r\n\t\t\t:style=\"{\r\n\t\t\t\tborderRadius: shape == 'circle' ? '50%' : $u.addUnit(borderRadius)\r\n\t\t\t}\"\r\n\t\t></image>\r\n\t\t<view\r\n\t\t\tv-if=\"showLoading && loading\"\r\n\t\t\tclass=\"u-image__loading\"\r\n\t\t\t:style=\"{\r\n\t\t\t\tborderRadius: shape == 'circle' ? '50%' : $u.addUnit(borderRadius),\r\n\t\t\t\tbackgroundColor: bgColor\r\n\t\t\t}\"\r\n\t\t>\r\n\t\t\t<slot v-if=\"$slots.loading\" name=\"loading\" />\r\n\t\t\t<u-icon v-else :name=\"loadingIcon\" :width=\"width\" :height=\"height\"></u-icon>\r\n\t\t</view>\r\n\t\t<view\r\n\t\t\tv-if=\"showError && isError && !loading\"\r\n\t\t\tclass=\"u-image__error\"\r\n\t\t\t:style=\"{\r\n\t\t\t\tborderRadius: shape == 'circle' ? '50%' : $u.addUnit(borderRadius)\r\n\t\t\t}\"\r\n\t\t>\r\n\t\t\t<slot v-if=\"$slots.error\" name=\"error\" />\r\n\t\t\t<u-icon v-else :name=\"errorIcon\" :width=\"width\" :height=\"height\"></u-icon>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * Image 图片\r\n * @description 此组件为uni-app的image组件的加强版，在继承了原有功能外，还支持淡入动画、加载中、加载失败提示、圆角值和形状等。\r\n * @tutorial https://uviewui.com/components/image.html\r\n * @property {String} src 图片地址\r\n * @property {String} mode 裁剪模式，见官网说明\r\n * \t@value scaleToFill\t\t不保持纵横比缩放图片，使图片的宽高完全拉伸至填满 image 元素\r\n * \t@value aspectFit\t\t\t保持纵横比缩放图片，使图片的长边能完全显示出来。也就是说，可以完整地将图片显示出来。\r\n * \t@value aspectFill\t\t\t保持纵横比缩放图片，只保证图片的短边能完全显示出来。也就是说，图片通常只在水平或垂直方向是完整的，另一个方向将会发生截取。\r\n * \t@value widthFix\t\t\t\t宽度不变，高度自动变化，保持原图宽高比不变\r\n * \t@value heightFix\t\t\t高度不变，宽度自动变化，保持原图宽高比不变 App 和 H5 平台 HBuilderX 2.9.3+ 支持、微信小程序需要基础库 2.10.3\r\n * \t@value top\t\t\t\t\t\t不缩放图片，只显示图片的顶部区域\r\n * \t@value bottom\t\t\t\t\t不缩放图片，只显示图片的底部区域\r\n * \t@value center\t\t\t\t\t不缩放图片，只显示图片的中间区域\r\n * \t@value left\t\t\t\t\t\t不缩放图片，只显示图片的左边区域\r\n * \t@value right\t\t\t\t\t不缩放图片，只显示图片的右边区域\r\n * \t@value top left\t\t\t\t不缩放图片，只显示图片的左上边区域\r\n * \t@value top right\t\t\t不缩放图片，只显示图片的右上边区域\r\n * \t@value bottom left\t\t不缩放图片，只显示图片的左下边区域\r\n * \t@value bottom right\t\t不缩放图片，只显示图片的右下边区域\r\n * @property {String | Number} width 宽度，单位任意，如果为数值，则为rpx单位（默认100%）\r\n * @property {String | Number} height 高度，单位任意，如果为数值，则为rpx单位（默认 auto）\r\n * @property {String} shape 图片形状，circle-圆形，square-方形（默认square）\r\n * @property {String | Number} border-radius 圆角值，单位任意，如果为数值，则为rpx单位（默认 0）\r\n * @property {Boolean} lazy-load 是否懒加载，仅微信小程序、App、百度小程序、字节跳动小程序有效（默认 true）\r\n * @property {Boolean} show-menu-by-longpress 是否开启长按图片显示识别小程序码菜单，仅微信小程序有效（默认 false）\r\n * @property {String} loading-icon 加载中的图标，或者小图片（默认 photo）\r\n * @property {String} error-icon 加载失败的图标，或者小图片（默认 error-circle）\r\n * @property {Boolean} show-loading 是否显示加载中的图标或者自定义的slot（默认 true）\r\n * @property {Boolean} show-error 是否显示加载错误的图标或者自定义的slot（默认 true）\r\n * @property {Boolean} fade 是否需要淡入效果（默认 true）\r\n * @property {String Number} width 传入图片路径时图片的宽度\r\n * @property {String Number} height 传入图片路径时图片的高度\r\n * @property {Boolean} webp 只支持网络资源，只对微信小程序有效（默认 false）\r\n * @property {String | Number} duration 搭配fade参数的过渡时间，单位ms（默认 500）\r\n * @event {Function} click 点击图片时触发\r\n * @event {Function} error 图片加载失败时触发\r\n * @event {Function} load 图片加载成功时触发\r\n * @example <u-image width=\"100%\" height=\"300rpx\" :src=\"src\"></u-image>\r\n */\r\nexport default {\r\n\tname: 'u-image',\r\n  emits: [\"click\", \"error\", \"load\"],\r\n\tprops: {\r\n\t\t// 图片地址\r\n\t\tsrc: {\r\n\t\t\ttype: [String,null],\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\t// 裁剪模式\r\n\t\tmode: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'aspectFill'\r\n\t\t},\r\n\t\t// 宽度，单位任意\r\n\t\twidth: {\r\n\t\t\ttype: [String, Number],\r\n\t\t\tdefault: '100%'\r\n\t\t},\r\n\t\t// 高度，单位任意\r\n\t\theight: {\r\n\t\t\ttype: [String, Number],\r\n\t\t\tdefault: 'auto'\r\n\t\t},\r\n\t\t// 图片形状，circle-圆形，square-方形\r\n\t\tshape: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'square'\r\n\t\t},\r\n\t\t// 圆角，单位任意\r\n\t\tborderRadius: {\r\n\t\t\ttype: [String, Number],\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\t// 是否懒加载，微信小程序、App、百度小程序、字节跳动小程序\r\n\t\tlazyLoad: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\t// 开启长按图片显示识别微信小程序码菜单\r\n\t\tshowMenuByLongpress: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\t// 加载中的图标，或者小图片\r\n\t\tloadingIcon: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'photo'\r\n\t\t},\r\n\t\t// 加载失败的图标，或者小图片\r\n\t\terrorIcon: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'error-circle'\r\n\t\t},\r\n\t\t// 是否显示加载中的图标或者自定义的slot\r\n\t\tshowLoading: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\t// 是否显示加载错误的图标或者自定义的slot\r\n\t\tshowError: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\t// 是否需要淡入效果\r\n\t\tfade: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\t// 只支持网络资源，只对微信小程序有效\r\n\t\twebp: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\t// 过渡时间，单位ms\r\n\t\tduration: {\r\n\t\t\ttype: [String, Number],\r\n\t\t\tdefault: 500\r\n\t\t},\r\n\t\t// 背景颜色，用于深色页面加载图片时，为了和背景色融合\r\n\t\tbgColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '#f3f4f6'\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\t// 图片是否加载错误，如果是，则显示错误占位图\r\n\t\t\tisError: false,\r\n\t\t\t// 初始化组件时，默认为加载中状态\r\n\t\t\tloading: true,\r\n\t\t\t// 不透明度，为了实现淡入淡出的效果\r\n\t\t\topacity: 1,\r\n\t\t\t// 过渡时间，因为props的值无法修改，故需要一个中间值\r\n\t\t\tdurationTime: this.duration,\r\n\t\t\t// 图片加载完成时，去掉背景颜色，因为如果是png图片，就会显示灰色的背景\r\n\t\t\tbackgroundStyle: {}\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\tsrc: {\r\n\t\t\timmediate: true,\r\n\t\t\thandler (n) {\r\n\t\t\t\tif(!n) {\r\n\t\t\t\t\t// 如果传入null或者''，或者false，或者undefined，标记为错误状态\r\n\t\t\t\t\tthis.isError = true;\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isError = false;\r\n\t\t\t\t\tthis.loading = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\twrapStyle() {\r\n\t\t\tlet style = {};\r\n\t\t\t// 通过调用addUnit()方法，如果有单位，如百分比，px单位等，直接返回，如果是纯粹的数值，则加上rpx单位\r\n\t\t\tstyle.width = this.$u.addUnit(this.width);\r\n\t\t\tstyle.height = this.$u.addUnit(this.height);\r\n\t\t\t// 如果是配置了圆形，设置50%的圆角，否则按照默认的配置值\r\n\t\t\tstyle.borderRadius = this.shape == 'circle' ? '50%' : this.$u.addUnit(this.borderRadius);\r\n\t\t\t// 如果设置圆角，必须要有hidden，否则可能圆角无效\r\n\t\t\tstyle.overflow = this.borderRadius > 0 ? 'hidden' : 'visible';\r\n\t\t\tif (this.fade) {\r\n\t\t\t\tstyle.opacity = this.opacity;\r\n\t\t\t\tstyle.transition = `opacity ${Number(this.durationTime) / 1000}s ease-in-out`;\r\n\t\t\t}\r\n\t\t\treturn style;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t// 点击图片\r\n\t\tonClick() {\r\n\t\t\tthis.$emit('click');\r\n\t\t},\r\n\t\t// 图片加载失败\r\n\t\tonErrorHandler(err) {\r\n\t\t\tthis.loading = false;\r\n\t\t\tthis.isError = true;\r\n\t\t\tthis.$emit('error', err);\r\n\t\t},\r\n\t\t// 图片加载完成，标记loading结束\r\n\t\tonLoadHandler() {\r\n\t\t\tthis.loading = false;\r\n\t\t\tthis.isError = false;\r\n\t\t\tthis.$emit('load');\r\n\t\t\t// 如果不需要动画效果，就不执行下方代码，同时移除加载时的背景颜色\r\n\t\t\t// 否则无需fade效果时，png图片依然能看到下方的背景色\r\n\t\t\tif (!this.fade) return this.removeBgColor();\r\n\t\t\t// 原来opacity为1(不透明，是为了显示占位图)，改成0(透明，意味着该元素显示的是背景颜色，默认的灰色)，再改成1，是为了获得过渡效果\r\n\t\t\tthis.opacity = 0;\r\n\t\t\t// 这里设置为0，是为了图片展示到背景全透明这个过程时间为0，延时之后延时之后重新设置为duration，是为了获得背景透明(灰色)\r\n\t\t\t// 到图片展示的过程中的淡入效果\r\n\t\t\tthis.durationTime = 0;\r\n\t\t\t// 延时50ms，否则在浏览器H5，过渡效果无效\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.durationTime = this.duration;\r\n\t\t\t\tthis.opacity = 1;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.removeBgColor();\r\n\t\t\t\t}, this.durationTime);\r\n\t\t\t}, 50);\r\n\t\t},\r\n\t\t// 移除图片的背景色\r\n\t\tremoveBgColor() {\r\n\t\t\t// 淡入动画过渡完成后，将背景设置为透明色，否则png图片会看到灰色的背景\r\n\t\t\tthis.backgroundStyle = {\r\n\t\t\t\tbackgroundColor: 'transparent'\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '../../libs/css/style.components.scss';\r\n\r\n.u-image {\r\n\tposition: relative;\r\n\ttransition: opacity 0.5s ease-in-out;\r\n\r\n\t&__image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t&__loading,\r\n\t&__error {\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\t@include vue-flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbackground-color: $u-bg-color;\r\n\t\tcolor: $u-tips-color;\r\n\t\tfont-size: 46rpx;\r\n\t}\r\n}\r\n</style>\r\n","import Component from 'D:/JAVAEE/myflies/uniapp-app/uniapp/uni_modules/vk-uview-ui/components/u-image/u-image.vue'\nwx.createComponent(Component)"],"names":[],"mappings":"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"}