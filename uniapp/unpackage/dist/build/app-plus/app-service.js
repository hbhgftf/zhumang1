var __defProp=Object.defineProperty,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__publicField=(e,t,n)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,n),n);if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";var t,n,i;function o(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const n in e)if("default"!==n){const i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>e[n]})}return t.default=e,Object.freeze(t)}function a(e,t){for(var n=0;n<t.length;n++){const i=t[n];if("string"!=typeof i&&!Array.isArray(i))for(const t in i)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(i,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>i[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const s=o(e);function r(e){return weex.requireModule(e)}function c(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}const u=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n};const l=u({data:()=>({faqs:[{question:"如何申请志愿者帮助？",answer:"在首页点击'视频协助'按钮，系统将自动匹配在线志愿者...",expanded:!1},{question:"地铁预约需要提前多久？",answer:"建议至少提前2小时预约，紧急情况可致电客服...",expanded:!1}]}),methods:{toggleAnswer(e){this.faqs[e].expanded=!this.faqs[e].expanded,uni.vibrateShort()},playIntroduction(){},repeatLastMessage(){},makeCall(){c("log","at pages/index/index.vue:102","拨打求助热线按钮被点击"),uni.makePhoneCall({phoneNumber:"110"})},openChat(){uni.navigateTo({url:"/pages-ai-desk/index/index"})}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"voice-control"},[e.createElementVNode("text",{class:"section-title"},"语音控制"),e.createElementVNode("view",{class:"voice-btns"},[e.createElementVNode("button",{class:"voice-btn",onClick:n[0]||(n[0]=(...e)=>s.playIntroduction&&s.playIntroduction(...e)),"aria-label":"播放使用说明"},[e.createElementVNode("image",{src:"/static/play.png",class:"btn-icon"}),e.createTextVNode(" 播放指南 ")]),e.createElementVNode("button",{class:"voice-btn",onClick:n[1]||(n[1]=(...e)=>s.repeatLastMessage&&s.repeatLastMessage(...e)),"aria-label":"重复最后一条语音"},[e.createElementVNode("image",{src:"/static/repeat.png",class:"btn-icon"}),e.createTextVNode(" 重复提示 ")])])]),e.createElementVNode("view",{class:"faq-section"},[e.createElementVNode("text",{class:"section-title"},"常见问题"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.faqs,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:"faq-item",onClick:e=>s.toggleAnswer(n)},[e.createElementVNode("view",{class:"question-block"},[e.createElementVNode("text",{class:"question-text"},e.toDisplayString(t.question),1),e.createElementVNode("view",{class:e.normalizeClass(["arrow",{expanded:t.expanded}])},null,2)]),t.expanded?(e.openBlock(),e.createElementBlock("view",{key:0,class:"answer-block"},e.toDisplayString(t.answer),1)):e.createCommentVNode("",!0)],8,["onClick"])))),128))]),e.createElementVNode("view",{class:"contact-section"},[e.createElementVNode("text",{class:"section-title"},"需要人工帮助？"),e.createElementVNode("button",{class:"contact-btn",onClick:n[2]||(n[2]=(...e)=>s.makeCall&&s.makeCall(...e)),"aria-label":"联系客服电话"},[e.createElementVNode("image",{src:"/static/phone.png",class:"btn-icon"}),e.createTextVNode(" 拨打求助热线 ")]),e.createElementVNode("button",{class:"contact-btn",onClick:n[3]||(n[3]=(...e)=>s.openChat&&s.openChat(...e)),"aria-label":"打开在线聊天"},[e.createElementVNode("image",{src:"/static/chat.png",class:"btn-icon"}),e.createTextVNode(" 在线即时沟通 ")])])])}],["__scopeId","data-v-26411607"]]);const d=u({data:()=>({voiceEnabled:!0,features:[{title:"视频协助",desc:"志愿者实时视频帮助",icon:"/static/video-help.png",path:"/pages/index/spxz/spxz",color:"#FFB74D"},{title:"出行预约",desc:"地铁/机场无障碍服务",icon:"/static/travel.png",path:"/pages/travel/travel",color:"#81C784"},{title:"政策查询",desc:"最新补贴政策解读",icon:"/static/policy.png",path:"/pages/policy/policy",color:"#64B5F6"}]}),computed:{voiceIcon(){return this.voiceEnabled?"/static/voice-on.png":"/static/voice-off.png"}},methods:{toggleVoiceGuide(){this.voiceEnabled=!this.voiceEnabled,uni.vibrateShort()},makeEmergencyCall(){c("log","at pages/index/course.vue:82","紧急求助按钮被点击"),uni.makePhoneCall({phoneNumber:"110"})},handleEmergency(){c("log","at pages/index/course.vue:86","紧急求助按钮被点击")},confirmEmergency(){c("log","at pages/index/course.vue:89","紧急求助按钮被双击")},speak(e){if(this.voiceEnabled){const t=uni.createInnerAudioContext();t.src=`https://tts-api.example.com/speak?text=${encodeURIComponent(e)}`,t.play()}}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("image",{src:"/static/logo.png",class:"logo"}),e.createElementVNode("text",{class:"title"},"助盲通"),e.createElementVNode("button",{class:"voice-btn",onClick:n[0]||(n[0]=(...e)=>s.toggleVoiceGuide&&s.toggleVoiceGuide(...e))},e.toDisplayString(a.voiceEnabled?"语音开启":"语音关闭"),1)]),e.createElementVNode("view",{class:"main-features"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.features,((t,n)=>(e.openBlock(),e.createElementBlock("navigator",{key:n,url:t.path,class:"feature-card",style:e.normalizeStyle({backgroundColor:t.color}),"hover-class":"hover-effect"},[e.createElementVNode("image",{src:t.icon,class:"feature-icon"},null,8,["src"]),e.createElementVNode("text",{class:"feature-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"feature-desc"},e.toDisplayString(t.desc),1)],12,["url"])))),128))]),e.createElementVNode("button",{class:"emergency-btn",onClick:n[1]||(n[1]=(...e)=>s.makeEmergencyCall&&s.makeEmergencyCall(...e)),"aria-label":"紧急求助"},[e.createElementVNode("image",{src:"/static/sos-icon.png",class:"sos-icon"}),e.createElementVNode("text",{class:"btn-text"},"紧急求助")])])}],["__scopeId","data-v-b016b41d"]]);const h=u({data:()=>({isVolunteer:!1,isOnline:!1}),onLoad(){this.checkVolunteerStatus()},onShow(){this.checkVolunteerStatus()},methods:{async checkVolunteerStatus(){const e=uni.getStorageSync("userInfo");if(!e||"string"==typeof e)return this.isVolunteer=!1,void(this.isOnline=!1);if("志愿者"===e.role){this.isVolunteer=!0;try{const t=await uni.request({url:`${this.$config.baseUrl}/api/volunteer/status/${e.openid}`,method:"GET",header:{Authorization:`Bearer ${e.token}`}});200===t.data.code?this.isOnline=t.data.data:(c("error","at pages/index/elective.vue:95","获取志愿者在线状态失败:",t.data.msg),this.isOnline=!1,uni.showToast({title:t.data.msg||"获取状态失败",icon:"none"}))}catch(t){c("error","at pages/index/elective.vue:104","请求获取志愿者在线状态失败:",t),this.isOnline=!1,uni.showToast({title:"请求获取状态失败",icon:"none"})}}else this.isVolunteer=!1,this.isOnline=!1},async toggleOnlineStatus(e){const t=uni.getStorageSync("userInfo");if(!t||"志愿者"!==t.role)return uni.showToast({title:"您不是志愿者",icon:"none"}),void this.$nextTick((()=>{this.isOnline=!e.detail.value}));const n=e.detail.value,i=t.openid;uni.showLoading({title:"更新状态中..."});const o=`${this.$config.baseUrl}/api/volunteer/status?openid=${i}&isOnline=${n}`;c("log","at pages/index/elective.vue:136","请求URL:",o);try{const e=await uni.request({url:o,method:"POST",header:{Authorization:`Bearer ${t.token}`}});200===e.data.code?(this.isOnline=n,uni.showToast({title:"状态更新成功",icon:"success"})):(c("error","at pages/index/elective.vue:153","更新志愿者在线状态失败:",e.data.msg),this.$nextTick((()=>{this.isOnline=!n})),uni.showToast({title:e.data.msg||"更新状态失败",icon:"none"}))}catch(a){c("error","at pages/index/elective.vue:162","请求更新志愿者在线状态失败:",a),this.$nextTick((()=>{this.isOnline=!n})),uni.showToast({title:"请求更新状态失败",icon:"none"})}finally{uni.hideLoading()}},goToRegister(){if(!uni.getStorageSync("userInfo"))return uni.showToast({title:"请先登录",icon:"none"}),void setTimeout((()=>{uni.navigateTo({url:"/pages/mine/"})}),1500);uni.navigateTo({url:"/pages/index/volunteer-register"})},goToVideoAssist(){uni.navigateTo({url:"/pages/spxz/spxz"})}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"volunteer-container"},[a.isVolunteer?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("view",{class:"status-bar"},[e.createElementVNode("text",{class:"status-title"},"服务状态"),e.createElementVNode("switch",{checked:a.isOnline,onChange:n[1]||(n[1]=(...e)=>s.toggleOnlineStatus&&s.toggleOnlineStatus(...e)),color:"#1AAD19",class:"status-switch"},null,40,["checked"]),e.createElementVNode("text",{class:"status-text"},e.toDisplayString(a.isOnline?"在线":"离线"),1)]),e.createElementVNode("view",{class:"service-scope"},[e.createElementVNode("text",{class:"section-title"},"可提供的帮助类型（多选）"),e.createElementVNode("view",{class:"tag-container"},[e.createElementVNode("view",{class:"tag mock-tag active",onClick:n[2]||(n[2]=(...e)=>s.goToVideoAssist&&s.goToVideoAssist(...e))},"视频协助"),e.createElementVNode("view",{class:"tag mock-tag"},"出行预约"),e.createElementVNode("view",{class:"tag mock-tag"},"政策咨询")])]),e.createElementVNode("view",{class:"task-list"},[e.createElementVNode("text",{class:"section-title"},"最新求助请求"),e.createElementVNode("view",{class:"task-item mock-task urgent"},[e.createElementVNode("view",{class:"task-header"},[e.createElementVNode("text",{class:"task-type"},"紧急求助"),e.createElementVNode("text",{class:"task-time"},"08/20 14:30")]),e.createElementVNode("text",{class:"task-content"},"需要协助识别药品有效期"),e.createElementVNode("view",{class:"response-btn mock-btn"},"立即响应")])])],64)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"register-section"},[e.createElementVNode("view",{class:"register-header"},[e.createElementVNode("text",{class:"register-title"},"成为志愿者"),e.createElementVNode("text",{class:"register-subtitle"},"加入我们，一起帮助他人")]),e.createElementVNode("button",{class:"register-btn",onClick:n[0]||(n[0]=(...e)=>s.goToRegister&&s.goToRegister(...e))},"成为志愿者")]))])}],["__scopeId","data-v-55a66dda"]]);const p=u({data:()=>({formData:{name:"",phone:"",idCard:"",openid:""}}),onLoad(){const e=uni.getStorageSync("userInfo");e?(this.formData.openid=e.openid,c("log","at pages/index/volunteer-register.vue:51",this.formData.openid)):(uni.showToast({title:"请先登录",icon:"none"}),setTimeout((()=>{uni.navigateTo({url:"/pages/mine/"})}),1500))},methods:{async submitForm(){if(this.formData.name&&this.formData.phone&&this.formData.idCard){c("log","at pages/index/volunteer-register.vue:76","志愿者注册表单数据：",{"姓名":this.formData.name,"手机号码":this.formData.phone,"身份证号":this.formData.idCard,openid:this.formData.openid});try{c("log","at pages/index/volunteer-register.vue:85","开始请求注册接口...");const e=await uni.request({url:`${this.$config.baseUrl}/user/user/volunteer/register`,method:"POST",data:this.formData,header:{"content-type":"application/json"}});c("log","at pages/index/volunteer-register.vue:95","接口返回数据：",e),e.data.success?(uni.showToast({title:"申请提交成功",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)):(c("error","at pages/index/volunteer-register.vue:106","注册失败，错误信息：",e.data),uni.showToast({title:e.data.message||"提交失败",icon:"none"}))}catch(e){c("error","at pages/index/volunteer-register.vue:113","请求发生错误：",e),c("error","at pages/index/volunteer-register.vue:114","错误详情：",{"错误信息":e.message,"错误堆栈":e.stack,"请求数据":this.formData}),uni.showToast({title:"提交失败，请重试",icon:"none"})}}else uni.showToast({title:"请填写完整信息",icon:"none"})}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"register-container"},[e.createElementVNode("view",{class:"form-header"},[e.createElementVNode("text",{class:"header-title"},"成为志愿者"),e.createElementVNode("text",{class:"header-subtitle"},"让我们一起帮助他人")]),e.createElementVNode("view",{class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"姓名"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>a.formData.name=e),placeholder:"请输入您的真实姓名"},null,512),[[e.vModelText,a.formData.name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"手机号码"),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=e=>a.formData.phone=e),placeholder:"请输入手机号码",maxlength:"11"},null,512),[[e.vModelText,a.formData.phone]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"身份证号"),e.withDirectives(e.createElementVNode("input",{type:"idcard","onUpdate:modelValue":n[2]||(n[2]=e=>a.formData.idCard=e),placeholder:"请输入身份证号码"},null,512),[[e.vModelText,a.formData.idCard]])]),e.createElementVNode("button",{class:"submit-btn",onClick:n[3]||(n[3]=(...e)=>s.submitForm&&s.submitForm(...e))},"提交申请")])])}],["__scopeId","data-v-a4374e7a"]]),g={data:()=>({login:{show:!1,avatar:"/static/default_avatar.png",nickname:""},userId:"",tempLocalPath:"",loading:!1,email:"",code:"",isSendingCode:!1,countdown:60}),onLoad(){const e=uni.getStorageSync("userInfo");e&&e.id&&(this.login.show=!0,this.userId=e.id,this.login.avatar=e.avatarUrl||this.login.avatar,this.login.nickname=e.nickname||"")},methods:{async handleSendCode(){if(!this.email)return void uni.showToast({title:"请输入邮箱",icon:"none"});if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.email)){if(!this.isSendingCode){this.isSendingCode=!0,this.countdown=60;try{const e=await uni.request({url:`${this.$config.baseUrl}/user/sendEmail/${this.email}`,method:"GET"});"验证码发送成功！"===e.data?(uni.showToast({title:"验证码已发送",icon:"none"}),this.startCountdown()):(uni.showToast({title:e.data,icon:"none"}),this.isSendingCode=!1)}catch(e){c("error","at pages/index/mine.vue:196","发送验证码失败:",e),uni.showToast({title:"发送验证码失败",icon:"none"}),this.isSendingCode=!1}}}else uni.showToast({title:"请输入正确的邮箱格式",icon:"none"})},startCountdown(){const e=setInterval((()=>{this.countdown>0?this.countdown--:(clearInterval(e),this.isSendingCode=!1)}),1e3)},async handleEmailLogin(){if(this.email&&this.code){if(!this.loading){this.loading=!0,uni.showLoading({title:"登录中..."});try{const e=await uni.request({url:`${this.$config.baseUrl}/user/login/email`,method:"POST",data:{email:this.email,code:this.code},header:{"Content-Type":"application/json"}});if(c("log","at pages/index/mine.vue:239","邮箱登录响应:",e),200===e.data.code&&e.data.success){const t=e.data.data.userInfo.token,n=e.data.data.userInfo,i={...n,id:n.id};uni.setStorageSync("token",t),uni.setStorageSync("userInfo",i),c("log","at pages/index/mine.vue:255","保存的用户信息:",i),c("log","at pages/index/mine.vue:256","保存的token:",t),this.login.show=!0,this.login.avatar=i.avatarUrl||"/static/default_avatar.png",this.login.nickname=i.nickname||"默认昵称",uni.showToast({title:"登录成功",icon:"none"})}else uni.showToast({title:e.data.msg||"登录失败",icon:"none"})}catch(e){c("error","at pages/index/mine.vue:271","登录失败:",e),uni.showToast({title:"登录请求失败，请重试",icon:"none"})}finally{this.loading=!1,uni.hideLoading()}}}else uni.showToast({title:"请输入邮箱和验证码",icon:"none"})},async handleAuth(){if(!this.loading){this.loading=!0,uni.showLoading({title:"登录中..."});try{const{code:e}=await uni.login({provider:"weixin"}),t=await uni.request({url:`${this.$config.baseUrl}/user/login`,method:"POST",data:{code:e},header:{"Content-Type":"application/x-www-form-urlencoded"}});if(200===t.data.code){const e=t.data.data.userInfo;uni.setStorageSync("userInfo",e),this.login.show=!0,this.userId=e.id,this.login.avatar=e.avatarUrl||"/static/default_avatar.png",this.login.nickname=e.nickname||"默认昵称",uni.showToast({title:"登录成功",icon:"none"})}else uni.showToast({title:`登录失败：${t.data.msg||"未知错误"}`,icon:"none"})}catch(e){c("error","at pages/index/mine.vue:314","登录失败:",e),uni.showToast({title:"登录请求失败，请重试",icon:"none"})}finally{this.loading=!1,uni.hideLoading()}}},async handleChooseAvatar(e){if(!this.login.show)return void uni.showToast({title:"请先登录",icon:"none"});const t=e.detail.avatarUrl,{tempFilePath:n}=await uni.downloadFile({url:t});this.tempLocalPath=n,await this.uploadAvatarToMinIO()},async uploadAvatarToMinIO(){if(this.tempLocalPath){uni.showLoading({title:"上传中..."});try{const e=uni.getStorageSync("token");if(!e)throw new Error("未找到登录凭证");const t=await uni.uploadFile({url:`${this.$config.baseUrl}/minio/upload`,filePath:this.tempLocalPath,name:"file",header:{Authorization:`Bearer ${e}`}});if(200!==t.statusCode)throw new Error(`上传失败，状态码: ${t.statusCode}`);{const e=JSON.parse(t.data);if(200!==e.code)throw new Error(e.message||"上传失败");{const t=e.data.url,n=uni.getStorageSync("userInfo");await this.updateUserInfo({id:n.id,avatarUrl:t})}}}catch(e){c("error","at pages/index/mine.vue:374","头像上传失败:",e),uni.showToast({title:"头像上传失败",icon:"none"})}finally{uni.hideLoading()}}},async handleNicknameChange(e){if(!this.login.show)return void uni.showToast({title:"请先登录",icon:"none"});const t=e.detail.value;if(t&&""!==t.trim()){const e=uni.getStorageSync("userInfo");await this.updateUserInfo({id:e.id,nickname:t.trim(),avatarUrl:e.avatarUrl||this.login.avatar})}},async updateUserInfo(e){try{const t=uni.getStorageSync("userInfo");if(!t||!t.id)throw new Error("用户未登录或ID缺失");const n=uni.getStorageSync("token");if(!n)throw new Error("未找到登录凭证");const i={id:e.id||t.id,avatarUrl:e.avatarUrl||t.avatarUrl||this.login.avatar,...e},o=await uni.request({url:`${this.$config.baseUrl}/user/updateUserInfo`,method:"POST",data:i,header:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(200!==o.data.code)throw new Error(o.data.message||"更新失败");{const n={...t,...e};uni.setStorageSync("userInfo",n),e.nickname&&(this.login.nickname=e.nickname),e.avatarUrl&&(this.login.avatar=e.avatarUrl),uni.showToast({title:"更新成功",icon:"none"})}}catch(t){c("error","at pages/index/mine.vue:448","更新失败:",t),uni.showToast({title:t.message,icon:"none"})}},navigateTo(e){"basicInfo"===e?uni.navigateTo({url:"/pages/basicInfo/basicInfo"}):uni.navigateTo({url:`/pages/${e}/${e}`})},handleLogout(){uni.showModal({title:"提示",content:"确定要退出登录吗？",success:e=>{e.confirm&&(uni.removeStorageSync("userInfo"),uni.removeStorageSync("token"),this.login.show=!1,this.login.avatar="/static/default_avatar.png",this.login.nickname="",this.userId="",this.email="",this.code="",uni.showToast({title:"已退出登录",icon:"none"}))}})}}};const f=u(g,[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"top-bg"}),e.createElementVNode("view",{class:"box"},[e.createElementVNode("view",{class:"head-box"},[e.createElementVNode("view",{class:"avatar-container"},[e.createElementVNode("button",{"open-type":"chooseAvatar",class:"avatar-btn",onChooseavatar:n[0]||(n[0]=(...e)=>s.handleChooseAvatar&&s.handleChooseAvatar(...e))},[e.createElementVNode("image",{class:"head-img",src:a.login.avatar,mode:"aspectFill"},null,8,["src"])],32)]),e.createElementVNode("view",{class:"tip"},e.toDisplayString(a.login.show?"点击头像可更换":"当前未登录，请登录！"),1),e.createElementVNode("view",{class:"nickname-container"},[e.createElementVNode("input",{type:"nickname",class:"nickname-input",placeholder:"请输入昵称",value:a.login.nickname,onChange:n[1]||(n[1]=(...e)=>s.handleNicknameChange&&s.handleNicknameChange(...e))},null,40,["value"])])]),a.login.show?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"login-section"},[e.createElementVNode("view",{class:"email-login"},[e.withDirectives(e.createElementVNode("input",{type:"text",class:"email-input",placeholder:"请输入邮箱","onUpdate:modelValue":n[2]||(n[2]=e=>a.email=e)},null,512),[[e.vModelText,a.email]]),e.createElementVNode("view",{class:"code-input-group"},[e.withDirectives(e.createElementVNode("input",{type:"text",class:"code-input",placeholder:"请输入验证码","onUpdate:modelValue":n[3]||(n[3]=e=>a.code=e)},null,512),[[e.vModelText,a.code]]),e.createElementVNode("button",{class:"send-code-btn",disabled:a.isSendingCode,onClick:n[4]||(n[4]=(...e)=>s.handleSendCode&&s.handleSendCode(...e))},e.toDisplayString(a.isSendingCode?`${a.countdown}s后重试`:"发送验证码"),9,["disabled"])]),e.createElementVNode("button",{onClick:n[5]||(n[5]=(...e)=>s.handleEmailLogin&&s.handleEmailLogin(...e)),class:"email-login-btn"},[e.createElementVNode("text",{class:"login-text"},"邮箱验证码登录")])]),e.createElementVNode("view",{class:"divider"},[e.createElementVNode("view",{class:"divider-line"}),e.createElementVNode("text",{class:"divider-text"},"或"),e.createElementVNode("view",{class:"divider-line"})]),e.createElementVNode("button",{onClick:n[6]||(n[6]=(...e)=>s.handleAuth&&s.handleAuth(...e)),class:"login-btn"},[e.createElementVNode("text",{class:"login-text"},"微信快捷登录")])])),a.login.show?(e.openBlock(),e.createElementBlock("view",{key:1,class:"function-list"},[e.createElementVNode("button",{class:"row",style:{width:"100%"},onClick:n[7]||(n[7]=e=>s.navigateTo("basicInfo"))},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("icon",{class:"icon-small",type:"success",size:"16",color:"green"}),e.createElementVNode("text",{class:"text"},"基本信息")]),e.createElementVNode("view",{class:"right"},"》")]),e.createElementVNode("button",{class:"row",style:{width:"100%"},onClick:n[8]||(n[8]=e=>s.navigateTo("feedback"))},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("icon",{class:"icon-small",type:"success",size:"16",color:"green"}),e.createElementVNode("text",{class:"text"},"匿名反馈")]),e.createElementVNode("view",{class:"right"},"》")]),e.createElementVNode("button",{class:"row",style:{width:"100%"},onClick:n[9]||(n[9]=e=>s.navigateTo("about"))},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("icon",{class:"icon-small",type:"success",size:"16",color:"green"}),e.createElementVNode("text",{class:"text"},"关于我们")]),e.createElementVNode("view",{class:"right"},"》")]),e.createElementVNode("button",{class:"row",style:{width:"100%"},"open-type":"share"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("icon",{class:"icon-small",type:"success",size:"16",color:"green"}),e.createElementVNode("text",{class:"text"},"分享好友")]),e.createElementVNode("view",{class:"right"},"》")]),e.createElementVNode("button",{class:"row",style:{width:"100%"},"open-type":"contact"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("icon",{class:"icon-small",type:"success",size:"16",color:"green"}),e.createElementVNode("text",{class:"text"},"在线客服")]),e.createElementVNode("view",{class:"right"},"》")])])):e.createCommentVNode("",!0),a.login.show?(e.openBlock(),e.createElementBlock("view",{key:2,class:"logout-section"},[e.createElementVNode("button",{onClick:n[10]||(n[10]=(...e)=>s.handleLogout&&s.handleLogout(...e)),class:"logout-btn"},[e.createElementVNode("text",{class:"logout-text"},"退出登录")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",null,"© 2023 微信小程序个人中心")])])}]]);const m=u({methods:{async handleAuth(){try{const{userInfo:e}=await uni.getUserProfile({desc:"测试授权",lang:"zh_CN"});c("log","at pages/test-auth/test-auth.vue:16","测试用户信息:",e)}catch(e){c("error","at pages/test-auth/test-auth.vue:18","测试授权错误:",e)}}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("button",{onClick:n[0]||(n[0]=(...e)=>s.handleAuth&&s.handleAuth(...e))},"测试授权")])}]]),_="/static/loading.gif",v="/static/error.png",y={data:()=>({regions:["全国","北京","上海","广州","深圳"],currentRegion:"全国",leftColumn:[],rightColumn:[],page:1,pageSize:10,loading:!1,hasMore:!0,error:!1,mockPolicies:Array.from({length:50},((e,t)=>({id:t+1,title:`2024年助残政策${t+1}`,summary:`本政策针对视力障碍群体提供${["就业","教育","出行"][Math.floor(3*Math.random())]}补贴`,publishDate:Date.now()-24*t*60*60*1e3,views:Math.floor(2e4*Math.random())+1e3,cover:`https://picsum.photos/300/${Math.floor(200*Math.random()+150)}?random=${t}`,tags:["国家政策","助残补贴","无障碍建设"][Math.floor(3*Math.random())]})))}),onLoad(){this.loadPolicies()},onReachBottom(){!this.loading&&this.hasMore&&this.loadPolicies()},methods:{async loadPolicies(){if(!this.loading&&this.hasMore){this.loading=!0,this.error=!1;try{const e=(this.page-1)*this.pageSize,t=this.page*this.pageSize,n=this.mockPolicies.slice(e,t);if(0===n.length)return void(this.hasMore=!1);n.forEach(((e,t)=>{t%2==0?this.leftColumn.push({...e,loaded:!1}):this.rightColumn.push({...e,loaded:!1})})),await new Promise((e=>setTimeout(e,1e3))),this.hasMore=t<this.mockPolicies.length,this.page++}catch(e){this.error=!0,c("error","at pages/policy/policy.vue:165","加载数据失败:",e)}finally{this.loading=!1}}},onRegionChange(e){this.currentRegion=this.regions[e.detail.value],this.resetData(),this.loadPolicies()},resetData(){this.leftColumn=[],this.rightColumn=[],this.page=1,this.hasMore=!0,this.error=!1},onImageLoad(e){const t=t=>{const n=t.findIndex((t=>t.id===e));-1!==n&&(t[n].loaded=!0)};t(this.leftColumn),t(this.rightColumn)},navigateToDetail(e){uni.navigateTo({url:`/pages/policy/detail?id=${e}`})},formatDate:e=>new Date(e).toISOString().split("T")[0],formatViews:e=>e>=1e4?`${(e/1e4).toFixed(1)}万`:e}};const I=u(y,[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("picker",{mode:"selector",range:a.regions,onChange:n[0]||(n[0]=(...e)=>s.onRegionChange&&s.onRegionChange(...e)),class:"region-picker"},[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("text",{class:"selected-region"},e.toDisplayString(a.currentRegion),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["range"])]),e.createElementVNode("view",{class:"waterfall-container"},[e.createElementVNode("view",{class:"waterfall-column left-column"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.leftColumn,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"policy-card",onClick:e=>s.navigateToDetail(t.id),style:e.normalizeStyle({opacity:t.loaded?1:0})},[t.cover?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.cover,mode:"widthFix",class:"card-cover",loading:"lazy",onLoad:e=>s.onImageLoad(t.id)},null,40,["src","onLoad"])):e.createCommentVNode("",!0),t.tags&&t.tags.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"card-tag"},e.toDisplayString(t.tags[0]),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"card-summary"},e.toDisplayString(t.summary),1),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"publish-date"},e.toDisplayString(s.formatDate(t.publishDate)),1),e.createElementVNode("text",{class:"views"},e.toDisplayString(s.formatViews(t.views))+"阅读",1)])])],12,["onClick"])))),128))]),e.createElementVNode("view",{class:"waterfall-column right-column"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.rightColumn,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"policy-card",onClick:e=>s.navigateToDetail(t.id),style:e.normalizeStyle({opacity:t.loaded?1:0})},[t.cover?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.cover,mode:"widthFix",class:"card-cover",loading:"lazy",onLoad:e=>s.onImageLoad(t.id)},null,40,["src","onLoad"])):e.createCommentVNode("",!0),t.tags&&t.tags.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"card-tag"},e.toDisplayString(t.tags[0]),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"card-summary"},e.toDisplayString(t.summary),1),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"publish-date"},e.toDisplayString(s.formatDate(t.publishDate)),1),e.createElementVNode("text",{class:"views"},e.toDisplayString(s.formatViews(t.views))+"阅读",1)])])],12,["onClick"])))),128))])]),a.loading||!a.hasMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[a.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading"},[e.createElementVNode("image",{src:_,mode:"widthFix",class:"loading-icon"}),e.createElementVNode("text",null,"加载中...")])):a.hasMore?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-more"},"没有更多数据了"))])):e.createCommentVNode("",!0),a.error?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("image",{src:v,mode:"widthFix",class:"error-icon"}),e.createElementVNode("text",{class:"error-text"},"加载失败，请检查网络"),e.createElementVNode("button",{class:"retry-btn",onClick:n[1]||(n[1]=(...e)=>s.loadPolicies&&s.loadPolicies(...e))},"重试")])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-970d1bb0"]]);const M=u({data:()=>({policy:null,loading:!0,error:!1}),onLoad(e){e.id&&this.loadPolicyDetail(e.id)},methods:{async loadPolicyDetail(e){this.loading=!0,this.error=!1;try{const t=await uni.request({url:`${this.$config.baseUrl}/policy/detail/${e}`}),{data:n}=t;200===n.code&&(this.policy=n.data)}catch(t){this.error=!0,c("error","at pages/policy/detail.vue:87","Failed to load policy detail:",t)}finally{this.loading=!1}},goBack(){uni.navigateBack()},formatDate(e){const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},formatViews:e=>e>1e4?(e/1e4).toFixed(1)+"w":e}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-btn",onClick:n[0]||(n[0]=(...e)=>s.goBack&&s.goBack(...e))},[e.createElementVNode("text",{class:"back-icon"},"←")]),e.createElementVNode("text",{class:"title"},"政策详情")]),a.policy?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content"},[a.policy.cover?(e.openBlock(),e.createElementBlock("image",{key:0,src:a.policy.cover,mode:"widthFix",class:"cover-image"},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"policy-header"},[e.createElementVNode("text",{class:"policy-title"},e.toDisplayString(a.policy.title),1),e.createElementVNode("view",{class:"meta-info"},[e.createElementVNode("text",{class:"publish-date"},"发布时间："+e.toDisplayString(s.formatDate(a.policy.publishDate)),1),e.createElementVNode("text",{class:"views"},"阅读量："+e.toDisplayString(s.formatViews(a.policy.views)),1)]),a.policy.tags&&a.policy.tags.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.policy.tags,((t,n)=>(e.openBlock(),e.createElementBlock("text",{key:n,class:"tag"},e.toDisplayString(t),1)))),128))])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"policy-content"},[e.createElementVNode("rich-text",{nodes:a.policy.content},null,8,["nodes"])])])):e.createCommentVNode("",!0),a.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading"},[e.createElementVNode("image",{src:_,mode:"widthFix",class:"loading-icon"}),e.createElementVNode("text",null,"加载中...")])):e.createCommentVNode("",!0),a.error?(e.openBlock(),e.createElementBlock("view",{key:2,class:"error-container"},[e.createElementVNode("image",{src:v,mode:"widthFix",class:"error-icon"}),e.createElementVNode("text",{class:"error-text"},"加载失败，请检查网络"),e.createElementVNode("button",{class:"retry-btn",onClick:n[1]||(n[1]=(...e)=>s.loadPolicyDetail&&s.loadPolicyDetail(...e))},"重试")])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-bef23b77"]]);const C=u({data:()=>({isVolunteer:!1,userInfo:{id:"",nickname:"",name:"",phone:"",usualAddress:"",voiceSettings:"",serviceHours:"",serviceRating:"",organization:"",certificationTime:"",username:""}}),onLoad(){this.checkVolunteerStatus(),this.loadUserInfo()},onShow(){this.checkVolunteerStatus()},methods:{checkVolunteerStatus(){const e=uni.getStorageSync("userInfo");e&&"志愿者"===e.role?this.isVolunteer=!0:this.isVolunteer=!1},async loadUserInfo(){try{const e=uni.getStorageSync("userInfo");if(c("log","at pages/basicInfo/basicInfo.vue:112","存储的用户信息:",e),!e)throw new Error("未找到用户信息，请先登录");if(!e.id)throw c("error","at pages/basicInfo/basicInfo.vue:119","用户信息中缺少ID:",e),new Error("用户信息不完整，请重新登录");const t=uni.getStorageSync("token");if(c("log","at pages/basicInfo/basicInfo.vue:124","存储的token:",t),!t)throw new Error("未找到登录凭证，请重新登录");const n=await uni.request({url:`${this.$config.baseUrl}/user/getUserInfo?id=${e.id}`,method:"GET",header:{Authorization:`Bearer ${t}`}});if(c("log","at pages/basicInfo/basicInfo.vue:138","获取用户信息响应:",n),200!==n.data.code)throw new Error(n.data.message||"获取用户信息失败");this.userInfo={...this.userInfo,...n.data.data.userInfo},c("log","at pages/basicInfo/basicInfo.vue:143","更新后的用户信息:",this.userInfo)}catch(e){c("error","at pages/basicInfo/basicInfo.vue:148","加载用户信息失败:",e),e.message.includes("未找到用户信息")||e.message.includes("未找到登录凭证")?uni.showModal({title:"提示",content:"请先登录",showCancel:!1,success:()=>{uni.switchTab({url:"/pages/index/mine"})}}):uni.showToast({title:e.message||"加载失败，请重试",icon:"none"})}},async handleSave(){try{const e=uni.getStorageSync("userInfo");if(!e||!e.id)throw new Error("用户未登录");const t=uni.getStorageSync("token");if(!t)throw new Error("未找到登录凭证");this.userInfo.id=e.id;const n=await uni.request({url:`${this.$config.baseUrl}/user/updateUserInfo`,method:"POST",data:this.userInfo,header:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(200!==n.data.code)throw new Error(n.data.message||"保存失败");uni.showToast({title:"保存成功",icon:"success"}),uni.setStorageSync("userInfo",{...e,...this.userInfo})}catch(e){c("error","at pages/basicInfo/basicInfo.vue:210","保存失败:",e),uni.showToast({title:e.message||"保存失败，请重试",icon:"none"})}}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"top-bg"}),e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"昵称"),e.withDirectives(e.createElementVNode("input",{type:"nickname",class:"input","onUpdate:modelValue":n[0]||(n[0]=e=>a.userInfo.nickname=e),placeholder:"请输入昵称"},null,512),[[e.vModelText,a.userInfo.nickname]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"姓名"),e.withDirectives(e.createElementVNode("input",{type:"text",class:"input","onUpdate:modelValue":n[1]||(n[1]=e=>a.userInfo.username=e),placeholder:"请输入用户名"},null,512),[[e.vModelText,a.userInfo.username]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"手机号"),e.withDirectives(e.createElementVNode("input",{type:"number",class:"input","onUpdate:modelValue":n[2]||(n[2]=e=>a.userInfo.phone=e),placeholder:"请输入手机号"},null,512),[[e.vModelText,a.userInfo.phone]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"常用地址"),e.withDirectives(e.createElementVNode("input",{type:"text",class:"input","onUpdate:modelValue":n[3]||(n[3]=e=>a.userInfo.usualAddress=e),placeholder:"请输入常用地址"},null,512),[[e.vModelText,a.userInfo.usualAddress]])]),a.isVolunteer?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"语音设置"),e.withDirectives(e.createElementVNode("input",{type:"text",class:"input","onUpdate:modelValue":n[4]||(n[4]=e=>a.userInfo.voiceSettings=e),placeholder:"请输入语音设置"},null,512),[[e.vModelText,a.userInfo.voiceSettings]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"服务时长"),e.withDirectives(e.createElementVNode("input",{type:"number",class:"input","onUpdate:modelValue":n[5]||(n[5]=e=>a.userInfo.serviceHours=e),placeholder:"请输入服务时长"},null,512),[[e.vModelText,a.userInfo.serviceHours]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"服务评分"),e.withDirectives(e.createElementVNode("input",{type:"number",class:"input","onUpdate:modelValue":n[6]||(n[6]=e=>a.userInfo.serviceRating=e),placeholder:"请输入服务评分"},null,512),[[e.vModelText,a.userInfo.serviceRating]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"所属组织"),e.withDirectives(e.createElementVNode("input",{type:"text",class:"input","onUpdate:modelValue":n[7]||(n[7]=e=>a.userInfo.organization=e),placeholder:"请输入所属组织"},null,512),[[e.vModelText,a.userInfo.organization]])]),e.createElementVNode("view",{class:"form-group"},[e.createElementVNode("text",{class:"label"},"认证时间"),e.withDirectives(e.createElementVNode("input",{type:"text",class:"input","onUpdate:modelValue":n[8]||(n[8]=e=>a.userInfo.certificationTime=e),placeholder:"请输入认证时间"},null,512),[[e.vModelText,a.userInfo.certificationTime]])])],64)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"button-container"},[e.createElementVNode("button",{class:"save-btn",onClick:n[9]||(n[9]=(...e)=>s.handleSave&&s.handleSave(...e))},"保存修改")])])}]]);var E="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},T=[],k=[],S="undefined"!=typeof Uint8Array?Uint8Array:Array,D=!1;function b(){D=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)T[t]=e[t],k[e.charCodeAt(t)]=t;k["-".charCodeAt(0)]=62,k["_".charCodeAt(0)]=63}function A(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16)+(e[s+1]<<8)+e[s+2],a.push(T[(o=i)>>18&63]+T[o>>12&63]+T[o>>6&63]+T[63&o]);return a.join("")}function L(e){var t;D||b();for(var n=e.length,i=n%3,o="",a=[],s=0,r=n-i;s<r;s+=16383)a.push(A(e,s,s+16383>r?r:s+16383));return 1===i?(t=e[n-1],o+=T[t>>2],o+=T[t<<4&63],o+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],o+=T[t>>10],o+=T[t>>4&63],o+=T[t<<2&63],o+="="),a.push(o),a.join("")}function R(e,t,n,i,o){var a,s,r=8*o-i-1,c=(1<<r)-1,u=c>>1,l=-7,d=n?o-1:0,h=n?-1:1,p=e[t+d];for(d+=h,a=p&(1<<-l)-1,p>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=h,l-=8);for(s=a&(1<<-l)-1,a>>=-l,l+=i;l>0;s=256*s+e[t+d],d+=h,l-=8);if(0===a)a=1-u;else{if(a===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),a-=u}return(p?-1:1)*s*Math.pow(2,a-i)}function w(e,t,n,i,o,a){var s,r,c,u=8*a-o-1,l=(1<<u)-1,d=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:a-1,g=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(r=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(r=0,s=l):s+d>=1?(r=(t*c-1)*Math.pow(2,o),s+=d):(r=t*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&r,p+=g,r/=256,o-=8);for(s=s<<o|r,u+=o;u>0;e[n+p]=255&s,p+=g,s/=256,u-=8);e[n+p-g]|=128*f}var O={}.toString,N=Array.isArray||function(e){return"[object Array]"==O.call(e)};function P(){return G.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function U(e,t){if(P()<t)throw new RangeError("Invalid typed array length");return G.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=G.prototype:(null===e&&(e=new G(t)),e.length=t),e}function G(e,t,n){if(!(G.TYPED_ARRAY_SUPPORT||this instanceof G))return new G(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return B(this,e)}return x(this,e,t,n)}function x(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),G.TYPED_ARRAY_SUPPORT?(e=t).__proto__=G.prototype:e=V(e,t),e}(e,t,n,i):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!G.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|H(t,n),o=(e=U(e,i)).write(t,n);return o!==i&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(q(t)){var n=0|j(t.length);return 0===(e=U(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?U(e,0):V(e,t);if("Buffer"===t.type&&N(t.data))return V(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function F(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function B(e,t){if(F(t),e=U(e,t<0?0:0|j(t)),!G.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function V(e,t){var n=t.length<0?0:0|j(t.length);e=U(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function j(e){if(e>=P())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+P().toString(16)+" bytes");return 0|e}function q(e){return!(null==e||!e._isBuffer)}function H(e,t){if(q(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return _e(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ve(e).length;default:if(i)return _e(e).length;t=(""+t).toLowerCase(),i=!0}}function K(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return se(this,t,n);case"utf8":case"utf-8":return ne(this,t,n);case"ascii":return oe(this,t,n);case"latin1":case"binary":return ae(this,t,n);case"base64":return te(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function z(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function Y(e,t,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=G.from(t,i)),q(t))return 0===t.length?-1:$(e,t,n,i,o);if("number"==typeof t)return t&=255,G.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):$(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function $(e,t,n,i,o){var a,s=1,r=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,r/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var l=-1;for(a=n;a<r;a++)if(u(e,a)===u(t,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===c)return l*s}else-1!==l&&(a-=a-l),l=-1}else for(n+c>r&&(n=r-c),a=n;a>=0;a--){for(var d=!0,h=0;h<c;h++)if(u(e,a+h)!==u(t,h)){d=!1;break}if(d)return a}return-1}function W(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i))>o&&(i=o):i=o;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var s=0;s<i;++s){var r=parseInt(t.substr(2*s,2),16);if(isNaN(r))return s;e[n+s]=r}return s}function J(e,t,n,i){return ye(_e(t,e.length-n),e,n,i)}function X(e,t,n,i){return ye(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function Z(e,t,n,i){return X(e,t,n,i)}function Q(e,t,n,i){return ye(ve(t),e,n,i)}function ee(e,t,n,i){return ye(function(e,t){for(var n,i,o,a=[],s=0;s<e.length&&!((t-=2)<0);++s)i=(n=e.charCodeAt(s))>>8,o=n%256,a.push(o),a.push(i);return a}(t,e.length-n),e,n,i)}function te(e,t,n){return 0===t&&n===e.length?L(e):L(e.slice(t,n))}function ne(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var a,s,r,c,u=e[o],l=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(a=e[o+1]))&&(c=(31&u)<<6|63&a)>127&&(l=c);break;case 3:a=e[o+1],s=e[o+2],128==(192&a)&&128==(192&s)&&(c=(15&u)<<12|(63&a)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:a=e[o+1],s=e[o+2],r=e[o+3],128==(192&a)&&128==(192&s)&&128==(192&r)&&(c=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&r)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),o+=d}return function(e){var t=e.length;if(t<=ie)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=ie));return n}(i)}G.TYPED_ARRAY_SUPPORT=void 0===E.TYPED_ARRAY_SUPPORT||E.TYPED_ARRAY_SUPPORT,G.poolSize=8192,G._augment=function(e){return e.__proto__=G.prototype,e},G.from=function(e,t,n){return x(null,e,t,n)},G.TYPED_ARRAY_SUPPORT&&(G.prototype.__proto__=Uint8Array.prototype,G.__proto__=Uint8Array),G.alloc=function(e,t,n){return i=null,a=t,s=n,F(o=e),o<=0?U(i,o):void 0!==a?"string"==typeof s?U(i,o).fill(a,s):U(i,o).fill(a):U(i,o);var i,o,a,s},G.allocUnsafe=function(e){return B(null,e)},G.allocUnsafeSlow=function(e){return B(null,e)},G.isBuffer=Ie,G.compare=function(e,t){if(!q(e)||!q(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},G.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},G.concat=function(e,t){if(!N(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return G.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=G.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!q(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},G.byteLength=H,G.prototype._isBuffer=!0,G.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)z(this,t,t+1);return this},G.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)z(this,t,t+3),z(this,t+1,t+2);return this},G.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)z(this,t,t+7),z(this,t+1,t+6),z(this,t+2,t+5),z(this,t+3,t+4);return this},G.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?ne(this,0,e):K.apply(this,arguments)},G.prototype.equals=function(e){if(!q(e))throw new TypeError("Argument must be a Buffer");return this===e||0===G.compare(this,e)},G.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},G.prototype.compare=function(e,t,n,i,o){if(!q(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0),r=Math.min(a,s),c=this.slice(i,o),u=e.slice(t,n),l=0;l<r;++l)if(c[l]!==u[l]){a=c[l],s=u[l];break}return a<s?-1:s<a?1:0},G.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},G.prototype.indexOf=function(e,t,n){return Y(this,e,t,n,!0)},G.prototype.lastIndexOf=function(e,t,n){return Y(this,e,t,n,!1)},G.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return W(this,e,t,n);case"utf8":case"utf-8":return J(this,e,t,n);case"ascii":return X(this,e,t,n);case"latin1":case"binary":return Z(this,e,t,n);case"base64":return Q(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},G.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ie=4096;function oe(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(127&e[o]);return i}function ae(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]);return i}function se(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",a=t;a<n;++a)o+=me(e[a]);return o}function re(e,t,n){for(var i=e.slice(t,n),o="",a=0;a<i.length;a+=2)o+=String.fromCharCode(i[a]+256*i[a+1]);return o}function ce(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function ue(e,t,n,i,o,a){if(!q(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function le(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function de(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;++o)e[n+o]=t>>>8*(i?o:3-o)&255}function he(e,t,n,i,o,a){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function pe(e,t,n,i,o){return o||he(e,0,n,4),w(e,t,n,i,23,4),n+4}function ge(e,t,n,i,o){return o||he(e,0,n,8),w(e,t,n,i,52,8),n+8}G.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),G.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=G.prototype;else{var o=t-e;n=new G(o,void 0);for(var a=0;a<o;++a)n[a]=this[a+e]}return n},G.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||ce(e,t,this.length);for(var i=this[e],o=1,a=0;++a<t&&(o*=256);)i+=this[e+a]*o;return i},G.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||ce(e,t,this.length);for(var i=this[e+--t],o=1;t>0&&(o*=256);)i+=this[e+--t]*o;return i},G.prototype.readUInt8=function(e,t){return t||ce(e,1,this.length),this[e]},G.prototype.readUInt16LE=function(e,t){return t||ce(e,2,this.length),this[e]|this[e+1]<<8},G.prototype.readUInt16BE=function(e,t){return t||ce(e,2,this.length),this[e]<<8|this[e+1]},G.prototype.readUInt32LE=function(e,t){return t||ce(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},G.prototype.readUInt32BE=function(e,t){return t||ce(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},G.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||ce(e,t,this.length);for(var i=this[e],o=1,a=0;++a<t&&(o*=256);)i+=this[e+a]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},G.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||ce(e,t,this.length);for(var i=t,o=1,a=this[e+--i];i>0&&(o*=256);)a+=this[e+--i]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*t)),a},G.prototype.readInt8=function(e,t){return t||ce(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},G.prototype.readInt16LE=function(e,t){t||ce(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},G.prototype.readInt16BE=function(e,t){t||ce(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},G.prototype.readInt32LE=function(e,t){return t||ce(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},G.prototype.readInt32BE=function(e,t){return t||ce(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},G.prototype.readFloatLE=function(e,t){return t||ce(e,4,this.length),R(this,e,!0,23,4)},G.prototype.readFloatBE=function(e,t){return t||ce(e,4,this.length),R(this,e,!1,23,4)},G.prototype.readDoubleLE=function(e,t){return t||ce(e,8,this.length),R(this,e,!0,52,8)},G.prototype.readDoubleBE=function(e,t){return t||ce(e,8,this.length),R(this,e,!1,52,8)},G.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||ue(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},G.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||ue(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},G.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,1,255,0),G.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},G.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,2,65535,0),G.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):le(this,e,t,!0),t+2},G.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,2,65535,0),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):le(this,e,t,!1),t+2},G.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,4,4294967295,0),G.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):de(this,e,t,!0),t+4},G.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,4,4294967295,0),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):de(this,e,t,!1),t+4},G.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);ue(this,e,t,n,o-1,-o)}var a=0,s=1,r=0;for(this[t]=255&e;++a<n&&(s*=256);)e<0&&0===r&&0!==this[t+a-1]&&(r=1),this[t+a]=(e/s|0)-r&255;return t+n},G.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);ue(this,e,t,n,o-1,-o)}var a=n-1,s=1,r=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===r&&0!==this[t+a+1]&&(r=1),this[t+a]=(e/s|0)-r&255;return t+n},G.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,1,127,-128),G.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},G.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,2,32767,-32768),G.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):le(this,e,t,!0),t+2},G.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,2,32767,-32768),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):le(this,e,t,!1),t+2},G.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,4,2147483647,-2147483648),G.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):de(this,e,t,!0),t+4},G.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||ue(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):de(this,e,t,!1),t+4},G.prototype.writeFloatLE=function(e,t,n){return pe(this,e,t,!0,n)},G.prototype.writeFloatBE=function(e,t,n){return pe(this,e,t,!1,n)},G.prototype.writeDoubleLE=function(e,t,n){return ge(this,e,t,!0,n)},G.prototype.writeDoubleBE=function(e,t,n){return ge(this,e,t,!1,n)},G.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o,a=i-n;if(this===e&&n<t&&t<i)for(o=a-1;o>=0;--o)e[o+t]=this[o+n];else if(a<1e3||!G.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},G.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!G.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=q(e)?e:_e(new G(e,i).toString()),r=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%r]}return this};var fe=/[^+\/0-9A-Za-z-_]/g;function me(e){return e<16?"0"+e.toString(16):e.toString(16)}function _e(e,t){var n;t=t||1/0;for(var i=e.length,o=null,a=[],s=0;s<i;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&a.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&a.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function ve(e){return function(e){var t,n,i,o,a,s;D||b();var r=e.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a="="===e[r-2]?2:"="===e[r-1]?1:0,s=new S(3*r/4-a),i=a>0?r-4:r;var c=0;for(t=0,n=0;t<i;t+=4,n+=3)o=k[e.charCodeAt(t)]<<18|k[e.charCodeAt(t+1)]<<12|k[e.charCodeAt(t+2)]<<6|k[e.charCodeAt(t+3)],s[c++]=o>>16&255,s[c++]=o>>8&255,s[c++]=255&o;return 2===a?(o=k[e.charCodeAt(t)]<<2|k[e.charCodeAt(t+1)]>>4,s[c++]=255&o):1===a&&(o=k[e.charCodeAt(t)]<<10|k[e.charCodeAt(t+1)]<<4|k[e.charCodeAt(t+2)]>>2,s[c++]=o>>8&255,s[c++]=255&o),s}(function(e){if((e=(t=e,t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(fe,"")).length<2)return"";for(var t;e.length%4!=0;)e+="=";return e}(e))}function ye(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function Ie(e){return null!=e&&(!!e._isBuffer||Me(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&Me(t.slice(0,0)));var t}function Me(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function Ce(e,t){return e(t={exports:{}},t.exports),t.exports}var Ee=Ce((function(e,t){var n,i,o,a,s,r,c,u,l,d,h,p,g;e.exports=(n=n||(i=Math,o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),s=(a={}).lib={},r=s.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,o=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<o;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<o;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=i.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t,n=[],o=function(e){var t=987654321,n=4294967295;return function(){var o=((t=36969*(65535&t)+(t>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return o/=4294967296,(o+=.5)*(i.random()>.5?1:-1)}},a=0;a<e;a+=4){var s=o(4294967296*(t||i.random()));t=987654071*s(),n.push(4294967296*s()|0)}return new c.init(n,e)}}),u=a.enc={},l=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var a=t[o>>>2]>>>24-o%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new c.init(n,t/2)}},d=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var a=t[o>>>2]>>>24-o%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new c.init(n,t)}},h=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},p=s.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,o=t.sigBytes,a=this.blockSize,s=o/(4*a),r=(s=e?i.ceil(s):i.max((0|s)-this._minBufferSize,0))*a,u=i.min(4*r,o);if(r){for(var l=0;l<r;l+=a)this._doProcessBlock(n,l);var d=n.splice(0,r);t.sigBytes-=u}return new c.init(d,u)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),s.Hasher=p.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new g.HMAC.init(e,n).finalize(t)}}}),g=a.algo={},a),n)})),Te=(Ce((function(e,t){var n,i,o,a,s,r;e.exports=(o=(i=n=Ee).lib,a=o.Base,s=o.WordArray,(r=i.x64={}).Word=a.extend({init:function(e,t){this.high=e,this.low=t}}),r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],i=0;i<t;i++){var o=e[i];n.push(o.high),n.push(o.low)}return s.create(n,this.sigBytes)},clone:function(){for(var e=a.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}}),n)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,i=[],o=0;o<n;o++)i[o>>>2]|=e[o]<<24-o%4*8;t.call(this,i,n)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib.WordArray,i=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}i.Utf16=i.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o+=2){var a=t[o>>>2]>>>16-o%4*8&65535;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var n=e.length,i=[],o=0;o<n;o++)i[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(i,2*n)}},i.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],a=0;a<n;a+=2){var s=o(t[a>>>2]>>>16-a%4*8&65535);i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var n=e.length,i=[],a=0;a<n;a++)i[a>>>1]|=o(e.charCodeAt(a)<<16-a%2*16);return t.create(i,2*n)}}}(),n.enc.Utf16)})),Ce((function(e,t){var n,i,o;e.exports=(o=(i=n=Ee).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var o=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,r=0;r<4&&a+.75*r<n;r++)o.push(i.charAt(s>>>6*(3-r)&63));var c=i.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var a=0;a<n.length;a++)i[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var r=e.indexOf(s);-1!==r&&(t=r)}return function(e,t,n){for(var i=[],a=0,s=0;s<t;s++)if(s%4){var r=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;i[a>>>2]|=(r|c)<<24-a%4*8,a++}return o.create(i,a)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(e){var t=n,i=t.lib,o=i.WordArray,a=i.Hasher,s=t.algo,r=[];!function(){for(var t=0;t<64;t++)r[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var a=this._hash.words,s=e[t+0],c=e[t+1],p=e[t+2],g=e[t+3],f=e[t+4],m=e[t+5],_=e[t+6],v=e[t+7],y=e[t+8],I=e[t+9],M=e[t+10],C=e[t+11],E=e[t+12],T=e[t+13],k=e[t+14],S=e[t+15],D=a[0],b=a[1],A=a[2],L=a[3];D=u(D,b,A,L,s,7,r[0]),L=u(L,D,b,A,c,12,r[1]),A=u(A,L,D,b,p,17,r[2]),b=u(b,A,L,D,g,22,r[3]),D=u(D,b,A,L,f,7,r[4]),L=u(L,D,b,A,m,12,r[5]),A=u(A,L,D,b,_,17,r[6]),b=u(b,A,L,D,v,22,r[7]),D=u(D,b,A,L,y,7,r[8]),L=u(L,D,b,A,I,12,r[9]),A=u(A,L,D,b,M,17,r[10]),b=u(b,A,L,D,C,22,r[11]),D=u(D,b,A,L,E,7,r[12]),L=u(L,D,b,A,T,12,r[13]),A=u(A,L,D,b,k,17,r[14]),D=l(D,b=u(b,A,L,D,S,22,r[15]),A,L,c,5,r[16]),L=l(L,D,b,A,_,9,r[17]),A=l(A,L,D,b,C,14,r[18]),b=l(b,A,L,D,s,20,r[19]),D=l(D,b,A,L,m,5,r[20]),L=l(L,D,b,A,M,9,r[21]),A=l(A,L,D,b,S,14,r[22]),b=l(b,A,L,D,f,20,r[23]),D=l(D,b,A,L,I,5,r[24]),L=l(L,D,b,A,k,9,r[25]),A=l(A,L,D,b,g,14,r[26]),b=l(b,A,L,D,y,20,r[27]),D=l(D,b,A,L,T,5,r[28]),L=l(L,D,b,A,p,9,r[29]),A=l(A,L,D,b,v,14,r[30]),D=d(D,b=l(b,A,L,D,E,20,r[31]),A,L,m,4,r[32]),L=d(L,D,b,A,y,11,r[33]),A=d(A,L,D,b,C,16,r[34]),b=d(b,A,L,D,k,23,r[35]),D=d(D,b,A,L,c,4,r[36]),L=d(L,D,b,A,f,11,r[37]),A=d(A,L,D,b,v,16,r[38]),b=d(b,A,L,D,M,23,r[39]),D=d(D,b,A,L,T,4,r[40]),L=d(L,D,b,A,s,11,r[41]),A=d(A,L,D,b,g,16,r[42]),b=d(b,A,L,D,_,23,r[43]),D=d(D,b,A,L,I,4,r[44]),L=d(L,D,b,A,E,11,r[45]),A=d(A,L,D,b,S,16,r[46]),D=h(D,b=d(b,A,L,D,p,23,r[47]),A,L,s,6,r[48]),L=h(L,D,b,A,v,10,r[49]),A=h(A,L,D,b,k,15,r[50]),b=h(b,A,L,D,m,21,r[51]),D=h(D,b,A,L,E,6,r[52]),L=h(L,D,b,A,g,10,r[53]),A=h(A,L,D,b,M,15,r[54]),b=h(b,A,L,D,c,21,r[55]),D=h(D,b,A,L,y,6,r[56]),L=h(L,D,b,A,S,10,r[57]),A=h(A,L,D,b,_,15,r[58]),b=h(b,A,L,D,T,21,r[59]),D=h(D,b,A,L,f,6,r[60]),L=h(L,D,b,A,C,10,r[61]),A=h(A,L,D,b,p,15,r[62]),b=h(b,A,L,D,I,21,r[63]),a[0]=a[0]+D|0,a[1]=a[1]+b|0,a[2]=a[2]+A|0,a[3]=a[3]+L|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var a=e.floor(i/4294967296),s=i;n[15+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),n[14+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process();for(var r=this._hash,c=r.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return r},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,i,o,a,s){var r=e+(t&n|~t&i)+o+s;return(r<<a|r>>>32-a)+t}function l(e,t,n,i,o,a,s){var r=e+(t&i|n&~i)+o+s;return(r<<a|r>>>32-a)+t}function d(e,t,n,i,o,a,s){var r=e+(t^n^i)+o+s;return(r<<a|r>>>32-a)+t}function h(e,t,n,i,o,a,s){var r=e+(n^(t|~i))+o+s;return(r<<a|r>>>32-a)+t}t.MD5=a._createHelper(c),t.HmacMD5=a._createHmacHelper(c)}(Math),n.MD5)})),Ce((function(e,t){var n,i,o,a,s,r,c,u;e.exports=(o=(i=n=Ee).lib,a=o.WordArray,s=o.Hasher,r=i.algo,c=[],u=r.SHA1=s.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],a=n[2],s=n[3],r=n[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var l=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=l<<1|l>>>31}var d=(i<<5|i>>>27)+r+c[u];d+=u<20?1518500249+(o&a|~o&s):u<40?1859775393+(o^a^s):u<60?(o&a|o&s|a&s)-1894007588:(o^a^s)-899497514,r=s,s=a,a=o<<30|o>>>2,o=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+r|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.SHA1=s._createHelper(u),i.HmacSHA1=s._createHmacHelper(u),n.SHA1)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(e){var t=n,i=t.lib,o=i.WordArray,a=i.Hasher,s=t.algo,r=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,o=0;o<64;)t(i)&&(o<8&&(r[o]=n(e.pow(i,.5))),c[o]=n(e.pow(i,1/3)),o++),i++}();var u=[],l=s.SHA256=a.extend({_doReset:function(){this._hash=new o.init(r.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],a=n[2],s=n[3],r=n[4],l=n[5],d=n[6],h=n[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var g=u[p-15],f=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,m=u[p-2],_=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;u[p]=f+u[p-7]+_+u[p-16]}var v=i&o^i&a^o&a,y=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),I=h+((r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25))+(r&l^~r&d)+c[p]+u[p];h=d,d=l,l=r,r=s+I|0,s=a,a=o,o=i,i=I+(y+v)|0}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+r|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(i/4294967296),n[15+(o+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=a._createHelper(l),t.HmacSHA256=a._createHmacHelper(l)}(Math),n.SHA256)})),Ce((function(e,t){var n,i,o,a,s,r;e.exports=(o=(i=n=Ee).lib.WordArray,a=i.algo,s=a.SHA256,r=a.SHA224=s.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=4,e}}),i.SHA224=s._createHelper(r),i.HmacSHA224=s._createHmacHelper(r),n.SHA224)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib.Hasher,i=e.x64,o=i.Word,a=i.WordArray,s=e.algo;function r(){return o.create.apply(o,arguments)}var c=[r(1116352408,3609767458),r(1899447441,602891725),r(3049323471,3964484399),r(3921009573,2173295548),r(961987163,4081628472),r(1508970993,3053834265),r(2453635748,2937671579),r(2870763221,3664609560),r(3624381080,2734883394),r(310598401,1164996542),r(607225278,1323610764),r(1426881987,3590304994),r(1925078388,4068182383),r(2162078206,991336113),r(2614888103,633803317),r(3248222580,3479774868),r(3835390401,2666613458),r(4022224774,944711139),r(264347078,2341262773),r(604807628,2007800933),r(770255983,1495990901),r(1249150122,1856431235),r(1555081692,3175218132),r(1996064986,2198950837),r(2554220882,3999719339),r(2821834349,766784016),r(2952996808,2566594879),r(3210313671,3203337956),r(3336571891,1034457026),r(3584528711,2466948901),r(113926993,3758326383),r(338241895,168717936),r(666307205,1188179964),r(773529912,1546045734),r(1294757372,1522805485),r(1396182291,2643833823),r(1695183700,2343527390),r(1986661051,1014477480),r(2177026350,1206759142),r(2456956037,344077627),r(2730485921,1290863460),r(2820302411,3158454273),r(3259730800,3505952657),r(3345764771,106217008),r(3516065817,3606008344),r(3600352804,1432725776),r(4094571909,1467031594),r(275423344,851169720),r(430227734,3100823752),r(506948616,1363258195),r(659060556,3750685593),r(883997877,3785050280),r(958139571,3318307427),r(1322822218,3812723403),r(1537002063,2003034995),r(1747873779,3602036899),r(1955562222,1575990012),r(2024104815,1125592928),r(2227730452,2716904306),r(2361852424,442776044),r(2428436474,593698344),r(2756734187,3733110249),r(3204031479,2999351573),r(3329325298,3815920427),r(3391569614,3928383900),r(3515267271,566280711),r(3940187606,3454069534),r(4118630271,4000239992),r(116418474,1914138554),r(174292421,2731055270),r(289380356,3203993006),r(460393269,320620315),r(685471733,587496836),r(852142971,1086792851),r(1017036298,365543100),r(1126000580,2618297676),r(1288033470,3409855158),r(1501505948,4234509866),r(1607167915,987167468),r(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=r()}();var l=s.SHA512=t.extend({_doReset:function(){this._hash=new a.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],a=n[2],s=n[3],r=n[4],l=n[5],d=n[6],h=n[7],p=i.high,g=i.low,f=o.high,m=o.low,_=a.high,v=a.low,y=s.high,I=s.low,M=r.high,C=r.low,E=l.high,T=l.low,k=d.high,S=d.low,D=h.high,b=h.low,A=p,L=g,R=f,w=m,O=_,N=v,P=y,U=I,G=M,x=C,F=E,B=T,V=k,j=S,q=D,H=b,K=0;K<80;K++){var z=u[K];if(K<16)var Y=z.high=0|e[t+2*K],$=z.low=0|e[t+2*K+1];else{var W=u[K-15],J=W.high,X=W.low,Z=(J>>>1|X<<31)^(J>>>8|X<<24)^J>>>7,Q=(X>>>1|J<<31)^(X>>>8|J<<24)^(X>>>7|J<<25),ee=u[K-2],te=ee.high,ne=ee.low,ie=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ae=u[K-7],se=ae.high,re=ae.low,ce=u[K-16],ue=ce.high,le=ce.low;Y=(Y=(Y=Z+se+(($=Q+re)>>>0<Q>>>0?1:0))+ie+(($+=oe)>>>0<oe>>>0?1:0))+ue+(($+=le)>>>0<le>>>0?1:0),z.high=Y,z.low=$}var de,he=G&F^~G&V,pe=x&B^~x&j,ge=A&R^A&O^R&O,fe=L&w^L&N^w&N,me=(A>>>28|L<<4)^(A<<30|L>>>2)^(A<<25|L>>>7),_e=(L>>>28|A<<4)^(L<<30|A>>>2)^(L<<25|A>>>7),ve=(G>>>14|x<<18)^(G>>>18|x<<14)^(G<<23|x>>>9),ye=(x>>>14|G<<18)^(x>>>18|G<<14)^(x<<23|G>>>9),Ie=c[K],Me=Ie.high,Ce=Ie.low,Ee=q+ve+((de=H+ye)>>>0<H>>>0?1:0),Te=_e+fe;q=V,H=j,V=F,j=B,F=G,B=x,G=P+(Ee=(Ee=(Ee=Ee+he+((de+=pe)>>>0<pe>>>0?1:0))+Me+((de+=Ce)>>>0<Ce>>>0?1:0))+Y+((de+=$)>>>0<$>>>0?1:0))+((x=U+de|0)>>>0<U>>>0?1:0)|0,P=O,U=N,O=R,N=w,R=A,w=L,A=Ee+(me+ge+(Te>>>0<_e>>>0?1:0))+((L=de+Te|0)>>>0<de>>>0?1:0)|0}g=i.low=g+L,i.high=p+A+(g>>>0<L>>>0?1:0),m=o.low=m+w,o.high=f+R+(m>>>0<w>>>0?1:0),v=a.low=v+N,a.high=_+O+(v>>>0<N>>>0?1:0),I=s.low=I+U,s.high=y+P+(I>>>0<U>>>0?1:0),C=r.low=C+x,r.high=M+G+(C>>>0<x>>>0?1:0),T=l.low=T+B,l.high=E+F+(T>>>0<B>>>0?1:0),S=d.low=S+j,d.high=k+V+(S>>>0<j>>>0?1:0),b=h.low=b+H,h.high=D+q+(b>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(i+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),n.SHA512)})),Ce((function(e,t){var n,i,o,a,s,r,c,u;e.exports=(o=(i=n=Ee).x64,a=o.Word,s=o.WordArray,r=i.algo,c=r.SHA512,u=r.SHA384=c.extend({_doReset:function(){this._hash=new s.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),i.SHA384=c._createHelper(u),i.HmacSHA384=c._createHmacHelper(u),n.SHA384)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(e){var t=n,i=t.lib,o=i.WordArray,a=i.Hasher,s=t.x64.Word,r=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){c[e+5*t]=(n+1)*(n+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,a=0;a<24;a++){for(var r=0,d=0,h=0;h<7;h++){if(1&o){var p=(1<<h)-1;p<32?d^=1<<p:r^=1<<p-32}128&o?o=o<<1^113:o<<=1}l[a]=s.create(r,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=s.create()}();var h=r.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,i=this.blockSize/2,o=0;o<i;o++){var a=e[t+2*o],s=e[t+2*o+1];a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(b=n[o]).high^=s,b.low^=a}for(var r=0;r<24;r++){for(var h=0;h<5;h++){for(var p=0,g=0,f=0;f<5;f++)p^=(b=n[h+5*f]).high,g^=b.low;var m=d[h];m.high=p,m.low=g}for(h=0;h<5;h++){var _=d[(h+4)%5],v=d[(h+1)%5],y=v.high,I=v.low;for(p=_.high^(y<<1|I>>>31),g=_.low^(I<<1|y>>>31),f=0;f<5;f++)(b=n[h+5*f]).high^=p,b.low^=g}for(var M=1;M<25;M++){var C=(b=n[M]).high,E=b.low,T=c[M];T<32?(p=C<<T|E>>>32-T,g=E<<T|C>>>32-T):(p=E<<T-32|C>>>64-T,g=C<<T-32|E>>>64-T);var k=d[u[M]];k.high=p,k.low=g}var S=d[0],D=n[0];for(S.high=D.high,S.low=D.low,h=0;h<5;h++)for(f=0;f<5;f++){var b=n[M=h+5*f],A=d[M],L=d[(h+1)%5+5*f],R=d[(h+2)%5+5*f];b.high=A.high^~L.high&R.high,b.low=A.low^~L.low&R.low}b=n[0];var w=l[r];b.high^=w.high,b.low^=w.low}},_doFinalize:function(){var t=this._data,n=t.words,i=(this._nDataBytes,8*t.sigBytes),a=32*this.blockSize;n[i>>>5]|=1<<24-i%32,n[(e.ceil((i+1)/a)*a>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var s=this._state,r=this.cfg.outputLength/8,c=r/8,u=[],l=0;l<c;l++){var d=s[l],h=d.high,p=d.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),u.push(p),u.push(h)}return new o.init(u,r)},clone:function(){for(var e=a.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=a._createHelper(h),t.HmacSHA3=a._createHmacHelper(h)}(Math),n.SHA3)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib,i=t.WordArray,o=t.Hasher,a=e.algo,s=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),r=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),l=i.create([0,1518500249,1859775393,2400959708,2840853838]),d=i.create([1352829926,1548603684,1836072691,2053994217,0]),h=a.RIPEMD160=o.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var a,h,y,I,M,C,E,T,k,S,D,b=this._hash.words,A=l.words,L=d.words,R=s.words,w=r.words,O=c.words,N=u.words;for(C=a=b[0],E=h=b[1],T=y=b[2],k=I=b[3],S=M=b[4],n=0;n<80;n+=1)D=a+e[t+R[n]]|0,D+=n<16?p(h,y,I)+A[0]:n<32?g(h,y,I)+A[1]:n<48?f(h,y,I)+A[2]:n<64?m(h,y,I)+A[3]:_(h,y,I)+A[4],D=(D=v(D|=0,O[n]))+M|0,a=M,M=I,I=v(y,10),y=h,h=D,D=C+e[t+w[n]]|0,D+=n<16?_(E,T,k)+L[0]:n<32?m(E,T,k)+L[1]:n<48?f(E,T,k)+L[2]:n<64?g(E,T,k)+L[3]:p(E,T,k)+L[4],D=(D=v(D|=0,N[n]))+S|0,C=S,S=k,k=v(T,10),T=E,E=D;D=b[1]+y+k|0,b[1]=b[2]+I+S|0,b[2]=b[3]+M+C|0,b[3]=b[4]+a+E|0,b[4]=b[0]+h+T|0,b[0]=D},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,a=o.words,s=0;s<5;s++){var r=a[s];a[s]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}return o},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function p(e,t,n){return e^t^n}function g(e,t,n){return e&t|~e&n}function f(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function _(e,t,n){return e^(t|~n)}function v(e,t){return e<<t|e>>>32-t}e.RIPEMD160=o._createHelper(h),e.HmacRIPEMD160=o._createHmacHelper(h)}(),n.RIPEMD160)})),Ce((function(e,t){var n,i,o,a;e.exports=(i=(n=Ee).lib.Base,o=n.enc,a=o.Utf8,void(n.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),r=o.words,c=s.words,u=0;u<n;u++)r[u]^=1549556828,c[u]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),Ce((function(e,t){var n,i,o,a,s,r,c,u,l;e.exports=(a=(o=(i=n=Ee).lib).Base,s=o.WordArray,c=(r=i.algo).SHA1,u=r.HMAC,l=r.PBKDF2=a.extend({cfg:a.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=u.create(n.hasher,e),o=s.create(),a=s.create([1]),r=o.words,c=a.words,l=n.keySize,d=n.iterations;r.length<l;){var h=i.update(t).finalize(a);i.reset();for(var p=h.words,g=p.length,f=h,m=1;m<d;m++){f=i.finalize(f),i.reset();for(var _=f.words,v=0;v<g;v++)p[v]^=_[v]}o.concat(h),c[0]++}return o.sigBytes=4*l,o}}),i.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)},n.PBKDF2)})),Ce((function(e,t){var n,i,o,a,s,r,c,u;e.exports=(a=(o=(i=n=Ee).lib).Base,s=o.WordArray,c=(r=i.algo).MD5,u=r.EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=n.hasher.create(),o=s.create(),a=o.words,r=n.keySize,c=n.iterations;a.length<r;){u&&i.update(u);var u=i.update(e).finalize(t);i.reset();for(var l=1;l<c;l++)u=i.finalize(u),i.reset();o.concat(u)}return o.sigBytes=4*r,o}}),i.EvpKDF=function(e,t,n){return u.create(n).compute(e,t)},n.EvpKDF)})),Ce((function(e,t){var n,i,o,a,s,r,c,u,l,d,h,p,g,f,m,_,v,y,I,M,C,E,T;e.exports=void((n=Ee).lib.Cipher||(i=n,o=i.lib,a=o.Base,s=o.WordArray,r=o.BufferedBlockAlgorithm,c=i.enc,c.Utf8,u=c.Base64,l=i.algo,d=l.EvpKDF,h=o.Cipher=r.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?T:M}return function(t){return{encrypt:function(n,i,o){return e(i).encrypt(t,n,i,o)},decrypt:function(n,i,o){return e(i).decrypt(t,n,i,o)}}}}()}),o.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),p=i.mode={},g=o.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=p.CBC=function(){var e=g.extend();function t(e,t,n){var i=this._iv;if(i){var o=i;this._iv=undefined}else o=this._prevBlock;for(var a=0;a<n;a++)e[t+a]^=o[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize;t.call(this,e,n,o),i.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,a=e.slice(n,n+o);i.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=a}}),e}(),m=i.pad={},_=m.Pkcs7={pad:function(e,t){for(var n=4*t,i=n-e.sigBytes%n,o=i<<24|i<<16|i<<8|i,a=[],r=0;r<i;r+=4)a.push(o);var c=s.create(a,i);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.BlockCipher=h.extend({cfg:h.cfg.extend({mode:f,padding:_}),reset:function(){h.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=n.createEncryptor;else{i=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==i?this._mode.init(this,t&&t.words):(this._mode=i.call(n,this,t&&t.words),this._mode.__creator=i)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),v=o.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=i.format={},I=y.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var i=s.create([1398893684,1701076831]).concat(n).concat(t);else i=t;return i.toString(u)},parse:function(e){var t=u.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var i=s.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return v.create({ciphertext:t,salt:i})}},M=o.SerializableCipher=a.extend({cfg:a.extend({format:I}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var o=e.createEncryptor(n,i),a=o.finalize(t),s=o.cfg;return v.create({ciphertext:a,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),C=i.kdf={},E=C.OpenSSL={execute:function(e,t,n,i){i||(i=s.random(8));var o=d.create({keySize:t+n}).compute(e,i),a=s.create(o.words.slice(t),4*n);return o.sigBytes=4*t,v.create({key:o,iv:a,salt:i})}},T=o.PasswordBasedCipher=M.extend({cfg:M.cfg.extend({kdf:E}),encrypt:function(e,t,n,i){var o=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize);i.iv=o.iv;var a=M.encrypt.call(this,e,t,o.key,i);return a.mixIn(o),a},decrypt:function(e,t,n,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var o=i.kdf.execute(n,e.keySize,e.ivSize,t.salt);return i.iv=o.iv,M.decrypt.call(this,e,t,o.key,i)}})))})),Ce((function(e,t){var n;e.exports=((n=Ee).mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,n,i){var o=this._iv;if(o){var a=o.slice(0);this._iv=void 0}else a=this._prevBlock;i.encryptBlock(a,0);for(var s=0;s<n;s++)e[t+s]^=a[s]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize;t.call(this,e,n,o,i),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,a=e.slice(n,n+o);t.call(this,e,n,o,i),this._prevBlock=a}}),e}(),n.mode.CFB)})),Ce((function(e,t){var n,i,o;e.exports=((n=Ee).mode.CTR=(o=(i=n.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,a=this._counter;o&&(a=this._counter=o.slice(0),this._iv=void 0);var s=a.slice(0);n.encryptBlock(s,0),a[i-1]=a[i-1]+1|0;for(var r=0;r<i;r++)e[t+r]^=s[r]}}),i.Decryptor=o,i),n.mode.CTR)})),Ce((function(e,t){var n;e.exports=((n=Ee).mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}return e}var i=e.Encryptor=e.extend({processBlock:function(e,n){var i,o=this._cipher,a=o.blockSize,s=this._iv,r=this._counter;s&&(r=this._counter=s.slice(0),this._iv=void 0),0===((i=r)[0]=t(i[0]))&&(i[1]=t(i[1]));var c=r.slice(0);o.encryptBlock(c,0);for(var u=0;u<a;u++)e[n+u]^=c[u]}});return e.Decryptor=i,e}(),n.mode.CTRGladman)})),Ce((function(e,t){var n,i,o;e.exports=((n=Ee).mode.OFB=(o=(i=n.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,a=this._keystream;o&&(a=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(a,0);for(var s=0;s<i;s++)e[t+s]^=a[s]}}),i.Decryptor=o,i),n.mode.OFB)})),Ce((function(e,t){var n,i;e.exports=((n=Ee).mode.ECB=((i=n.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),i.Decryptor=i.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),i),n.mode.ECB)})),Ce((function(e,t){var n;e.exports=((n=Ee).pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,i=4*t,o=i-n%i,a=n+o-1;e.clamp(),e.words[a>>>2]|=o<<24-a%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)})),Ce((function(e,t){var n;e.exports=((n=Ee).pad.Iso10126={pad:function(e,t){var i=4*t,o=i-e.sigBytes%i;e.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)})),Ce((function(e,t){var n;e.exports=((n=Ee).pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)})),Ce((function(e,t){var n;e.exports=((n=Ee).pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},n.pad.ZeroPadding)})),Ce((function(e,t){var n;e.exports=((n=Ee).pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)})),Ce((function(e,t){var n,i,o,a;e.exports=(o=(i=n=Ee).lib.CipherParams,a=i.enc.Hex,i.format.Hex={stringify:function(e){return e.ciphertext.toString(a)},parse:function(e){var t=a.parse(e);return o.create({ciphertext:t})}},n.format.Hex)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib.BlockCipher,i=e.algo,o=[],a=[],s=[],r=[],c=[],u=[],l=[],d=[],h=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,i=0;for(t=0;t<256;t++){var g=i^i<<1^i<<2^i<<3^i<<4;g=g>>>8^255&g^99,o[n]=g,a[g]=n;var f=e[n],m=e[f],_=e[m],v=257*e[g]^16843008*g;s[n]=v<<24|v>>>8,r[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,u[n]=v,v=16843009*_^65537*m^257*f^16843008*n,l[g]=v<<24|v>>>8,d[g]=v<<16|v>>>16,h[g]=v<<8|v>>>24,p[g]=v,n?(n=f^e[e[e[_^f]]],i^=e[e[i]]):n=i=1}}();var g=[0,1,2,4,8,16,32,64,128,27,54],f=i.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,i=4*((this._nRounds=n+6)+1),a=this._keySchedule=[],s=0;s<i;s++)if(s<n)a[s]=t[s];else{var r=a[s-1];s%n?n>6&&s%n==4&&(r=o[r>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r]):(r=o[(r=r<<8|r>>>24)>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r],r^=g[s/n|0]<<24),a[s]=a[s-n]^r}for(var c=this._invKeySchedule=[],u=0;u<i;u++)s=i-u,r=u%4?a[s]:a[s-4],c[u]=u<4||s<=4?r:l[o[r>>>24]]^d[o[r>>>16&255]]^h[o[r>>>8&255]]^p[o[255&r]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,r,c,u,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,h,p,a),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,o,a,s,r){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],p=4,g=1;g<c;g++){var f=i[u>>>24]^o[l>>>16&255]^a[d>>>8&255]^s[255&h]^n[p++],m=i[l>>>24]^o[d>>>16&255]^a[h>>>8&255]^s[255&u]^n[p++],_=i[d>>>24]^o[h>>>16&255]^a[u>>>8&255]^s[255&l]^n[p++],v=i[h>>>24]^o[u>>>16&255]^a[l>>>8&255]^s[255&d]^n[p++];u=f,l=m,d=_,h=v}f=(r[u>>>24]<<24|r[l>>>16&255]<<16|r[d>>>8&255]<<8|r[255&h])^n[p++],m=(r[l>>>24]<<24|r[d>>>16&255]<<16|r[h>>>8&255]<<8|r[255&u])^n[p++],_=(r[d>>>24]<<24|r[h>>>16&255]<<16|r[u>>>8&255]<<8|r[255&l])^n[p++],v=(r[h>>>24]<<24|r[u>>>16&255]<<16|r[l>>>8&255]<<8|r[255&d])^n[p++],e[t]=f,e[t+1]=m,e[t+2]=_,e[t+3]=v},keySize:8});e.AES=t._createHelper(f)}(),n.AES)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib,i=t.WordArray,o=t.BlockCipher,a=e.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],r=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=a.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var i=s[n]-1;t[n]=e[i>>>5]>>>31-i%32&1}for(var o=this._subKeys=[],a=0;a<16;a++){var u=o[a]=[],l=c[a];for(n=0;n<24;n++)u[n/6|0]|=t[(r[n]-1+l)%28]<<31-n%6,u[4+(n/6|0)]|=t[28+(r[n+24]-1+l)%28]<<31-n%6;for(u[0]=u[0]<<1|u[0]>>>31,n=1;n<7;n++)u[n]=u[n]>>>4*(n-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),h.call(this,1,1431655765);for(var i=0;i<16;i++){for(var o=n[i],a=this._lBlock,s=this._rBlock,r=0,c=0;c<8;c++)r|=u[c][((s^o[c])&l[c])>>>0];this._lBlock=s,this._rBlock=a^r}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,h.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function p(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=o._createHelper(d);var g=a.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(i.create(e.slice(0,2))),this._des2=d.createEncryptor(i.create(e.slice(2,4))),this._des3=d.createEncryptor(i.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(g)}(),n.TripleDES)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib.StreamCipher,i=e.algo,o=i.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,i=this._S=[],o=0;o<256;o++)i[o]=o;o=0;for(var a=0;o<256;o++){var s=o%n,r=t[s>>>2]>>>24-s%4*8&255;a=(a+i[o]+r)%256;var c=i[o];i[o]=i[a],i[a]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=a.call(this)},keySize:8,ivSize:0});function a(){for(var e=this._S,t=this._i,n=this._j,i=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var a=e[t];e[t]=e[n],e[n]=a,i|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,i}e.RC4=t._createHelper(o);var s=i.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)a.call(this)}});e.RC4Drop=t._createHelper(s)}(),n.RC4)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib.StreamCipher,i=e.algo,o=[],a=[],s=[],r=i.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)o[n]^=i[n+4&7];if(t){var a=t.words,s=a[0],r=a[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),d=u>>>16|4294901760&l,h=l<<16|65535&u;for(o[0]^=u,o[1]^=d,o[2]^=l,o[3]^=h,o[4]^=u,o[5]^=d,o[6]^=l,o[7]^=h,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)o[i]=16711935&(o[i]<<8|o[i]>>>24)|4278255360&(o[i]<<24|o[i]>>>8),e[t+i]^=o[i]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)a[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],o=65535&i,r=i>>>16,c=((o*o>>>17)+o*r>>>15)+r*r,u=((4294901760&i)*i|0)+((65535&i)*i|0);s[n]=c^u}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.Rabbit=t._createHelper(r)}(),n.Rabbit)})),Ce((function(e,t){var n;e.exports=(n=Ee,function(){var e=n,t=e.lib.StreamCipher,i=e.algo,o=[],a=[],s=[],r=i.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)c.call(this);for(o=0;o<8;o++)i[o]^=n[o+4&7];if(t){var a=t.words,s=a[0],r=a[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),d=u>>>16|4294901760&l,h=l<<16|65535&u;for(i[0]^=u,i[1]^=d,i[2]^=l,i[3]^=h,i[4]^=u,i[5]^=d,i[6]^=l,i[7]^=h,o=0;o<4;o++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)o[i]=16711935&(o[i]<<8|o[i]>>>24)|4278255360&(o[i]<<24|o[i]>>>8),e[t+i]^=o[i]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)a[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],o=65535&i,r=i>>>16,c=((o*o>>>17)+o*r>>>15)+r*r,u=((4294901760&i)*i|0)+((65535&i)*i|0);s[n]=c^u}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.RabbitLegacy=t._createHelper(r)}(),n.RabbitLegacy)})),Ce((function(e,t){e.exports=Ee})));function ke(){throw new Error("setTimeout has not been defined")}function Se(){throw new Error("clearTimeout has not been defined")}var De=ke,be=Se;function Ae(e){if(De===setTimeout)return setTimeout(e,0);if((De===ke||!De)&&setTimeout)return De=setTimeout,setTimeout(e,0);try{return De(e,0)}catch(t){try{return De.call(null,e,0)}catch(n){return De.call(this,e,0)}}}"function"==typeof E.setTimeout&&(De=setTimeout),"function"==typeof E.clearTimeout&&(be=clearTimeout);var Le,Re=[],we=!1,Oe=-1;function Ne(){we&&Le&&(we=!1,Le.length?Re=Le.concat(Re):Oe=-1,Re.length&&Pe())}function Pe(){if(!we){var e=Ae(Ne);we=!0;for(var t=Re.length;t;){for(Le=Re,Re=[];++Oe<t;)Le&&Le[Oe].run();Oe=-1,t=Re.length}Le=null,we=!1,function(e){if(be===clearTimeout)return clearTimeout(e);if((be===Se||!be)&&clearTimeout)return be=clearTimeout,clearTimeout(e);try{be(e)}catch(t){try{return be.call(null,e)}catch(n){return be.call(this,e)}}}(e)}}function Ue(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Re.push(new Ge(e,t)),1!==Re.length||we||Ae(Pe)}function Ge(e,t){this.fun=e,this.array=t}Ge.prototype.run=function(){this.fun.apply(null,this.array)};var xe=E.performance||{};function Fe(){}function Be(){Be.init.call(this)}function Ve(e){return void 0===e._maxListeners?Be.defaultMaxListeners:e._maxListeners}function je(e,t,n,i){var o,a,s,r;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),s=a[t]):(a=e._events=new Fe,e._eventsCount=0),s){if("function"==typeof s?s=a[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),!s.warned&&(o=Ve(e))&&o>0&&s.length>o){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,r=u,"function"==typeof console.warn?c("warn","at debug/lib-generate-test-usersig-es.min.js:2",r):c("log","at debug/lib-generate-test-usersig-es.min.js:2",r)}}else s=a[t]=n,++e._eventsCount;return e}function qe(e,t,n){var i=!1;function o(){e.removeListener(t,o),i||(i=!0,n.apply(e,arguments))}return o.listener=n,o}function He(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function Ke(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}xe.now||xe.mozNow||xe.msNow||xe.oNow||xe.webkitNow,Fe.prototype=Object.create(null),Be.EventEmitter=Be,Be.usingDomains=!1,Be.prototype.domain=void 0,Be.prototype._events=void 0,Be.prototype._maxListeners=void 0,Be.defaultMaxListeners=10,Be.init=function(){this.domain=null,Be.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Fe,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Be.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Be.prototype.getMaxListeners=function(){return Ve(this)},Be.prototype.emit=function(e){var t,n,i,o,a,s,r,c="error"===e;if(s=this._events)c=c&&null==s.error;else if(!c)return!1;if(r=this.domain,c){if(t=arguments[1],!r){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=r,t.domainThrown=!1,r.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(i=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var i=e.length,o=Ke(e,i),a=0;a<i;++a)o[a].call(n)}(n,l,this);break;case 2:!function(e,t,n,i){if(t)e.call(n,i);else for(var o=e.length,a=Ke(e,o),s=0;s<o;++s)a[s].call(n,i)}(n,l,this,arguments[1]);break;case 3:!function(e,t,n,i,o){if(t)e.call(n,i,o);else for(var a=e.length,s=Ke(e,a),r=0;r<a;++r)s[r].call(n,i,o)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,i,o,a){if(t)e.call(n,i,o,a);else for(var s=e.length,r=Ke(e,s),c=0;c<s;++c)r[c].call(n,i,o,a)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(i-1),a=1;a<i;a++)o[a-1]=arguments[a];!function(e,t,n,i){if(t)e.apply(n,i);else for(var o=e.length,a=Ke(e,o),s=0;s<o;++s)a[s].apply(n,i)}(n,l,this,o)}return!0},Be.prototype.addListener=function(e,t){return je(this,e,t,!1)},Be.prototype.on=Be.prototype.addListener,Be.prototype.prependListener=function(e,t){return je(this,e,t,!0)},Be.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,qe(this,e,t)),this},Be.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,qe(this,e,t)),this},Be.prototype.removeListener=function(e,t){var n,i,o,a,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Fe:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){s=n[a].listener,o=a;break}if(o<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Fe,this;delete i[e]}else!function(e,t){for(var n=t,i=n+1,o=e.length;i<o;n+=1,i+=1)e[n]=e[i];e.pop()}(n,o);i.removeListener&&this.emit("removeListener",e,s||t)}return this},Be.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Fe,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Fe:delete n[e]),this;if(0===arguments.length){for(var i,o=Object.keys(n),a=0;a<o.length;++a)"removeListener"!==(i=o[a])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new Fe,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Be.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},Be.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):He.call(e,t)},Be.prototype.listenerCount=He,Be.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ze="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},Ye=/%[sdj%]/g;function $e(e){if(!rt(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(Ze(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,a=String(e).replace(Ye,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return e}})),s=i[n];n<o;s=i[++n])st(s)||!lt(s)?a+=" "+s:a+=" "+Ze(s);return a}function We(e,t){if(ct(E.process))return function(){return We(e,t).apply(this,arguments)};var n=!1;return function(){return n||(c("error","at debug/lib-generate-test-usersig-es.min.js:2",t),n=!0),e.apply(this,arguments)}}var Je,Xe={};function Ze(e,t){var n={seen:[],stylize:et};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),at(t)?n.showHidden=t:t&&function(e,t){if(!t||!lt(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]]}(n,t),ct(n.showHidden)&&(n.showHidden=!1),ct(n.depth)&&(n.depth=2),ct(n.colors)&&(n.colors=!1),ct(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Qe),nt(n,e,n.depth)}function Qe(e,t){var n=Ze.styles[t];return n?"["+Ze.colors[n][0]+"m"+e+"["+Ze.colors[n][1]+"m":e}function et(e,t){return e}function nt(e,t,n){if(e.customInspect&&t&&pt(t.inspect)&&t.inspect!==Ze&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return rt(i)||(i=nt(e,i,n)),i}var o=function(e,t){if(ct(t))return e.stylize("undefined","undefined");if(rt(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return"number"==typeof t?e.stylize(""+t,"number"):at(t)?e.stylize(""+t,"boolean"):st(t)?e.stylize("null","null"):void 0}(e,t);if(o)return o;var a,s=Object.keys(t),r=(a={},s.forEach((function(e,t){a[e]=!0})),a);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),ht(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return it(t);if(0===s.length){if(pt(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(ut(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(dt(t))return e.stylize(Date.prototype.toString.call(t),"date");if(ht(t))return it(t)}var u,l,d="",h=!1,p=["{","}"];return u=t,Array.isArray(u)&&(h=!0,p=["[","]"]),pt(t)&&(d=" [Function"+(t.name?": "+t.name:"")+"]"),ut(t)&&(d=" "+RegExp.prototype.toString.call(t)),dt(t)&&(d=" "+Date.prototype.toUTCString.call(t)),ht(t)&&(d=" "+it(t)),0!==s.length||h&&0!=t.length?n<0?ut(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=h?function(e,t,n,i,o){for(var a=[],s=0,r=t.length;s<r;++s)ft(t,String(s))?a.push(ot(e,t,n,i,String(s),!0)):a.push("");return o.forEach((function(o){o.match(/^\d+$/)||a.push(ot(e,t,n,i,o,!0))})),a}(e,t,n,r,s):s.map((function(i){return ot(e,t,n,r,i,h)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,d,p)):p[0]+d+p[1]}function it(e){return"["+Error.prototype.toString.call(e)+"]"}function ot(e,t,n,i,o,a){var s,r,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?r=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(r=e.stylize("[Setter]","special")),ft(i,o)||(s="["+o+"]"),r||(e.seen.indexOf(c.value)<0?(r=st(n)?nt(e,c.value,null):nt(e,c.value,n-1)).indexOf("\n")>-1&&(r=a?r.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+r.split("\n").map((function(e){return"   "+e})).join("\n")):r=e.stylize("[Circular]","special")),ct(s)){if(a&&o.match(/^\d+$/))return r;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+r}function at(e){return"boolean"==typeof e}function st(e){return null===e}function rt(e){return"string"==typeof e}function ct(e){return void 0===e}function ut(e){return lt(e)&&"[object RegExp]"===gt(e)}function lt(e){return"object"==typeof e&&null!==e}function dt(e){return lt(e)&&"[object Date]"===gt(e)}function ht(e){return lt(e)&&("[object Error]"===gt(e)||e instanceof Error)}function pt(e){return"function"==typeof e}function gt(e){return Object.prototype.toString.call(e)}function ft(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function mt(){this.head=null,this.tail=null,this.length=0}Ze.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Ze.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},mt.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},mt.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},mt.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},mt.prototype.clear=function(){this.head=this.tail=null,this.length=0},mt.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},mt.prototype.concat=function(e){if(0===this.length)return G.alloc(0);if(1===this.length)return this.head.data;for(var t=G.allocUnsafe(e>>>0),n=this.head,i=0;n;)n.data.copy(t,i),i+=n.data.length,n=n.next;return t};var _t=G.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function vt(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!_t(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=It;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Mt;break;default:return void(this.write=yt)}this.charBuffer=new G(6),this.charReceived=0,this.charLength=0}function yt(e){return e.toString(this.encoding)}function It(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function Mt(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}vt.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i,o=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,o),o-=this.charReceived),o=(t+=e.toString(this.encoding,0,o)).length-1,(i=t.charCodeAt(o))>=55296&&i<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),e.copy(this.charBuffer,0,0,a),t.substring(0,o)}return t},vt.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},vt.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,i=this.charBuffer,o=this.encoding;t+=i.slice(0,n).toString(o)}return t},kt.ReadableState=Tt;var Ct,Et=(Ct="stream",ct(Je)&&(Je=""),Ct=Ct.toUpperCase(),Xe[Ct]||(new RegExp("\\b"+Ct+"\\b","i").test(Je)?Xe[Ct]=function(){var e=$e.apply(null,arguments);c("error","at debug/lib-generate-test-usersig-es.min.js:2","%s %d: %s",Ct,0,e)}:Xe[Ct]=function(){}),Xe[Ct]);function Tt(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Qt&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new mt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new vt(e.encoding),this.encoding=e.encoding)}function kt(e){if(!(this instanceof kt))return new kt(e);this._readableState=new Tt(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Be.call(this)}function St(e,t,n,i,o){var a,s,r,c=(a=t,r=null,Ie(s=n)||"string"==typeof s||null==s||a.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r);if(c)e.emit("error",c);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,At(e)}}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!o){var u=new Error("stream.push() after EOF");e.emit("error",u)}else if(t.endEmitted&&o){var l=new Error("stream.unshift() after end event");e.emit("error",l)}else{var d;!t.decoder||o||i||(n=t.decoder.write(n),d=!t.objectMode&&0===n.length),o||(t.reading=!1),d||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&At(e))),function(e,t){t.readingMore||(t.readingMore=!0,Ue(Rt,e,t))}(e,t)}else o||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}ze(kt,Be),kt.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=G.from(e,t),t=""),St(this,n,e,t,!1)},kt.prototype.unshift=function(e){return St(this,this._readableState,e,"",!0)},kt.prototype.isPaused=function(){return!1===this._readableState.flowing},kt.prototype.setEncoding=function(e){return this._readableState.decoder=new vt(e),this._readableState.encoding=e,this};var Dt=8388608;function bt(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=((n=e)>=Dt?n=Dt:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var n}function At(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Et("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Ue(Lt,e):Lt(e))}function Lt(e){Et("emit readable"),e.emit("readable"),Nt(e)}function Rt(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Et("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function wt(e){Et("readable nexttick read 0"),e.read(0)}function Ot(e,t){t.reading||(Et("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Nt(e),t.flowing&&!t.reading&&e.read(0)}function Nt(e){var t=e._readableState;for(Et("flow",t.flowing);t.flowing&&null!==e.read(););}function Pt(e,t){return 0===t.length?null:(t.objectMode?s=t.buffer.shift():!e||e>=t.length?(s=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):(n=e,i=t.buffer,o=t.decoder,n<i.head.data.length?(a=i.head.data.slice(0,n),i.head.data=i.head.data.slice(n)):a=n===i.head.data.length?i.shift():o?function(e,t){var n=t.head,i=1,o=n.data;for(e-=o.length;n=n.next;){var a=n.data,s=e>a.length?a.length:e;if(s===a.length?o+=a:o+=a.slice(0,e),0===(e-=s)){s===a.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(s));break}++i}return t.length-=i,o}(n,i):function(e,t){var n=G.allocUnsafe(e),i=t.head,o=1;for(i.data.copy(n),e-=i.data.length;i=i.next;){var a=i.data,s=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,s),0===(e-=s)){s===a.length?(++o,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=a.slice(s));break}++o}return t.length-=o,n}(n,i),s=a),s);var n,i,o,a,s}function Ut(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,Ue(Gt,t,e))}function Gt(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function xt(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}function Ft(){}function Bt(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function Vt(e,t){Object.defineProperty(this,"buffer",{get:We((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Qt&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n,i=e._writableState,o=i.sync,a=i.writecb;if((n=i).writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t)!function(e,t,n,i,o){--t.pendingcb,n?Ue(o,i):o(i),e._writableState.errorEmitted=!0,e.emit("error",i)}(e,i,o,t,a);else{var s=zt(i);s||i.corked||i.bufferProcessing||!i.bufferedRequest||Kt(e,i),o?Ue(Ht,e,i,s,a):Ht(e,i,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Wt(this)}function jt(e){if(!(this instanceof jt||this instanceof Qt))return new jt(e);this._writableState=new Vt(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Be.call(this)}function qt(e,t,n,i,o,a,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,a,t.onwrite),t.sync=!1}function Ht(e,t,n,i){var o,a;n||(o=e,0===(a=t).length&&a.needDrain&&(a.needDrain=!1,o.emit("drain"))),t.pendingcb--,i(),$t(e,t)}function Kt(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var s=0;n;)o[s]=n,n=n.next,s+=1;qt(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new Wt(t)}else{for(;n;){var r=n.chunk,c=n.encoding,u=n.callback;if(qt(e,t,!1,t.objectMode?1:r.length,r,c,u),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function zt(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function Yt(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function $t(e,t){var n=zt(t);return n&&(0===t.pendingcb?(Yt(e,t),t.finished=!0,e.emit("finish")):Yt(e,t)),n}function Wt(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var i=t.entry;for(t.entry=null;i;){var o=i.callback;e.pendingcb--,o(n),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}kt.prototype.read=function(e){Et("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Et("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Ut(this):At(this),null;if(0===(e=bt(e,t))&&t.ended)return 0===t.length&&Ut(this),null;var i,o=t.needReadable;return Et("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&Et("length less than watermark",o=!0),t.ended||t.reading?Et("reading or ended",o=!1):o&&(Et("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=bt(n,t))),null===(i=e>0?Pt(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Ut(this)),null!==i&&this.emit("data",i),i},kt.prototype._read=function(e){this.emit("error",new Error("not implemented"))},kt.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,Et("pipe count=%d opts=%j",i.pipesCount,t);var o=t&&!1===t.end?u:s;function a(e){Et("onunpipe"),e===n&&u()}function s(){Et("onend"),e.end()}i.endEmitted?Ue(o):n.once("end",o),e.on("unpipe",a);var r=function(e){return function(){var t=e._readableState;Et("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Nt(e))}}(n);e.on("drain",r);var c=!1;function u(){Et("cleanup"),e.removeListener("close",p),e.removeListener("finish",g),e.removeListener("drain",r),e.removeListener("error",h),e.removeListener("unpipe",a),n.removeListener("end",s),n.removeListener("end",u),n.removeListener("data",d),c=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||r()}var l=!1;function d(t){Et("ondata"),l=!1,!1!==e.write(t)||l||((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==xt(i.pipes,e))&&!c&&(Et("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,l=!0),n.pause())}function h(t){Et("onerror",t),f(),e.removeListener("error",h),0===e.listeners("error").length&&e.emit("error",t)}function p(){e.removeListener("finish",g),f()}function g(){Et("onfinish"),e.removeListener("close",p),f()}function f(){Et("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",h),e.once("close",p),e.once("finish",g),e.emit("pipe",n),i.flowing||(Et("pipe resume"),n.resume()),e},kt.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this);return this}var a=xt(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},kt.prototype.on=function(e,t){var n=Be.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&At(this):Ue(wt,this))}return n},kt.prototype.addListener=kt.prototype.on,kt.prototype.resume=function(){var e,t,n=this._readableState;return n.flowing||(Et("resume"),n.flowing=!0,e=this,(t=n).resumeScheduled||(t.resumeScheduled=!0,Ue(Ot,e,t))),this},kt.prototype.pause=function(){return Et("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Et("pause"),this._readableState.flowing=!1,this.emit("pause")),this},kt.prototype.wrap=function(e){var t=this._readableState,n=!1,i=this;for(var o in e.on("end",(function(){if(Et("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&i.push(e)}i.push(null)})),e.on("data",(function(o){Et("wrapped data"),t.decoder&&(o=t.decoder.write(o)),t.objectMode&&null==o||(t.objectMode||o&&o.length)&&(i.push(o)||(n=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));return function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n])}(["error","close","destroy","pause","resume"],(function(t){e.on(t,i.emit.bind(i,t))})),i._read=function(t){Et("wrapped _read",t),n&&(n=!1,e.resume())},i},kt._fromList=Pt,jt.WritableState=Vt,ze(jt,Be),Vt.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},jt.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},jt.prototype.write=function(e,t,n){var i,o,a,s=this._writableState,r=!1;return"function"==typeof t&&(n=t,t=null),G.isBuffer(e)?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=Ft),s.ended?(i=this,o=n,a=new Error("write after end"),i.emit("error",a),Ue(o,a)):function(e,t,n,i){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):G.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),Ue(i,a),o=!1),o}(this,s,e,n)&&(s.pendingcb++,r=function(e,t,n,i,o){var a,s,r;s=n,r=i,(a=t).objectMode||!1===a.decodeStrings||"string"!=typeof s||(s=G.from(s,r)),n=s,G.isBuffer(n)&&(i="buffer");var c=t.objectMode?1:n.length;t.length+=c;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest=new Bt(n,i,o),l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else qt(e,t,!1,c,n,i,o);return u}(this,s,e,t,n)),r},jt.prototype.cork=function(){this._writableState.corked++},jt.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Kt(this,e))},jt.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},jt.prototype._write=function(e,t,n){n(new Error("not implemented"))},jt.prototype._writev=null,jt.prototype.end=function(e,t,n){var i,o,a,s=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),s.corked&&(s.corked=1,this.uncork()),s.ending||s.finished||(i=this,a=n,(o=s).ending=!0,$t(i,o),a&&(o.finished?Ue(a):i.once("finish",a)),o.ended=!0,i.writable=!1)},ze(Qt,kt);for(var Jt=Object.keys(jt.prototype),Xt=0;Xt<Jt.length;Xt++){var Zt=Jt[Xt];Qt.prototype[Zt]||(Qt.prototype[Zt]=jt.prototype[Zt])}function Qt(e){if(!(this instanceof Qt))return new Qt(e);kt.call(this,e),jt.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",en)}function en(){this.allowHalfOpen||this._writableState.ended||Ue(tn,this)}function tn(e){e.end()}function nn(e){this.afterTransform=function(t,n){return function(e,t,n){var i=e._transformState;i.transforming=!1;var o=i.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));i.writechunk=null,i.writecb=null,null!=n&&e.push(n),o(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function on(e){if(!(this instanceof on))return new on(e);Qt.call(this,e),this._transformState=new nn(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){an(t,e)})):an(t)}))}function an(e,t){if(t)return e.emit("error",t);var n=e._writableState,i=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function sn(e){if(!(this instanceof sn))return new sn(e);on.call(this,e)}function rn(){Be.call(this)}ze(on,Qt),on.prototype.push=function(e,t){return this._transformState.needTransform=!1,Qt.prototype.push.call(this,e,t)},on.prototype._transform=function(e,t,n){throw new Error("Not implemented")},on.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var o=this._readableState;(i.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},on.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},ze(sn,on),sn.prototype._transform=function(e,t,n){n(null,e)},ze(rn,Be),rn.Readable=kt,rn.Writable=jt,rn.Duplex=Qt,rn.Transform=on,rn.PassThrough=sn,rn.Stream=rn,rn.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",r));var a=!1;function s(){a||(a=!0,e.end())}function r(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===Be.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",r),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return n.on("error",c),e.on("error",c),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e};var cn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function un(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function ln(e,t,n,i,o){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),o);else for(var a=0;a<i;a++)e[o+a]=t[n+a]}var dn=Uint8Array,hn=Uint16Array,pn=Int32Array;function gn(e){for(var t=e.length;--t>=0;)e[t]=0}var fn=256,mn=286,_n=30,vn=15,yn=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],In=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Mn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Cn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],En=new Array(576);gn(En);var Tn=new Array(60);gn(Tn);var kn=new Array(512);gn(kn);var Sn=new Array(256);gn(Sn);var Dn=new Array(29);gn(Dn);var bn,An,Ln,Rn=new Array(_n);function wn(e,t,n,i,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=o,this.has_stree=e&&e.length}function On(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Nn(e){return e<256?kn[e]:kn[256+(e>>>7)]}function Pn(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Un(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Pn(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function Gn(e,t,n){Un(e,n[2*t],n[2*t+1])}function xn(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function Fn(e,t,n){var i,o,a=new Array(16),s=0;for(i=1;i<=vn;i++)a[i]=s=s+n[i-1]<<1;for(o=0;o<=t;o++){var r=e[2*o+1];0!==r&&(e[2*o]=xn(a[r]++,r))}}function Bn(e){var t;for(t=0;t<mn;t++)e.dyn_ltree[2*t]=0;for(t=0;t<_n;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Vn(e){e.bi_valid>8?Pn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function jn(e,t,n,i){var o=2*t,a=2*n;return e[o]<e[a]||e[o]===e[a]&&i[t]<=i[n]}function qn(e,t,n){for(var i=e.heap[n],o=n<<1;o<=e.heap_len&&(o<e.heap_len&&jn(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!jn(t,i,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=i}function Hn(e,t,n){var i,o,a,s,r=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*r]<<8|e.pending_buf[e.d_buf+2*r+1],o=e.pending_buf[e.l_buf+r],r++,0===i?Gn(e,o,t):(Gn(e,(a=Sn[o])+fn+1,t),0!==(s=yn[a])&&Un(e,o-=Dn[a],s),Gn(e,a=Nn(--i),n),0!==(s=In[a])&&Un(e,i-=Rn[a],s))}while(r<e.last_lit);Gn(e,256,t)}function Kn(e,t){var n,i,o,a=t.dyn_tree,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==a[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(o=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[o]=0,e.opt_len--,r&&(e.static_len-=s[2*o+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)qn(e,a,n);o=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],qn(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,a[2*o]=a[2*n]+a[2*i],e.depth[o]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,a[2*n+1]=a[2*i+1]=o,e.heap[1]=o++,qn(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,o,a,s,r,c=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,f=0;for(a=0;a<=vn;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(a=c[2*c[2*(i=e.heap[n])+1]+1]+1)>g&&(a=g,f++),c[2*i+1]=a,i>u||(e.bl_count[a]++,s=0,i>=p&&(s=h[i-p]),r=c[2*i],e.opt_len+=r*(a+s),d&&(e.static_len+=r*(l[2*i+1]+s)));if(0!==f){do{for(a=g-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[g]--,f-=2}while(f>0);for(a=g;0!==a;a--)for(i=e.bl_count[a];0!==i;)(o=e.heap[--n])>u||(c[2*o+1]!==a&&(e.opt_len+=(a-c[2*o+1])*c[2*o],c[2*o+1]=a),i--)}}(e,t),Fn(a,u,e.bl_count)}function zn(e,t,n){var i,o,a=-1,s=t[1],r=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)o=s,s=t[2*(i+1)+1],++r<c&&o===s||(r<u?e.bl_tree[2*o]+=r:0!==o?(o!==a&&e.bl_tree[2*o]++,e.bl_tree[32]++):r<=10?e.bl_tree[34]++:e.bl_tree[36]++,r=0,a=o,0===s?(c=138,u=3):o===s?(c=6,u=3):(c=7,u=4))}function Yn(e,t,n){var i,o,a=-1,s=t[1],r=0,c=7,u=4;for(0===s&&(c=138,u=3),i=0;i<=n;i++)if(o=s,s=t[2*(i+1)+1],!(++r<c&&o===s)){if(r<u)do{Gn(e,o,e.bl_tree)}while(0!=--r);else 0!==o?(o!==a&&(Gn(e,o,e.bl_tree),r--),Gn(e,16,e.bl_tree),Un(e,r-3,2)):r<=10?(Gn(e,17,e.bl_tree),Un(e,r-3,3)):(Gn(e,18,e.bl_tree),Un(e,r-11,7));r=0,a=o,0===s?(c=138,u=3):o===s?(c=6,u=3):(c=7,u=4)}}gn(Rn);var $n=!1;function Wn(e,t,n,i){var o,a,s;Un(e,0+(i?1:0),3),a=t,s=n,Vn(o=e),Pn(o,s),Pn(o,~s),ln(o.pending_buf,o.window,a,s,o.pending),o.pending+=s}function Jn(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Sn[n]+fn+1)]++,e.dyn_dtree[2*Nn(t)]++),e.last_lit===e.lit_bufsize-1}function Xn(e,t,n,i){for(var o=65535&e,a=e>>>16&65535,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{a=a+(o=o+t[i++]|0)|0}while(--s);o%=65521,a%=65521}return o|a<<16}var Zn=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();function Qn(e,t,n,i){var o=Zn,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}var ei,ti=-2,ni=258,ii=262,oi=103,ai=113,si=666;function ri(e,t){return e.msg=cn[t],t}function ci(e){return(e<<1)-(e>4?9:0)}function ui(e){for(var t=e.length;--t>=0;)e[t]=0}function li(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(ln(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function di(e,t){(function(e,t,n,i){var o,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<fn;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Kn(e,e.l_desc),Kn(e,e.d_desc),s=function(e){var t;for(zn(e,e.dyn_ltree,e.l_desc.max_code),zn(e,e.dyn_dtree,e.d_desc.max_code),Kn(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Cn[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=o&&(o=a)):o=a=n+5,n+4<=o&&-1!==t?Wn(e,t,n,i):4===e.strategy||a===o?(Un(e,2+(i?1:0),3),Hn(e,En,Tn)):(Un(e,4+(i?1:0),3),function(e,t,n,i){var o;for(Un(e,t-257,5),Un(e,n-1,5),Un(e,i-4,4),o=0;o<i;o++)Un(e,e.bl_tree[2*Cn[o]+1],3);Yn(e,e.dyn_ltree,t-1),Yn(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Hn(e,e.dyn_ltree,e.dyn_dtree)),Bn(e),i&&Vn(e)})(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,li(e.strm)}function hi(e,t){e.pending_buf[e.pending++]=t}function pi(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function gi(e,t){var n,i,o=e.max_chain_length,a=e.strstart,s=e.prev_length,r=e.nice_match,c=e.strstart>e.w_size-ii?e.strstart-(e.w_size-ii):0,u=e.window,l=e.w_mask,d=e.prev,h=e.strstart+ni,p=u[a+s-1],g=u[a+s];e.prev_length>=e.good_match&&(o>>=2),r>e.lookahead&&(r=e.lookahead);do{if(u[(n=t)+s]===g&&u[n+s-1]===p&&u[n]===u[a]&&u[++n]===u[a+1]){a+=2,n++;do{}while(u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&a<h);if(i=ni-(h-a),a=h-ni,i>s){if(e.match_start=t,s=i,i>=r)break;p=u[a+s-1],g=u[a+s]}}}while((t=d[t&l])>c&&0!=--o);return s<=e.lookahead?s:e.lookahead}function fi(e){var t,n,i,o,a,s,r,c,u,l,d=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-ii)){ln(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=d?i-d:0}while(--n);t=n=d;do{i=e.prev[--t],e.prev[t]=i>=d?i-d:0}while(--n);o+=d}if(0===e.strm.avail_in)break;if(s=e.strm,r=e.window,c=e.strstart+e.lookahead,u=o,l=void 0,(l=s.avail_in)>u&&(l=u),n=0===l?0:(s.avail_in-=l,ln(r,s.input,s.next_in,l,c),1===s.state.wrap?s.adler=Xn(s.adler,r,l,c):2===s.state.wrap&&(s.adler=Qn(s.adler,r,l,c)),s.next_in+=l,s.total_in+=l,l),e.lookahead+=n,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+3-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<ii&&0!==e.strm.avail_in)}function mi(e,t){for(var n,i;;){if(e.lookahead<ii){if(fi(e),e.lookahead<ii&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-ii&&(e.match_length=gi(e,n)),e.match_length>=3)if(i=Jn(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=Jn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(di(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(di(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?1:2}function _i(e,t){for(var n,i,o;;){if(e.lookahead<ii){if(fi(e),e.lookahead<ii&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ii&&(e.match_length=gi(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,i=Jn(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(di(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=Jn(e,0,e.window[e.strstart-1]))&&di(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Jn(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(di(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?1:2}function vi(e,t,n,i,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=o}function yi(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new hn(1146),this.dyn_dtree=new hn(122),this.bl_tree=new hn(78),ui(this.dyn_ltree),ui(this.dyn_dtree),ui(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new hn(16),this.heap=new hn(573),ui(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new hn(573),ui(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ii(e){var t,n,i,o=(n=e)&&n.state?(n.total_in=n.total_out=0,n.data_type=2,(i=n.state).pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?42:ai,n.adler=2===i.wrap?0:1,i.last_flush=0,function(e){$n||(function(){var e,t,n,i,o,a=new Array(16);for(n=0,i=0;i<28;i++)for(Dn[i]=n,e=0;e<1<<yn[i];e++)Sn[n++]=i;for(Sn[n-1]=i,o=0,i=0;i<16;i++)for(Rn[i]=o,e=0;e<1<<In[i];e++)kn[o++]=i;for(o>>=7;i<_n;i++)for(Rn[i]=o<<7,e=0;e<1<<In[i]-7;e++)kn[256+o++]=i;for(t=0;t<=vn;t++)a[t]=0;for(e=0;e<=143;)En[2*e+1]=8,e++,a[8]++;for(;e<=255;)En[2*e+1]=9,e++,a[9]++;for(;e<=279;)En[2*e+1]=7,e++,a[7]++;for(;e<=287;)En[2*e+1]=8,e++,a[8]++;for(Fn(En,287,a),e=0;e<_n;e++)Tn[2*e+1]=5,Tn[2*e]=xn(e,5);bn=new wn(En,yn,257,mn,vn),An=new wn(Tn,In,0,_n,vn),Ln=new wn(new Array(0),Mn,0,19,7)}(),$n=!0),e.l_desc=new On(e.dyn_ltree,bn),e.d_desc=new On(e.dyn_dtree,An),e.bl_desc=new On(e.bl_tree,Ln),e.bi_buf=0,e.bi_valid=0,Bn(e)}(i),0):ri(n,ti);return 0===o&&((t=e.state).window_size=2*t.w_size,ui(t.head),t.max_lazy_match=ei[t.level].max_lazy,t.good_match=ei[t.level].good_length,t.nice_match=ei[t.level].nice_length,t.max_chain_length=ei[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),o}function Mi(e,t){var n,i,o,a;if(!e||!e.state||t>5||t<0)return e?ri(e,ti):ti;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===si&&4!==t)return ri(e,0===e.avail_out?-5:ti);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,hi(i,31),hi(i,139),hi(i,8),i.gzhead?(hi(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),hi(i,255&i.gzhead.time),hi(i,i.gzhead.time>>8&255),hi(i,i.gzhead.time>>16&255),hi(i,i.gzhead.time>>24&255),hi(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),hi(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(hi(i,255&i.gzhead.extra.length),hi(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Qn(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(hi(i,0),hi(i,0),hi(i,0),hi(i,0),hi(i,0),hi(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),hi(i,3),i.status=ai);else{var s=8+(i.w_bits-8<<4)<<8;s|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(s|=32),s+=31-s%31,i.status=ai,pi(i,s),0!==i.strstart&&(pi(i,e.adler>>>16),pi(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=Qn(e.adler,i.pending_buf,i.pending-o,o)),li(e),o=i.pending,i.pending!==i.pending_buf_size));)hi(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=Qn(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=Qn(e.adler,i.pending_buf,i.pending-o,o)),li(e),o=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,hi(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>o&&(e.adler=Qn(e.adler,i.pending_buf,i.pending-o,o)),0===a&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=Qn(e.adler,i.pending_buf,i.pending-o,o)),li(e),o=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,hi(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>o&&(e.adler=Qn(e.adler,i.pending_buf,i.pending-o,o)),0===a&&(i.status=oi)}else i.status=oi;if(i.status===oi&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&li(e),i.pending+2<=i.pending_buf_size&&(hi(i,255&e.adler),hi(i,e.adler>>8&255),e.adler=0,i.status=ai)):i.status=ai),0!==i.pending){if(li(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&ci(t)<=ci(n)&&4!==t)return ri(e,-5);if(i.status===si&&0!==e.avail_in)return ri(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&i.status!==si){var r=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(fi(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=Jn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(di(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(di(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,i,o,a,s=e.window;;){if(e.lookahead<=ni){if(fi(e),e.lookahead<=ni&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=s[o=e.strstart-1])===s[++o]&&i===s[++o]&&i===s[++o]){a=e.strstart+ni;do{}while(i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&o<a);e.match_length=ni-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Jn(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Jn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(di(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(di(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(di(e,!1),0===e.strm.avail_out)?1:2}(i,t):ei[i.level].func(i,t);if(3!==r&&4!==r||(i.status=si),1===r||3===r)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===r&&(1===t?function(e){var t;Un(e,2,3),Gn(e,256,En),16===(t=e).bi_valid?(Pn(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(i):5!==t&&(Wn(i,0,0,!1),3===t&&(ui(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),li(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(hi(i,255&e.adler),hi(i,e.adler>>8&255),hi(i,e.adler>>16&255),hi(i,e.adler>>24&255),hi(i,255&e.total_in),hi(i,e.total_in>>8&255),hi(i,e.total_in>>16&255),hi(i,e.total_in>>24&255)):(pi(i,e.adler>>>16),pi(i,65535&e.adler)),li(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)}ei=[new vi(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fi(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,di(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-ii&&(di(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(di(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(di(e,!1),e.strm.avail_out),1)})),new vi(4,4,8,4,mi),new vi(4,5,16,8,mi),new vi(4,6,32,32,mi),new vi(4,4,16,16,_i),new vi(8,16,32,32,_i),new vi(8,16,128,128,_i),new vi(8,32,128,256,_i),new vi(32,128,258,1024,_i),new vi(32,258,258,4096,_i)];function Ci(e,t){var n,i,o,a,s,r,c,u,l,d,h,p,g,f,m,_,v,y,I,M,C,E,T,k,S;n=e.state,i=e.next_in,k=e.input,o=i+(e.avail_in-5),a=e.next_out,S=e.output,s=a-(t-e.avail_out),r=a+(e.avail_out-257),c=n.dmax,u=n.wsize,l=n.whave,d=n.wnext,h=n.window,p=n.hold,g=n.bits,f=n.lencode,m=n.distcode,_=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{g<15&&(p+=k[i++]<<g,g+=8,p+=k[i++]<<g,g+=8),y=f[p&_];t:for(;;){if(p>>>=I=y>>>24,g-=I,0==(I=y>>>16&255))S[a++]=65535&y;else{if(!(16&I)){if(!(64&I)){y=f[(65535&y)+(p&(1<<I)-1)];continue t}if(32&I){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}M=65535&y,(I&=15)&&(g<I&&(p+=k[i++]<<g,g+=8),M+=p&(1<<I)-1,p>>>=I,g-=I),g<15&&(p+=k[i++]<<g,g+=8,p+=k[i++]<<g,g+=8),y=m[p&v];n:for(;;){if(p>>>=I=y>>>24,g-=I,!(16&(I=y>>>16&255))){if(!(64&I)){y=m[(65535&y)+(p&(1<<I)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(C=65535&y,g<(I&=15)&&(p+=k[i++]<<g,(g+=8)<I&&(p+=k[i++]<<g,g+=8)),(C+=p&(1<<I)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=I,g-=I,C>(I=a-s)){if((I=C-I)>l&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,T=h,0===d){if(E+=u-I,I<M){M-=I;do{S[a++]=h[E++]}while(--I);E=a-C,T=S}}else if(d<I){if(E+=u+d-I,(I-=d)<M){M-=I;do{S[a++]=h[E++]}while(--I);if(E=0,d<M){M-=I=d;do{S[a++]=h[E++]}while(--I);E=a-C,T=S}}}else if(E+=d-I,I<M){M-=I;do{S[a++]=h[E++]}while(--I);E=a-C,T=S}for(;M>2;)S[a++]=T[E++],S[a++]=T[E++],S[a++]=T[E++],M-=3;M&&(S[a++]=T[E++],M>1&&(S[a++]=T[E++]))}else{E=a-C;do{S[a++]=S[E++],S[a++]=S[E++],S[a++]=S[E++],M-=3}while(M>2);M&&(S[a++]=S[E++],M>1&&(S[a++]=S[E++]))}break}}break}}while(i<o&&a<r);i-=M=g>>3,p&=(1<<(g-=M<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<o?o-i+5:5-(i-o),e.avail_out=a<r?r-a+257:257-(a-r),n.hold=p,n.bits=g}var Ei=15,Ti=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ki=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Si=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Di=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function bi(e,t,n,i,o,a,s,r){var c,u,l,d,h,p,g,f,m,_=r.bits,v=0,y=0,I=0,M=0,C=0,E=0,T=0,k=0,S=0,D=0,b=null,A=0,L=new hn(16),R=new hn(16),w=null,O=0;for(v=0;v<=Ei;v++)L[v]=0;for(y=0;y<i;y++)L[t[n+y]]++;for(C=_,M=Ei;M>=1&&0===L[M];M--);if(C>M&&(C=M),0===M)return o[a++]=20971520,o[a++]=20971520,r.bits=1,0;for(I=1;I<M&&0===L[I];I++);for(C<I&&(C=I),k=1,v=1;v<=Ei;v++)if(k<<=1,(k-=L[v])<0)return-1;if(k>0&&(0===e||1!==M))return-1;for(R[1]=0,v=1;v<Ei;v++)R[v+1]=R[v]+L[v];for(y=0;y<i;y++)0!==t[n+y]&&(s[R[t[n+y]]++]=y);if(0===e?(b=w=s,p=19):1===e?(b=Ti,A-=257,w=ki,O-=257,p=256):(b=Si,w=Di,p=-1),D=0,y=0,v=I,h=a,E=C,T=0,l=-1,d=(S=1<<C)-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){g=v-T,s[y]<p?(f=0,m=s[y]):s[y]>p?(f=w[O+s[y]],m=b[A+s[y]]):(f=96,m=0),c=1<<v-T,I=u=1<<E;do{o[h+(D>>T)+(u-=c)]=g<<24|f<<16|m}while(0!==u);for(c=1<<v-1;D&c;)c>>=1;if(0!==c?(D&=c-1,D+=c):D=0,y++,0==--L[v]){if(v===M)break;v=t[n+s[y]]}if(v>C&&(D&d)!==l){for(0===T&&(T=C),h+=I,k=1<<(E=v-T);E+T<M&&!((k-=L[E+T])<=0);)E++,k<<=1;if(S+=1<<E,1===e&&S>852||2===e&&S>592)return 1;o[l=D&d]=C<<24|E<<16|h-a}}return 0!==D&&(o[h+D]=v-T<<24|64<<16),r.bits=C,0}var Ai=-2,Li=12,Ri=30;function wi(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Oi(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new hn(320),this.work=new hn(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ni(e){var t,n,i;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,(n=e)&&n.state?(i=n.state,n.total_in=n.total_out=i.total=0,n.msg="",i.wrap&&(n.adler=1&i.wrap),i.mode=1,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new pn(852),i.distcode=i.distdyn=new pn(592),i.sane=1,i.back=-1,0):Ai):Ai}var Pi,Ui,Gi=!0;function xi(e){if(Gi){var t;for(Pi=new pn(512),Ui=new pn(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(bi(1,e.lens,0,288,Pi,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;bi(2,e.lens,0,32,Ui,0,e.work,{bits:5}),Gi=!1}e.lencode=Pi,e.lenbits=9,e.distcode=Ui,e.distbits=5}var Fi;function Bi(e){if(e<1||e>7)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function Vi(e,t){for(var n=0;n<e.length;n++)this[t+n]=e[n]}Bi.prototype.init=function(e,t,n,i,o){var a;switch(this.windowBits=e,this.level=t,this.memLevel=n,this.strategy=i,3!==this.mode&&4!==this.mode||(this.windowBits+=16),7===this.mode&&(this.windowBits+=32),5!==this.mode&&6!==this.mode||(this.windowBits=-this.windowBits),this.strm=new un,this.mode){case 1:case 3:case 5:a=function(e,t,n,i,o,a){if(!e)return ti;var s=1;if(-1===t&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),o<1||o>9||i<8||i>15||t<0||t>9||a<0||a>4)return ri(e,ti);8===i&&(i=9);var r=new yi;return e.state=r,r.strm=e,r.wrap=s,r.gzhead=null,r.w_bits=i,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=o+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+3-1)/3),r.window=new dn(2*r.w_size),r.head=new hn(r.hash_size),r.prev=new hn(r.w_size),r.lit_bufsize=1<<o+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new dn(r.pending_buf_size),r.d_buf=1*r.lit_bufsize,r.l_buf=3*r.lit_bufsize,r.level=t,r.strategy=a,r.method=8,Ii(e)}(this.strm,this.level,0,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case 7:a=function(e,t){var n,i,o,a,s,r;return e?(i=new Oi,e.state=i,i.window=null,0!==(a=t,n=(o=e)&&o.state?(r=o.state,a<0?(s=0,a=-a):(s=1+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?Ai:(null!==r.window&&r.wbits!==a&&(r.window=null),r.wrap=s,r.wbits=a,Ni(o))):Ai)&&(e.state=null),n):Ai}(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}0===a?(this.write_in_progress=!1,this.init_done=!0):this._error(a)},Bi.prototype.params=function(){throw new Error("deflateParams Not supported")},Bi.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(0===this.mode)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},Bi.prototype.write=function(e,t,n,i,o,a,s){this._writeCheck(),this.write_in_progress=!0;var r=this;return Ue((function(){r.write_in_progress=!1;var c=r._write(e,t,n,i,o,a,s);r.callback(c[0],c[1]),r.pending_close&&r.close()})),this},Bi.prototype.writeSync=function(e,t,n,i,o,a,s){return this._writeCheck(),this._write(e,t,n,i,o,a,s)},Bi.prototype._write=function(e,t,n,i,o,a,s){if(this.write_in_progress=!0,0!==e&&1!==e&&2!==e&&3!==e&&4!==e&&5!==e)throw new Error("Invalid flush value");null==t&&(t=new G(0),i=0,n=0),o._set?o.set=o._set:o.set=Vi;var r,c=this.strm;switch(c.avail_in=i,c.input=t,c.next_in=n,c.avail_out=s,c.output=o,c.next_out=a,this.mode){case 1:case 3:case 5:r=Mi(c,e);break;case 7:case 2:case 4:case 6:r=function(e,t){var n,i,o,a,s,r,c,u,l,d,h,p,g,f,m,_,v,y,I,M,C,E,T,k,S,D,b,A,L,R,w=0,O=new dn(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Ai;(n=e.state).mode===Li&&(n.mode=13),s=e.next_out,o=e.output,c=e.avail_out,a=e.next_in,i=e.input,r=e.avail_in,u=n.hold,l=n.bits,d=r,h=c,E=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(2&n.wrap&&35615===u){n.check=0,O[0]=255&u,O[1]=u>>>8&255,n.check=Qn(n.check,O,2,0),u=0,l=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=Ri;break}if(8!=(15&u)){e.msg="unknown compression method",n.mode=Ri;break}if(l-=4,C=8+(15&(u>>>=4)),0===n.wbits)n.wbits=C;else if(C>n.wbits){e.msg="invalid window size",n.mode=Ri;break}n.dmax=1<<C,e.adler=n.check=1,n.mode=512&u?10:Li,u=0,l=0;break;case 2:for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(n.flags=u,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=Ri;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Ri;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,n.check=Qn(n.check,O,2,0)),u=0,l=0,n.mode=3;case 3:for(;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.head&&(n.head.time=u),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,O[2]=u>>>16&255,O[3]=u>>>24&255,n.check=Qn(n.check,O,4,0)),u=0,l=0,n.mode=4;case 4:for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,n.check=Qn(n.check,O,2,0)),u=0,l=0,n.mode=5;case 5:if(1024&n.flags){for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,n.check=Qn(n.check,O,2,0)),u=0,l=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((p=n.length)>r&&(p=r),p&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),ln(n.head.extra,i,a,p,C)),512&n.flags&&(n.check=Qn(n.check,i,p,a)),r-=p,a+=p,n.length-=p),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===r)break e;p=0;do{C=i[a+p++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&p<r);if(512&n.flags&&(n.check=Qn(n.check,i,p,a)),r-=p,a+=p,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===r)break e;p=0;do{C=i[a+p++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&p<r);if(512&n.flags&&(n.check=Qn(n.check,i,p,a)),r-=p,a+=p,C)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Ri;break}u=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Li;break;case 10:for(;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}e.adler=n.check=wi(u),u=0,l=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=c,e.next_in=a,e.avail_in=r,n.hold=u,n.bits=l,2;e.adler=n.check=1,n.mode=Li;case Li:if(5===t||6===t)break e;case 13:if(n.last){u>>>=7&l,l-=7&l,n.mode=27;break}for(;l<3;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}switch(n.last=1&u,l-=1,3&(u>>>=1)){case 0:n.mode=14;break;case 1:if(xi(n),n.mode=20,6===t){u>>>=2,l-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=Ri}u>>>=2,l-=2;break;case 14:for(u>>>=7&l,l-=7&l;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Ri;break}if(n.length=65535&u,u=0,l=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(p=n.length){if(p>r&&(p=r),p>c&&(p=c),0===p)break e;ln(o,i,a,p,s),r-=p,a+=p,c-=p,s+=p,n.length-=p;break}n.mode=Li;break;case 17:for(;l<14;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(n.nlen=257+(31&u),u>>>=5,l-=5,n.ndist=1+(31&u),u>>>=5,l-=5,n.ncode=4+(15&u),u>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Ri;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;l<3;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.lens[N[n.have++]]=7&u,u>>>=3,l-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},E=bi(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid code lengths set",n.mode=Ri;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(w=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,v=65535&w,!((m=w>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(v<16)u>>>=m,l-=m,n.lens[n.have++]=v;else{if(16===v){for(k=m+2;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(u>>>=m,l-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=Ri;break}C=n.lens[n.have-1],p=3+(3&u),u>>>=2,l-=2}else if(17===v){for(k=m+3;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}l-=m,C=0,p=3+(7&(u>>>=m)),u>>>=3,l-=3}else{for(k=m+7;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}l-=m,C=0,p=11+(127&(u>>>=m)),u>>>=7,l-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Ri;break}for(;p--;)n.lens[n.have++]=C}}if(n.mode===Ri)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Ri;break}if(n.lenbits=9,T={bits:n.lenbits},E=bi(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid literal/lengths set",n.mode=Ri;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},E=bi(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,E){e.msg="invalid distances set",n.mode=Ri;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(r>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=a,e.avail_in=r,n.hold=u,n.bits=l,Ci(e,h),s=e.next_out,o=e.output,c=e.avail_out,a=e.next_in,i=e.input,r=e.avail_in,u=n.hold,l=n.bits,n.mode===Li&&(n.back=-1);break}for(n.back=0;_=(w=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,v=65535&w,!((m=w>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(_&&!(240&_)){for(y=m,I=_,M=v;_=(w=n.lencode[M+((u&(1<<y+I)-1)>>y)])>>>16&255,v=65535&w,!(y+(m=w>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}u>>>=y,l-=y,n.back+=y}if(u>>>=m,l-=m,n.back+=m,n.length=v,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=Li;break}if(64&_){e.msg="invalid literal/length code",n.mode=Ri;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(k=n.extra;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(w=n.distcode[u&(1<<n.distbits)-1])>>>16&255,v=65535&w,!((m=w>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(!(240&_)){for(y=m,I=_,M=v;_=(w=n.distcode[M+((u&(1<<y+I)-1)>>y)])>>>16&255,v=65535&w,!(y+(m=w>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}u>>>=y,l-=y,n.back+=y}if(u>>>=m,l-=m,n.back+=m,64&_){e.msg="invalid distance code",n.mode=Ri;break}n.offset=v,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(k=n.extra;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Ri;break}n.mode=25;case 25:if(0===c)break e;if(p=h-c,n.offset>p){if((p=n.offset-p)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Ri;break}p>n.wnext?(p-=n.wnext,g=n.wsize-p):g=n.wnext-p,p>n.length&&(p=n.length),f=n.window}else f=o,g=s-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{o[s++]=f[g++]}while(--p);0===n.length&&(n.mode=21);break;case 26:if(0===c)break e;o[s++]=n.length,c--,n.mode=21;break;case 27:if(n.wrap){for(;l<32;){if(0===r)break e;r--,u|=i[a++]<<l,l+=8}if(h-=c,e.total_out+=h,n.total+=h,h&&(e.adler=n.check=n.flags?Qn(n.check,o,h,s-h):Xn(n.check,o,h,s-h)),h=c,(n.flags?u:wi(u))!==n.check){e.msg="incorrect data check",n.mode=Ri;break}u=0,l=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Ri;break}u=0,l=0}n.mode=29;case 29:E=1;break e;case Ri:E=-3;break e;case 31:return-4;default:return Ai}return e.next_out=s,e.avail_out=c,e.next_in=a,e.avail_in=r,n.hold=u,n.bits=l,(n.wsize||h!==e.avail_out&&n.mode<Ri&&(n.mode<27||4!==t))&&(S=e,D=e.output,b=e.next_out,A=h-e.avail_out,null===(R=S.state).window&&(R.wsize=1<<R.wbits,R.wnext=0,R.whave=0,R.window=new dn(R.wsize)),A>=R.wsize?(ln(R.window,D,b-R.wsize,R.wsize,0),R.wnext=0,R.whave=R.wsize):((L=R.wsize-R.wnext)>A&&(L=A),ln(R.window,D,b-A,L,R.wnext),(A-=L)?(ln(R.window,D,b-A,A,0),R.wnext=A,R.whave=R.wsize):(R.wnext+=L,R.wnext===R.wsize&&(R.wnext=0),R.whave<R.wsize&&(R.whave+=L)))),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,n.wrap&&h&&(e.adler=n.check=n.flags?Qn(n.check,o,h,e.next_out-h):Xn(n.check,o,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Li?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===h||4===t)&&0===E&&(E=-5),E}(c,e);break;default:throw new Error("Unknown mode "+this.mode)}return 1!==r&&0!==r&&this._error(r),this.write_in_progress=!1,[c.avail_in,c.avail_out]},Bi.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,1===this.mode||3===this.mode||5===this.mode?function(e){var t;e&&e.state&&(42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==oi&&t!==ai&&t!==si?ri(e,ti):(e.state=null,t===ai&&ri(e,-3)))}(this.strm):function(e){if(!e||!e.state)return Ai;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},Bi.prototype.reset=function(){switch(this.mode){case 1:case 5:Fi=Ii(this.strm);break;case 2:case 6:Fi=Ni(this.strm)}0!==Fi&&this._error(Fi)},Bi.prototype._error=function(e){this.onerror(cn[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var ji=Object.freeze({NONE:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:Bi}),qi={};Object.keys(ji).forEach((function(e){qi[e]=ji[e]})),qi.Z_MIN_WINDOWBITS=8,qi.Z_MAX_WINDOWBITS=15,qi.Z_DEFAULT_WINDOWBITS=15,qi.Z_MIN_CHUNK=64,qi.Z_MAX_CHUNK=1/0,qi.Z_DEFAULT_CHUNK=16384,qi.Z_MIN_MEMLEVEL=1,qi.Z_MAX_MEMLEVEL=9,qi.Z_DEFAULT_MEMLEVEL=8,qi.Z_MIN_LEVEL=-1,qi.Z_MAX_LEVEL=9,qi.Z_DEFAULT_LEVEL=qi.Z_DEFAULT_COMPRESSION;var Hi={Z_OK:qi.Z_OK,Z_STREAM_END:qi.Z_STREAM_END,Z_NEED_DICT:qi.Z_NEED_DICT,Z_ERRNO:qi.Z_ERRNO,Z_STREAM_ERROR:qi.Z_STREAM_ERROR,Z_DATA_ERROR:qi.Z_DATA_ERROR,Z_MEM_ERROR:qi.Z_MEM_ERROR,Z_BUF_ERROR:qi.Z_BUF_ERROR,Z_VERSION_ERROR:qi.Z_VERSION_ERROR};function Ki(e,t){if("string"==typeof t&&(t=new G(t)),!Ie(t))throw new TypeError("Not a string or buffer");var n=qi.Z_FINISH;return e._processChunk(t,n)}function zi(e){if(!(this instanceof zi))return new zi(e);Qi.call(this,e,qi.DEFLATE)}function Yi(e){if(!(this instanceof Yi))return new Yi(e);Qi.call(this,e,qi.INFLATE)}function $i(e){if(!(this instanceof $i))return new $i(e);Qi.call(this,e,qi.GZIP)}function Wi(e){if(!(this instanceof Wi))return new Wi(e);Qi.call(this,e,qi.GUNZIP)}function Ji(e){if(!(this instanceof Ji))return new Ji(e);Qi.call(this,e,qi.DEFLATERAW)}function Xi(e){if(!(this instanceof Xi))return new Xi(e);Qi.call(this,e,qi.INFLATERAW)}function Zi(e){if(!(this instanceof Zi))return new Zi(e);Qi.call(this,e,qi.UNZIP)}function Qi(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||qi.Z_DEFAULT_CHUNK,on.call(this,e),e.flush&&e.flush!==qi.Z_NO_FLUSH&&e.flush!==qi.Z_PARTIAL_FLUSH&&e.flush!==qi.Z_SYNC_FLUSH&&e.flush!==qi.Z_FULL_FLUSH&&e.flush!==qi.Z_FINISH&&e.flush!==qi.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||qi.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<qi.Z_MIN_CHUNK||e.chunkSize>qi.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<qi.Z_MIN_WINDOWBITS||e.windowBits>qi.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<qi.Z_MIN_LEVEL||e.level>qi.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<qi.Z_MIN_MEMLEVEL||e.memLevel>qi.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=qi.Z_FILTERED&&e.strategy!=qi.Z_HUFFMAN_ONLY&&e.strategy!=qi.Z_RLE&&e.strategy!=qi.Z_FIXED&&e.strategy!=qi.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!Ie(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new qi.Zlib(t);var n=this;this._hadError=!1,this._binding.onerror=function(e,t){n._binding=null,n._hadError=!0;var i=new Error(e);i.errno=t,i.code=qi.codes[t],n.emit("error",i)};var i=qi.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(i=e.level);var o=qi.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(o=e.strategy),this._binding.init(e.windowBits||qi.Z_DEFAULT_WINDOWBITS,i,e.memLevel||qi.Z_DEFAULT_MEMLEVEL,o,e.dictionary),this._buffer=new G(this._chunkSize),this._offset=0,this._closed=!1,this._level=i,this._strategy=o,this.once("end",this.close)}Object.keys(Hi).forEach((function(e){Hi[Hi[e]]=e})),ze(Qi,on),Qi.prototype.params=function(e,t,n){if(e<qi.Z_MIN_LEVEL||e>qi.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=qi.Z_FILTERED&&t!=qi.Z_HUFFMAN_ONLY&&t!=qi.Z_RLE&&t!=qi.Z_FIXED&&t!=qi.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var i=this;this.flush(qi.Z_SYNC_FLUSH,(function(){i._binding.params(e,t),i._hadError||(i._level=e,i._strategy=t,n&&n())}))}else Ue(n)},Qi.prototype.reset=function(){return this._binding.reset()},Qi.prototype._flush=function(e){this._transform(new G(0),"",e)},Qi.prototype.flush=function(e,t){var n=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=qi.Z_FULL_FLUSH),n.ended)t&&Ue(t);else if(n.ending)t&&this.once("end",t);else if(n.needDrain){var i=this;this.once("drain",(function(){i.flush(t)}))}else this._flushFlag=e,this.write(new G(0),"",t)},Qi.prototype.close=function(e){if(e&&Ue(e),!this._closed){this._closed=!0,this._binding.close();var t=this;Ue((function(){t.emit("close")}))}},Qi.prototype._transform=function(e,t,n){var i,o=this._writableState,a=(o.ending||o.ended)&&(!e||o.length===e.length);if(null===!e&&!Ie(e))return n(new Error("invalid input"));a?i=qi.Z_FINISH:(i=this._flushFlag,e.length>=o.length&&(this._flushFlag=this._opts.flush||qi.Z_NO_FLUSH)),this._processChunk(e,i,n)},Qi.prototype._processChunk=function(e,t,n){var i=e&&e.length,o=this._chunkSize-this._offset,a=0,s=this,r="function"==typeof n;if(!r){var c,u=[],l=0;this.on("error",(function(e){c=e}));do{var d=this._binding.writeSync(t,e,a,i,this._buffer,this._offset,o)}while(!this._hadError&&g(d[0],d[1]));if(this._hadError)throw c;var h=G.concat(u,l);return this.close(),h}var p=this._binding.write(t,e,a,i,this._buffer,this._offset,o);function g(c,d){if(!s._hadError){var h=o-d;if(function(e){if(!e)throw new Error("have should not go down")}(h>=0),h>0){var p=s._buffer.slice(s._offset,s._offset+h);s._offset+=h,r?s.push(p):(u.push(p),l+=p.length)}if((0===d||s._offset>=s._chunkSize)&&(o=s._chunkSize,s._offset=0,s._buffer=new G(s._chunkSize)),0===d){if(a+=i-c,i=c,!r)return!0;var f=s._binding.write(t,e,a,i,s._buffer,s._offset,s._chunkSize);return f.callback=g,void(f.buffer=e)}if(!r)return!1;n()}}p.buffer=e,p.callback=g},ze(zi,Qi),ze(Yi,Qi),ze($i,Qi),ze(Wi,Qi),ze(Ji,Qi),ze(Xi,Qi),ze(Zi,Qi);var eo=function(e,t){return Ki(new zi(t),e)},to=function(e,t){return Ki(new Yi(t),e)};class no{constructor(e,t,n){this.SDKAPPID=e,this.EXPIRETIME=n,this.PRIVATEKEY=t}genTestUserSig(e){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(e)?this._isNumber(this.EXPIRETIME)?(c("log","at debug/lib-generate-test-usersig-es.min.js:2","sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+e+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(e,this.EXPIRETIME,null)):(c("error","at debug/lib-generate-test-usersig-es.min.js:2","expireTime must be a number"),""):(c("error","at debug/lib-generate-test-usersig-es.min.js:2","userID must be a string"),""):(c("error","at debug/lib-generate-test-usersig-es.min.js:2","privateKey must be a string"),""):(c("error","at debug/lib-generate-test-usersig-es.min.js:2","sdkAppID must be a number"),"")}newBuffer(e,t){return G.from?G.from(e,t):new G(e,t)}unescape(e){return e.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}escape(e){return e.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}encode(e){return this.escape(this.newBuffer(e).toString("base64"))}decode(e){return this.newBuffer(this.unescape(e),"base64")}base64encode(e){return this.newBuffer(e).toString("base64")}base64decode(e){return this.newBuffer(e,"base64").toString()}_hmacsha256(e,t,n,i){let o="TLS.identifier:"+e+"\n";o+="TLS.sdkappid:"+this.SDKAPPID+"\n",o+="TLS.time:"+t+"\n",o+="TLS.expire:"+n+"\n",null!=i&&(o+="TLS.userbuf:"+i+"\n");let a=Te.HmacSHA256(o,this.PRIVATEKEY);return Te.enc.Base64.stringify(a)}_utc(){return Math.round(Date.now()/1e3)}_isNumber(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"==typeof e&&e.constructor===Number)}_isString(e){return"string"==typeof e}genSigWithUserbuf(e,t,n){let i=this._utc(),o={"TLS.ver":"2.0","TLS.identifier":e,"TLS.sdkappid":this.SDKAPPID,"TLS.time":i,"TLS.expire":t},a="";if(null!=n){let s=this.base64encode(n);o["TLS.userbuf"]=s,a=this._hmacsha256(e,i,t,s)}else a=this._hmacsha256(e,i,t,null);o["TLS.sig"]=a;let s=JSON.stringify(o),r=eo(this.newBuffer(s)).toString("base64"),u=this.escape(r);return c("log","at debug/lib-generate-test-usersig-es.min.js:2","ret="+u),u}validate(e){let t=this.decode(e);c("log","at debug/lib-generate-test-usersig-es.min.js:2","validate ret="+to(t))}}const io=1600089018;function oo(e){const t=new no(io,"3ed492e6eeeaa0f87871f78b24a18619a1e854631a09cd7b20e9ca886ee80d36",604800).genTestUserSig(e);return{sdkAppID:io,userSig:t}}const ao=r("TencentCloud-TUICallKit");uni.$TUICallKit=ao;const so=u({data:()=>({inputID:"",isLogin:!1,userID:""}),methods:{handleLogin(){this.userID=this.inputID;const{userSig:e,sdkAppID:t}=oo(this.userID),n={SDKAppID:t,userID:this.userID,userSig:e};uni.$TUICallKit.login(n,(e=>{0===e.code?(this.isLogin=!0,this.inputID="",c("log","at pages/index/spxz/spxz.vue:31","[TUICallKit] login success.")):c("error","at pages/index/spxz/spxz.vue:33","[TUICallKit] login failed, failed message = ",e.msg,params)}))},handleCall(){try{const e={userIDList:[this.inputID],callMediaType:2,callParams:{roomID:234,strRoomID:"2323423",timeout:30}};uni.$TUICallKit.calls(e,(e=>{c("log","at pages/index/spxz/spxz.vue:47","[TUICallKit] call params: ",JSON.stringify(e))})),this.inputID=""}catch(e){c("log","at pages/index/spxz/spxz.vue:52","[TUICallKit] call error: ",e)}}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>a.inputID=e),placeholder:a.isLogin?"please enter a caller userID":"please enter your login userID"},null,8,["placeholder"]),[[e.vModelText,a.inputID]]),e.withDirectives(e.createElementVNode("text",null," your userID: "+e.toDisplayString(a.userID),513),[[e.vShow,a.isLogin]]),e.withDirectives(e.createElementVNode("button",{onClick:n[1]||(n[1]=(...e)=>s.handleLogin&&s.handleLogin(...e))}," Login ",512),[[e.vShow,!a.isLogin]]),e.withDirectives(e.createElementVNode("button",{onClick:n[2]||(n[2]=(...e)=>s.handleCall&&s.handleCall(...e))}," start call ",512),[[e.vShow,a.isLogin]])])}]]);let ro;ro=3;let co=a({__proto__:null,get vueVersion(){return 3}},[s]);var uo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function lo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ho={exports:{}};ho.exports=function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function t(e){if(Array.isArray(e))return e}function n(e,t,n){t=u(t);var i=e;if(!(t=d()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))||"object"!=typeof t&&"function"!=typeof t){if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(t=i))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,I(i.key),i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){var n,i,o,a,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return o=!(i=!0),{s:function(){s=s.call(e)},n:function(){var e=s.next();return i=e.done,e},e:function(e){o=!0,n=e},f:function(){try{i||null==s.return||s.return()}finally{if(o)throw n}}};if(Array.isArray(e)||(s=C(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!e})()}function h(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)),i}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(null==e)return{};var n,i=function(e,t){if(null==e)return{};var n,i={};for(n in e)if({}.hasOwnProperty.call(e,n)){if(0<=t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),a=0;a<o.length;a++)n=o[a],0<=t.indexOf(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e,n){return t(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,r=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(l){u=!0,o=l}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return r}}(e,n)||C(e,n)||p()}function y(t){return function(t){if(Array.isArray(t))return e(t)}(t)||h(t)||C(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e){return"symbol"==typeof(e=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return String(e);if("object"!=typeof(t=t.call(e,"string")))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e))?e:e+""}function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(t,n){var i;if(t)return"string"==typeof t?e(t,n):"Map"===(i="Object"===(i={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:i)||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}function E(e){var t="function"==typeof Map?new Map:void 0;return function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){var i;return d()?Reflect.construct.apply(null,arguments):((i=[null]).push.apply(i,t),t=new(e.bind.apply(e,i)),n&&_(t,n.prototype),t)}(e,arguments,u(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_(n,e)}(e)}var T={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",ROOM_CUSTOM_DATA_RECEIVED:"onRoomCustomDataReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",MESSAGE_REACTIONS_UPDATED:"onMessageReactionsUpdated",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",MY_FOLLOWERS_LIST_UPDATED:"onMyFollowersListUpdated",MY_FOLLOWING_LIST_UPDATED:"onMyFollowingListUpdated",MUTUAL_FOLLOWERS_LIST_UPDATED:"onMutualFollowersListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",ALL_RECEIVE_MESSAGE_OPT_UPDATED:"onAllReceiveMessageOptUpdated",SERVER_CONFIG_UPDATED:"onServerConfigUpdated"},k={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_ROOM:"Room",GRP_LIVE:"Live",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",RECEIVE_WITH_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_MSG_EXCEPT_AT:"NotReceiveMsgExceptAt",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",INVITE_OPTIONS_DISABLE_INVITE:"DisableInvite",INVITE_OPTIONS_NEED_PERMISSION:"NeedPermission",INVITE_OPTIONS_FREE_ACCESS:"FreeAccess",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INVITE_OPTION:"inviteOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3,IOS_OFFLINE_PUSH_NO_SOUND:"push.no_sound",IOS_OFFLINE_PUSH_DEFAULT_SOUND:"default"},S={NEW_INVITATION_RECEIVED:"newInvitationReceived",INVITEE_ACCEPTED:"ts_invitee_accepted",INVITEE_REJECTED:"ts_invitee_rejected",INVITATION_CANCELLED:"ts_invitation_cancelled",INVITATION_TIMEOUT:"ts_invitation_timeout",INVITATION_MODIFIED:"ts_invitation_modified",ACTION_TYPE_UNKNOWN:0,ACTION_TYPE_INVITE:1,ACTION_TYPE_CANCEL_INVITE:2,ACTION_TYPE_ACCEPT_INVITE:3,ACTION_TYPE_REJECT_INVITE:4,ACTION_TYPE_INVITE_TIMEOUT:5},D=a((function e(){i(this,e),this.cache=[],this.options=null}),[{key:"use",value:function(e){if("function"!=typeof e)throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(e){if(this.middlewares&&0<this.middlewares.length)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),b=a((function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;i(this,e),this.high=t,this.low=n}),[{key:"equal",value:function(e){return null!==e&&this.low===e.low&&this.high===e.high}},{key:"toString",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t="0"+t,n--;return e+t}}]),A={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"},INDONESIA:{DEFAULT:"wss://wssidn-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",IPV6:"wss://wssv6.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",BACKUP_WEB:"wss://*w4c.my-cpaas.com",STAT:"https://events.im.qcloud.com",ANYCAST:"wss://162.14.13.203"},OVERSEA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",IPV6:"wss://wssv6.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",BACKUP_WEB:"wss://*w4c.my-cpaas.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT0:"wss://*w4s.my-imcloud.com",DEFAULT:"wss://wsssgp.im.qcloud.com",IPV6:"wss://wsssgpv6.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",BACKUP_WEB:"wss://*w4s.my-cpaas.com",STAT:"https://apisgp.my-imcloud.com",ANYCAST:"wss://162.14.19.159"},KOREA:{DEFAULT0:"wss://*w4k.my-imcloud.com",DEFAULT:"wss://wsskr.im.qcloud.com",IPV6:"wss://wsskrv6.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",BACKUP_WEB:"wss://*w4k.my-cpaas.com",STAT:"https://apikr.my-imcloud.com",ANYCAST:"wss://162.14.13.104"},GERMANY:{DEFAULT0:"wss://*w4g.my-imcloud.com",DEFAULT:"wss://wssger.im.qcloud.com",IPV6:"wss://wssgerv6.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",BACKUP_WEB:"wss://*w4g.my-cpaas.com",STAT:"https://apiger.my-imcloud.com",ANYCAST:"wss://162.14.3.17"},IND:{DEFAULT0:"wss://*w4i.my-imcloud.com",DEFAULT:"wss://wssind.my-imcloud.com",IPV6:"wss://wssindv6.im.qcloud.com",BACKUP:"wss://wssind.im.qcloud.com",BACKUP_WEB:"wss://*w4i.my-cpaas.com",STAT:"https://apiind.my-imcloud.com",ANYCAST:"wss://162.14.19.46"},JPN:{DEFAULT0:"wss://*w4j.my-imcloud.com",DEFAULT:"wss://wssjpn.im.qcloud.com",IPV6:"wss://wssjpnv6.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",BACKUP_WEB:"wss://*w4j.my-cpaas.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT0:"wss://*w4u.my-imcloud.com",DEFAULT:"wss://wssusa.im.qcloud.com",IPV6:"wss://wssusav6.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",BACKUP_WEB:"wss://*w4u.my-cpaas.com",STAT:"https://apiusa.my-imcloud.com",ANYCAST:"wss://162.14.10.42"},INDONESIA:{DEFAULT0:"wss://*w4y.my-imcloud.com",DEFAULT:"wss://wssidn.im.qcloud.com",IPV6:"wss://wssidnv6.im.qcloud.com",BACKUP:"wss://wssidn.my-imcloud.com",BACKUP_WEB:"wss://*w4y.my-cpaas.com",STAT:"https://apiidn.my-imcloud.com",ANYCAST:"wss://43.129.34.169"}}},L={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15,DONUT_NATIVE_APP:19,NS_NATIVE_APP:20,RN_NATIVE_APP:21},R="1.7.3",w=537048168,O="CHINA",N={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){this.CURRENT=A.PRODUCTION[0<arguments.length&&void 0!==arguments[0]?arguments[0]:O]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GRP:"group_open_http_svc",GRP_AV:"group_open_avchatroom_http_svc",GRP_COMMUNITY:"million_group_open_http_svc",GRP_ATTR:"group_open_attr_http_svc",FD:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GRP_NO_AUTH:"group_open_http_noauth_svc",BIG_GRP_POLLING:"group_open_long_polling_http_svc",BIG_GRP_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",WEB_IM:"webim",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MSG:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate",IM_OPEN_SPEECH:"im_open_speech",MSG_SEARCH:"message_search",GRP_SEARCH:"group_search",GRP_MEMBER_SEARCH:"group_member_search",USER_SEARCH:"user_search",FOLLOW:"follow",OFFLINE_PUSH_REPORT:"offline_push_report",IM_MSG_LOGIC:"im_msg_db_logic"}},P={SEARCH_GRP_SNS:new b(0,Math.pow(2,1)).toString(),AV_HISTORY_MSG:new b(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new b(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new b(0,Math.pow(2,4)).toString(),AV_MBR_LIST:new b(0,Math.pow(2,6)).toString(),USER_STATUS:new b(0,Math.pow(2,7)).toString(),CONV_MARK:new b(0,Math.pow(2,9)).toString(),CONV_GROUP:new b(0,Math.pow(2,10)).toString(),AV_BAN_MBR:new b(0,Math.pow(2,11)).toString(),MSG_EXT:new b(0,Math.pow(2,13)).toString(),GRP_COUNTER:new b(0,Math.pow(2,15)).toString(),PLUGIN_TRANSLATE:new b(Math.pow(2,6)).toString(),PLUGIN_VOICE_TO_TEXT:new b(Math.pow(2,7)).toString(),PLUGIN_CS:new b(Math.pow(2,8)).toString(),PLUGIN_PUSH:new b(Math.pow(2,9)).toString(),PLUGIN_BOT:new b(Math.pow(2,10)).toString(),MSG_REACTION:new b(Math.pow(2,16)).toString(),FOLLOW:new b(Math.pow(2,20)).toString()},U="group_profile",G=["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember","InviteJoinOption"],x=["Role","JoinTime","MsgSeq","MsgFlag"],F="web.sdk.qcloud.com",B="web.sdk.cloud.tencent.cn",V="web.sdk.tencent.cn";N.HOST.setCurrent(O);for(var j,q="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),H=q&&"function"==typeof wx.createGamePortal,K="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),z="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),Y="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),$="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),W="undefined"!=typeof jd&&"function"==typeof jd.getSystemInfoSync,J="undefined"!=typeof uni&&"undefined"==typeof window&&!0,X=q&&"object"===M(wx.miniapp),Z="undefined"!=typeof uni,Q=q||K||z||Y||$||J||W,ee="undefined"==typeof window&&!Q&&void 0!==uo&&void 0!==uo.NativeScriptGlobals,te=void 0!==uo&&(void 0!==uo.nativeModuleProxy||void 0!==uo.ReactNative),ne="undefined"!=typeof uni?!Q:"undefined"!=typeof window&&!Q&&!te,ie=K?qq:z?tt:Y?swan:$?my:q?wx:J?uni:W?jd:{},oe=ne&&window&&window.navigator&&window.navigator.userAgent||"",ae=(W="WEB",/(micromessenger|webbrowser)/i.test(oe)?W="WEB":K?W="QQ_MP":z?W="TT_MP":Y?W="BAIDU_MP":$?W="ALI_MP":q?W=X?"DONUT_NATIVE_APP":"WX_MP":J?W="UNI_NATIVE_APP":ee?W="NS_NATIVE_APP":te&&(W="RN_NATIVE_APP"),L[W]),se=(X=/iPad/i.test(oe),ee=/iPhone/i.test(oe)&&!X,W=/iPod/i.test(oe),ee||X||W),re=(ee=oe.match(/OS (\d+)_/i))&&ee[1]?ee[1]:null,ce=/Android/i.test(oe),ue=(X=oe.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(W=X[1]&&parseFloat(X[1]),ee=X[2]&&parseFloat(X[2]),W&&ee?parseFloat(X[1]+"."+X[2]):W||null):null,le=(X=!(ee=/Edge/i.test(oe))&&/Chrome/i.test(oe),/MSIE/.test(oe)||-1<oe.indexOf("Trident")&&-1<oe.indexOf("rv:11.0")),de=W=!(W=(W=/MSIE\s(\d+)\.\d/.exec(oe))&&parseFloat(W[1]))&&/Trident\/7.0/i.test(oe)&&/rv:11.0/.test(oe)?11:W,he=(W=/Safari/i.test(oe)&&!X&&!ce&&!ee,/Windows/i.test(oe)),pe=/MAC OS X/i.test(oe),ge=ne&&"undefined"!=typeof Worker&&!le,fe=ce||se,me=ne&&void 0!==window.tencent_cloud_im_csig_flutter_for_web_25F_cy,_e="undefined"!=typeof window&&void 0!==window.navigator&&(X=window.navigator.standalone,!(!se||X||W)),ve="undefined"!=typeof console?console:void 0!==uo&&uo.console?uo.console:"undefined"!=typeof window&&window.console?window.console:{},ye=function(){},Ie=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],Me=Ie.length;Me--;)j=Ie[Me],console[j]||(ve[j]=ye);function Ce(){var e=new Date;return e.setTime(De()),e}function Ee(){Se=0}function Te(){return Math.floor(De()/1e3)}var ke=ve,Se=0,De=function(){return(new Date).getTime()+Se},be=0;function Ae(){return qt()?"%c Chat %c":"Chat"}function Le(){var e=Ce();return e.toLocaleTimeString("en-US",{hour12:!1})+"."+function(e){var t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}(e.getMilliseconds())}var Re={arguments2String:function(e){var t="";if(1===e.length)t=e[0];else for(var n=0,i=e.length;n<i;n++){if(ht(e[n]))try{t+=pt(e[n])?JSON.stringify(e[n],["message","code"]):JSON.stringify(e[n])}catch(o){t+=o?o.message:"";break}else t+=e[n];t+=" "}return t},_exec:function(e,t){qt()?ke[e](Ae(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Le(),t):ke[e]("".concat(Ae()," ").concat(Le()," ").concat(t))},d:function(){var e;be<=-1&&(e=this.arguments2String(arguments),this._exec("debug",e))},l:function(){var e;be<=0&&(e=this.arguments2String(arguments),this._exec("log",e))},log:function(){var e;be<=0&&(e=this.arguments2String(arguments),this._exec("log",e))},i:function(){var e;be<=1&&(e=this.arguments2String(arguments),this._exec("info",e))},w:function(){var e;be<=2&&(e=this.arguments2String(arguments),this._exec("warn",e))},e:function(){var e;be<=3&&(e=this.arguments2String(arguments),this._exec("error",e))},setLevel:function(e){e<4&&this._exec("log","set level from "+be+" to "+e),be=e},getLevel:function(){return be}},we={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Oe={NICK:"".concat(ee="Tag_Profile_IM_","Nick"),GENDER:"".concat(ee,"Gender"),BIRTHDAY:"".concat(ee,"BirthDay"),LOCATION:"".concat(ee,"Location"),SELFSIGNATURE:"".concat(ee,"SelfSignature"),ALLOWTYPE:"".concat(ee,"AllowType"),LANGUAGE:"".concat(ee,"Language"),AVATAR:"".concat(ee,"Image"),MESSAGESETTINGS:"".concat(ee,"MsgSettings"),ADMINFORBIDTYPE:"".concat(ee,"AdminForbidType"),LEVEL:"".concat(ee,"Level"),ROLE:"".concat(ee,"Role")},Ne={GROUP:"".concat("Tag_SNS_IM_","Group"),REMARK:"".concat("Tag_SNS_IM_","Remark"),ADDSOURCE:"".concat("Tag_SNS_IM_","AddSource"),ADDWORDING:"".concat("Tag_SNS_IM_","Wording"),ADDTIME:"".concat("Tag_SNS_IM_","AddTime")},Pe={UNKNOWN:"".concat(X="Gender_Type_","Unknown"),FEMALE:"".concat(X,"Female"),MALE:"".concat(X,"Male")},Ue={NONE:"".concat("AdminForbid_Type_","None"),SEND_OUT:"".concat("AdminForbid_Type_","SendOut")},Ge={NEED_CONFIRM:"".concat("AllowType_Type_","NeedConfirm"),ALLOW_ANY:"".concat("AllowType_Type_","AllowAny"),DENY_ANY:"".concat("AllowType_Type_","DenyAny")},xe="JoinedSuccess",Fe="WaitAdminApproval",Be="@TOPIC#_",Ve=Object.prototype.hasOwnProperty;function je(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if($e(e)){for(var t in e)if(Ve.call(e,t))return!1;return!0}return!!(qe(e)||He(e)||Ke(e))&&0===e.size}function qe(e){return"map"===gt(e)}function He(e){return"set"===gt(e)}function Ke(e){return"file"===gt(e)}function ze(e){return null!==e&&("number"==typeof e&&!isNaN(+e)||"object"===M(e)&&e.constructor===Number)}function Ye(e){return null!==e&&"object"===M(e)}function $e(e){if("object"===M(e)&&null!==e){if(null===(e=Object.getPrototypeOf(e)))return 1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return e===t}}function We(e){return"function"==typeof Array.isArray?Array.isArray(e):"array"===gt(e)}function Je(e){return We(e)&&0<e.length}function Xe(e){return"function"==typeof e}function Ze(e){return"filelist"===gt(e)}function Qe(e){return"string"==typeof e&&(e=e[0],!/[^a-zA-Z0-9]/.test(e))}function et(e,t,n,i){if(!ht(e)||!ht(t))return 0;for(var o,a=0,s=Object.keys(t),r=0,c=s.length;r<c;r++)if(o=s[r],!(dt(t[o])||n&&n.includes(o)))if(ht(e[o])&&ht(t[o]))a+=et(e[o],t[o],n,i);else{if(i&&i.includes(t[o]))continue;e[o]!==t[o]&&(e[o]=t[o],a+=1)}return a}function nt(e,t){var n,i=new Map,o=s(e.entries());try{for(o.s();!(n=o.n()).done;){var a=v(n.value,2),r=a[0],c=a[1];c&&i.set(r,t?JSON.stringify(c):JSON.parse(JSON.stringify(c)))}}catch(u){o.e(u)}finally{o.f()}return i}function it(e){if(0===e.length)return 0;for(var t=0,n=0,i="undefined"!=typeof document&&void 0!==document.characterSet?document.characterSet:"UTF-8";void 0!==e[t];)n+=e[t++].charCodeAt[t]<=255?1:!1===i?3:2;return n}function ot(e){return e=e||99999999,Math.round(Math.random()*e)}function at(){for(var e="",t=32;0<t;--t)e+=ft[Math.floor(Math.random()*mt)];return e}function st(e,t){for(var n in e)if(e[n]===t)return 1}function rt(e){return-1===e.indexOf("http://")||-1===e.indexOf("https://")?"https://"+e:e.replace(/https|http/,"https")}function ct(e){if(0===Object.getOwnPropertyNames(e).length)return Object.create(null);var t,n,i=Array.isArray(e)?[]:Object.create(null);for(n in e)null!==e[n]?void 0!==e[n]?(t=M(e[n]),0<=["string","number","function","boolean"].indexOf(t)?i[n]=e[n]:i[n]=ct(e[n])):i[n]=void 0:i[n]=null;return i}var ut=["url"],lt=function(e){return"string"==typeof e},dt=function(e){return void 0===e},ht=function(e){return We(e)||Ye(e)},pt=function(e){return e instanceof Error},gt=function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()},ft=(Date.now||(Date.now=function(){return(new Date).getTime()}),"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),mt=ft.length,_t={};function vt(e,t){var n;return!(!We(e)||!We(t))&&(n=!1,t.forEach((function(t){var i=t.key,o=(t=t.value,e.find((function(e){return e.key===i})));o?o.value!==t&&(o.value=t,n=!0):(e.push({key:i,value:t}),n=!0)})),n)}function yt(e){return je(e)?[]:e.filter((function(e){return!0===e.isModified}))}function It(e){if($e(e)&&$e(e.webhookInfo)){var t=[];if(e.webhookInfo.disableCloudMessagePreHook&&t.push("ForbidBeforeSendMsgCallback"),e.webhookInfo.disableCloudMessagePostHook&&t.push("ForbidAfterSendMsgCallback"),0!==t.length)return t}}function Mt(e){return je(e)?[]:e.filter((function(e){return!1===e.isModified}))}function Ct(e){return e===k.GRP_AVCHATROOM}function Et(e){var t=e.type;return e=e.groupID,t===k.GRP_COMMUNITY||"".concat(e).startsWith("@TGS#_")&&!"".concat(e).includes(Be)}function Tt(e){return"".concat(e).startsWith("@TGS#_")&&"".concat(e).includes(Be)}function kt(e){return lt(e)&&e.slice(0,3)===k.CONV_C2C}function St(e){return lt(e)&&e.slice(0,5)===k.CONV_GROUP}function Dt(e){return lt(e)&&e===k.CONV_SYSTEM}function bt(e,t){var n={};return Object.keys(e).forEach((function(i){n[i]=t(e[i],i)})),n}function At(e){return te?Promise.resolve({width:0,height:0}):Q?new Promise((function(t,n){ie.getImageInfo({src:e,success:function(e){t({width:e.width,height:e.height})},fail:function(){t({width:0,height:0})}})})):le&&9===de?Promise.resolve({width:0,height:0}):new Promise((function(t,n){var i=new Image;i.onload=function(){t({width:this.width,height:this.height}),i=null},i.onerror=function(){t({width:0,height:0}),i=null},i.src=e}))}function Lt(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function Rt(){var e=ce?"android":se?"ios":he?"windows":pe?"mac":"unknown";if(Q)try{var t=ie.getSystemInfoSync().platform;void 0!==t&&(e=t)}catch(n){}return e}function wt(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var i=0;i<n;i++){var o=parseInt(e[i]),a=parseInt(t[i]);if(a<o)return 1;if(o<a)return-1}return 0}function Ot(e){var t=void 0===(t=e.originUrl)?void 0:t,n=e.originWidth,i=e.originHeight,o=(e=void 0===(e=e.min)?198:e,{url:void 0,width:0,height:0});return((n=parseInt(n))<=(i=parseInt(i))?n:i)<=e?(o.url=t,o.width=n,o.height=i):(i<=n?(o.width=Math.ceil(n*e/i),o.height=e):(o.width=e,o.height=Math.ceil(i*e/n)),i=t&&-1<t.indexOf("?")?"".concat(t,"&"):"".concat(t,"?"),o.url="".concat(i,198===e?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")),dt(t)?m(o,ut):o}function Nt(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function Pt(e){return(e=e.servcmd).slice(e.indexOf(".")+1)}function Ut(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function Gt(e,t){return e.includes(t)}function xt(e,t){return e.includes(t)}function Ft(e){return e.split(Be)[0]}function Bt(e,t,n){if(dt(t))return"";switch(e){case k.MSG_TEXT:return t.text;case k.MSG_IMAGE:return n?"[Image]":"[图片]";case k.MSG_LOCATION:return n?"[Location]":"[位置]";case k.MSG_AUDIO:return n?"[Voice]":"[语音]";case k.MSG_VIDEO:return n?"[Video]":"[视频]";case k.MSG_FILE:return n?"[File]":"[文件]";case k.MSG_CUSTOM:return n?"[Custom Messages]":"[自定义消息]";case k.MSG_GRP_TIP:return n?"[Group Notification]":"[群提示消息]";case k.MSG_GRP_SYS_NOTICE:return n?"[Group System Message]":"[群系统通知]";case k.MSG_FACE:return n?"[Animated Sticker]":"[动画表情]";case k.MSG_MERGER:return n?"[Chat Record]":"[聊天记录]";default:return""}}function Vt(e){return e===k.MSG_TEXT||e===k.MSG_CUSTOM||e===k.MSG_LOCATION||e===k.MSG_FACE}function jt(e){var t=[];if(lt(e)){var n=e.length;if(0!==n)for(var i=n-1;0<=i;i--)"1"===e[i]&&t.push(Math.pow(2,n-i-1))}return t}function qt(){return!le&&!Q}function Ht(e){return"the length of userIDList cannot exceed ".concat(e)}function Kt(e){var t;if(We(e)&&0!==e.length)return t=0,e.forEach((function(e){t+=e})),t.toFixed(0)}function zt(e){var t;if(We(e)&&0!==e.length)return t=0,e.forEach((function(e){t+=e})),(t/e.length).toFixed(0)}function Yt(e,t,n){t=!(1<arguments.length&&void 0!==t)||t,n=!(2<arguments.length&&void 0!==n)||n;var i=Date.now();return t?n?"".concat(i-e," ms"):"".concat(Math.round((i-e)/1e3)," s"):n?i-e:Math.round((i-e)/1e3)}function $t(e){return!!(e&&1<e)}function Wt(e,t,n,i){var o,a,s;return void 0===t||(o=!0,t.required&&je(e)&&(Re.e("[".concat(n,'] Missing required params: "').concat(i,'".')),o=!1),je(e)||(a=gt(e))===(s=t.type.toLowerCase())||"asyncfunction"===a&&"function"===s||(Re.e("[".concat(n,'] Invalid params: type check failed for "').concat(i,'". Expected ').concat(t.type,".")),o=!1),t.validator&&!t.validator(e,n,i)&&(Re.e("[".concat(n,'] Invalid params: custom validator check failed for "').concat(i,'".')),o=!1),o)}function Jt(e){return!(!e||!(kt(e)||St(e)||Dt(e))&&((e=Un("InvalidConversationID",e))&&Re.w(e),1))}function Xt(e){""!==e.desc&&""!==Un("API_REFER")&&Re.w("[".concat(e.api,"] | ").concat(e.paramName," | ").concat(e.desc,", ").concat(Un("API_REFER")).concat(e.api))}function Zt(){return Un("StringRequiredLog")}function Qt(e){return Un("NonEmptyStringRequiredLog",e)}function en(){return Un("NumberRequiredLog")}function tn(){return Un("UndefinedNotAllowedLog")}function nn(){return Un("FileRequiredLog")}function on(){return Un("FunctionRequiredLog")}function an(){return Un("ArrayRequiredLog")}function sn(){return Un("NonEmptyArrayLog")}function rn(){return Un("CallbackMissingLog")}function cn(){return Un("PositiveIntegerRequiredLog")}function un(e,t){return Un("StringNotLongerThanLog",e,t)}function ln(e,t){return Un("NumberGreaterThanLog",e,t)}function dn(e,t){return Un("NumberGreaterOrEqualLog",e,t)}function hn(e){return Un("KeyValueStringRequiredLog",e)}function pn(){return Un("PlainObjectRequiredLog")}function gn(){return Un("NonEmptyContentRequiredLog")}function fn(){return Un("FileNotSelectedLog")}function mn(){return Un("MessageInstanceRequiredLog")}function _n(){return Un("NonAnonymousFunctionLog")}function vn(){return Un("MessageExtensionNotAvailableLog")}function yn(){return Un("MessageReactionRequiredLog")}function In(e,t){return Un("ContainsUnsupportedTypeLog",e,t)}function Mn(e,t,n,i){var o=i.allowUndefined,a=i.allowEmpty;return i=i.maxLength,dt(e)?!!o||(Xt({api:t,paramName:n,desc:tn()}),!1):We(e)?!(0===e.length&&(Xt({api:t,paramName:n,desc:sn()}),!a)||i&&e.length>i&&(Xt({api:t,paramName:n,desc:Un("MaximumArrayLengthLog",n,i)}),1)):(Xt({api:t,paramName:n,desc:an()}),!1)}function Cn(e,t,n,i){var o=i.allowUndefined,a=i.min;return i=i.max,dt(e)?!!o||(Xt({api:t,paramName:n,desc:tn()}),!1):ze(e)?ze(a)&&e<a?(Xt({api:t,paramName:n,desc:0===a?dn(n,a):ln(n,a-1)}),!1):!(ze(i)&&i<e&&(Xt({api:t,paramName:n,desc:Un("MaximumNumberLog",n,i)}),1)):(Xt({api:t,paramName:n,desc:en()}),!1)}function En(e){return{code:0,data:e||{}}}function Tn(e){return Promise.resolve(En(e))}function kn(e){var t,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e instanceof Fn?(n&&null!==Vn&&Vn.emit(T.ERROR,e),Promise.reject(e)):e instanceof Error?(t=new Fn({code:Bn.UNCAUGHT_ERROR}),n&&null!==Vn&&Vn.emit(T.ERROR,t),Promise.reject(t)):dt(e)||dt(e.code)?Promise.reject(new Fn({code:Bn.UNCAUGHT_ERROR})):(t=new Fn(e),n&&null!==Vn&&Vn.emit(T.ERROR,t),Promise.reject(t))}var Sn="unSend",Dn="success",bn="fail",An="notStart",Ln="pending",Rn="resolved",wn="rejected",On={type:"Boolean",required:!0},Nn={type:"number",required:!0},Pn={keywordListForMsg:{type:"Array",required:!1,validator:function(e,t,n){return Mn(e,t,n,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},keywordListExceptMsg:{type:"Array",required:!0,validator:function(e,t,n){return Mn(e,t,n,{allowUndefined:!1,allowEmpty:!1,maxLength:5})}},keywordListMatchType:{type:"String",required:!1,validator:function(e,t,n){return!e||"or"===e||"and"===e||Xt({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}},cursor:{type:"String",required:!1},count:{type:"Number",required:!1,validator:function(e,t,n){return Cn(e,t,n,{allowUndefined:!0,min:1,max:100})}},groupTypeList:{type:"Array",required:!1,validator:function(e,t,n){var i;return!e||!(!Mn(e,t,n,{allowUndefined:!0,allowEmpty:!0})||(i=[k.GRP_PUBLIC,k.GRP_COMMUNITY,k.GRP_WORK,k.GRP_MEETING],0<e.filter((function(e){return-1===i.indexOf(e)})).length&&(Xt({api:t,paramName:n,desc:In(n,"group")}),1)))}}},Un=null,Gn={hookGetAPITips:function(e){Un=e},login:{userID:W={type:"String",required:!0},userSig:W},addToBlacklist:{userIDList:ee={type:"Array",required:!0}},removeFromBlacklist:{userIDList:ee},on:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:Qt(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:on()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:Qt(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:on()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:Qt(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:on()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],sendMessage:[f({name:"message"},X={type:"Object",required:!0})],setMessageExtensions:[f(f({name:"message"},X),{},{validator:function(e,t,n){return e.status===Dn&&!0===e.isSupportExtension||(Xt({api:t,paramName:n,desc:vn()}),!1)}}),f({name:"extensions"},ee)],getMessageExtensions:[f(f({name:"message"},X),{},{validator:function(e,t,n){return e.status===Dn&&!0===e.isSupportExtension||(Xt({api:t,paramName:n,desc:vn()}),!1)}})],deleteMessageExtensions:[f(f({name:"message"},X),{},{validator:function(e,t,n){return e.status===Dn&&!0===e.isSupportExtension||(Xt({api:t,paramName:n,desc:vn()}),!1)}})],addMessageReaction:[f(f({name:"message"},X),{},{validator:function(e,t,n){return e.status===Dn||(Xt({api:t,paramName:n,desc:yn()}),!1)}}),f({name:"reactionID"},W)],removeMessageReaction:[f(f({name:"message"},X),{},{validator:function(e,t,n){return e.status===Dn||(Xt({api:t,paramName:n,desc:yn()}),!1)}}),f({name:"reactionID"},W)],getMessageReactions:{messageList:f({},ee)},getAllUserListOfMessageReaction:{message:f(f({},X),{},{validator:function(e,t,n){return e.status===Dn||(Xt({api:t,paramName:n,desc:yn()}),!1)}}),reactionID:f({},W),nextSeq:{type:"Number"},count:{type:"Number"}},getMessageList:{conversationID:f(f({},W),{},{validator:Jt}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(e,t,n){return!(!dt(e)&&!/^[1-9][0-9]*$/.test(e)&&(Xt({api:t,paramName:n,desc:cn()}),1))}}},getMessageListHopping:{conversationID:f(f({},W),{},{validator:Jt}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(e,t,n){return!(!dt(e)&&0!==e&&1!==e&&(Xt({api:t,paramName:n,desc:Un("0Or1RequiredLog")}),1))}},count:{type:"Number",validator:function(e,t,n){return!(!dt(e)&&!/^[1-9][0-9]*$/.test(e)&&(Xt({api:t,paramName:n,desc:cn}),1))}}},setMessageRead:{conversationID:f(f({},W),{},{validator:Jt})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(e,t,n){return!e||-1!==[k.READ_ALL_C2C_MSG,k.READ_ALL_GROUP_MSG,k.READ_ALL_MSG].indexOf(e)||(Xt({api:t,paramName:n,desc:Un("ValidScopeRequired")}),!1)}}},getConversationProfile:[f(f({name:"conversationID"},W),{},{validator:Jt})],clearHistoryMessage:[f(f({name:"conversationID"},W),{},{validator:Jt})],pinConversation:{conversationID:f(f({},W),{},{validator:Jt}),isPinned:f({},On)},setConversationDraft:{conversationID:f(f({},W),{},{validator:Jt}),draftText:{type:"String",validator:function(e,t,n){return!!lt(e)||(Xt({api:t,paramName:n,desc:Zt()}),!1)}}},setConversationCustomData:{conversationIDList:f({},ee),customData:{type:"String",validator:function(e,t,n){return lt(e)?!(256<e.length&&(Xt({api:t,paramName:n,desc:un(n,256)}),1)):(Xt({api:t,paramName:n,desc:Zt()}),!1)}}},markConversation:{conversationIDList:f({},ee),markType:{type:"number",validator:function(e,t,n){return ze(e)?e<=0?(Xt({api:t,paramName:n,desc:ln(n,0)}),!1):!(e>=Math.pow(2,64)&&(Xt({api:t,paramName:n,desc:Un("NumberLessThanLog",n,"Math.pow(2,64)")}),1)):(Xt({api:t,paramName:n,desc:en()}),!1)}},enableMark:f({},On)},createConversationGroup:{conversationIDList:f({},ee),groupName:f(f({},W),{},{validator:function(e,t,n){return!(!e||32<e.length&&(Xt({api:t,paramName:n,desc:un(n,32)}),1))}})},deleteConversationGroup:[f({name:"groupName"},W)],renameConversationGroup:{oldName:f({},W),newName:f(f({},W),{},{validator:function(e,t,n){return!(!e||32<e.length&&(Xt({api:t,paramName:n,desc:un(n,32)}),1))}})},addConversationsToGroup:{conversationIDList:f({},ee),groupName:f({},W)},deleteConversationsFromGroup:{conversationIDList:f({},ee),groupName:f({},W)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:W,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:ee},createGroup:{name:W},joinGroup:{groupID:W,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[f({name:"groupID"},W)],handleApplication:{message:X,handleAction:W,handleMessage:{type:"String"}},changeGroupOwner:{groupID:W,newOwnerID:W},updateGroupProfile:{groupID:W,muteAllMembers:{type:"Boolean"}},dismissGroup:[f({name:"groupID"},W)],searchGroupByID:[f({name:"groupID"},W)],getGroupOnlineMemberCount:[f({name:"groupID"},W)],initGroupAttributes:{groupID:W,groupAttributes:f(f({},X),{},{validator:function(e,t,n){var i=!0;return Object.keys(e).forEach((function(o){if(!lt(e[o]))return Xt({api:t,paramName:n,desc:hn("value")}),i=!1})),i}})},setGroupAttributes:{groupID:W,groupAttributes:f(f({},X),{},{validator:function(e,t,n){var i=!0;return Object.keys(e).forEach((function(o){if(!lt(e[o]))return Xt({api:t,paramName:n,desc:hn("value")}),i=!1})),i}})},deleteGroupAttributes:{groupID:W,keyList:{type:"Array",validator:function(e,t,n){var i;return dt(e)||!We(e)?(Xt({api:t,paramName:n,desc:an()}),!1):!!je(e)||(i=!0,e.forEach((function(e){if(!lt(e))return Xt({api:t,paramName:n,desc:Un("StringArrayRequiredLog")}),i=!1})),i)}}},getGroupAttributes:{groupID:W,keyList:{type:"Array",validator:function(e,t,n){var i;return dt(e)||!We(e)?(Xt({api:t,paramName:n,desc:an()}),!1):!!je(e)||(i=!0,e.forEach((function(e){if(!lt(e))return Xt({api:t,paramName:n,desc:hn("key")}),i=!1})),i)}}},setGroupCounters:{groupID:W,counters:X},increaseGroupCounter:{groupID:W,key:W,value:Nn},decreaseGroupCounter:{groupID:W,key:W,value:Nn},getGroupCounters:{groupID:W},getGroupMemberList:{groupID:W,count:{type:"Number"}},getGroupMemberProfile:{groupID:W,userIDList:ee,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:W,userIDList:ee},setGroupMemberRole:{groupID:W,userID:W,role:W},setGroupMemberMuteTime:{groupID:W,userID:W,muteTime:{type:"Number",validator:function(e){return 0<=e}}},setGroupMemberNameCard:{groupID:W,userID:{type:"String"},nameCard:{type:"String",validator:function(e,t,n){return lt(e)?(e.length,!0):(Xt({api:t,paramName:n,desc:Zt()}),!1)}}},setGroupMemberCustomField:{groupID:W,userID:{type:"String"},memberCustomField:ee},deleteGroupMember:{groupID:W},markGroupMemberList:{groupID:W,markType:{type:"number",validator:function(e,t,n){return ze(e)?!(e<1e3&&(Xt({api:t,paramName:n,desc:dn(n,1e3)}),1)):(Xt({api:t,paramName:n,desc:en()}),!1)}},userIDList:f({},ee),enableMark:f({},On)},createTextMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){return $e(e)?lt(e.text)?0!==e.text.length||(Xt({api:t,paramName:"payload.text",desc:gn()}),!1):(Xt({api:t,paramName:"payload.text",desc:Zt()}),!1):(Xt({api:t,paramName:n,desc:pn()}),!1)}})},createTextAtMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){return $e(e)?lt(e.text)?0===e.text.length?(Xt({api:t,paramName:"payload.text",desc:gn()}),!1):!(e.atUserList&&!We(e.atUserList)&&(Xt({api:t,paramName:"payload.atUserList",desc:an()}),1)):(Xt({api:t,paramName:"payload.text",desc:Zt()}),!1):(Xt({api:t,paramName:n,desc:pn()}),!1)}})},createCustomMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){return $e(e)?e.data&&!lt(e.data)?(Xt({api:t,paramName:"payload.data",desc:Zt()}),!1):e.description&&!lt(e.description)?(Xt({api:t,paramName:"payload.description",desc:Zt()}),!1):!(e.extension&&!lt(e.extension)&&(Xt({api:t,paramName:"payload.extension",desc:Zt()}),1)):(Xt({api:t,paramName:"payload",desc:pn()}),!1)}})},createImageMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){if(!$e(e))return Xt({api:t,paramName:n,desc:pn()}),!1;if(dt(e.file))return Xt({api:t,paramName:"payload.file",desc:tn()}),!1;if(ne){if(!(e.file instanceof HTMLInputElement||Ke(e.file)))return $e(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Xt({api:t,paramName:"payload.file",desc:fn()}),!1):(Xt({api:t,paramName:"payload.file",desc:nn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Xt({api:t,paramName:"payload.file",desc:fn()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:rn()}),!0}}})},createAudioMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){return!!$e(e)||(Xt({api:t,paramName:n,desc:pn()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:rn()}),!0}}},createVideoMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){if(!$e(e))return Xt({api:t,paramName:n,desc:pn()}),!1;if(dt(e.file))return Xt({api:t,paramName:"payload.file",desc:tn()}),!1;if(ne){if(!(e.file instanceof HTMLInputElement||Ke(e.file)))return $e(e.file)&&"undefined"!=typeof uni?!!Ke(e.file.tempFile)||(Xt({api:t,paramName:"payload.file",desc:fn()}),!1):(Xt({api:t,paramName:"payload.file",desc:nn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Xt({api:t,paramName:"payload.file",desc:fn()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:rn()}),!0}}},createFaceMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){return $e(e)?ze(e.index)?!!lt(e.data)||(Xt({api:t,paramName:"payload.data",desc:Zt()}),!1):(Xt({api:t,paramName:"payload.index",desc:en()}),!1):(Xt({api:t,paramName:n,desc:pn()}),!1)}})},createFileMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){if(!$e(e))return Xt({api:t,paramName:n,desc:pn()}),!1;if(dt(e.file))return Xt({api:t,paramName:"payload.file",desc:tn()}),!1;if(ne){if(!(e.file instanceof HTMLInputElement||Ke(e.file)))return $e(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Xt({api:t,paramName:"payload.file",desc:fn()}),!1):(Xt({api:t,paramName:"payload.file",desc:nn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Xt({api:t,paramName:"payload.file",desc:fn()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:rn()}),!0}}},createLocationMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){return $e(e)?lt(e.description)?ze(e.longitude)?!!ze(e.latitude)||(Xt({api:t,paramName:"payload.latitude",desc:en()}),!1):(Xt({api:t,paramName:"payload.longitude",desc:en()}),!1):(Xt({api:t,paramName:"payload.description",desc:Zt()}),!1):(Xt({api:t,paramName:n,desc:pn()}),!1)}})},createMergerMessage:{to:W,conversationType:W,payload:f(f({},X),{},{validator:function(e,t,n){var i;return je(e.messageList)?(Xt({api:t,paramName:"payload.messageList",desc:sn()}),!1):je(e.compatibleText)?(Xt({api:t,paramName:"payload.compatibleText",desc:Qt("compatibleText")}),!1):(i=!1,e.messageList.forEach((function(e){e.status===bn&&(i=!0)})),!i||(Xt({api:t,paramName:"payload.messageList",desc:Un("MergeFailedMessageLog")}),!1))}})},revokeMessage:[f(f({name:"message"},X),{},{validator:function(e,t,n){return je(e)?(Xt({api:t,paramName:n,desc:mn()}),!1):e.conversationType===k.CONV_SYSTEM?(Xt({api:t,paramName:n,desc:Un("MessageCanBeRevokedDesc")}),!1):!0!==e.isRevoked||(Xt({api:t,paramName:n,desc:Un("MessageRevokedLog")}),!1)}})],deleteMessage:[f(f({name:"messageList"},ee),{},{validator:function(e,t,n){return!je(e)||(Xt({api:t,paramName:n,desc:sn()}),!1)}})],translateText:{sourceTextList:ee,sourceLanguage:W,targetLanguage:W},convertVoiceToText:{message:f(f({},X),{},{validator:function(e,t,n){return je(e)?(Xt({api:t,paramName:n,desc:mn()}),!1):e.type===k.MSG_AUDIO&&e.status===Dn||(Xt({api:t,paramName:n,desc:Un("AudioMessageRequiredLog")}),!1)}})},modifyMessage:[f(f({name:"message"},X),{},{validator:function(e,t,n){return je(e)?(Xt({api:t,paramName:n,desc:mn()}),!1):e.conversationType===k.CONV_SYSTEM?(Xt({api:t,paramName:n,desc:Un("MessageCanBeModifiedLog")}),!1):!0!==e._onlineOnlyFlag||(Xt({api:t,paramName:n,desc:Un("OnlineMessageNotSupportLog")}),!1)}})],searchCloudMessages:{keywordList:Pn.keywordListForMsg,keywordListMatchType:Pn.keywordListMatchType,cursor:Pn.cursor,senderUserIDList:{type:"Array",required:!1,validator:function(e,t,n){return Mn(e,t,n,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},messageTypeList:{type:"Array",required:!1,validator:function(e,t,n){var i;return!e||!(!Mn(e,t,n,{allowUndefined:!0,allowEmpty:!0})||(i=[k.MSG_TEXT,k.MSG_IMAGE,k.MSG_AUDIO,k.MSG_FILE,k.MSG_VIDEO,k.MSG_LOCATION,k.MSG_CUSTOM,k.MSG_MERGER],0<e.filter((function(e){return-1===i.indexOf(e)})).length&&(Xt({api:t,paramName:n,desc:In(n,"message")}),1)))}},conversationID:{type:"String",required:!1,validator:function(e){return!e||Jt(e)}},timePosition:{type:"number",required:!1,validator:function(e,t,n){return Cn(e,t,n,{allowUndefined:!0,min:0})}},timePeriod:{type:"number",required:!1,validator:function(e,t,n){return Cn(e,t,n,{allowUndefined:!0,min:0})}}},searchCloudUsers:{keywordList:Pn.keywordListExceptMsg,keywordListMatchType:Pn.keywordListMatchType,cursor:Pn.cursor,count:Pn.count,miniBirthday:{type:"Number",required:!1,validator:function(e,t,n){return Cn(e,t,n,{allowUndefined:!0,min:0})}},maxBirthday:{type:"Number",required:!1,validator:function(e,t,n){return Cn(e,t,n,{allowUndefined:!0,min:0})}},gender:{type:"String",required:!1,validator:function(e,t,n){return!e||e===k.GENDER_FEMALE||e===k.GENDER_MALE||Xt({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}}},searchCloudGroups:{keywordList:Pn.keywordListExceptMsg,keywordListMatchType:Pn.keywordListMatchType,cursor:Pn.cursor,count:Pn.count,groupTypeList:Pn.groupTypeList},searchCloudGroupMembers:{keywordList:Pn.keywordListExceptMsg,keywordListMatchType:Pn.keywordListMatchType,cursor:Pn.cursor,count:Pn.count,groupTypeList:Pn.groupTypeList,groupIDList:{type:"Array",required:!1,validator:function(e,t,n){return Mn(e,t,n,{allowUndefined:!0,allowEmpty:!0})}}},getUserProfile:{userIDList:{type:"Array",validator:function(e,t,n){return We(e)?(0===e.length&&Xt({api:t,paramName:n,desc:sn()}),!0):(Xt({api:t,paramName:n,desc:an()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(e,t,n){return!!dt(e)||!!We(e)||(Xt({api:t,paramName:n,desc:an()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(e,t,n){return!!lt(e)||(Xt({api:t,paramName:n,desc:Zt()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return We(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:an()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return We(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:an()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return!e||!!We(e)||(Xt({api:t,paramName:n,desc:an()}),!1)}}},addFriend:{to:W,source:{type:"String",required:!0,validator:function(e,t,n){return!(!e||(e.startsWith("AddSource_Type_")?8<e.replace("AddSource_Type_","").length&&(Xt({api:t,paramName:n,desc:un("keyword",8)}),1):(Xt({api:t,paramName:n,desc:Un("SourcePrefixLog")}),1)))}},remark:{type:"String",required:!1,validator:function(e,t,n){return!(lt(e)&&96<e.length&&(Xt({api:t,paramName:n,desc:un(n,96)}),1))}}},deleteFriend:{userIDList:ee},checkFriend:{userIDList:ee},getFriendProfile:{userIDList:ee},updateFriend:{userID:W,remark:{type:"String",required:!1,validator:function(e,t,n){return!(lt(e)&&96<e.length&&(Xt({api:t,paramName:n,desc:un(n,96)}),1))}},friendCustomField:{type:"Array",required:!1,validator:function(e,t,n){var i;return!e||(We(e)?(i=!0,e.forEach((function(e){return lt(e.key)&&-1!==e.key.indexOf("Tag_SNS_Custom")?lt(e.value)?8<e.key.replace("Tag_SNS_Custom_","").length?(Xt({api:t,paramName:n,desc:un("keyword",8)}),i=!1):void 0:(Xt({api:t,paramName:n,desc:hn("value")}),i=!1):(Xt({api:t,paramName:n,desc:Un("FriendCustomFieldPrefixLog")}),i=!1)})),i):(Xt({api:t,paramName:n,desc:an()}),!1))}}},acceptFriendApplication:{userID:W},refuseFriendApplication:{userID:W},deleteFriendApplication:{userID:W},createFriendGroup:{name:W},deleteFriendGroup:{name:W},addToFriendGroup:{name:W,userIDList:ee},removeFromFriendGroup:{name:W,userIDList:ee},renameFriendGroup:{oldName:W,newName:W},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(e,t,n){return We(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:an()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(e,t,n){return We(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:an()}),!1)}}],createTopicInCommunity:{groupID:W,topicName:W},deleteTopicFromCommunity:{groupID:W,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!We(e)||(Xt({api:t,paramName:n,desc:an()}),!1)}}},updateTopicProfile:{groupID:W,topicID:W},getTopicList:{groupID:W,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!We(e)||(Xt({api:t,paramName:n,desc:an()}),!1)}}},followUser:[f({name:"userIDList"},ee)],unfollowUser:[f({name:"userIDList"},ee)],getMyFollowingList:[f(f({name:"startIndex"},W),{},{required:!1})],getMyFollowersList:[f(f({name:"startIndex"},W),{},{required:!1})],getMutualFollowersList:[f(f({name:"startIndex"},W),{},{required:!1})],getUserFollowInfo:[f(f({name:"userIDList"},ee),{},{required:!1})],checkFollowType:[f({name:"userIDList"},ee)],addSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:Qt(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:on()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],removeSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:Qt(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:on()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],invite:{userID:W},inviteSync:[f(f({},X),{},{validator:function(e,t,n){return $e(e)?!!lt(e.userID)||(Xt({api:t,paramName:"options.userID",desc:Zt()}),!1):(Xt({api:t,paramName:"options",desc:pn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:on()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:on()}),!0}}],inviteInGroup:{groupID:W,inviteeList:ee},inviteInGroupSync:[f(f({},X),{},{validator:function(e,t,n){return $e(e)?lt(e.groupID)?!!We(e.inviteeList)||(Xt({api:t,paramName:"options.inviteeList",desc:an()}),!1):(Xt({api:t,paramName:"options.groupID",desc:Zt()}),!1):(Xt({api:t,paramName:"options",desc:pn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:on()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return dt(e)&&Xt({api:t,paramName:n,desc:on()}),!0}}],accept:{inviteID:W},reject:{inviteID:W},getSignalingInfo:[f(f({name:"message"},X),{},{validator:function(e,t,n){return!je(e)||(Xt({api:t,paramName:n,desc:mn()}),!1)}})],modifyInvitation:{inviteID:W,data:W}},xn={login:1,logout:1,getLoginUser:1,getServerTime:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,isReady:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,convertVoiceToText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,setConversationDraft:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,setMessageRemindType:1,setAllReceiveMessageOpt:1,getAllReceiveMessageOpt:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,searchCloudMessages:1,searchCloudUsers:1,searchCloudGroups:1,searchCloudGroupMembers:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,followUser:1,unfollowUser:1,getMyFollowingList:1,getMyFollowersList:1,getMutualFollowersList:1,getUserFollowInfo:1,checkFollowType:1,callExperimentalAPI:1,addSignalingListener:1,removeSignalingListener:1,invite:1,inviteSync:1,inviteInGroup:1,inviteInGroupSync:1,cancel:1,accept:1,reject:1,getSignalingInfo:1,modifyInvitation:1},Fn=(l(si,E(Error)),a(si)),Bn={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MSG_SEND_FAIL:2100,MSG_SEND_FAIL_NOT_IN_AV:2101,MSG_INSTANCE_REQUIRED:2105,MSG_INVALID_CONV_TYPE:2106,MSG_F_IS_EMPTY:2108,MSG_ONPROGRESS_ERR:2109,MSG_REVOKE_FAIL:2110,MSG_DELETE_FAIL:2111,MSG_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MSG_LIST_EMPTY:2114,MSG_SEND_GRP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GRP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,VOICE_TO_TEXT_FAIL:2118,UNSUPPORTED_VOICE_FORMAT:2119,MSG_I_SELECT_F_FIRST:2251,MSG_I_TYPES_LIMIT:2252,MSG_I_SIZE_LIMIT:2253,MSG_A_UPLOAD_FAIL:2300,MSG_A_SIZE_LIMIT:2301,MSG_V_UPLOAD_FAIL:2350,MSG_V_SIZE_LIMIT:2351,MSG_V_TYPES_LIMIT:2352,MSG_F_UPLOAD_FAIL:2400,MSG_F_SELECT_F_FIRST:2401,MSG_F_SIZE_LIMIT:2402,MSG_F_URL_IS_EMPTY:2403,MSG_MERGER_TYPE_INVALID:2450,MSG_MERGER_KEY_INVALID:2451,MSG_MERGER_DOWNLOAD_FAIL:2452,MSG_FORWARD_TYPE_INVALID:2453,MSG_FORWARD_INVALID_ELEMENTS:2454,MSG_MODIFY_CONFLICT:2480,MSG_MODIFY_DISABLED_IN_AV:2481,CONV_NOT_FOUND:2500,USER_OR_GRP_NOT_FOUND:2501,CONV_UN_RECORDED_TYPE:2502,INVALID_CONV_ID:2503,ILLEGAL_GRP_TYPE:2600,ILLEGAL_GRP_ID:2602,CANNOT_FIND_GRP:2603,CANNOT_CHANGE_OWNER_IN_AV:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,MEMBER_NOT_IN_GRP:2623,JOIN_GRP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AV:2661,CANNOT_JOIN_NON_AV_WITHOUT_LOGIN:2662,NOT_OWNER:2681,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,OPERATION_NOT_SUPPORTED_IN_AV:2687,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GRP_EXISTED:2710,FRIEND_GRP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,NO_PROTOCOL:2997,NO_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,NO_USE:3122,PROFANITY_FOUND:3123,OPTIONS_IS_EMPTY:3153,MSG_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022,SIGNALING_INVALID_INVITE_ID:8010,SIGNALING_NO_PERMISSION:8011,SIGNALING_ALREADY_EXISTS:8012,INVALID_CANCEL_MESSAGE:8020},Vn=null,jn=(Nn=a((function e(t){i(this,e),this._m=t,this._n=""}),[{key:"isLoggedIn",value:function(){return this._m.get(12).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.get(12).isOversea()}},{key:"isPrivateNetWork",value:function(){var e=this._m.get(12);return e.isPrivateNetWork()&&!e.getFileDownloadProxy()}},{key:"getFileDownloadProxy",value:function(){return this._m.get(12).getFileDownloadProxy()}},{key:"getDownloadFileAuthKey",value:function(){return this._m.get(12).getDownloadFileAuthKey()}},{key:"getMyUserID",value:function(){return this._m.get(12).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.get(12).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.get(12).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.get(12).isIntl()}},{key:"isUsingChatCore",value:function(){return this._m.get(12).isUsingChatCore()}},{key:"isDevMode",value:function(){return this._m.get(12).isDevMode()}},{key:"get",value:function(e){return this._m.get(e)}},{key:"getPlatform",value:function(){return ae}},{key:"getCloudConfig",value:function(e){return this._m.get(23).getCloudConfig(e)}},{key:"emitOEvt",value:function(e,t){this._m.getOEmitInst().emit(e,t)}},{key:"emitIEvt",value:function(e,t){this._m.getIEmitInst().emit(e,t)}},{key:"getIEmitInst",value:function(){return this._m.getIEmitInst()}},{key:"req",value:function(e){return this._m.get(20).req(e)}},{key:"canIUse",value:function(e){return this._m.get(27).canIUse(e)}},{key:"getErrMsg",value:function(e,t,n){return this._m.getErrMsg(e,t,n)}},{key:"warn",value:function(e,t,n){(e=this.getErrMsg(e,t,n))&&Re.w(e)}},{key:"noUse",value:function(e){var t=Bn.NO_USE;return kn({code:t,message:this.getErrMsg(t,e)})}}]),{LOGIN:"wslogin",LOGOUT:"wslogout",HELLO:"wshello",KICK_OTHER:"KickOther",SYNC_UNREAD_MSG:"getmsg",SEND_C2C_MSG:"sendmsg",SEND_GRP_MSG:"send_group_msg",GET_USER_PROFILE:"portrait_get_all",UPDATE_MY_PROFILE:"portrait_set",GET_BL:"black_list_get",ADD_TO_BL:"black_list_add",RM_FROM_BL:"black_list_delete",GET_FD_LIST:"friend_get",GET_FD_PROFILE:"friend_get_specified",CHECK_FD:"friend_check",DEL_FD:"friend_delete",ADD_FD:"friend_add",UPDATE_FD:"friend_update",RESPOND_FD_APPLICATION:"friend_response",GET_FD_APPLICATION_LIST:"pendency_get",DEL_FD_APPLICATION:"pendency_delete",REFUSE_FD_APPLICATION:"pendency_refuse",REPORT_FD_APPLICATION:"pendency_report",GET_FD_GRP_LIST:"group_get",CREATE_FD_GRP:"group_add",DEL_FD_GRP:"group_delete",UPDATE_FD_GRP:"group_update",REVOKE_C2C_MSG:"msgwithdraw",SET_C2C_MSG_READ:"msgreaded",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_C2C_ROAMING_MSG:"getroammsg",GET_C2C_PEER_READ_TIME:"get_peer_read_time",DEL_C2C_MSG:"delete_c2c_msg_ramble",MODIFY_C2C_MSG:"modify_c2c_msg",MODIFY_C2C_MSG_EXT:"set_key_values",GET_C2C_MSG_EXT:"get_key_values",ADD_C2C_MSG_REACTION:"reaction_add",RM_C2C_MSG_REACTION:"reaction_del",GET_C2C_MSG_REACTIONS:"reaction_multi_stat",GET_C2C_MSG_REACTION_USER_LIST:"reaction_iterate",PAGING_GET_CONV_LIST:"page_get",DEL_CONV:"batch_delete",CLEAR_HISTORY_MSG:"clear_msg",PIN_CONV:"top",DEL_GROUP_AT_TIPS:"deletemsg",SET_CONV_CUSTOM_DATA:"set_conv_custom_data",MARK_CONV:"mark_contact",CREATE_CONV_GRP:"create_contact_group",DEL_CONV_GRP:"del_contact_group",RENAME_CONV_GRP:"update_contact_group",ADD_CONV_TO_GRP:"add_conv_to_group",DEL_CONV_FROM_GRP:"del_conv_from_group",GET_CONV_GRP_LIST:"get_contact_group",SEARCH_CONV_GRP_MARK:"search_contact_group",GET_GRP_LIST:"get_joined_group_list",GET_GRP_PROFILE:"get_group_self_member_info",CREATE_GRP:"create_group",DISMISS_GRP:"destroy_group",UPDATE_GRP_PROFILE:"modify_group_base_info",APPLY_JOIN_GRP:"apply_join_group",APPLY_JOIN_GRP_NOAUTH:"apply_join_group_noauth",QUIT_GRP:"quit_group",SEARCH_GRP:"get_group_public_info",CHANGE_GRP_OWNER:"change_group_owner",HANDLE_GRP_APPLICATION:"handle_apply_join_group",HANDLE_INVITE_JOIN_GRP:"handle_invite_join_permission_group",HANDLE_GRP_INVITATION:"handle_invite_join_group",REVOKE_GRP_MSG:"group_msg_recall",SET_GRP_MSG_READ:"msg_read_report",SET_ALL_MSG_READ:"read_all_unread_msg",GET_GRP_ROAMING_MSG:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",GET_GRP_RECEIPTS_BY_USERS:"get_group_msg_receipts_by_users",GET_GRP_PENDENCY:"get_pendency",DEL_GRP_SYSTEM_NOTICE:"deletemsg",AV_POLLING:"get_msg",AV_NOAUTH_POLLING:"get_msg_noauth",GET_ONLINE_MBR_NUM:"get_online_member_num",DEL_GRP_MSG:"delete_group_ramble_msg_by_seq",MODIFY_GRP_MSG:"modify_group_msg",SET_GRP_ATTR:"set_group_attr",MODIFY_GRP_ATTR:"modify_group_attr",DEL_GRP_ATTR:"delete_group_attr",CLEAR_GRP_ATTR:"clear_group_attr",GET_GRP_ATTR:"get_group_attr",MODIFY_GRP_MSG_EXT:"group_set_key_values",GET_GRP_MSG_EXT:"group_get_key_values",GET_GRP_NOTIFY:"batch_get_group_notify",UPDATE_GRP_COUNTER:"update_group_counter",GET_GRP_COUNTER:"get_group_counter",ADD_GRP_MSG_REACTION:"group_reaction_add",RM_GRP_MSG_REACTION:"group_reaction_del",GET_GRP_MSG_REACTIONS:"group_reaction_multi_stat",GET_GRP_MSG_REACTION_USER_LIST:"group_reaction_iterate",GET_GRP_MBR_LIST:"get_group_member_info",GET_AV_MBR_LIST:"get_members",GET_GRP_MBR_PROFILE:"get_specified_group_member_info",ADD_GRP_MBR:"add_group_member",DEL_GRP_MBR:"delete_group_member",BAN_AV_MBR:"ban_group_member",MODIFY_GRP_MBR_INFO:"modify_group_member_info",MARK_AV_MBR_INFO:"modify_user_info",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",SIMPLE_COS_PRE_SIG:"simple_sig",GET_IMAGE_INFO:"get_imageinfo",GET_IP:"get_final_ip",VIDEO_COVER:"video_cover",SSO_STAT:"tim_web_report_v2",PING:"alive",MSG_PUSH:"msg_push",CS:"query",GRP_CS:"query_grp",MBR_CS:"query_grp_member",USER_CS:"query_user",MULTI_MSG_PUSH:"multi_msg_push_ws",MSG_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",UPLOAD_MERGER_MSG:"save_relay_json_msg",DOWNLOAD_MERGER_MSG:"get_relay_json_msg",FETCH_CLOUD_CTRL_CONFIG:"fetch_config",PUSHED_CLOUD_CTRL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",OVERLOAD_NOTIFY:"notify2",CREATE_TOPIC:"create_topic",DEL_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUB_USER_STATUS:"ws_status_subscribe",UNSUB_USER_STATUS:"ws_status_unsubscribe",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PUSH_REPORT:"uniapp_sdk_report",GET_PROFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",VOICE_TO_TEXT:"ws_sentence_recognition",FOLLOW:"follow_add",UNFOLLOW:"follow_delete",GET_FOLLOW:"follow_get",GET_FOLLOW_INFO:"follow_get_info",CHECK_FOLLOW_TYPE:"follow_check",SET_ALL_RECEIVE_MSG_OPT:"ws_set_do_not_disturb",GET_ALL_RECEIVE_MSG_OPT:"ws_get_do_not_disturb"}),qn="networkRTT",Hn="messageE2EDelay",Kn="sendMessageC2C",zn="sendMessageGroup",Yn="sendMessageGroupAV",$n="sendMessageRichMedia",Wn="cosUpload",Jn="messageReceivedGroup",Xn="messageReceivedGroupAVPush",Zn="messageReceivedGroupAVPull",Qn=r(r(r(r(r(r(r(r(r(r({},qn,2),Hn,3),Kn,4),zn,5),Yn,6),$n,7),Jn,8),Xn,9),Zn,10),Wn,11),ei={info:4,warning:5,error:6},ti={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},ni={login:4,plugin_search:16,plugin_translate:16,plugin_voice_to_text:16,plugin_cs:16,plugin_push:16,plugin_bot:16,plugin_emoji_reaction:16,tui_key_features:16},ii=a(ai,[{key:"updateTimeStamp",value:function(){this.timestamp=De()}},{key:"start",value:function(e){return this._startts=e,this}},{key:"end",value:function(){var e,t=this,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._sentFlag||(this._netMonitorModule&&(e=this._netMonitorModule.getNetworkType(),this.setNetworkType(e)),e=De(),0===this.costTime&&(this.costTime=e-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(e)),n?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout((function(){t._sentFlag=!0,t._eventStatModule&&t._eventStatModule.pushIn(t)}),0))}},{key:"setError",value:function(e){var t;return e instanceof Error?this._sentFlag||(t=!0,(t=this._netMonitorModule?this._netMonitorModule.isOnline():t)?(e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message)):this.setCode(Bn.NO_NETWORK),this.setLevel("error")):Re.w("".concat(this._n,".setError value not instanceof Error, please check!")),this}},{key:"setCode",value:function(e){return dt(e)||this._sentFlag||("ECONNABORTED"===e&&(this.code=103),ze(e)?this.code=e:Re.w("".concat(this._n,".setCode value not a number, please check!"),e,M(e))),this}},{key:"setMessage",value:function(e){return dt(e)||this._sentFlag||(ze(e)&&(this.message=e.toString()),lt(e)&&(this.message=e)),this}},{key:"setCostTime",value:function(e){return this.costTime=e,this}},{key:"setLevel",value:function(e){return dt(e)||this._sentFlag||(this.level=ei[e]),this}},{key:"setMoreMessage",value:function(e){return je(this.moreMessage)?this.moreMessage="".concat(e):this.moreMessage+=" ".concat(e),this}},{key:"setNetworkType",value:function(e){return dt(e)?Re.w("".concat(this._n,".setNetworkType value is undefined, please check!")):(e=ti[e.toLowerCase()],dt(e)||(this.networkType=e)),this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(e){return this.uiPlatform=e,this}},{key:"setExtension",value:function(e){return this.extension=e,this}},{key:"setEventType",value:function(e){return this.eventType=e,this}}],[{key:"bindEventStatModule",value:function(e){ai.prototype._eventStatModule=e}},{key:"bindNetMonitorModule",value:function(e){ai.prototype._netMonitorModule=e}}]),oi=a((function e(t){i(this,e),this.type=k.MSG_TEXT,this.content={text:t.text||""}}),[{key:"setText",value:function(e){this.content.text=e}},{key:"sendable",value:function(){return 0!==this.content.text.length}}]);function ai(e){i(this,ai),this._n="SSOLogData",this.eventType=ni[e]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=e,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=De()}function si(e){i(this,si),t=n(this,si);var t,o=e.code,a=e.message;return e=e.data,t.code=o,a?t.message=a:t._getErrMsg&&(t.message=t._getErrMsg(t.code)),t.data=e||{},t}function ri(e,t,n,i){var o;return i=3<arguments.length&&void 0!==i?i:[],e&&(o=e,t&&(e.startsWith("http://")?o=e.replace(/^http:\/\/[^/]+/,t):e.startsWith("https://")&&(o=e.replace(/^https:\/\/[^/]+/,t))),n&&-1===o.indexOf("authKey=")&&li(o,i)?(-1<o.indexOf("?")?"".concat(o,"&authKey="):"".concat(o,"?authKey=")).concat(n):o)}function ci(e,t,n){var i=2<arguments.length&&void 0!==n?n:[];return n=t[0].content||t[0].payload,e===k.MSG_IMAGE?n.imageInfoArray.forEach((function(e){li(e.imageUrl,i)&&(e.imageUrl=ui(e.imageUrl))})):e===k.MSG_VIDEO?(li(n.snapshotUrl,i)&&(n.snapshotUrl=ui(n.snapshotUrl),n.thumbUrl=ui(n.thumbUrl)),li(n.remoteVideoUrl,i)&&(n.remoteVideoUrl=ui(n.remoteVideoUrl))):e===k.MSG_AUDIO?li(n.remoteAudioUrl,i)&&(n.remoteAudioUrl=ui(n.remoteAudioUrl)):e===k.MSG_FILE?li(n.fileUrl,i)&&(n.fileUrl=ui(n.fileUrl)):e===k.MSG_MERGER&&(e=(n=t[0].content||t[0].payload).downloadKey,n=void 0===(n=n.messageList)?[]:n,je(void 0===e?"":e))&&n.forEach((function(e){ci(e.messageBody[0].type,e.messageBody,i)})),t}function ui(e){if(!e)return e;if(-1===e.indexOf("authKey="))return e;for(var t=(e=e.split("?"))[1].split("&"),n=0,i=0;i<t.length;i++)if(-1<t[i].indexOf("authKey=")){n=i;break}return t.splice(n,1),0<t.length?"".concat(e[0],"?").concat(t.join("&")):e[0]}function li(e,t){var n=!1;if(e){var i=(e=e.match(/:\/\/([0-9]?\.)?(.[^/:]+)/))&&e[2]||"";if(i.includes("rich-dev"))return 1;for(var o=0;o<t.length;o++)if(i.endsWith(t[o])){n=!0;break}}return n}var di=a((function e(t,n,o,a){i(this,e),this._imageMemoryURL="",this._fileDownloadProxy=n,this._authKey=o,this._fileDNList=a,Q||te?this.createImageDataASURL(t.file):this.createImageDataASURLInWeb(t.file),this._initImageInfoModel(),this.type=k.MSG_IMAGE,this._percent=0,this.content={imageFormat:t.imageFormat||we.UNKNOWN,uuid:t.uuid,imageInfoArray:[]},this.initImageInfoArray(t.imageInfoArray),this._autoFixUrl()}),[{key:"_initImageInfoModel",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=ot(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.imageUrl||t.url||"",this.url=ri(t.url||e._imageMemoryURL,e._fileDownloadProxy,e._authKey,e._fileDNList)},this._ImageInfoModel.prototype={setSizeType:function(e){this.sizeType=e},setType:function(e){this.type=e},setImageUrl:function(t){t&&(this.imageUrl=ri(t,e._fileDownloadProxy,e._authKey,e._fileDNList))},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(e){for(var t,n=0,i=null;n<=2;)t=dt(e)||dt(e[n])?{type:0,size:0,width:0,height:0,url:""}:e[n],(i=new this._ImageInfoModel(t)).setSizeType(n+1),i.setType(n),this.addImageInfo(i),n++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(e){for(var t,n=this.content.imageInfoArray.length,i=0;i<n;i++)t=this.content.imageInfoArray[i],e[i].size&&(t.size=e[i].size),e[i].url&&t.setImageUrl(e[i].url),e[i].width&&(t.width=e[i].width),e[i].height&&(t.height=e[i].height)}},{key:"_autoFixUrl",value:function(){for(var e=this.content.imageInfoArray.length,t="",n="",i=["http","https"],o=null,a=0;a<e;a++)this.content.imageInfoArray[a].url&&""!==(o=this.content.imageInfoArray[a]).imageUrl&&(n=o.imageUrl.slice(0,o.imageUrl.indexOf("://")+1),t=o.imageUrl.slice(o.imageUrl.indexOf("://")+1),i.indexOf(n)<0&&(n="https:"),this.content.imageInfoArray[a].setImageUrl([n,t].join("")))}},{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateImageFormat",value:function(e){this.content.imageFormat=we[e.toUpperCase()]||we.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(e){void 0!==e&&0<e.files.length&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:"createImageDataASURL",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:"replaceImageInfo",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:"addImageInfo",value:function(e){3<=this.content.imageInfoArray.length||this.content.imageInfoArray.push(e)}},{key:"updateAccessSideImageInfoArray",value:function(){var e=this.content.imageInfoArray,t=void 0===(t=(n=e[0]).width)?0:t,n=void 0===(n=n.height)?0:n;0!==t&&0!==n&&(Nt(e),Object.assign(e[2],Ot({originWidth:t,originHeight:n,min:720})))}},{key:"sendable",value:function(){return 0!==this.content.imageInfoArray.length&&""!==this.content.imageInfoArray[0].imageUrl&&0!==this.content.imageInfoArray[0].size}}]),hi=a((function e(t){i(this,e),this.type=k.MSG_FACE,this.content=t||null}),[{key:"sendable",value:function(){return null!==this.content}}]),pi=a((function e(t,n,o,a){i(this,e),this.type=k.MSG_AUDIO,this._percent=0,this._fileDownloadProxy=n,this._authKey=o,this._fileDNList=a,this.content={downloadFlag:2,second:t.second,size:t.size,url:ri(t.url,this._fileDownloadProxy,this._authKey,this._fileDNList),remoteAudioUrl:ri(t.url||"",this._fileDownloadProxy,this._authKey,this._fileDNList),uuid:t.uuid}}),[{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateAudioUrl",value:function(e){this.content.remoteAudioUrl=ri(e,this._fileDownloadProxy,this._authKey,this._fileDNList)}},{key:"sendable",value:function(){return""!==this.content.remoteAudioUrl}}]),gi={from:!0,groupID:!0,groupName:!0,to:!0},fi=a((function e(t){i(this,e),this.type=k.MSG_GRP_TIP,this.content={},this._initContent(t)}),[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"remarkInfo":case"memberExtraInfo":case"onlineMemberInfo":break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case"operatorInfo":t.content.operatorInfo={},t._initOperatorInfo(e[n]);break;case"memberInfoList":case"msgMemberInfo":t._updateMemberList(e[n]);break;case"memberNum":t.content[n]=e[n],t.content.memberCount=e[n];break;case"newGroupProfile":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}})),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n];gi[i]&&(this.content.groupProfile[i]=e[i])}}},{key:"_initOperatorInfo",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n];this.content.operatorInfo[i]=e[i]}}},{key:"_updateMemberList",value:function(e){je(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach((function(t){e.forEach((function(e){t.userID===e.userID&&Object.assign(t,e)}))}))}},{key:"_initNewGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n];this.content.newGroupProfile[i]="muteAllMembers"!==i?e[i]:1===e[i]}}}]),mi={from:!0,groupID:!0,groupName:!0,to:!0,groupType:!0},_i=a((function e(t){i(this,e),this.type=k.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(t)}),[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"memberInfoList":break;case"remarkInfo":t.content.handleMessage=e[n];break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}}))}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n];mi[i]&&("groupName"===i?this.content.groupProfile.name=e[i]:this.content.groupProfile[i]=e[i])}}}]),vi=a((function e(t,n,o,a){i(this,e),this.type=k.MSG_FILE,this._percent=0;var s=this._getFileInfo(t);this.content={downloadFlag:2,fileUrl:ri(t.url||t.fileUrl,n,o,a)||"",uuid:t.uuid,fileName:s.name||"",fileSize:s.size||0}}),[{key:"_getFileInfo",value:function(e){var t,n;return dt(e.fileName)||dt(e.fileSize)?(t=e.file.files[0],J&&(t.path&&-1!==t.path.indexOf(".")&&(n=t.path.slice(t.path.lastIndexOf(".")+1).toLowerCase(),t.type=n,t.name||(t.name="".concat(ot(999999),".").concat(n))),t.name||(t.type="",t.name=t.path.slice(t.path.lastIndexOf("/")+1).toLowerCase()),t.suffix&&(t.type=t.suffix),t.url||(t.url=t.path)),{size:t.size,name:t.name}):{size:e.fileSize,name:e.fileName}}},{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateFileUrl",value:function(e){this.content.fileUrl=e}},{key:"sendable",value:function(){return""!==this.content.fileUrl&&""!==this.content.fileName&&0!==this.content.fileSize}}]),yi=a((function e(t){i(this,e),this.type=k.MSG_CUSTOM,this.content={data:t.data||"",description:t.description||"",extension:t.extension||""}}),[{key:"setData",value:function(e){return this.content.data=e,this}},{key:"setDescription",value:function(e){return this.content.description=e,this}},{key:"setExtension",value:function(e){return this.content.extension=e,this}},{key:"sendable",value:function(){return 0!==this.content.data.length||0!==this.content.description.length||0!==this.content.extension.length}}]),Ii=a((function e(t,n,o,a){i(this,e),this.type=k.MSG_VIDEO,this._percent=0,this._fileDownloadProxy=n,this._authKey=o,this._fileDNList=a,this.content={remoteVideoUrl:ri(t.remoteVideoUrl||t.videoUrl||"",this._fileDownloadProxy,this._authKey,this._fileDNList),videoFormat:t.videoFormat,videoSecond:parseInt(t.videoSecond,10),videoSize:t.videoSize,videoUrl:ri(t.videoUrl,this._fileDownloadProxy,this._authKey,this._fileDNList),videoDownloadFlag:2,videoUUID:t.videoUUID,thumbUUID:t.thumbUUID,thumbFormat:t.thumbFormat,thumbWidth:t.thumbWidth,snapshotWidth:t.thumbWidth,thumbHeight:t.thumbHeight,snapshotHeight:t.thumbHeight,thumbSize:t.thumbSize,snapshotSize:t.thumbSize,thumbDownloadFlag:2,thumbUrl:ri(t.thumbUrl,this._fileDownloadProxy,this._authKey,this._fileDNList),snapshotUrl:ri(t.thumbUrl,this._fileDownloadProxy,this._authKey,this._fileDNList)}}),[{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateVideoUrl",value:function(e){e&&(this.content.remoteVideoUrl=ri(e,this._fileDownloadProxy,this._authKey,this._fileDNList))}},{key:"updateSnapshotInfo",value:function(e){var t=e.snapshotUrl,n=e.snapshotWidth;e=e.snapshotHeight,je(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),je(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),je(e)||(this.content.thumbHeight=this.content.snapshotHeight=Number(e))}},{key:"sendable",value:function(){return""!==this.content.remoteVideoUrl}}]),Mi=a((function e(t){i(this,e),this.type=k.MSG_LOCATION;var n=t.description,o=t.longitude;t=t.latitude,this.content={description:n,longitude:o,latitude:t}}),[{key:"sendable",value:function(){return!0}}]),Ci=a((function e(t,n,o,a){var s,r;i(this,e),this.from=t.from,this.messageSender=t.from,this.time=t.time,this.messageSequence=t.sequence,this.clientSequence=t.clientSequence||t.sequence,this.messageRandom=t.random,this.cloudCustomData=t.cloudCustomData||"",this.clientTime=t.clientTime||void 0,t.ID?(this.ID=t.ID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",t.messageBody?this.messageBody=JSON.parse(JSON.stringify(t.messageBody)):this.messageBody=[{type:t.type,payload:t.payload}],t.conversationType?t.conversationType.startsWith(k.CONV_C2C)?this.receiverUserID=t.to:t.conversationType.startsWith(k.CONV_GROUP)&&(this.receiverGroupID=t.to):t.receiverGroupID?this.receiverGroupID=t.receiverGroupID:t.receiverUserID&&(this.receiverUserID=t.receiverUserID),this.messageReceiver=t.to||t.messageReceiver):(this.nick=t.nick||"",this.avatar=t.avatar||"",this.messageBody=[],s=t.elements[0].type,r=t.elements[0].content,this._patchRichMediaPayload(s,r),this._updateRichMediaDownloadUrl(s,r,n,o,a),s===k.MSG_MERGER?this.messageBody.push({type:s,payload:new Ei(r,n,o,a).content}):this.messageBody.push({type:s,payload:r}),t.groupID&&(this.receiverGroupID=t.groupID,this.messageReceiver=t.groupID),t.to&&(this.receiverUserID=t.to,this.messageReceiver=t.to),this.ID="".concat(t.tinyID,"-").concat(t.clientTime,"-").concat(t.random))}),[{key:"_patchRichMediaPayload",value:function(e,t){e===k.MSG_IMAGE?t.imageInfoArray.forEach((function(e){!e.imageUrl&&e.url&&(e.imageUrl=e.url,e.sizeType=e.type,1===e.type?e.type=0:3===e.type&&(e.type=1))})):e===k.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===k.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===k.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}},{key:"_updateRichMediaDownloadUrl",value:function(e,t,n,i,o){(n||i)&&(e===k.MSG_IMAGE?t.imageInfoArray.forEach((function(e){e.imageUrl=ri(e.imageUrl,n,i,o),e.url=ri(e.url,n,i,o)})):e===k.MSG_VIDEO?(t.remoteVideoUrl=ri(t.remoteVideoUrl,n,i,o),t.videoUrl=ri(t.videoUrl,n,i,o),t.thumbUrl=ri(t.thumbUrl,n,i,o),t.snapshotUrl=ri(t.thumbUrl,n,i,o),t.snapshotHeight=t.thumbHeight,t.snapshotWidth=t.thumbWidth):e===k.MSG_AUDIO?(t.remoteAudioUrl=ri(t.remoteAudioUrl,n,i,o),t.url=ri(t.url,n,i,o)):e===k.MSG_FILE&&(t.fileUrl=ri(t.fileUrl,n,i,o)))}}]),Ei=a((function e(t,n,o,a){var s,r,c,u,l,d,h;i(this,e),this.type=k.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},t.downloadKey?(r=t.downloadKey,c=t.pbDownloadKey,u=t.title,l=t.abstractList,d=t.compatibleText,s=t.version,this.content.downloadKey=r,this.content.pbDownloadKey=c,this.content.title=u,this.content.abstractList=l,this.content.compatibleText=d,this.content.version=s||0):je(t.messageList)?1===t.layersOverLimit&&(this.content.layersOverLimit=!0):(r=t.messageList,c=t.title,u=t.abstractList,l=t.compatibleText,d=t.version,h=[],r.forEach((function(e){je(e)||(e=new Ci(e,n,o,a),h.push(e))})),this.content.messageList=h,this.content.title=c,this.content.abstractList=u,this.content.compatibleText=l,this.content.version=d||0)}),[{key:"sendable",value:function(){return!je(this.content.messageList)||!je(this.content.downloadKey)}}]),Ti={1:k.MSG_PRIORITY_HIGH,2:k.MSG_PRIORITY_NORMAL,3:k.MSG_PRIORITY_LOW,4:k.MSG_PRIORITY_LOWEST},ki=a((function e(t){i(this,e),this.ID="",this.conversationID=t.conversationID||null,this.conversationType=t.conversationType||k.CONV_C2C,this.conversationSubType=t.conversationSubType,this.time=t.time||Math.ceil(Date.now()/1e3),this.sequence=t.sequence||0,this.clientSequence=t.clientSequence||t.sequence||0,this.random=t.random||0===t.random?t.random:ot(),this.priority=this._computePriority(t.priority),this.nick=t.nick||"",this.avatar=t.avatar||"",this.isPeerRead=!1,this.nameCard="",this.hasRiskContent=$t(t.checkResult),this._elements=[],this.isPlaceMessage=t.isPlaceMessage||0,this.isRevoked=2===t.isPlaceMessage||8===t.msgFlagBits,this.from=t.from||null,this.to=t.to||null,this.flow="",this.isSystemMessage=t.isSystemMessage||!1,this.protocol=t.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=t.status||Dn,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=t.cloudCustomData||"",this.isDeleted=!1,this.isModified=!!t.messageVersion,this._isExcludedFromUnreadCount=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromUnreadCount),this._isExcludedFromLastMessage=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromLastMessage),this.clientTime=t.clientTime||Te()||0,this.senderTinyID=t.senderTinyID||t.tinyID||"",this.readReceiptInfo=t.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0,timestamp:0},this.needReadReceipt=!0===t.needReadReceipt||1===t.needReadReceipt,this.version=t.messageVersion||0,this.isBroadcastMessage=t.isBroadcastMessage||!1,this._receiverList=t.receiverList||void 0,this.isSupportExtension=!0===t.isSupportExtension||1===t.isSupportExtension,this._cmConfigID=t.customModerationConfigurationID,this.revoker=t.revokerInfo&&t.revokerInfo.revoker||"",this.revokerInfo=t.revokerInfo||{userID:"",nick:"",avatar:""},this.revokeReason=t.revokeReason||"",this.reInitialize(t.currentUser),this.extractGroupInfo(t.groupProfile||null),this.handleGroupAtInfo(t),this.initC2CReadReceiptInfo(t)}),[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(e){null!==e&&(lt(e.nick)&&(this.nick=e.nick),lt(e.avatar)&&(this.avatar=e.avatar),$e(e=e.messageFromAccountExtraInformation))&&lt(e.nameCard)&&(this.nameCard=e.nameCard)}},{key:"handleGroupAtInfo",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach((function(e){e!==k.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:e}),t.atUserList.push(e)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(k.MSG_AT_ALL))})),We(e.groupAtInfo)&&e.groupAtInfo.forEach((function(e){0===e.groupAtAllFlag?t.atUserList.push(e.groupAtUserID):1===e.groupAtAllFlag&&t.atUserList.push(k.MSG_AT_ALL)}))}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(e){e&&(this.status=this.from?Dn:Sn,!this.from)&&(this.from=e),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:"isSendable",value:function(){return 0!==this._elements.length&&(!0===this._relayFlag||"function"==typeof this._elements[0].sendable&&this._elements[0].sendable())}},{key:"_initTo",value:function(e){this.conversationType===k.CONV_GROUP&&(this.to=e.groupID)}},{key:"_initSequence",value:function(e){var t,n,i;0===this.clientSequence&&e&&(this.clientSequence=!!e&&(void 0===_t[e]&&(t="3".concat((i=new Date).getHours()).slice(-2),n="0".concat(i.getMinutes()).slice(-2),i="0".concat(i.getSeconds()).slice(-2),_t[e]=parseInt([t,n,i,"0001"].join("")),i=n=t=null,Re.l("autoIncrementIndex start index:".concat(_t[e]))),_t[e]++)),0===this.sequence&&this.conversationType===k.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===k.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(e){""!==e&&(e===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(e){var t=this.to,n=this.conversationType;n!==k.CONV_SYSTEM?(e=n===k.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID=e?"".concat(n).concat(e):null):this.conversationID=k.CONV_SYSTEM}},{key:"isElement",value:function(e){return e instanceof oi||e instanceof di||e instanceof hi||e instanceof pi||e instanceof vi||e instanceof Ii||e instanceof fi||e instanceof _i||e instanceof yi||e instanceof Mi||e instanceof Ei}},{key:"setElement",value:function(e,t,n,i){var o=this;if(this.isElement(e))this._elements=[e];else{var a=function(e){if(e.type&&e.content)switch(e.type){case k.MSG_TEXT:o.setTextElement(e.content);break;case k.MSG_IMAGE:o.setImageElement(e.content,t,n,i);break;case k.MSG_AUDIO:o.setAudioElement(e.content,t,n,i);break;case k.MSG_FILE:o.setFileElement(e.content,t,n,i);break;case k.MSG_VIDEO:o.setVideoElement(e.content,t,n,i);break;case k.MSG_CUSTOM:o.setCustomElement(e.content);break;case k.MSG_LOCATION:o.setLocationElement(e.content);break;case k.MSG_GRP_TIP:o.setGroupTipElement(e.content);break;case k.MSG_GRP_SYS_NOTICE:o.setGroupSystemNoticeElement(e.content);break;case k.MSG_FACE:o.setFaceElement(e.content);break;case k.MSG_MERGER:o.setMergerElement(e.content,t,n,i)}};if(We(e))for(var s=0;s<e.length;s++)a(e[s]);else a(e)}this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(e){e="string"==typeof e?e:e.text,e=new oi({text:e}),this._elements.push(e)}},{key:"setImageElement",value:function(e,t,n,i){e=new di(e,t,n,i),this._elements.push(e)}},{key:"setAudioElement",value:function(e,t,n,i){e=new pi(e,t,n,i),this._elements.push(e)}},{key:"setFileElement",value:function(e,t,n,i){e=new vi(e,t,n,i),this._elements.push(e)}},{key:"setVideoElement",value:function(e,t,n,i){e=new Ii(e,t,n,i),this._elements.push(e)}},{key:"setLocationElement",value:function(e){e=new Mi(e),this._elements.push(e)}},{key:"setCustomElement",value:function(e){e=new yi(e),this._elements.push(e)}},{key:"setGroupTipElement",value:function(e){var t,n={},i=e.operationType;je(e.memberInfoList)?e.operatorInfo&&(n=e.operatorInfo):i!==k.GRP_TIP_MBR_JOIN&&i!==k.GRP_TIP_MBR_KICKED_OUT&&i!==k.GRP_TIP_MBR_SET_ADMIN&&i!==k.GRP_TIP_MBR_CANCELED_ADMIN||(n=e.memberInfoList[0]),je(e.memberExtraInfo)||(t=e.memberExtraInfo.reason,e.msgMemberInfo.forEach((function(e){e.reason=t}))),i=n.nick,n=n.avatar,lt(i)&&(this.nick=i),lt(n)&&(this.avatar=n),i=new fi(e),this._elements.push(i)}},{key:"setGroupSystemNoticeElement",value:function(e){e=new _i(e),this._elements.push(e)}},{key:"setFaceElement",value:function(e){e=new hi(e),this._elements.push(e)}},{key:"setMergerElement",value:function(e,t,n,i){e=new Ei(e,t,n,i),this._elements.push(e)}},{key:"setIsRead",value:function(e){this.isRead=e}},{key:"setRelayFlag",value:function(e){this._relayFlag=e}},{key:"_computePriority",value:function(e){if(!dt(e)){if(lt(e)&&-1!==Object.values(Ti).indexOf(e))return e;if(ze(e)&&(e=""+e,-1!==Object.keys(Ti).indexOf(e)))return Ti[e]}return k.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(e){var t=e.nick;e=e.avatar,lt(t)&&(this.nick=t),lt(e)&&(this.avatar=e)}},{key:"setNameCard",value:function(e){lt(e)&&(this.nameCard=e)}},{key:"initC2CReadReceiptInfo",value:function(e){var t=e.readReceiptSentByPeer;e=void 0===(e=e.timestamp)?0:e,this.conversationType===k.CONV_C2C&&!0===this.needReadReceipt&&(this.readReceiptInfo.isPeerRead=1===(void 0===t?void 0:t),this.readReceiptInfo.timestamp=e)}}]),Si=["sound","FCMChannelID"],Di=["ignoreIOSBadge","disableVoipPush","enableIOSBackgroundNotification"],bi={HonorImportance:{range:["LOW","NORMAL"],defaultValue:void 0},MeizuNotifyType:{range:[0,1],defaultValue:void 0}},Ai={enableIOSBackgroundNotification:{range:[!0,!1],defaultValue:!1},interruptionLevel:{range:["passive","active","time-sensitive","critical"],defaultValue:"active"}};function Li(e,t){for(var n in t){var i,o;Object.prototype.hasOwnProperty.call(t,n)&&(i=(o=t[n]).range,o=o.defaultValue,e[n]=i.includes(e[n])?e[n]:o)}return e}function Ri(e){if($e(e))return{pushFlag:!0===e.disablePush?1:0,title:e.title||"",desc:e.description||"",ext:e.extension||"",apnsInfo:(n=(t=e).apnsInfo,i=void 0!==(i=t.ignoreIOSBadge)&&i,t=t.disableVoipPush,o=(n=Li(void 0===n?{}:n,Ai)).ignoreIOSBadge,a=n.disableVoipPush,s=n.enableIOSBackgroundNotification,n=m(n,Di),o=!0===o||!0===i?1:0,i=void 0,dt(t)||(i=!1===t?1:0),dt(a)||(i=!1===a?1:0),f(f({},n),{},{badgeMode:o,isVoipPush:i,contentAvailable:s?1:0})),androidInfo:(a=void 0===(a=(t=e).androidInfo)?{}:a,t=t.androidOPPOChannelID,t=a.OPPOChannelID||(void 0===t?"":t),a=Li(a,bi),n=void 0===(n=a.sound)?"":n,o=void 0===(o=a.FCMChannelID)?"":o,f(f({},m(a,Si)),{},{Sound:-1===(n=(a=n).lastIndexOf("."))?a:a.slice(0,n),OPPOChannelID:t,GoogleChannelID:o}))};var t,n,i,o,a,s}l(Pi,Nn);var wi=a(Pi,[{key:"onNewMessage",value:function(e){var t=e.dataList,n=e.isInstantMessage,i=e.C2CRemainingUnreadList,o=e.C2CPairUnreadList,a=(e=e.isSyncingEnded,i=(n||Re.l("".concat(this._n,".onNewMessage C2CPairUnreadList:"),o,"C2CRemainingUnreadList:",i),t=this._assembly({dataList:t,C2CRemainingUnreadList:i,C2CPairUnreadList:o,isInstantMessage:n})).conversationOptionsList,o=t.messageList,t=t.isUnreadC2CMessage,0<(a=yt(o)).length&&this.emitOEvt(T.MESSAGE_MODIFIED,a),this.get(11).onNewMessage({conversationOptionsList:i,isInstantMessage:n,isUnreadC2CMessage:t,isSyncingEnded:e}),Mt(o));n&&0<a.length&&this.emitOEvt(T.MESSAGE_RECEIVED,a),o.length=0}},{key:"_assembly",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,i=e.C2CPairUnreadList,o=e.isInstantMessage,a=null,s=[],r=[],c={},u=this.get(26),l=!1,d=this.get(11),h=this.get(4),p=(e=this.get(17),this.getFileDownloadProxy()),g=this.getDownloadFileAuthKey(),f=e.getFileDNList(),m=0,_=t.length;m<_;m++)if(this._isC2CNotice(t[m]))this._noticeFromUnreadDBList.push(t[m].eventArray[0].c2CNotifyMsgArray[0]);else{var v=t[m],y=(v.currentUser=this.getMyUserID(),v.conversationType=k.CONV_C2C,v.isSystemMessage=!!v.isSystemMessage,(dt(v.nick)||dt(v.avatar))&&(l=!0),(a=new ki(v)).setElement(v.elements,p,g,f),a.setNickAndAvatar({nick:v.nick,avatar:v.avatar}),a.conversationID);if(o){if(this._msgFromUnreadDBMap.get(a.ID))continue;var I,M,C=!1,E=(a.from!==this.getMyUserID()?(M=d.getLatestMessageSentByPeer(y))&&(I=M.nick,M=M.avatar,l?a.setNickAndAvatar({nick:I,avatar:M}):I===a.nick&&M===a.avatar||(C=!0)):(I=d.getLatestMessageSentByMe(y))&&(M=I.nick,E=I.avatar,M===a.nick&&E===a.avatar||(d.modifyMessageSentByMe({conversationID:y,latestNick:a.nick,latestAvatar:a.avatar}),h.mockOnNickAvatarModified(a.nick,a.avatar))),1===t[m].isModified);if(d.isMessageSentByCurrentInstance(a)?a.isModified=E:E=!1,0===v.msgLifeTime)a._onlineOnlyFlag=!0,d.isMessageSentByCurrentInstance(a)||r.push(a);else{if(!d.pushIntoMessageList(r,a,E))continue;C&&(d.modifyMessageSentByPeer({conversationID:y,latestNick:a.nick,latestAvatar:a.avatar}),d.updateUserProfileSpecifiedKey({conversationID:y,nick:a.nick,avatar:a.avatar}))}o&&0<a.clientTime&&u.addMessageDelay(a.clientTime)}else this._msgFromUnreadDBMap.set(a.ID,a);if(0!==v.msgLifeTime){if(!1===a._onlineOnlyFlag){if(ze(C=d.getLastMessageTime(y))&&a.time<C)continue;o&&(dt(c[y])?(v=0,"in"!==a.flow||a._isExcludedFromUnreadCount||(v=1),c[y]=s.push({conversationID:y,unreadCount:v,type:a.conversationType,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?"":a})-1):(v=c[y],s[v].type=a.conversationType,s[v].subType=a.conversationSubType,s[v].lastMessage=a._isExcludedFromLastMessage?"":a,"in"!==a.flow||a._isExcludedFromUnreadCount||s[v].unreadCount++))}}else a._onlineOnlyFlag=!0}this._handleNoticeFromUnreadDB();var T=!1;if(We(i)&&0<i.length)for(var S=0,D=i.length;S<D;S++)!function(e){if(i[e].from!==k.CONV_SYSTEM){T=!0;var t=s.find((function(t){return t.conversationID==="".concat(k.CONV_C2C).concat(i[e].from)}));t?t.unreadCount=i[e].unreadCount:s.push({conversationID:"".concat(k.CONV_C2C).concat(i[e].from),unreadCount:i[e].unreadCount,type:k.CONV_C2C})}}(S);if(We(n))for(var b=0,A=n.length;b<A;b++)!function(e){s.find((function(t){return t.conversationID==="".concat(k.CONV_C2C).concat(n[e].from)}))||s.push({conversationID:"".concat(k.CONV_C2C).concat(n[e].from),type:k.CONV_C2C,lastMsgTime:n[e].lastMsgTime})}(b);return{conversationOptionsList:s,messageList:r,isUnreadC2CMessage:T}}},{key:"getMessageListFromUnreadDB",value:function(){return y(this._msgFromUnreadDBMap.values())}},{key:"_isC2CNotice",value:function(e){return!(!We(e=e.eventArray)||10!==e[0].event)}},{key:"_handleNoticeFromUnreadDB",value:function(){var e,t=this._noticeFromUnreadDBList.length;0!==t&&(Re.l("".concat(this._n,"._handleNoticeFromUnreadDB count:").concat(t)),e=[],this._noticeFromUnreadDBList.forEach((function(t){t.hasOwnProperty("c2cMessageRevokedNotify")&&e.push(t)})),this.onMsgRevoked({dataList:e}),this._noticeFromUnreadDBList.length=0,e.length=0)}},{key:"onMsgRevoked",value:function(e,t){var n,i=this,o=this.get(11),a=[];e.dataList.forEach((function(e){e.c2cMessageRevokedNotify&&(e=e.c2cMessageRevokedNotify.revokedInfos,dt(e)||e.forEach((function(e){var t=i.getMyUserID()===e.from?"".concat(k.CONV_C2C).concat(e.to):"".concat(k.CONV_C2C).concat(e.from);n=o.revoke(t,e.sequence,e.random);var s,r=e.revokerInfo&&e.revokerInfo.revoker,c=e.revokerInfo&&e.revokerInfo.reason||"";n?s=n:(s={conversationID:t,sequence:e.sequence},e.tinyID&&e.clientTime&&e.random&&(s.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)),e.time&&(s.time=e.time)),s&&(s.revoker=r,s.revokeReason=c,s.revokerInfo={userID:r,nick:"",avatar:""},a.push(s))})))})),0!==a.length&&(Re.l("".concat(this._n,".onMsgRevoked count:").concat(a.length," updateUnreadCount:").concat(t)),o.onMessageRevoked(a,t),o.updateRevokerInfo(a).then((function(e){i.emitOEvt(T.MESSAGE_REVOKED,e)})))}},{key:"onMsgReadReceipt",value:function(e){var t=this;e.dataList.forEach((function(e){var n;je(e.c2cMessageReadReceipt)||(n=e.c2cMessageReadReceipt.to,e.c2cMessageReadReceipt.uinPairReadArray.forEach((function(e){e=e.peerReadTime;var i=(Re.l("".concat(t._n,".onMsgReadReceipt to:").concat(n," peerReadTime:").concat(e)),"".concat(k.CONV_C2C).concat(n)),o=t.get(11);o.recordPeerReadTime(i,e),o.updateMsgIsPeerReadProp(i,e)})))}))}},{key:"onMsgReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n;je(e.c2cMessageReadNotice)||(n=t.get(11),e.c2cMessageReadNotice.uinPairReadArray.forEach((function(e){var i=e.from;e=e.peerReadTime,Re.l("".concat(t._n,".onMsgReadNotice from:").concat(i," lastReadTime:").concat(e)),i="".concat(k.CONV_C2C).concat(i),n.updateIsReadAfterReadReport({conversationID:i,lastMessageTime:e}),n.updateUnreadCount(i)})))}))}},{key:"onMsgModified",value:function(e){Re.l("".concat(this._n,".onMsgModified options:"),e);var t=this.get(11);e.dataList.forEach((function(e){t.onMessageModified(f(f({},e),{},{conversationType:k.CONV_C2C}))}))}},{key:"onReadReceiptList",value:function(e){Re.l("".concat(this._n,".onReadReceiptList options:"),e),this.get(11).updateReadReceiptInfo(e.dataList)}},{key:"sendMessage",value:function(e,t){return e=this._createC2CMessagePack(e,t),this.req(e)}},{key:"_createC2CMessagePack",value:function(e,t){var n=null,i=(t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),!0===t.onlineUserOnly)&&(n?n.disablePush=!0:n={disablePush:!0}),""),o=(lt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(i=e.cloudCustomData),[]),a=($e(t)&&$e(t.messageControlInfo)&&(a=(r=t.messageControlInfo).excludedFromUnreadCount,s=r.excludedFromLastMessage,r=r.excludedFromContentModeration,!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===r)&&o.push("NoMsgCheck"),this.isOnlineMessage(e,t)?0:void 0),s=JSON.parse(JSON.stringify(e.getElements())),r=this.get(17).getFileDNList();return{P:jn.SEND_C2C_MSG,data:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:ci(e.type,s,r),cloudCustomData:i,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:a,nick:e.nick,avatar:e.avatar,offlinePushInfo:Ri(n),messageControlInfo:0!==a?o:void 0,clientTime:e.clientTime,needReadReceipt:!0===e.needReadReceipt?1:0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0,cmConfigID:e._cmConfigID,forbidCallbackControl:It(t)}}}},{key:"isOnlineMessage",value:function(e,t){return!(!t||!0!==t.onlineUserOnly)}},{key:"revokeMessage",value:function(e){return this.req({P:jn.REVOKE_C2C_MSG,data:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:"deleteMessage",value:function(e){var t=e.to;return e=e.keyList,Re.l("".concat(this._n,".deleteMessage toAccount:").concat(t," count:").concat(e.length)),this.req({P:jn.DEL_C2C_MSG,data:{fromAccount:this.getMyUserID(),to:t,keyList:e}})}},{key:"modifyRemoteMessage",value:function(e){var t=e.from,n=e.to,i=void 0===(i=e.version)?0:i,o=e.sequence,a=e.random,s=e.time,r=e.payload,c=e.type,u=e.cloudCustomData,l=void(e=e._elements);return Vt(c)&&(1<e.length&&e.splice(0,1,{type:c,content:r}),l=e),this.req({P:jn.MODIFY_C2C_MSG,data:{from:t,to:n,version:i,sequence:o,random:a,time:s,elements:l,cloudCustomData:u}})}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,i=e.lastMessageTime,o="".concat(this._n,".").concat("setMessageRead"),a=(e="convID:".concat(n," lastMessageTime:").concat(i),Re.l("".concat(o," ").concat(e)),ze(i)||this.warn("DoNotModifyLastTime"),new ii("setMessageRead"));return a.setMessage(e),this.req({P:jn.SET_C2C_MSG_READ,data:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:n.replace("C2C",""),lastMessageTime:i,receipt:1}]}}}).then((function(){a.end(),Re.l("".concat(o," ok"));var e=t.get(11);return e.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:i}),e.updateUnreadCount(n),En()})).catch((function(e){return a.setError(e).end(),Re.l("".concat(o," failed. error:"),e),kn(e)}))}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessage"),i=e.peerAccount,o=e.conversationID,a=e.count,s=e.lastMessageTime,r=(e=e.messageKey,"peerAccount:".concat(i," count:").concat(a||15," lastMessageTime:").concat(s||0," messageKey:").concat(e)),c=(Re.l("".concat(n," ").concat(r)),new ii("getRoamingMessage"));return this.req({P:jn.GET_C2C_ROAMING_MSG,data:{peerAccount:i,count:a||15,lastMessageTime:s||0,messageKey:e}}).then((function(e){var i=(e=e.data).complete,a=e.messageList,s=e.messageKey,u=(e=e.lastMessageTime,dt(a)?Re.l("".concat(n," ok. complete:").concat(i," but messageList is undefined!")):Re.l("".concat(n," ok. complete:").concat(i," count:").concat(a.length)),c.setMessage("".concat(r," complete:").concat(i," length:").concat(a.length)).end(),t.get(11)),l=((i=1===i)&&u.setCompleted(o),[]);return a=u.onRoamingMessage(a,o,!0,l),u.modifyMessageList(o),u.updateIsRead(o),u.updateRoamingMsgKeyAndTime(o,s,e),s=u.getPeerReadTime(o),Re.l("".concat(n," update isPeerRead property. convID:").concat(o," peerReadTime:").concat(s)),s?u.updateMsgIsPeerReadProp(o,s):(e=o.replace(k.CONV_C2C,""),t.getRemotePeerReadTime([e]).then((function(){u.updateMsgIsPeerReadProp(o,u.getPeerReadTime(o))}))),s="",0<a.length?s=a[0].ID:(e=u.getLocalOldestMessage(o))&&(s=e.ID),Re.l("".concat(n," nextReqID:").concat(s," storedMsgCount:").concat(a.length)),{nextReqID:s,storedMessageList:a,assembledMessageList:l,isPullingCompleted:i}})).catch((function(e){return c.setMessage(r).setError(e).end(),Re.w("".concat(n," failed. error:"),e),kn(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessagesHopping"),i=e.peerAccount,o=void 0===(o=e.time)?0:o,a=e.count,s=e.direction,r="".concat(k.CONV_C2C).concat(i),c="peerAccount:".concat(i," count:").concat(a," time:").concat(o," direction:").concat(s),u=(Re.l("".concat(n," ").concat(c)),new ii("getRoamingMessagesHopping"));return this.req({P:jn.GET_C2C_ROAMING_MSG,data:{peerAccount:i,count:a+1,lastMessageTime:o,direction:s}}).then((function(e){var i=(e=e.data).complete,o=void 0===(o=e.messageList)?[]:o,a=(e=e.lastMessageTime,"complete:".concat(i," count:").concat(o.length)),l=(Re.l("".concat(n," ok. ").concat(a)),u.setMessage("".concat(c," ").concat(a)).end(),1!==i&&(1===s?o.pop():o.shift()),t.get(11));return a=l.onRoamingMessage(o,r,!1),t._modifyMessageList(r,a),o=t._computeResult({complete:i,lastMessageTime:e,resultList:a}),l.storeHoppingMessageList(o.messageList),i=l.getPeerReadTime(r),Re.l("".concat(n," update isPeerRead property. convID:").concat(r," peerReadTime:").concat(i)),i?l.updateMsgIsPeerReadProp(r,i):(e=r.replace(k.CONV_C2C,""),t.getRemotePeerReadTime([e]).then((function(){l.updateMsgIsPeerReadProp(r,l.getPeerReadTime(r))}))),En(o)})).catch((function(e){return u.setMessage(c).setError(e).end(),Re.w("".concat(n," failed. error:"),e),kn(e)}))}},{key:"_computeResult",value:function(e){var t=void 0===(t=e.complete)?0:t,n=e.lastMessageTime;return e={messageList:y(void 0===(e=e.resultList)?[]:e),isCompleted:!1,nextMessageTime:""},1===t?e.isCompleted=!0:e.nextMessageTime=n,e}},{key:"_modifyMessageList",value:function(e,t){if(e=this.get(11).getLocalConversation(e))for(var n=e.userProfile.nick,i=e.userProfile.avatar,o=(e=this.get(4).getNickAndAvatarByUserID(this.getMyUserID())).nick,a=e.avatar,s=t.length-1;0<=s;s--){var r=t[s];"in"===r.flow&&(r.nick!==n&&r.setNickAndAvatar({nick:n}),r.avatar!==i)&&r.setNickAndAvatar({avatar:i}),"out"===r.flow&&(r.nick!==o&&r.setNickAndAvatar({nick:o}),r.avatar!==a)&&r.setNickAndAvatar({avatar:a})}}},{key:"getRemotePeerReadTime",value:function(e){var t,n=this,i="".concat(this._n,".").concat("getRemotePeerReadTime");return je(e)?Promise.resolve():(t=new ii("getRemotePeerReadTime"),Re.l("".concat(i," userIDList:").concat(e)),this.req({P:jn.GET_C2C_PEER_READ_TIME,data:{userIDList:e}}).then((function(o){var a=o.data.peerReadTimeList;Re.l("".concat(i," ok. peerReadTimeList:").concat(a));for(var s="",r=n.get(11),c=0;c<e.length;c++)s+="".concat(e[c],"-").concat(a[c]," "),0<a[c]&&r.recordPeerReadTime("".concat(k.CONV_C2C).concat(e[c]),a[c]);t.setMessage(s).end()})).catch((function(e){t.setError(e).end(),Re.w("".concat(i," failed. error:"),e)})))}},{key:"sendReadReceipt",value:function(e){var t,n=e[0].conversationID.replace(k.CONV_C2C,""),i=new ii("sendReadReceipt"),o=(i.setMessage("peerAccount:".concat(n)),this.getMyUserID());return 0===(e=e.filter((function(e){return e.from!==o&&!0===e.needReadReceipt})).map((function(e){return{fromAccount:e.from,toAccount:e.to,sequence:e.sequence,random:e.random,time:e.time,clientTime:e.clientTime}}))).length?kn({code:Bn.READ_RECEIPT_MSG_LIST_EMPTY}):(t="".concat(this._n,".").concat("sendReadReceipt"),Re.l("".concat(t,". peerAccount:").concat(n," length:").concat(e.length)),this.req({P:jn.SEND_C2C_READ_RECEIPT,data:{peerAccount:n,messageInfoList:e}}).then((function(e){return i.end(),Re.l("".concat(t," ok")),En()})).catch((function(e){return i.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)})))}},{key:"getReadReceiptList",value:function(e){var t=e[0].conversationID.replace(k.CONV_C2C,"");return Re.l("".concat(this._n,".getReadReceiptList peerAccount:").concat(t," msgCount:").concat(e.length)),Tn({messageList:e})}},{key:"getMessageExtensions",value:function(e,t){return Re.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.req({P:jn.GET_C2C_MSG_EXT,data:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return Re.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),this.req({P:jn.MODIFY_C2C_MSG_EXT,data:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),extensionList:t,operateType:n}})}},{key:"getMessageKey",value:function(e){var t=e.clientSequence,n=e.random;return e=e.time,"".concat(t,"_").concat(n,"_").concat(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._msgFromUnreadDBMap.clear(),this._noticeFromUnreadDBList.length=0}}]),Oi={A2KEY_AND_TINYID_UPDATED:"_inner".concat(1),CLOUD_CONFIG:"_inner".concat(2),PROFILE_UPDATED:"_inner".concat(3),CONV_SYNC_COMPLETED:"_inner".concat(4),C2C_UNREAD_HANDLE_COMPLETED:"_inner".concat(5)},Ni=a((function e(t){i(this,e),this._convM=t,this._map=new Map,this._n="MsgListHandler",this._latestMsgSentByPeerMap=new Map,this._latestMsgSentByMeMap=new Map,this._hoppingMsgMap=new Map,this.TOPIC_MSG_LIMIT=1e3,this._convM.getIEmitInst().on(Oi.CLOUD_CONFIG,this._onCloudConfig,this)}),[{key:"_onCloudConfig",value:function(){var e=this._convM.getCloudConfig("topic_msg_limit");dt(e)||(this.TOPIC_MSG_LIMIT=Number(e)),Re.l("".concat(this._n,"._onCloudConfig topicMsgLimit:").concat(this.TOPIC_MSG_LIMIT))}},{key:"onCheckTimer",value:function(e){if(e%20==0&&0<this._map.size){var t,n=s(this._map);try{for(n.s();!(t=n.n()).done;){var i=v(t.value,2),o=i[0],a=i[1];o.includes(Be)&&a.size>=this.TOPIC_MSG_LIMIT&&this._convM.clearMemMsg(o,!0)}}catch(r){n.e(r)}finally{n.f()}}}},{key:"pushIn",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=e.conversationID,i=!0,o=(this._map.has(n)||this._map.set(n,new Map),this._getUniqueIDOfMsg(e));if(this._map.get(n).has(o)){var a=this._map.get(n).get(o);if(!t||!0===a.isModified)return!1}return this._map.get(n).set(o,e),this._setLatestMsgSentByPeer(n,e),this._setLatestMsgSentByMe(n,e),i}},{key:"unshift",value:function(e,t){var n;if(We(e)?0<e.length&&(n=e[0].conversationID,this._unshiftMultipleMsgs(e,t)):(n=e.conversationID,this._unshiftSingleMsg(e,t)),n){var i=Array.from(this._map.get(n).values());if(0!==(e=i.length)){for(var o=e-1;0<=o;o--)if("out"===i[o].flow){this._setLatestMsgSentByMe(n,i[o]);break}if(n.startsWith(k.CONV_C2C))for(var a=e-1;0<=a;a--)if("in"===i[a].flow){this._setLatestMsgSentByPeer(n,i[a]);break}}}}},{key:"_unshiftSingleMsg",value:function(e,t){var n,i,o=e.conversationID,a=this._getUniqueIDOfMsg(e);this._map.has(o)?(n=this._map.get(o),i=Array.from(n),n.has(a)||(i.unshift([a,e]),this._map.set(o,new Map(i)),t.push(e))):(this._map.set(o,new Map),this._map.get(o).set(a,e),t.push(e))}},{key:"_unshiftMultipleMsgs",value:function(e,t){for(var n=e.length,i=[],o=e[0].conversationID,a=this._map.get(o),s=this._map.has(o)?Array.from(a):[],r=0;r<n;r++){var c=this._getUniqueIDOfMsg(e[r]);a&&a.has(c)||(i.push([c,e[r]]),t.push(e[r]))}this._map.set(o,new Map(i.concat(s)))}},{key:"remove",value:function(e){var t=e.conversationID;e=this._getUniqueIDOfMsg(e),this._map.has(t)&&this._map.get(t).delete(e)}},{key:"revoke",value:function(e,t,n){var i;return this._map.has(e)?(i=this._map.get(e),this._updateMsgIsRevoked(i,t,n)):this._hoppingMsgMap.has(e)?(i=this._hoppingMsgMap.get(e),this._updateMsgIsRevoked(i,t,n)):null}},{key:"_updateMsgIsRevoked",value:function(e,t,n){var i,o=s(e);try{for(o.s();!(i=o.n()).done;){var a=v(i.value,2)[1];if(a.sequence===t&&(dt(n)||a.random===n))return a.isRevoked||(a.isRevoked=!0),a}}catch(r){o.e(r)}finally{o.f()}}},{key:"removeByConvID",value:function(e){var t=this._map.has(e);Re.l("".concat(this._n,".removeByConvID convID:").concat(e," has:").concat(t)),t&&(this._map.delete(e),this._latestMsgSentByPeerMap.delete(e),this._latestMsgSentByMeMap.delete(e))}},{key:"findMessage",value:function(e){return this._findMsg(e,this._map)||this._findMsg(e,this._hoppingMsgMap)}},{key:"_findMsg",value:function(e,t){var n,i=null,o=s(t);try{for(o.s();!(n=o.n()).done;)for(var a=y(v(n.value,2)[1].values()),r=a.length,c=0;c<r;c++)if(a[c].ID===e){i=a[c];break}}catch(u){o.e(u)}finally{o.f()}return i}},{key:"updateMsgIsPeerReadProp",value:function(e,t){var n,i=[];return this._map.has(e)?(n=this._map.get(e),i=this._updateMsgIsPeerReadProp(n,t)):this._hoppingMsgMap.has(e)&&(n=this._hoppingMsgMap.get(e),i=this._updateMsgIsPeerReadProp(n,t)),Re.l("".concat(this._n,".updateMsgIsPeerReadProp convID:").concat(e," peerReadTime:").concat(t," count:").concat(i.length)),i}},{key:"_updateMsgIsPeerReadProp",value:function(e,t){var n,i=[],o=s(e);try{for(o.s();!(n=o.n()).done;){var a=v(n.value,2)[1];a.time<=t&&!a.isPeerRead&&"out"===a.flow&&(a.isPeerRead=!0,i.push(a))}}catch(r){o.e(r)}finally{o.f()}return i}},{key:"updateMsgIsModifiedProp",value:function(e){var t=e.conversationID;this._map.has(t)&&(e=this._getUniqueIDOfMsg(e),t=this._map.get(t).get(e))&&(t.isModified=!0)}},{key:"hasLocalMsgList",value:function(e){return this._map.has(e)}},{key:"getLocalMsgList",value:function(e){return this.hasLocalMsgList(e)?y(this._map.get(e).values()):[]}},{key:"getLocalMaxSeq",value:function(e){return this.hasLocalMsgList(e)?(e=y(this._map.get(e).values()).map((function(e){return e.sequence})),Math.max.apply(Math,y(e))):0}},{key:"getLocalMaxTime",value:function(e){return this.hasLocalMsgList(e)?(e=y(this._map.get(e).values()).map((function(e){return e.time})),Math.max.apply(Math,y(e))):0}},{key:"hasLocalMsg",value:function(e,t){for(var n=!1,i=this.getLocalMsgList(e),o=i.length,a=0;a<o;a++)i[a].ID===t&&(n=!0);return n}},{key:"getLocalMsg",value:function(e,t){for(var n=null,i=this.getLocalMsgList(e),o=i.length,a=0;a<o;a++)if(i[a].ID===t){n=i[a];break}return n}},{key:"getLocalLastMsg",value:function(e){for(var t=this.getLocalMsgList(e),n=void 0,i=t.length-1;0<=i;i--)if(t[i].status===Dn){n=t[i];break}return n}},{key:"getLocalSecondLastMsg",value:function(e){return(e=this.getLocalMsgList(e))[e.length-2]}},{key:"getLocalOldestMsg",value:function(e){return this.getLocalMsgList(e)[0]}},{key:"_setLatestMsgSentByPeer",value:function(e,t){e.startsWith(k.CONV_C2C)&&"in"===t.flow&&this._latestMsgSentByPeerMap.set(e,t)}},{key:"_setLatestMsgSentByMe",value:function(e,t){"out"===t.flow&&this._latestMsgSentByMeMap.set(e,t)}},{key:"getLatestMsgSentByPeer",value:function(e){return this._latestMsgSentByPeerMap.get(e)}},{key:"getLatestMsgSentByMe",value:function(e){return this._latestMsgSentByMeMap.get(e)}},{key:"modifyMsgSentByPeer",value:function(e){var t=e.conversationID,n=e.latestNick,i=e.latestAvatar;if(!je(e=this._map.get(t))){var o=Array.from(e.values());if(0!==(e=o.length)){for(var a=null,s=0,r=!1,c=e-1;0<=c;c--)"in"===o[c].flow&&((a=o[c]).nick!==n&&(a.setNickAndAvatar({nick:n}),r=!0),a.avatar!==i&&(a.setNickAndAvatar({avatar:i}),r=!0),r)&&(s+=1);Re.l("".concat(this._n,".modifyMsgSentByPeer convID:").concat(t," count:").concat(s))}}}},{key:"modifyMsgSentByMe",value:function(e){var t=e.conversationID,n=e.latestNick,i=e.latestAvatar;if(!je(e=this._map.get(t))){var o=Array.from(e.values());if(0!==(e=o.length)){for(var a=null,s=0,r=!1,c=e-1;0<=c;c--)"out"===o[c].flow&&((a=o[c]).nick!==n&&(a.setNickAndAvatar({nick:n}),r=!0),a.avatar!==i&&(a.setNickAndAvatar({avatar:i}),r=!0),r)&&(s+=1);Re.l("".concat(this._n,".modifyMsgSentByMe convID:").concat(t," count:").concat(s))}}}},{key:"getTopicConvIDList",value:function(e){return y(this._map.keys()).filter((function(t){return t.startsWith("".concat(k.CONV_GROUP).concat(e))}))}},{key:"onMsgModified",value:function(e,t){var n,i,o,a;return(this._map.has(e)||this._hoppingMsgMap.has(e))&&(n="".concat(this._n,".onMsgModified"),o=this._getUniqueIDOfMsg(t),a=!!(i=this._getTargetMsg(e,o)),Re.l("".concat(n," convID:").concat(e," uniqueID:").concat(o," has:").concat(a)),a)?(e=t.messageVersion,o=t.elements,a=t.cloudCustomData,t=t.checkResult,Re.l("".concat(n," localVersion:").concat(i.version," remoteVersion:").concat(e)),i.version<e?(i.version=e,i._elements=JSON.parse(JSON.stringify(o)),i.payload=i._elements[0].content,i.type=i._elements[0].type,i.cloudCustomData=a,i.isModified=!0,i.hasRiskContent=$t(t),{isUpdated:!0,message:i}):{isUpdated:!1,message:i}):{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMsg",value:function(e){var t=e.from,n=e.to,i=e.random,o=e.sequence;return e=e.time,"".concat(t,"-").concat(n,"-").concat(i,"-").concat(o,"-").concat(e)}},{key:"_getTargetMsg",value:function(e,t){if(this._map.has(e))return this._map.get(e).get(t);var n=void 0;if(this._hoppingMsgMap.has(e))for(var i=y(this._hoppingMsgMap.get(e).values()),o=0;o<i.length;o++)if(this._getUniqueIDOfMsg(i[o])===t){n=i[o];break}return n}},{key:"storeHoppingMsgList",value:function(e){if(0!==e.length){var t=e[0].conversationID,n=e.length;this._hoppingMsgMap.has(t)||this._hoppingMsgMap.set(t,new Map);for(var i=this._hoppingMsgMap.get(t),o=0;o<n;o++){var a=e[o];i.has(a.ID)||i.set(a.ID,a)}}}},{key:"getHoppingMsg",value:function(e,t){if(this._hoppingMsgMap.has(e))return this._hoppingMsgMap.get(e).get(t)}},{key:"reset",value:function(){this._map.clear(),this._latestMsgSentByPeerMap.clear(),this._latestMsgSentByMeMap.clear(),this._hoppingMsgMap.clear()}}]);function Pi(e){return i(this,Pi),(e=n(this,Pi,[e]))._n="C2CModule",e._msgFromUnreadDBMap=new Map,e._noticeFromUnreadDBList=[],e}function Ui(e){this.mixin(e)}function Gi(e,t,n){return dt(e)?{lastTime:0,lastSequence:0,fromAccount:"",messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:n&&e.ID||e instanceof ki?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",messageForShow:Bt(e.type,e.payload,t),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||"",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||"",nameCard:e.nameCard||"",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:f(f({},e),{},{messageForShow:Bt(e.type,e.payload,t)})}function xi(e,t){return je(e)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",avatar:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",payload:e.payload||null,type:e.type||"",messageForShow:Bt(e.type,e.payload,t),nick:e.nick||"",avatar:e.avatar||"",version:e.version||0,cloudCustomData:e.cloudCustomData||"",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}}function Fi(e){var t=String(e).replace(/[=]+$/,""),n="";if(t.length%4==1)return"";for(var i,o,a=0,s=0;o=t.charAt(s++);~o&&(i=a%4?64*i+o:o,a++%4)&&(n+=String.fromCharCode(255&i>>(-2*a&6))))o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);try{return decodeURIComponent(escape(n))}catch(r){return""}}Ui.mixin=function(e){(e=e.prototype||e)._isReady=!1,e.ready=function(e){if(e)return this._isReady?void(1<arguments.length&&void 0!==arguments[1]&&arguments[1]?e.call(this):setTimeout(e,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(e))},e.triggerReady=function(){var e=this;this._isReady=!0,setTimeout((function(){var t=e._readyQueue;e._readyQueue=[],t&&0<t.length&&t.forEach((function(e){e.call(this)}),e)}),1)},e.resetReady=function(){this._isReady=!1,this._readyQueue=[]},e.isReady=function(){return this._isReady}};var Bi=["jpg","jpeg","gif","png","bmp","image","webp"],Vi=["mp4","quicktime","mov"],ji=a((function e(t){var n=this;i(this,e),je(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.gender=t.gender||"",this.birthday=t.birthday||0,this.location=t.location||"",this.selfSignature=t.selfSignature||"",this.allowType=t.allowType||k.ALLOW_TYPE_ALLOW_ANY,this.language=t.language||0,this.avatar=t.avatar||"",this.messageSettings=t.messageSettings||0,this.adminForbidType=t.adminForbidType||k.FORBID_TYPE_NONE,this.level=t.level||0,this.role=t.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],je(t.profileCustomField))||t.profileCustomField.forEach((function(e){n.profileCustomField.push({key:e.key,value:e.value})}))}),[{key:"validate",value:function(e){var t,n=!0,i="";if(je(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var o=e.profileCustomField.length,a=null,s=0;s<o;s++){if(a=e.profileCustomField[s],!lt(a.key)||-1===a.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!lt(a.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if("profileCustomField"===t)continue;if(je(e[t])&&!lt(e[t])&&!ze(e[t])){i="key:"+t+", invalid value:"+e[t],n=!1;continue}switch(t){case"nick":lt(e[t])||(n=!(i="nick must be a string")),500<it(e[t])&&(i="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(it(e[t])," bytes"),n=!1);break;case"gender":st(Pe,e.gender)||(i="key:gender, invalid value:"+e.gender,n=!1);break;case"birthday":ze(e.birthday)||(n=!(i="birthday must be a number"));break;case"location":lt(e.location)||(n=!(i="location must be a string"));break;case"selfSignature":lt(e.selfSignature)||(n=!(i="selfSignature must be a string"));break;case"allowType":st(Ge,e.allowType)||(i="key:allowType, invalid value:"+e.allowType,n=!1);break;case"language":ze(e.language)||(n=!(i="language must be a number"));break;case"avatar":lt(e.avatar)||(n=!(i="avatar must be a string"));break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n=!(i="messageSettings must be 0 or 1"));break;case"adminForbidType":st(Ue,e.adminForbidType)||(i="key:adminForbidType, invalid value:"+e.adminForbidType,n=!1);break;case"level":ze(e.level)||(n=!(i="level must be a number"));break;case"role":ze(e.role)||(n=!(i="role must be a number"));break;default:i="unknown key:"+t+"  "+e[t],n=!1}}return{valid:n,tips:i}}}]),qi=a((function e(t){i(this,e),this.MAX_LENGTH=t,this.map=new Map}),[{key:"set",value:function(e){var t;this.map.size>=this.MAX_LENGTH&&(t=this.map.entries().next().value[0],this.map.delete(t)),this.map.set(e,1)}},{key:"has",value:function(e){return this.map.has(e)}},{key:"delete",value:function(e){this.has(e)&&this.map.delete(e)}},{key:"reset",value:function(){this.map.clear()}}]),Hi=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","inviteOption","_lastRevokedTime"],Ki=a((function e(t){i(this,e),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.inviteOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(t)}),[{key:"memberNum",get:function(){return this.memberCount},set:function(e){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(e){}},{key:"_initGroup",value:function(e){for(var t in e)Hi.indexOf(t)<0||("selfInfo"!==t?("memberNum"===t&&(this.memberCount=e[t]),"maxMemberNum"===t&&(this.maxMemberCount=e[t]),"isSupportTopic"!==t?this[t]=e[t]:this.isSupportTopic=1===e[t]):this.updateSelfInfo(e[t]))}},{key:"updateGroup",value:function(e){var t=this;(e.appid=void 0,e.grossTopicNextMsgSeq=void 0,e.selfInfo&&(e.selfInfo.grossTopicReadSeq=void 0),e=JSON.parse(JSON.stringify(e))).lastMsgTime&&(this.lastMessage.lastTime=e.lastMsgTime),dt(e.muteAllMembers)||("On"===e.muteAllMembers?e.muteAllMembers=!0:e.muteAllMembers=!1),e.groupCustomField&&vt(this.groupCustomField,e.groupCustomField),dt(e.memberNum)||(this.memberCount=e.memberNum),dt(e.maxMemberNum)||(this.maxMemberCount=e.maxMemberNum),dt(e.isSupportTopic)||(this.isSupportTopic=ze(e.isSupportTopic)?1===e.isSupportTopic:e.isSupportTopic),et(this,e,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),We(e.members)&&0<e.members.length&&e.members.forEach((function(e){e.userID===t.selfInfo.userID&&et(t.selfInfo,e,["sequence"])}))}},{key:"updateSelfInfo",value:function(e){e={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList},et(this.selfInfo,f({},e),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(e){this.selfInfo.nameCard=e}}]),zi=a((function e(t,n){var o=2<arguments.length&&void 0!==arguments[2]&&arguments[2];i(this,e),this.conversationID=t.conversationID||"",this.unreadCount=t.unreadCount||0,this.type=t.type||"",this.lastMessage=Gi(t.lastMessage,n,o),t.lastMsgTime&&(this.lastMessage.lastTime=t.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=t.peerReadTime||0,this.groupAtInfoList=[],this.remark=t.remark||"",this.isPinned=t.isPinned||!1,this.messageRemindType=t.messageRemindType,this.markList=t.markList||[],this.customData=t.customData||"",this.conversationGroupList=t.conversationGroupList||[],this.draftText=t.draftText||"",this._initProfile(t),this.subType=this.groupProfile?this.groupProfile.type:""}),[{key:"toAccount",get:function(){return this.conversationID.startsWith(k.CONV_C2C)?this.conversationID.replace(k.CONV_C2C,""):this.conversationID.startsWith(k.CONV_GROUP)?this.conversationID.replace(k.CONV_GROUP,""):""}},{key:"_initProfile",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"userProfile":t.userProfile=e.userProfile;break;case"groupProfile":t.groupProfile=e.groupProfile}})),dt(this.userProfile)&&this.type===k.CONV_C2C?this.userProfile=new ji({userID:e.conversationID.replace("C2C","")}):dt(this.groupProfile)&&this.type===k.CONV_GROUP&&(this.groupProfile=new Ki({groupID:e.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(e){var t=e.nextUnreadCount,n=e.isFromGetConversations;e=e.isUnreadC2CMessage,dt(t)||(Ct(this.subType)?this.unreadCount=0:n&&this.type===k.CONV_GROUP||n&&this.type===k.CONV_TOPIC||e&&this.type===k.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:"updateLastMessage",value:function(e){this.lastMessage=Gi(e)}},{key:"updateGroupAtInfoList",value:function(e){var n;this._isNeedMergeGroupAtInfo(e)||(-1!==(n=(t(n=e.groupAtType)||h(n)||C(n)||p()).slice(0)).indexOf(k.CONV_AT_ME)&&-1!==n.indexOf(k.CONV_AT_ALL)&&(n=[k.CONV_AT_ALL_AT_ME]),n={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:n,__random:e.__random,__sequence:e.__sequence},this.groupAtInfoList.push(n))}},{key:"_isNeedMergeGroupAtInfo",value:function(e){var t,n=e.groupID,i=e.sequence;return!!Et({groupID:n})&&(t=!1,this.groupAtInfoList.forEach((function(n){n.messageSequence===i&&(-1<n.atTypeArray.indexOf(k.CONV_AT_ME)&&-1<e.groupAtType.indexOf(k.CONV_AT_ALL)&&(n.atTypeArray=[k.CONV_AT_ALL_AT_ME]),-1<n.atTypeArray.indexOf(k.CONV_AT_ALL)&&-1<e.groupAtType.indexOf(k.CONV_AT_ME)&&(n.atTypeArray=[k.CONV_AT_ALL_AT_ME],n.__random=e.__random,n.__sequence=e.__sequence),t=!0)})),t)}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(e){var t=e.sequence;return e=e.time,this.type===k.CONV_C2C&&t===this.lastMessage.lastSequence&&e===this.lastMessage.lastTime||this.type===k.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}},{key:"setDraftText",value:function(e){this.draftText=e}}]),Yi=r(r(r({},k.MSG_REMIND_ACPT_AND_NOTE,0),k.MSG_REMIND_DISCARD,1),k.MSG_REMIND_ACPT_NOT_NOTE,2),$i=a((function e(t){i(this,e),this._convM=t,this._n="MsgRemindHandler"}),[{key:"onAllRcvMsgOptNotify",value:function(e){e=this._handleResult(e),this._convM.emitOEvt(T.ALL_RECEIVE_MESSAGE_OPT_UPDATED,e)}},{key:"getC2CMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".getC2CMsgRemindType");return this._convM.req({P:jn.GET_C2C_PEER_MUTE_NOTIFICATIONS,data:{toAccount:this._convM.getMyUserID(),userIDList:e}}).then((function(i){Re.l("".concat(n," ok. userIDList:").concat(e)),i=i.data.muteFlagList,t._convM.onC2CMsgRemindTypeFetched(i)})).catch((function(e){Re.e("".concat(n," failed. error:"),e)}))}},{key:"set",value:function(e){return e.groupID?this._setGroupMsgRemindType(e):We(e.userIDList)?this._setC2CMsgRemindType(e):void 0}},{key:"_setGroupMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".").concat("_setGroupMsgRemindType"),i=e.groupID,o=e.messageRemindType,a="groupID:".concat(i," messageRemindType:").concat(o),s=new ii("_setGroupMsgRemindType"),r=(s.setMessage(a),this._get(7));return r?r.modifyGroupMemberInfo({groupID:i,messageRemindType:o,userID:this._convM.getMyUserID()}).then((function(){s.end(),Re.l("".concat(n," ok. ").concat(a));var i=t.onGroupMsgRemindTypeUpdated(e);return t._convM.onTotalUnreadCountUpdate(),En(i)})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)})):kn({code:Bn.NO_MODULE})}},{key:"onGroupMsgRemindTypeUpdated",value:function(e){var t,n,i=e.groupID,o=(e=e.messageRemindType,Re.l("".concat(this._n,".onGroupMsgRemindTypeUpdated groupID:").concat(i," messageRemindType:").concat(e)),this._get(7).getLocalGroupProfile(i));return o&&(o.selfInfo.messageRemindType=e),Tt(i)?(t=Ft(n=i),(n=this._get(10).getLocalTopic(t,n))&&n.updateSelfInfo({messageRemindType:e})&&this._convM.emitOEvt(T.TOPIC_UPDATED,{groupID:t,topic:n}),{topic:n}):(this._convM.patchMsgRemindType({ID:i,isC2CConversation:!1,messageRemindType:e})&&this._emitConvUpdate(),{group:o})}},{key:"_setC2CMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".").concat("_setC2CMsgRemindType"),i=e.userIDList,o=e.messageRemindType,a=i.slice(0,30),s=(e=Yi[o]||0,"userIDList:".concat(a," messageRemindType:").concat(o)),r=new ii("_setC2CMsgRemindType");return r.setMessage(s),this._convM.req({P:jn.SET_C2C_PEER_MUTE_NOTIFICATIONS,data:{userIDList:a,muteFlag:e}}).then((function(e){r.end(),e=e.data.errorList;var i=[],c=[],u=(We(e)&&e.forEach((function(e){i.push(e.userID),c.push({userID:e.userID,code:e.errorCode})})),e=a.filter((function(e){return-1===i.indexOf(e)})),Re.l("".concat(n," ok. ").concat(s," successUserIDList:").concat(e," failureUserIDList:").concat(JSON.stringify(c))),0);return e.forEach((function(e){t._convM.patchMsgRemindType({ID:e,isC2CConversation:!0,messageRemindType:o})&&(u+=1)})),1<=u&&t._emitConvUpdate(),a.length=i.length=0,t._convM.onTotalUnreadCountUpdate(),Tn({successUserIDList:e.map((function(e){return{userID:e}})),failureUserIDList:c})})).catch((function(e){return r.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"_get",value:function(e){return this._convM.get(e)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"setAllRcvMsgOpt",value:function(e){var t="".concat(this._n,".").concat("setAllRcvMsgOpt"),n=void 0===(n=e.messageRemindType)?k.MSG_REMIND_ACPT_NOT_NOTE:n,i=void 0===(i=e.isRepeated)||i,o=void 0===(o=(a=this._calcStartAndEndTime(e)).startTime)?0:o,a=void 0===(a=a.endTime)?0:a,s=(e=JSON.stringify(e),new ii("setAllRcvMsgOpt"));return s.setMessage(e),Re.l("".concat(t," options:").concat(e)),this._convM.req({P:jn.SET_ALL_RECEIVE_MSG_OPT,data:{messageRemindType:Yi[n],startTime:o,endTime:a,isRepeated:i?1:0}}).then((function(e){return s.end(),Re.l("".concat(t," ok.")),En(e)})).catch((function(e){return s.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))}},{key:"_calcStartAndEndTime",value:function(e){var t=void 0===(t=e.startHour)?0:t,n=void 0===(n=e.startMinute)?0:n,i=void 0===(i=e.startSecond)?0:i,o=void 0===(o=e.duration)?0:o,a=(e=void 0===(e=e.isRepeated)||e,(r=new Date).getFullYear()),s=r.getMonth(),r=r.getDate();return{startTime:a=Math.round(new Date(a,s,r,t,n,i).getTime()/1e3),endTime:e&&86400<=o?a+86400:a+o}}},{key:"getAllRcvMsgOpt",value:function(){var e=this,t="".concat(this._n,".").concat("getAllRcvMsgOpt"),n=new ii("getAllRcvMsgOpt");return this._convM.req({P:jn.GET_ALL_RECEIVE_MSG_OPT,data:{toAccount:this._convM.getMyUserID()}}).then((function(i){return i=i.data,n.setMessage(JSON.stringify(i)).end(),Re.l("".concat(t," ok. data:").concat(JSON.stringify(i))),En(i=e._handleResult(i))})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))}},{key:"_handleResult",value:function(e){var t=e.messageRemindType,n=e.startTime,i=e.endTime,o=(e=e.isRepeated,k.MSG_REMIND_ACPT_AND_NOTE);return 1===t&&(o=k.MSG_REMIND_DISCARD),{messageRemindType:o=2===t?k.MSG_REMIND_ACPT_NOT_NOTE:o,startTime:n,endTime:i,isRepeated:1===e}}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),Wi=a((function e(t){i(this,e),this._convM=t,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=An}),[{key:"setConvCustomData",value:function(e){var t=this,n="".concat(this._n,".").concat("setConvCustomData"),i=e.conversationIDList,o=e.customData,a=(Re.l("".concat(n," options:"),e),new ii("setConvCustomData")),s=(a.setMessage(JSON.stringify(e)),{fromAccount:this._getMyUserID(),itemList:[]}),r=[],c=[];return i.forEach((function(e){var n;return t._hasLocalConv(e)?kt(e)||St(e)?(n={operationType:2,contactItem:void 0,customMark:o},kt(e)?n.contactItem={type:1,toAccount:e.replace(k.CONV_C2C,"")}:St(e)&&(n.contactItem={type:2,groupID:e.replace(k.CONV_GROUP,"")}),void s.itemList.push(n)):(t._onConvIDInvalid(c,e),!0):(t._onConvNotFound(c,e),!0)})),c.length===i.length?Tn({successConversationIDList:r,failureConversationIDList:c}):this._convM.req({P:jn.SET_CONV_CUSTOM_DATA,data:s}).then((function(e){var i,s,u;return a.end(),Re.l("".concat(n," ok")),We(e=e.data.resultItem)&&(u=!1,e.forEach((function(e){i=t._concatConvID(e.contactItem),0===e.resultCode?(r.push(i),(s=t._getLocalConv(i))&&s.customData!==o&&(s.customData=o,u=!0)):c.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===u)&&t._emitConvUpdate(),En({successConversationIDList:r,failureConversationIDList:c})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"markConv",value:function(e){var t,n,i,o,a,s,r,c,u,l,d=this;return this._convM.canIUse(P.CONV_MARK)?(t="".concat(this._n,".").concat("markConv"),n=e.conversationIDList,i=e.markType,o=e.enableMark,Re.l("".concat(t," options:"),e),a=new ii("markConv"),s=void a.setMessage(JSON.stringify(e)),r=void 0,e=this._getFlagBit(i),!0===o?r=[e]:s=[e],c={fromAccount:this._getMyUserID(),itemList:[]},u=[],l=[],n.forEach((function(e){var t;return d._hasLocalConv(e)?kt(e)||St(e)?(t={operationType:1,contactItem:void 0,clearMark:s,setMark:r},kt(e)?t.contactItem={type:1,toAccount:e.replace(k.CONV_C2C,"")}:St(e)&&(t.contactItem={type:2,groupID:e.replace(k.CONV_GROUP,"")}),void c.itemList.push(t)):(d._onConvIDInvalid(l,e),!0):(d._onConvNotFound(l,e),!0)})),l.length===n.length?Tn({successConversationIDList:u,failureConversationIDList:l}):this._convM.req({P:jn.MARK_CONV,data:c}).then((function(e){var n,s,r;return a.end(),Re.l("".concat(t," ok")),We(e=e.data.resultItem)&&(r=!1,e.forEach((function(e){var t;n=d._concatConvID(e.contactItem),0===e.resultCode?(u.push(n),(s=d._getLocalConv(n))&&(t=s.markList.indexOf(i),!0===o?-1===t&&(s.markList.push(i),r=!0):-1!==t&&(s.markList.splice(t,1),r=!0))):l.push({conversationID:n,code:e.resultCode,message:e.resultInfo})})),!0===r)&&d._emitConvUpdate(),En({successConversationIDList:u,failureConversationIDList:l})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._convM.noUse("markConv")}},{key:"getLocalConvGroupList",value:function(){var e=this;return Re.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===wn?this.getRemoteConvGroupList().then((function(){return En(y(e._convGroupMap.values()))})):Tn(y(this._convGroupMap.values()))}},{key:"searchConvGroupAndMark",value:function(e,t){var n=this,i="".concat(this._n,".searchConvGroupAndMark"),o=[];return e.forEach((function(e){1===t?o.push({type:1,toAccount:e}):2===t&&o.push({type:2,groupID:e})})),Re.l("".concat(i," type:").concat(t," list:"),e),this._convM.req({P:jn.SEARCH_CONV_GRP_MARK,data:{fromAccount:this._getMyUserID(),contactItem:o}}).then((function(e){var t=(e=e.data).contactItem;e=e.groupItem,Re.l("".concat(i," ok. contactItem:"),t,"groupItem:",e),n._fillConvGroupMap(e),n._handleContactItem(t),n._emitConvUpdate()})).catch((function(e){Re.w("".concat(i," failed. error:"),e)}))}},{key:"_fillConvGroupMap",value:function(e){var t=this;We(e)&&e.forEach((function(e){var n=e.convGroupID;e=e.groupName,t._convGroupMap.set(n,e)}))}},{key:"_handleContactItem",value:function(e){var t,n=this;We(e)&&e.forEach((function(e){var i=[],o=e.standardMark,a=e.customData,s=e.convGroupIDList;We(s)&&s.forEach((function(e){n._convGroupMap.has(e)&&i.push(n._convGroupMap.get(e))})),t=n._concatConvID(e),(t=n._getLocalConv(t))&&(t.markList=jt(o),t.customData=a||"",t.conversationGroupList=[].concat(i))}))}},{key:"getRemoteConvGroupList",value:function(){var e=this,t="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=Ln,this._convM.req({P:jn.GET_CONV_GRP_LIST,data:{fromAccount:this._getMyUserID(),startIndex:this._startIndex}}).then((function(n){var i=(n=n.data).completeFlag,o=n.contactItem,a=void 0===(a=n.nextStartIndex)?0:a;if(n=n.groupItem,e._startIndex=a,Re.l("".concat(t," completeFlag:").concat(i," nextStartIndex:").concat(a,", groupItem:"),n,"contactItem:",o),e._fillConvGroupMap(n),e._handleContactItem(o),0===i)return e.getRemoteConvGroupList();1===i&&(e._pagingStatus=Rn,e._emitConvUpdate(),e._emitConvGroupListUpdate())})).catch((function(n){e._pagingStatus=wn,Re.w("".concat(t," failed. error:"),n)}))}},{key:"createConvGroup",value:function(e){var t,n,i,o,a,s,r=this;return this._convM.canIUse(P.CONV_GROUP)?(t="".concat(this._n,".").concat("createConvGroup"),Re.l("".concat(t," options:"),e),(n=new ii("createConvGroup")).setMessage(JSON.stringify(e)),i=e.groupName,e=e.conversationIDList,o={fromAccount:this._getMyUserID(),itemList:[{groupName:i,contactItem:[]}]},a=[],s=[],e.forEach((function(e){return r._hasLocalConv(e)?kt(e)||St(e)?void(kt(e)?o.itemList[0].contactItem.push({type:1,toAccount:e.replace(k.CONV_C2C,"")}):St(e)&&o.itemList[0].contactItem.push({type:2,groupID:e.replace(k.CONV_GROUP,"")})):(r._onConvIDInvalid(s,e),!0):(r._onConvNotFound(s,e),!0)})),s.length===e.length?Tn({successConversationIDList:a,failureConversationIDList:s}):this._convM.req({P:jn.CREATE_CONV_GRP,data:o}).then((function(e){n.end(),Re.l("".concat(t," ok"));var o,c,u,l=(e=e.data.groupResultItem[0]).groupItem;return e=e.resultItem,$e(l)&&(r._convGroupMap.set(l.convGroupID,l.groupName),r._emitConvGroupListUpdate()),We(e)&&(u=!1,e.forEach((function(e){o=r._concatConvID(e.contactItem),0===e.resultCode?(a.push(o),(c=r._getLocalConv(o))&&-1===c.conversationGroupList.indexOf(i)&&(c.conversationGroupList.push(i),u=!0)):s.push({conversationID:o,code:e.resultCode,message:e.resultInfo})})),!0===u)&&(r._emitConvUpdate(),r._emitConvGroupListUpdate()),En({successConversationIDList:a,failureConversationIDList:s})})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._convM.noUse("createConvGroup")}},{key:"deleteConvGroup",value:function(e){var t,n,i=this;return this._convM.canIUse(P.CONV_GROUP)?(t="".concat(this._n,".").concat("deleteConvGroup"),Re.l("".concat(t," groupName:").concat(e)),(n=new ii("deleteConvGroup")).setMessage(e),this._convM.req({P:jn.DEL_CONV_GRP,data:{fromAccount:this._getMyUserID(),groupName:[e]}}).then((function(o){var a;n.end(),Re.l("".concat(t," ok")),We(o=o.data.groupItem)&&(a=!1,o.forEach((function(e){i._convGroupMap.has(e.convGroupID)&&(i._convGroupMap.delete(e.convGroupID),a=!0)})),!0===a)&&i._emitConvGroupListUpdate(),i._eraseFromConversationGroupList([e])})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._convM.noUse("deleteConvGroup")}},{key:"renameConvGroup",value:function(e){var t,n,i,o,a=this;return this._convM.canIUse(P.CONV_GROUP)?(t="".concat(this._n,".").concat("renameConvGroup"),Re.l("".concat(t," options:"),e),(n=new ii("renameConvGroup")).setMessage(JSON.stringify(e)),i=e.oldName,o=e.newName,this._convM.req({P:jn.RENAME_CONV_GRP,data:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:i,newName:o}}}).then((function(e){n.end(),Re.l("".concat(t," ok")),e=e.data.updateGroupResult.convGroupID,a._convGroupMap.set(e,o),a._emitConvGroupListUpdate(),e=a._convM.getLocalConvList();var s,r,c=!1;e.forEach((function(e){s=e.conversationGroupList,-1!==(r=s.indexOf(i))&&(s.splice(r,1,o),c=!0)})),!0===c&&a._emitConvUpdate()})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._convM.noUse("renameConvGroup")}},{key:"addConvsToGroup",value:function(e){var t,n,i,o,a,s,r,c=this;return this._convM.canIUse(P.CONV_GROUP)?(t="".concat(this._n,".").concat("addConvsToGroup"),Re.l("".concat(t," options:"),e),(n=new ii("addConvsToGroup")).setMessage(JSON.stringify(e)),i=e.conversationIDList,o=e.groupName,a={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:o,updateItem:[]}},s=[],r=[],i.forEach((function(e){return c._hasLocalConv(e)?kt(e)||St(e)?void(kt(e)?a.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:e.replace(k.CONV_C2C,"")}}):St(e)&&a.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:e.replace(k.CONV_GROUP,"")}})):(c._onConvIDInvalid(r,e),!0):(c._onConvNotFound(r,e),!0)})),r.length===i.length?Tn({successConversationIDList:s,failureConversationIDList:r}):this._convM.req({P:jn.ADD_CONV_TO_GRP,data:a}).then((function(e){var i,a,u;return n.end(),Re.l("".concat(t," ok")),We(e=e.data.updateGroupResult.contactResultItem)&&(u=!1,e.forEach((function(e){i=c._concatConvID(e.contactItem),0===e.resultCode?(a=c._getLocalConv(i))&&-1===a.conversationGroupList.indexOf(o)&&(a.conversationGroupList.push(o),s.push(i),u=!0):r.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===u)&&(c._emitConvUpdate(),c._emitConvInGroupUpdate(o)),En({successConversationIDList:s,failureConversationIDList:r})})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._convM.noUse("addConvsToGroup")}},{key:"deleteConvsFromGroup",value:function(e){var t,n,i,o,a,s,r,c=this,u="deleteConvsFromGroup";return this._convM.canIUse(P.CONV_GROUP)?(t="".concat(this._n,".").concat(u),Re.l("".concat(t," options:"),e),(n=new ii(u)).setMessage(JSON.stringify(e)),i=e.conversationIDList,o=e.groupName,a={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:o,updateItem:[]}},s=[],r=[],i.forEach((function(e){return c._hasLocalConv(e)?kt(e)||St(e)?void(kt(e)?a.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:e.replace(k.CONV_C2C,"")}}):St(e)&&a.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:e.replace(k.CONV_GROUP,"")}})):(c._onConvIDInvalid(r,e),!0):(c._onConvNotFound(r,e),!0)})),r.length===i.length?Tn({successConversationIDList:s,failureConversationIDList:r}):this._convM.req({P:jn.DEL_CONV_FROM_GRP,data:a}).then((function(e){var i,a,u;return n.end(),Re.l("".concat(t," ok")),We(e=e.data.updateGroupResult.contactResultItem)&&(u=!1,e.forEach((function(e){var t;i=c._concatConvID(e.contactItem),0===e.resultCode?(a=c._getLocalConv(i))&&-1!==(t=a.conversationGroupList.indexOf(o))&&(a.conversationGroupList.splice(t,1),s.push(i),u=!0):r.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===u)&&(c._emitConvUpdate(),c._emitConvInGroupUpdate(o)),En({successConversationIDList:s,failureConversationIDList:r})})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._convM.noUse(u)}},{key:"onConvMarkUpdated",value:function(e){var t,n,i=this;je(e)||(Re.l("".concat(this._n,".onConvMarkUpdated markItemList:"),e),n=!1,e.forEach((function(e){var o=e.recentContactItem,a=e.optType,s=e.standardMark;e=e.customMark,t=i._concatConvID(o),(t=i._getLocalConv(t))&&(1===a?n=i._diffStandardMark(t,s):2===a?n=i._diffCustomMark(t,e):3===a&&(o=i._diffStandardMark(t,s),a=i._diffCustomMark(t,e),n=o||a))})),!0===n&&this._emitConvUpdate())}},{key:"_diffStandardMark",value:function(e,t){t=jt(t);var n=!1;return!0!==function(e,t){if(e!==t){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1}return!0}(e.markList,t)&&(e.markList=t,n=!0),n}},{key:"_diffCustomMark",value:function(e,t){var n=!1;return e.customData!==t&&void 0!==t&&(e.customData=t,n=!0),n}},{key:"onConvGroupCreated",value:function(e){var t=this,n=(Re.l("".concat(this._n,".onConvGroupCreated resultList:"),e),!1),i=!1;We(e)&&(e.forEach((function(e){var o,a,s=(a=e.msgGroupItem).groupID,r=a.groupName;t._convGroupMap.get(s)!==r&&(t._convGroupMap.set(s,r),i=!0),We(a=e.msgRecentContactItem)&&a.forEach((function(e){o=t._concatConvID(e),(o=t._getLocalConv(o))&&-1===o.conversationGroupList.indexOf(r)&&(o.conversationGroupList.push(r),n=!0)}))})),!0===n&&this._emitConvUpdate(),!0===i)&&this._emitConvGroupListUpdate()}},{key:"onConvGroupDeleted",value:function(e){var t,n=this,i=(Re.l("".concat(this._n,".onConvGroupDeleted groupItemList:"),e),[]);We(e)&&(t=!1,e.forEach((function(e){var o=e.groupID;e=e.groupName,n._convGroupMap.has(o)&&(n._convGroupMap.delete(o),t=!0,i.push(e))})),!0===t)&&this._emitConvGroupListUpdate(),this._eraseFromConversationGroupList(i)}},{key:"_eraseFromConversationGroupList",value:function(e){je(e)||(this._convM.getLocalConvList().forEach((function(t){t.conversationGroupList=t.conversationGroupList.filter((function(t){return!e.includes(t)}))})),this._emitConvUpdate())}},{key:"onConvGroupNameUpdated",value:function(e){Re.l("".concat(this._n,".onConvGroupNameUpdated options:"),e);var t,n,i,o=e.groupID,a=e.groupName,s=e.oldGroupName;this._convGroupMap.get(o)!==a&&(this._convGroupMap.set(o,a),this._emitConvGroupListUpdate(),e=this._convM.getLocalConvList(),i=!1,e.forEach((function(e){t=e.conversationGroupList,-1!==(n=t.indexOf(s))&&(t.splice(n,1,a),i=!0)})),!0===i)&&this._emitConvUpdate()}},{key:"onConvInGroupUpdated",value:function(e){var t,n,i,o=this,a=(Re.l("".concat(this._n,".onConvInGroupUpdated options:"),e),e.oldGroupName);We(e=e.recentContactUpdateGroupItem)&&(i=!1,e.forEach((function(e){var s=e.contactOptType;e=e.recentContactItem,t=o._concatConvID(e),(t=o._getLocalConv(t))&&(n=t.conversationGroupList.indexOf(a),1===s?-1===n&&(t.conversationGroupList.push(a),i=!0):2===s&&-1!==n&&(t.conversationGroupList.splice(n,1),i=!0))})),!0===i)&&(this._emitConvUpdate(),this._emitConvInGroupUpdate(a))}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){var t,n,i=this,o=(Re.l("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),e),e.msgRecentContactItem),a=(e=e.msgRecentContactUpdateContactItem,o=this._concatConvID(o),this._getLocalConv(o));a&&We(e)&&(n=!1,e.forEach((function(e){var o=e.groupOptType;e=e.recentContactGroupItem.groupName,t=a.conversationGroupList.indexOf(e),1===o?-1===t&&(a.conversationGroupList.push(e),n=!0):2===o&&-1!==t&&(a.conversationGroupList.splice(t,1),n=!0),!0===n&&i._emitConvInGroupUpdate(e)})),!0===n)&&this._emitConvUpdate()}},{key:"onConvGroupListSynced",value:function(e){We(e)&&0!==e.length&&(Re.l("".concat(this._n,".onConvGroupListSynced groupItem:"),e),this._fillConvGroupMap(e))}},{key:"getConvGroupListByID",value:function(e){var t,n=this;if(!je(e))return t=[],e.forEach((function(e){n._convGroupMap.has(e)&&t.push(n._convGroupMap.get(e))})),t}},{key:"_onConvNotFound",value:function(e,t){e.push({conversationID:t,code:Bn.CONV_NOT_FOUND,message:this._convM.getErrMsg(Bn.CONV_NOT_FOUND)})}},{key:"_onConvIDInvalid",value:function(e,t){e.push({conversationID:t,code:Bn.INVALID_CONV_ID,message:this._convM.getErrMsg(Bn.INVALID_CONV_ID)})}},{key:"_getFlagBit",value:function(e){for(var t=e.toString(2),n=t.length,i=n-1;0<=i;i--)if("1"===t[i])return n-i-1}},{key:"_concatConvID",value:function(e){var t,n=e.type,i=e.to,o=e.groupID;return e=e.userID,1===n?dt(e)?dt(i)||(t="".concat(k.CONV_C2C).concat(i)):t="".concat(k.CONV_C2C).concat(e):2===n&&(t="".concat(k.CONV_GROUP).concat(o)),t}},{key:"_getMyUserID",value:function(){return this._convM.getMyUserID()}},{key:"_getLocalConv",value:function(e){return this._convM.getLocalConversation(e)}},{key:"_hasLocalConv",value:function(e){return this._convM.hasLocalConversation(e)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._convM.emitOEvt(T.CONVERSATION_GROUP_LIST_UPDATED,y(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(e){var t={groupName:e,conversationList:[]},n=this._convM.getLocalConvList();t.conversationList=n.filter((function(t){return t.conversationGroupList.includes(e)})),this._convM.emitOEvt(T.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=An}}]),Ji=(l(Do,Nn),a(Do,[{key:"_initListeners",value:function(){var e=this.getIEmitInst();e.on(Oi.A2KEY_AND_TINYID_UPDATED,this._init,this),e.on(Oi.PROFILE_UPDATED,this._onProfileUpdated,this),e.on(Oi.CLOUD_CONFIG,this._onCloudConfig,this)}},{key:"_init",value:function(){var e=this,t=(Re.l("".concat(this._n,"._init")),this.get(13).getItem("conversationMap")),n=this.isIntl(),i=this.isUsingChatCore();if(t){for(var o=t.length,a=0;a<o;a++){var s=t[a];if(s){if(this._isNonExistentAccount(s.conversationID))continue;if(s.groupProfile&&Ct(s.groupProfile.type))continue}this._convMap.set(s.conversationID,new zi(t[a],n,i))}this.emitConvUpdate(!0,!1)}this.ready((function(){0<e._tmpGroupList.length&&(e.updateConvGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)})),this.syncConvList()}},{key:"_isNonExistentAccount",value:function(e){var t;return"@TLS#ERROR"===(t=e.startsWith(k.CONV_C2C)?e.replace(k.CONV_C2C,""):t)||"@TLS#NOT_FOUND"===t}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&this._msgListHandler.onCheckTimer(e)}},{key:"onMessageSent",value:function(e){this._onSendOrRcvMsg({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(e){this._onSendOrRcvMsg(e)}},{key:"_onSendOrRcvMsg",value:function(e){var t=this,n=e.conversationOptionsList,i=void 0===(i=e.isInstantMessage)||i,o=void 0!==(o=e.isUnreadC2CMessage)&&o,a=void 0===(a=e.updateUnreadCount)||a,s=void 0!==(s=e.isSyncingEnded)&&s;this._isReady?0!==n.length?(!0===i&&this._checkNewConv(n),this._updateLocalConvList({conversationOptionsList:n,isInstantMessage:i,isUnreadC2CMessage:o,isFromGetConversations:!1,updateUnreadCount:a}),i||(this._convIDFromUnreadDBMap=new Map([].concat(y(this._convIDFromUnreadDBMap),y(n.map((function(e){return[e.conversationID,1]}))))),this._diffAndDeleteConv(),s&&this.emitIEvt(Oi.C2C_UNREAD_HANDLE_COMPLETED)),0<n.filter((function(e){return!t._isConvNeedShow(e.conversationID)})).length||this.emitConvUpdate()):s&&this.emitIEvt(Oi.C2C_UNREAD_HANDLE_COMPLETED):this.ready((function(){t._onSendOrRcvMsg(e)}))}},{key:"updateConvGroupProfile",value:function(e){var t,n=this;We(e)&&0===e.length||(0!==this._convMap.size?(t=!1,e.forEach((function(e){var i="".concat(k.CONV_GROUP).concat(e.groupID);n._convMap.has(i)&&(t=!0,(i=n._convMap.get(i)).groupProfile=JSON.parse(JSON.stringify(e)),i.lastMessage.lastSequence<e.nextMessageSeq&&(i.lastMessage.lastSequence=e.nextMessageSeq-1),i.subType||(i.subType=e.type))})),t&&this.emitConvUpdate(!0,!1)):this._tmpGroupList=e)}},{key:"onMessageRevoked",value:function(e,t){var n,i,o,a=this;0!==e.length&&(n=null,i=!1,o=[],e.forEach((function(e){(n=a._convMap.get(e.conversationID))&&(t&&n.reduceUnreadCount()&&(i=n.type!==k.CONV_TOPIC),n.type===k.CONV_TOPIC?o.push(e):n.isLastMessageRevoked({sequence:e.sequence,time:e.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),i=!0))})),this.get(10).onMessageRevoked(o),i)&&this.emitConvUpdate(!0,!1)}},{key:"updateRevokerInfo",value:function(e){for(var t=new Set,n=0;n<e.length;n++){var i=e[n].revoker;t.add(i)}var o=y(t),a=this.get(4);return new Promise((function(t){a.getUserProfile({userIDList:o}).then((function(n){if(!We(n=n.data)||0===n.length)return t(e);var i,o={},a=s(n);try{for(a.s();!(i=a.n()).done;){var r=i.value,c=r.userID,u=r.nick,l=r.avatar;o[c]={nick:u,avatar:l}}}catch(d){a.e(d)}finally{a.f()}e.forEach((function(e){var t=e.revoker;o[t]&&(e.revokerInfo.nick=o[t].nick||"",e.revokerInfo.avatar=o[t].avatar||"")})),t(e)})).catch((function(){t(e)}))}))}},{key:"isLastMessageRevoked",value:function(e){var t=!1,n=e.conversationID,i=e.sequence,o=e.time,a=this._convMap.get(n);return a&&(t=a.type===k.CONV_TOPIC?this.get(10).isLastMessageRevoked({topicID:n.replace(k.CONV_GROUP,""),sequence:i}):a.isLastMessageRevoked({sequence:i,time:o})),Re.l("".concat(this._n,".isLastMessageRevoked options:"),e,"ret:".concat(t)),t}},{key:"onMessageDeleted",value:function(e){var t=this;if(0!==e.length){var n=null;e.forEach((function(e){(n=t._msgListHandler.getLocalMsg(e.conversationID,e.ID))&&(n.isDeleted=!0),e!==n&&(e.isDeleted=!0)})),e=e[0].conversationID;for(var i=this._msgListHandler.getLocalMsgList(e),o={},a=i.length-1;0<=a;a--)if(!i[a].isDeleted){o=i[a];break}var s,r=this._convMap.get(e);r&&(s=!1,r.lastMessage.lastSequence===o.sequence&&r.lastMessage.lastTime===o.time||(je(o)&&(o=void 0),r.updateLastMessage(o),r.type!==k.CONV_TOPIC&&(s=!0),Re.l("".concat(this._n,".onMessageDeleted. update convID:").concat(e," with lastMessage:"),r.lastMessage)),e.startsWith(k.CONV_C2C)&&this.updateUnreadCount(e),s)&&this.emitConvUpdate(!0,!1)}}},{key:"onMessageModified",value:function(e){var t="".concat(this._n,".onMessageModified"),n=e.conversationType,i=e.from,o=e.to,a=e.time,s=e.sequence,r=e.elements,c=e.cloudCustomData,u=e.messageVersion,l=this.getMyUserID(),d="".concat(n).concat(o),h=(n=(o===l&&n===k.CONV_C2C&&(d="".concat(n).concat(i)),l=this._msgListHandler.onMsgModified(d,e)).isUpdated,l=l.message,!0===n&&this.emitOEvt(T.MESSAGE_MODIFIED,[l]),this._isTopicConv(d));return null===l?Re.l("".concat(t," message is null! options:"),e):Re.l("".concat(t," isUpdated:").concat(n," isTopicMessage:").concat(h," from:").concat(i," to:").concat(o," sequence:").concat(l.sequence," time:").concat(l.time)),h?this.get(10).onMessageModified(e):(n=this._convMap.get(d))&&(i=n.lastMessage)&&i.lastTime===a&&i.lastSequence===s&&i.version!==u&&(Re.l("".concat(t," convID:").concat(d," lastMessage updated")),i.type=r[0].type,i.payload=r[0].content,i.messageForShow=Bt(i.type,i.payload,this.isIntl()),i.cloudCustomData=c,i.version=u,this.emitConvUpdate(!0,!1)),l}},{key:"onNewGroupAtTips",value:function(e){var t=this,n=(e=e.dataList,null);e.forEach((function(e){e.groupAtTips?n=e.groupAtTips:e.elements?n=f(f({},e.elements),{},{sync:!0}):e.groupAtType&&(n=f(f({},e),{},{sync:!0})),n.__random=e.random,n.__sequence=e.clientSequence,t._tmpGroupAtTipsList.push(n)})),Re.l("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var e,t=this;0!==this._tmpGroupAtTipsList.length&&(e=!1,this._tmpGroupAtTipsList.forEach((function(n){var i=n.groupID,o=n.from,a=void 0===(a=n.topicID)?void 0:a,s=void 0!==(s=n.sync)&&s;o!==t.getMyUserID()&&(dt(a)?(o=t._convMap.get("".concat(k.CONV_GROUP).concat(i)))&&(o.updateGroupAtInfoList(n),e=!0):((i=t._convMap.get("".concat(k.CONV_GROUP).concat(a)))&&(i.updateGroupAtInfoList(n),t.get(10).onAtInfoUpdated({topicID:a,groupAtInfoList:i.groupAtInfoList})),je(i)&&s&&(t.updateTopicConversation([{conversationID:"".concat(k.CONV_GROUP).concat(a),type:k.CONV_TOPIC}]),t._convMap.get("".concat(k.CONV_GROUP).concat(a)).updateGroupAtInfoList(n))))})),e&&this.emitConvUpdate(!0,!1),this._tmpGroupAtTipsList.length=0)}},{key:"_checkNewConv",value:function(e){var t=this,n=[],i=[];e.forEach((function(e){t._convMap.has(e.conversationID)||(e.type===k.CONV_C2C?n.push(e.conversationID.replace(k.CONV_C2C,"")):e.type===k.CONV_GROUP&&i.push(e.conversationID.replace(k.CONV_GROUP,"")))})),0<n.length&&(this._onNewC2CConv(n),n=null),0<i.length&&(this._onNewGroupConv(i),i=null)}},{key:"_onNewC2CConv",value:function(e){var t=this.get(6);return Promise.all([t.getRemotePeerReadTime(e),this._msgRemindHandler.getC2CMsgRemindType(e),this._convGroupHandler.searchConvGroupAndMark(e,1)])}},{key:"_onNewGroupConv",value:function(e){var t=this.get(7);return t?Promise.all([t.getMsgRemindType(e),this._convGroupHandler.searchConvGroupAndMark(e,2)]):Promise.resolve()}},{key:"_setStorageConvList",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.getLocalConvList().filter((function(e){return e.type===k.CONV_C2C||e.type===k.CONV_GROUP&&e.lastMessage.type!==k.MSG_GRP_TIP})).slice(0,20).map((function(e){return{conversationID:e.conversationID,type:e.type,subType:e.subType,lastMessage:e.lastMessage,groupProfile:e.groupProfile,userProfile:e.userProfile}}));this.get(13).setItem("conversationMap",t,e)}},{key:"emitConvUpdate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.getLocalConvList();t&&(t=this.get(7))&&t.updateGroupLastMessage(n),e&&(this.get(12).isPartialUpdatedConvs()?(this._diffConvMap(this._convMapForDiff,this._convMap),0<this._partialUpdatedConvMap.size&&(this.emitOEvt(T.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate(),this._convMapForDiff.clear(),this._convMapForDiff=nt(this._convMap,!0)),0===this._convMapForDiff.size&&(this._convMapForDiff=nt(this._convMap,!0))):(this.emitOEvt(T.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate()))}},{key:"_diffConvMap",value:function(e,t){var n,i=s(t);try{for(i.s();!(n=i.n()).done;){var o=v(n.value,2),a=o[0],r=o[1];e.has(a)&&JSON.stringify(r)===e.get(a)||this._partialUpdatedConvMap.set(a,r)}}catch(c){i.e(c)}finally{i.f()}}},{key:"getPartialUpdatedConvs",value:function(){var e=y(nt(this._partialUpdatedConvMap,!1).values());return this._partialUpdatedConvMap.clear(),e}},{key:"getLocalConvList",value:function(){var e=this;return y(this._convMap.values()).filter((function(t){return e._isConvNeedShow(t.conversationID)}))}},{key:"getLocalConversation",value:function(e){return this._convMap.get(e)}},{key:"hasLocalConversation",value:function(e){return this._convMap.has(e)}},{key:"getLocalOldestMessage",value:function(e){return this._msgListHandler.getLocalOldestMsg(e)}},{key:"syncConvList",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n="syncConvList",i=new ii(n);return this._pagingStatus===An&&this._convMap.clear(),this._pagingGetConvList(t).then((function(t){var o=zt(e._pagingGetCostList),a=Kt(e._pagingGetCostList);return e._pagingGetCostList.length=0,e._pagingStatus=Rn,e._diffAndDeleteConv(),e.emitConvUpdate(!0,!1),e._setStorageConvList(),e._handleC2CPeerReadTime(),e.emitIEvt(Oi.CONV_SYNC_COMPLETED),a="count:".concat(e._convMap.size," sum:").concat(a," avg:").concat(o),Re.l("".concat(e._n,".").concat(n,". ").concat(a)),i.setMessage(a).end(),t})).catch((function(t){return e._pagingStatus=wn,i.setMessage(e._pagingTs).setError(t).end(),kn(t)}))}},{key:"_diffAndDeleteConv",value:function(){var e,t=this;this._isSyncCompleted()&&(e=[],this._convMap.forEach((function(n,i){!t._pagingConvIDMap.has(i)&&t._convIDFromUnreadDBMap.has(i)&&(t._convMap.delete(i),e.push(i))})),Re.l("".concat(this._n,"._diffAndDeleteConv list:").concat(e)),e=null)}},{key:"_pagingGetConvList",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n="".concat(this._n,"._pagingGetConvList"),i=(Re.l("".concat(n," incrementalPullFlag:").concat(t," ts:").concat(this._pagingTs," startIdx:").concat(this._pagingStartIdx)+" pinnedTs:".concat(this._pagingPinnedTs," pinnedStartIdx:").concat(this._pagingPinnedStartIdx)),Date.now());return this._pagingStatus=Ln,this.req({P:jn.PAGING_GET_CONV_LIST,data:{fromAccount:this.getMyUserID(),timeStamp:t?this._pagingTs:0,startIndex:t?this._pagingStartIdx:0,pinnedTimeStamp:t?this._pagingPinnedTs:0,pinnedStartIndex:t?this._pagingPinnedStartIdx:0,orderType:1}}).then((function(t){var o=(t=t.data).completeFlag,a=void 0===(a=t.conversations)?[]:a,s=t.timeStamp,r=t.startIndex,c=t.pinnedTimeStamp,u=t.pinnedStartIndex;if(t=t.groupItem,e._pagingGetCostList.push(Yt(i,!1)),Re.l("".concat(n," ok. completeFlag:").concat(o," count:").concat(a.length," cost:").concat(Yt(i))),e._convGroupHandler.onConvGroupListSynced(t),0<a.length&&(t=e._getConvOptions(a),e._pagingConvIDMap=new Map([].concat(y(e._pagingConvIDMap),y(t.map((function(e){return[e.conversationID,1]}))))),e._updateLocalConvList({conversationOptionsList:t,isFromGetConversations:!0,updateUnreadCount:!0}),e.isLoggedIn())&&e.emitConvUpdate(),!e._isReady){if(!e.isLoggedIn())return Tn();e.triggerReady()}return e._pagingTs=s,e._pagingStartIdx=r,e._pagingPinnedTs=c,e._pagingPinnedStartIdx=u,1!==o?e._pagingGetConvList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),Tn())})).catch((function(t){throw!e.isLoggedIn()||e._isReady||(Re.w("".concat(n," failed. error:"),t),e.triggerReady()),t}))}},{key:"_updateLocalConvList",value:function(e){var t=e.isFromGetConversations,n=Date.now();e=this._getTmpConvListMapping(e).newConvList,this._convMap=new Map(this._sortConvList(y(this._convMap))),t||this._updateUserOrGroupProfile(e),Re.l("".concat(this._n,"._updateLocalConvList cost:").concat(Yt(n)))}},{key:"_getTmpConvListMapping",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,i=e.isInstantMessage,o=e.isUnreadC2CMessage,a=void 0!==o&&o,s=e.updateUnreadCount,r=[],c=[],u=this.get(7),l=this.get(8),d=this.isIntl(),h=this.isUsingChatCore(),p=0,g=t.length;p<g;p++){var f=new zi(t[p],d,h),m=f.conversationID,_=f.type;if(!this._isNonExistentAccount(m)){if(this._convMap.has(m)){var v=this._convMap.get(m);if(n&&_!==k.CONV_TOPIC){this._convMap.set(m,f),_===k.CONV_C2C?f.unreadCount=v.unreadCount:_===k.CONV_GROUP&&(f.groupProfile=JSON.parse(JSON.stringify(v.groupProfile)));continue}var y=["unreadCount","allowType","adminForbidType","payload"],I=(!1===i&&y.push("lastMessage"),"boolean"==typeof i&&y.push("isPinned"),t[p].lastMessage),M=!dt(I);M||t[p].type===k.CONV_TOPIC||this._onLastMsgNotExist(t[p]),dt(i)&&M&&null===v.lastMessage.payload&&(v.lastMessage.payload=I.payload),je(v.lastMessage.revoker)||(v.lastMessage.revoker=null),et(v,f,y,[null,void 0,"",0,NaN]),!0===s&&v.updateUnreadCount({nextUnreadCount:f.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:a}),i&&M&&(I.payload&&(v.lastMessage.payload=I.payload),v.type===k.CONV_GROUP)&&(v.lastMessage.nameCard=I.nameCard,v.lastMessage.nick=I.nick),M&&v.lastMessage.cloudCustomData!==I.cloudCustomData&&(v.lastMessage.cloudCustomData=I.cloudCustomData||"")}else _===k.CONV_GROUP&&u?(y=f.groupProfile.groupID,(M=u.getLocalGroupProfile(y))&&(f.groupProfile=M,!0===s)&&f.updateUnreadCount({nextUnreadCount:0})):_===k.CONV_C2C&&(v=m.replace(k.CONV_C2C,""),l)&&l.isMyFriend(v)&&(f.remark=l.getFriendRemark(v)),r.push(f),this._convMap.set(m,f);this._convMap.get(m).type===k.CONV_TOPIC&&c.push(this._convMap.get(m))}}for(var C=this.get(10),E=0,T=c.length;E<T;E++){var S,D=(S=c[E]).conversationID;je(S=S.groupAtInfoList)||C.onAtInfoUpdated({topicID:D.replace(k.CONV_GROUP,""),groupAtInfoList:S})}return{newConvList:r}}},{key:"_onLastMsgNotExist",value:function(e){new ii("lastMsgNotExist").setMessage(JSON.stringify(e)).end()}},{key:"_sortConvList",value:function(e){var t=[],n=[],i=[],o=[];return e.forEach((function(e){(!0===e[1].isPinned?je(e[1].lastMessage.lastTime)?n:t:je(e[1].lastMessage.lastTime)?o:i).push(e)})),t.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})).concat(n).concat(i.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime}))).concat(o)}},{key:"_sortConvListAndEmitEvent",value:function(){this._convMap=new Map(this._sortConvList(y(this._convMap))),this.emitConvUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(e){var t,n,i,o,a=this;0!==e.length&&(t=[],n=[],i=this.get(4),o=this.get(7),e.forEach((function(e){var i;e.type===k.CONV_C2C?t.push(e.toAccount):e.type===k.CONV_GROUP&&(i=e.toAccount,o.hasLocalGroup(i)?e.groupProfile=o.getLocalGroupProfile(i):n.push(i))})),Re.l("".concat(this._n,"._updateUserOrGroupProfile userIDList:").concat(t," groupIDList:").concat(n)),0<t.length&&i.getUserProfile({userIDList:t}).then((function(e){We(e=e.data)?e.forEach((function(e){a._doUpdateUserProfile("".concat(k.CONV_C2C).concat(e.userID),e)})):a._doUpdateUserProfile("".concat(k.CONV_C2C).concat(e.userID),e)})),0<n.length)&&o.getGroupProfileAdvance({groupIDList:n,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then((function(e){e=e.data.successGroupList;var t=!1;e.forEach((function(e){var n="".concat(k.CONV_GROUP).concat(e.groupID);a._convMap.has(n)&&(et((n=a._convMap.get(n)).groupProfile,e,[],[null,void 0,"",0,NaN]),!n.subType&&e.type&&(n.subType=e.type),t=!0)})),t&&a.emitConvUpdate()}))}},{key:"_doUpdateUserProfile",value:function(e,t){this.hasLocalConversation(e)&&(this.getLocalConversation(e).userProfile=t,this.emitConvUpdate())}},{key:"_getConvOptions",value:function(e){var t=this,n=[],i=(e=e.filter((function(e){var n=e.type;return e=e.userID,1===n&&!t._isNonExistentAccount(e)||2===n})),this.getMyUserID());return e=e.map((function(e){var o;return dt(e.lastMsg)&&(e.lastMsg={elements:[]}),1===e.type?(o={userID:e.userID,nick:e.peerNick,avatar:e.peerAvatar},n.push(o),{conversationID:"".concat(k.CONV_C2C).concat(e.userID),type:k.CONV_C2C,lastMessage:{lastTime:e.time,lastSequence:e.sequence,fromAccount:e.lastC2CMsgFromAccount,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:null,payload:e.lastMsg.elements[0]?t._amendLayersOverLimitProp(e.lastMsg.elements[0].content,e.lastMsg.elements[0].type):null,cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:8===e.lastMessageFlag,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:e.lastC2CMsgFromAccount===i&&e.time<=e.c2cPeerReadTime,revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null},unreadCount:0,userProfile:new ji(o),peerReadTime:e.c2cPeerReadTime,isPinned:1===e.isPinned,customData:e.customMark||"",markList:jt(e.standardMark),conversationGroupList:t._convGroupHandler.getConvGroupListByID(e.contactGroupId),remark:e.friendRemark||"",messageRemindType:t._transMsgRemindType(e.messageRemindType)}):{conversationID:"".concat(k.CONV_GROUP).concat(e.groupID),type:k.CONV_GROUP,lastMessage:f(f({lastTime:e.time,lastSequence:e.sequence,fromAccount:e.msgGroupFromAccount},t._patchTypeAndPayload(e)),{},{cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:2===e.lastMessageFlag,onlineOnlyFlag:!1,nick:e.senderNick||"",nameCard:e.senderNameCard||"",revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null}),groupProfile:new Ki({groupID:e.groupID,name:e.groupNick,avatar:e.groupImage,type:e.groupType,nextMessageSeq:e.nextMessageSeq}),unreadCount:t._computeGroupUnreadCount(e),peerReadTime:0,isPinned:1===e.isPinned,version:0,customData:e.customMark||"",markList:jt(e.standardMark),conversationGroupList:t._convGroupHandler.getConvGroupListByID(e.contactGroupId),messageRemindType:t._transMsgRemindType(e.messageRemindType)}})),0<n.length&&this.get(4).onConvProfileUpdated(n),e}},{key:"_transMsgRemindType",value:function(e){var t="";return 0===e?t=k.MSG_REMIND_ACPT_AND_NOTE:1===e?t=k.MSG_REMIND_DISCARD:2===e?t=k.MSG_REMIND_ACPT_NOT_NOTE:3===e&&(t=k.NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT),t}},{key:"_computeGroupUnreadCount",value:function(e){var t;return 0<(t=(void 0===(t=e.unreadCount)?0:t)-(void 0===(e=e.noUnreadCount)?0:e))?t:0}},{key:"_patchTypeAndPayload",value:function(e){var t=(e=e.lastMsg).event,n=void 0===(n=e.elements)?[]:n;return e=void 0===(e=e.groupTips)?{}:e,dt(void 0===t?void 0:t)||je(e)?{type:n[0]?n[0].type:null,payload:n[0]?this._amendLayersOverLimitProp(n[0].content,n[0].type):null}:((t=new ki(e)).setElement({type:k.MSG_GRP_TIP,content:f(f({},e.elements),{},{groupProfile:e.groupProfile})}),n=JSON.parse(JSON.stringify(t.payload)),t=null,{type:k.MSG_GRP_TIP,payload:n})}},{key:"_amendLayersOverLimitProp",value:function(e,t){var n=this.getFileDownloadProxy(),i=this.getDownloadFileAuthKey(),o=this.get(17).getFileDNList(),a=e.layersOverLimit,s=null;return t===k.MSG_IMAGE&&(s=new di(e,n,i,o)),t===k.MSG_VIDEO&&(s=new Ii(e,n,i,o)),t===k.MSG_SOUND&&(s=new pi(e,n,i,o)),t===k.MSG_FILE&&((s=new vi(e,n,i,o)).content.url=void 0),0===a?e.layersOverLimit=!1:1===a&&(e.layersOverLimit=!0),s&&Object.assign(e,s.content),e}},{key:"getLocalMessageList",value:function(e){return this._msgListHandler.getLocalMsgList(e)}},{key:"deleteLocalMessage",value:function(e){e instanceof ki&&this._msgListHandler.remove(e)}},{key:"onConvDeleted",value:function(e){We(e)&&(e=e.map((function(e){var t=e.type,n=e.userID;return e=e.groupID,1===t?"".concat(k.CONV_C2C).concat(n):2===t?"".concat(k.CONV_GROUP).concat(e):void 0})),Re.l("".concat(this._n,".onConvDeleted convIDList:").concat(e)),this.deleteLocalConvList(e))}},{key:"onConvPinnedStatus",value:function(e,t){var n,i=this;We(e)&&(n=!1,e.forEach((function(e){var o,a=e.type,s=e.userID;e=e.groupID,1===a?o=i.getLocalConversation("".concat(k.CONV_C2C).concat(s)):2===a&&(o=i.getLocalConversation("".concat(k.CONV_GROUP).concat(e))),o&&(Re.l("".concat(i._n,".onConvPinnedStatus convID:").concat(o.conversationID," localPinned:").concat(o.isPinned," remotePinned:").concat(t)),t?o.isPinned||(o.isPinned=!0,n=!0):o.isPinned&&(o.isPinned=!1,n=!0))})),n)&&this._sortConvListAndEmitEvent()}},{key:"getMessageList",value:function(e){var t=this,n=e.conversationID,i=e.nextReqMessageID,o=(e=e.count,"".concat(this._n,".getMessageList")),a="";if((r=this.getLocalConversation(n))&&r.groupProfile&&(a=r.groupProfile.type),Ct(a))return Re.l("".concat(o," not available in ").concat(a,". convID:").concat(n)),Tn({messageList:[],nextReqMessageID:"",isCompleted:!0});(dt(e)||15<e)&&(e=15),i||this._isMeInCommunity(n)||this.clearMemMsg(n);var s=this._computeRemainingCount({conversationID:n,nextReqMessageID:i}),r=this._completedMap.has(n);return Re.l("".concat(o," convID:").concat(n," isEverCleared:").concat(this._isEverCleared(n)," nextReqMessageID:").concat(i)+" remainingCount:".concat(s," count:").concat(e," isCompleted:").concat(r)),this._needGetHistory({conversationID:n,remainingCount:s,count:e})?this.getHistoryMessages({conversationID:n,nextReqMessageID:i,count:20}).then((function(e){var i=e.nextReqID,a=e.storedMessageList,r=e.assembledMessageList,c=(e=e.isPullingCompleted,t._completedMap.has(n)),u=a,l=(0<s&&(u=t._msgListHandler.getLocalMsgList(n).slice(0,a.length+s)),{nextReqMessageID:void 0,messageList:void 0,isCompleted:void 0});return t._isEverCleared(n)?(l.nextReqMessageID=i,l.messageList=r,l.isCompleted=e):(l.nextReqMessageID=c?"":i,l.messageList=u,l.isCompleted=c),a=l.messageList.filter((function(e){return e.isRevoked}))||[],r=l.messageList.map((function(e){return e.sequence})),Re.l("".concat(o," ret.nextReqMessageID:").concat(l.nextReqMessageID," ret.isCompleted:").concat(l.isCompleted," sequenceList:"),r),We(a)&&0!==a.length?t.updateRevokerInfo(a).then((function(e){return e.forEach((function(e){var t=e.revokerInfo;l.messageList=l.messageList.map((function(n){return n.ID===e.ID&&t&&(n.revokeReason=t.reason||"",n.revokerInfo={userID:t.revoker||n.revoker,nick:t.nick,avatar:t.avatar}),n}))})),En(l)})):En(l)})):(this.modifyMessageList(n),Tn(a=this._getMsgListFromMem({conversationID:n,nextReqMessageID:i,count:e})))}},{key:"_isEverCleared",value:function(e){return this._everClearedMap.has(e)}},{key:"_getMsgListFromMem",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,i=(e=e.count,"".concat(this._n,"._getMsgListFromMem")),o=this._msgListHandler.getLocalMsgList(t),a=o.length,s=kt(t),r=0,c={isCompleted:!1,nextReqMessageID:"",messageList:[]};return n?(r=s?o.findIndex((function(e){return e.ID===n})):o.findIndex((function(e){return e.sequence+""===n})))>e?(c.messageList=o.slice(r-e,r),c.nextReqMessageID=s?o[r-e].ID:o[r-e].sequence+""):(c.messageList=o.slice(0,r),c.isCompleted=!0):e<a?(c.messageList=o.slice(r=a-e,a),c.nextReqMessageID=s?o[r].ID:o[r].sequence+""):(c.messageList=o.slice(0,a),c.isCompleted=!0),e=c.messageList.map((function(e){return e.sequence})),Re.l("".concat(i," convID:").concat(t)+" ret.nextReqMessageID:".concat(c.nextReqMessageID," ret.isCompleted:").concat(c.isCompleted," sequenceList:").concat(e)),c}},{key:"getMessageListHopping",value:function(e){var t,n,i=e.conversationID,o=e.sequence,a=e.time,s=e.count;return e=void 0===(e=e.direction)?0:e,(dt(s)||15<s)&&(s=15),i.startsWith(k.CONV_C2C)?(t=this.get(6),n=i.replace(k.CONV_C2C,""),t.getRoamingMessagesHopping({peerAccount:n,time:a,count:s,direction:e})):i.startsWith(k.CONV_GROUP)?(t=this.get(7),n=i.replace(k.CONV_GROUP,""),t.getRoamingMessagesHopping({groupID:n,sequence:o,count:s,direction:e})):void 0}},{key:"_computeRemainingCount",value:function(e){var t,n=e.conversationID,i=e.nextReqMessageID,o=(e=this._msgListHandler.getLocalMsgList(n)).length;return Re.l("".concat(this._n,"._computeRemainingCount convID:").concat(n," nextReqMessageID:").concat(i," length:").concat(o)),i?(t=0,kt(n)?t=e.findIndex((function(e){return e.ID===i})):St(n)&&(t=-1!==i.indexOf("-")?e.findIndex((function(e){return e.ID===i})):e.findIndex((function(e){return e.sequence+""===i}))),-1===t?0:t):o}},{key:"_needGetHistory",value:function(e){var t=e.conversationID,n=e.remainingCount,i=(e=e.count,this.getLocalConversation(t)),o="";return i&&i.groupProfile&&(o=i.groupProfile.type),!(Dt(t)||Ct(o)||!this._isEverCleared(t)&&(i=n<=e&&!this._completedMap.has(t),Re.l("".concat(this._n,"._needGetHistory convID:").concat(t," ret:").concat(i)),!i))}},{key:"_isTopicConv",value:function(e){return Tt(e=e.replace(k.CONV_GROUP,""))}},{key:"getHistoryMessages",value:function(e){var t,n,i,o,a,s,r=e.conversationID,c=e.count;return e=e.nextReqMessageID,r===k.CONV_SYSTEM?Tn():(c=20<c?20:15,t=null,kt(r)?(s=0,n="",i=!1,a=this._roamingMsgKeyAndTimeMap.has(r),e&&(i=!0,a?(s=this._roamingMsgKeyAndTimeMap.get(r).lastMessageTime,n=this._roamingMsgKeyAndTimeMap.get(r).messageKey):(o=this._msgListHandler.findMessage(e))&&(s=o.time,Re.l("".concat(this._n,".getHistoryMessages convID:").concat(r," isRelayInfoExisted:").concat(a," lastMessageTime:").concat(s)))),(t=this.get(6)).getRoamingMessage({conversationID:r,peerAccount:r.replace(k.CONV_C2C,""),count:c,lastMessageTime:i?s:0,messageKey:i?n:""})):St(r)?(t=this.get(7))?(o=r.replace(k.CONV_GROUP,""),a=null,this._convMap.has(r)&&!Tt(o)&&(a=this._convMap.get(r).lastMessage),s=0,e?s=Number(e):a&&(s=a.lastSequence),t.getRoamingMessage({conversationID:r,groupID:o,count:c,sequence:s})):kn({code:Bn.NO_MODULE}):Tn())}},{key:"patchConvLastMessage",value:function(e){var t,n,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=this.getLocalConversation(e);o&&(t=(n=o.lastMessage).messageForShow,n=n.payload,je(t)||je(n)||i)&&0!==(t=this._msgListHandler.getLocalMsgList(e)).length&&(n=t[t.length-1],Re.l("".concat(this._n,".patchConvLastMessage bForceUpdate:").concat(i," convID:").concat(e," payload:"),n.payload),o.updateLastMessage(n))}},{key:"onRoamingMessage",value:function(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],o=3<arguments.length?arguments[3]:void 0,a=(c=1<arguments.length?arguments[1]:void 0).startsWith(k.CONV_C2C)?k.CONV_C2C:k.CONV_GROUP,s=null,r=[],c=[],u=0,l=n.length,d=a===k.CONV_GROUP,h=this.getFileDownloadProxy(),p=this.getDownloadFileAuthKey(),g=We(o),m=this.get(17).getFileDNList(),_=function(){d?--u:++u},v=function(){return d?l<=u:u<l};for(u=d?n.length-1:0,l=d?0:n.length;v();_())1!==n[u].isPlaceMessage&&((s=new ki(n[u])).to=n[u].to,a!==k.CONV_GROUP||dt(n[u].topicID)||(s.to=n[u].topicID),s.isSystemMessage=!!n[u].isSystemMessage,s.conversationType=a,e=4===n[u].event?{type:k.MSG_GRP_TIP,content:f(f({},n[u].elements),{},{groupProfile:n[u].groupProfile})}:n[u].elements,d||s.setNickAndAvatar({nick:n[u].nick,avatar:n[u].avatar}),je(e)?((t=new ii("emptyMessageBody")).setMessage("from:".concat(s.from," to:").concat(s.to," sequence:").concat(s.sequence," event:").concat(n[u].event)),t.setLevel("warning").end()):(s.setElement(e,h,p,m),s.reInitialize(this.getMyUserID()),r.push(s),g&&o.push(s)));return _=v=null,i?(this._msgListHandler.unshift(r,c),r=null,c):r}},{key:"findMessage",value:function(e){return this._msgListHandler.findMessage(e)}},{key:"_isMeInCommunity",value:function(e){var t=!0;return this._isTopicConv(e)&&(e=Ft(e.replace(k.CONV_GROUP,"")),this.get(7).hasLocalGroup(e)||(t=!1,Re.l("".concat(this._n,"._isMeInCommunity groupID:").concat(e," ret:").concat(t)))),t}},{key:"deleteTopicRoamingInfo",value:function(e){var t=this;Et({groupID:e})&&this._msgListHandler.getTopicConvIDList(e).forEach((function(e){t.clearMemMsg(e)}))}},{key:"deleteGroupRoamingInfo",value:function(e){e="".concat(k.CONV_GROUP).concat(e),0<this._msgListHandler.getLocalMsgList(e).length&&this.clearMemMsg(e)}},{key:"setMessageRead",value:function(e){var t=e.conversationID,n=this.getLocalConversation(t);if(e="".concat(this._n,".setMessageRead"),Re.l("".concat(e," convID:").concat(t," unreadCount:").concat(n?n.unreadCount:0)),!n)return Tn();if(n.type!==k.CONV_GROUP&&n.type!==k.CONV_TOPIC||je(n.groupAtInfoList)||this.deleteGroupAtTips(t),0===n.unreadCount)return Tn();var i=this._msgListHandler.getLocalLastMsg(t),o=n.lastMessage.lastTime,a=(o<(a=this._msgListHandler.getLocalMaxTime(t))&&(Re.l("".concat(e," update lastMessageTime from ").concat(o," to ").concat(a)),o=a),this._msgListHandler.getLocalMaxSeq(t)),s=n.lastMessage.lastSequence,r=(s<a&&(Re.l("".concat(e," update lastMessageSeq from ").concat(s," to ").concat(a)),s=a),n.type===k.CONV_TOPIC&&dt(i)&&(e=this.get(10),i=Ft(a=t.replace(k.CONV_GROUP,"")),e=e.getLocalTopic(i,a))&&(s=e.nextMessageSeq-1),null);switch(n.type){case k.CONV_C2C:return(r=this.get(6))?r.setMessageRead({conversationID:t,lastMessageTime:o}):kn({code:Bn.NO_MODULE});case k.CONV_GROUP:case k.CONV_TOPIC:return(r=this.get(7))?r.setMessageRead({conversationID:t,lastMessageSeq:s}):kn({code:Bn.NO_MODULE});case k.CONV_SYSTEM:return n.unreadCount=0,this.emitConvUpdate(!0,!1),Tn();default:return Tn()}}},{key:"setAllMessageRead",value:function(){var e,t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i="setAllMessageRead",o="".concat(this._n,".").concat(i),a=(n.scope||(n.scope=k.READ_ALL_MSG),Re.l("".concat(o," options:"),n),this._createSetAllMessageReadPack(n));return 0===a.readAllC2CMessage&&0===a.groupMessageReadInfoList.length?Tn():(e=new ii(i),this.req({P:jn.SET_ALL_MSG_READ,data:a}).then((function(i){return i=i.data,i=t._handleAllMsgRead(i),e.setMessage("scope:".concat(n.scope," failureGroups:").concat(JSON.stringify(i))).end(),Tn()})).catch((function(t){return e.setError(t).end(),Re.w("".concat(o," failed. error:"),t),kn({code:t&&t.code?t.code:Bn.MSG_UNREAD_ALL_FAIL,message:t&&t.message?t.message:void 0})})))}},{key:"setConvCustomData",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:"markConv",value:function(e){return this._convGroupHandler.markConv(e)}},{key:"getConvGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConvGroup",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:"deleteConvGroup",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:"renameConvGroup",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:"addConvsToGroup",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:"deleteConvsFromGroup",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:"onConvMarkUpdated",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:"onConvGroupCreated",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:"onConvGroupDeleted",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:"onConvGroupNameUpdated",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:"onConvInGroupUpdated",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:"_getConvLastMessageSeq",value:function(e){var t=this._msgListHandler.getLocalLastMsg(e.conversationID);return e=e.lastMessage.lastSequence,t&&e<t.sequence?t.sequence:e}},{key:"_getConvLastMessageTime",value:function(e){var t=this._msgListHandler.getLocalLastMsg(e.conversationID);return e=e.lastMessage.lastTime,t&&e<t.time?t.time:e}},{key:"_createSetAllMessageReadPack",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},i=e.scope,o=s(this._convMap);try{for(o.s();!(t=o.n()).done;){var a,r=v(t.value,2)[1];if(0<r.unreadCount)if(r.type===k.CONV_C2C&&0===n.readAllC2CMessage){if(i===k.READ_ALL_MSG)n.readAllC2CMessage=1;else if(i===k.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else r.type!==k.CONV_GROUP||i!==k.READ_ALL_GROUP_MSG&&i!==k.READ_ALL_MSG||(a=this._getConvLastMessageSeq(r),n.groupMessageReadInfoList.push({groupID:r.groupProfile.groupID,messageSequence:a}))}}catch(c){o.e(c)}finally{o.f()}return n}},{key:"onPushedAllMessageRead",value:function(e){this._handleAllMsgRead(e)}},{key:"_handleAllMsgRead",value:function(e){var t=e.groupMessageReadInfoList;return e=e.readAllC2CMessage,t=this._parseGroupReadInfo(t),1<=this._updateAllConvUnreadCount({readAllC2CMessage:e})&&this.emitConvUpdate(!0,!1),t}},{key:"_parseGroupReadInfo",value:function(e){var t=[];if(e&&e.length)for(var n=0,i=e.length;n<i;n++){var o=(r=e[n]).groupID,a=r.sequence,s=r.retCode,r=r.lastMessageSeq;dt(s)?this._remoteGroupReadSeqMap.set(o,r):(this._remoteGroupReadSeqMap.set(o,a),0!==s&&t.push("".concat(o,"-").concat(a,"-").concat(s)))}return t}},{key:"_updateAllConvUnreadCount",value:function(e){var t,n=e.readAllC2CMessage,i=0,o=s(this._convMap);try{for(o.s();!(t=o.n()).done;){var a,r,c,u,l=v(t.value,2),d=l[0],h=l[1];1<=h.unreadCount&&(1===n&&h.type===k.CONV_C2C?(a=this._getConvLastMessageTime(h),this.updateIsReadAfterReadReport({conversationID:d,lastMessageTime:a})):h.type===k.CONV_GROUP&&(r=d.replace(k.CONV_GROUP,""),this._remoteGroupReadSeqMap.has(r))&&(c=this._remoteGroupReadSeqMap.get(r),u=this._getConvLastMessageSeq(h),this.updateIsReadAfterReadReport({conversationID:d,remoteReadSequence:c}),c<=u)&&this._remoteGroupReadSeqMap.delete(r),this.updateUnreadCount(d,!1))&&(i+=1)}}catch(p){o.e(p)}finally{o.f()}return i}},{key:"isRemoteRead",value:function(e){var t,n=e.conversationID,i=(e=e.sequence,n.replace(k.CONV_GROUP,"")),o=!1;return this._remoteGroupReadSeqMap.has(i)&&(e<=(t=this._remoteGroupReadSeqMap.get(i))&&(o=!0,Re.l("".concat(this._n,".isRemoteRead convID:").concat(n," msgSeq:").concat(e," remoteReadSeq:").concat(t))),t+10<=e)&&this._remoteGroupReadSeqMap.delete(i),o}},{key:"updateIsReadAfterReadReport",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,i=e.lastMessageTime,o=this._msgListHandler.getLocalMsgList(t);if(0!==o.length)for(var a,s=o.length-1;0<=s;s--)if(a=o[s],!(i&&a.time>i||n&&a.sequence>n)){if("in"===a.flow&&a.isRead)break;a.setIsRead(!0)}}},{key:"updateUnreadCount",value:function(e){var t,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=!1,o=this.getLocalConversation(e),a=this._msgListHandler.getLocalMsgList(e);if(o)return(t=o.unreadCount)!==(a=a.filter((function(e){return!e.isRead&&!e._onlineOnlyFlag&&!e.isDeleted})).length)&&(o.unreadCount=a,i=!0,Re.l("".concat(this._n,".updateUnreadCount from ").concat(t," to ").concat(a,", convID:").concat(e)),!0===n)&&this.emitConvUpdate(!0,!1),i&&o.type===k.CONV_TOPIC&&(t=o.unreadCount,a=this.get(10),n=e.replace(k.CONV_GROUP,""),a.onUnreadCountUpdatedFromConv(n,t)),i}},{key:"clearGroupAtInfoList",value:function(e){var t,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=this.getLocalConversation(e);i&&0<i.groupAtInfoList.length&&(i.clearGroupAtInfoList(),Re.l("".concat(this._n,".clearGroupAtInfoList convID:").concat(e)),i.type===k.CONV_TOPIC&&(i=i.groupAtInfoList,t=this.get(10),e=e.replace(k.CONV_GROUP,""),t.onAtInfoUpdated({topicID:e,groupAtInfoList:i})),!0===n)&&this.emitConvUpdate(!0,!1)}},{key:"updateReadReceiptInfo",value:function(e){var t,n,i,o=this,a=void 0===(r=e.userID)?void 0:r,s=void 0===(r=e.groupID)?void 0:r,r=e.readReceiptList,c=void 0===(e=e.timestamp)?0:e;je(r)||(t=[],dt(a)?dt(s)||(n="".concat(k.CONV_GROUP).concat(s),r.forEach((function(e){var i=e.tinyID,a=e.clientTime,r=e.random,c=e.readCount;e=e.unreadCount,i="".concat(i,"-").concat(a,"-").concat(r),a=o._msgListHandler.getLocalMsg(n,i)||o._msgListHandler.getHoppingMsg(n,i),r={groupID:s,messageID:i,readCount:0,unreadCount:0},a&&(ze(c)&&(a.readReceiptInfo.readCount=c,r.readCount=c),ze(e)&&(a.readReceiptInfo.unreadCount=e,r.unreadCount=e),t.push(r))}))):(i="".concat(k.CONV_C2C).concat(a),r.forEach((function(e){var n=e.tinyID,s=e.clientTime;e=e.random,n="".concat(n,"-").concat(s,"-").concat(e),(s=o._msgListHandler.getLocalMsg(i,n)||o._msgListHandler.getHoppingMsg(i,n))&&!s.readReceiptInfo.isPeerRead&&(s.readReceiptInfo.isPeerRead=!0,s.readReceiptInfo.timestamp=c,t.push({userID:a,messageID:n,isPeerRead:!0,timestamp:c}))}))),0<t.length&&this.emitOEvt(T.MESSAGE_READ_RECEIPT_RECEIVED,t))}},{key:"updateIsRead",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&0!==n.length&&!Dt(t.type)){for(var i=[],o=0,a=n.length;o<a;o++)"in"!==n[o].flow?"out"!==n[o].flow||n[o].isRead||n[o].setIsRead(!0):i.push(n[o]);var s=0;s=t.type===k.CONV_C2C?(e=i.slice(-t.unreadCount).filter((function(e){return e.isRevoked})).length,i.length-t.unreadCount-e):i.length-t.unreadCount;for(var r=0;r<s&&!i[r].isRead;r++)i[r].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(e){var t,n,i,o=this,a="".concat(this._n,".deleteGroupAtTips"),s=(Re.l("".concat(a)),this._convMap.get(e));return s&&0!==(t=s.groupAtInfoList).length?(s=void 0,e.startsWith(k.CONV_GROUP)&&(s=e.replace(k.CONV_GROUP,"")),n=y(t),(Et({groupID:s})||Tt(s))&&0===(n=t.filter((function(e){return!e.atTypeArray.includes(k.CONV_AT_ALL)}))).length?(this.clearGroupAtInfoList(e,!1),Promise.resolve()):(i=this.getMyUserID(),this.req({P:jn.DEL_GROUP_AT_TIPS,data:{messageListToDelete:n.map((function(e){return{from:e.from,to:i,messageSeq:e.__sequence,messageRandom:e.__random,groupID:dt(e.topicID)?e.groupID:e.topicID}}))}}).then((function(){return Re.l("".concat(a," ok. count:").concat(t.length)),o.clearGroupAtInfoList(e,!1),Promise.resolve()})).catch((function(e){return Re.e("".concat(a," failed. error:"),e),kn(e)})))):Promise.resolve()}},{key:"appendToMessageList",value:function(e){return this._msgListHandler.pushIn(e)}},{key:"setMessageRandom",value:function(e){this._sll.set(e.random)}},{key:"deleteMessageRandom",value:function(e){this._sll.delete(e.random)}},{key:"pushIntoMessageList",value:function(e,t,n){return!(!this._msgListHandler.pushIn(t,n)||this._sll.has(t.random)&&!n||(e.push(t),0))}},{key:"revoke",value:function(e,t,n){return this._msgListHandler.revoke(e,t,n)}},{key:"getPeerReadTime",value:function(e){return this._peerReadTimeMap.get(e)}},{key:"recordPeerReadTime",value:function(e,t){(!this._peerReadTimeMap.has(e)||this._peerReadTimeMap.get(e)<t)&&this._peerReadTimeMap.set(e,t)}},{key:"updateMsgIsPeerReadProp",value:function(e,t){var n;e.startsWith(k.CONV_C2C)&&0<t&&(0<(n=this._msgListHandler.updateMsgIsPeerReadProp(e,t)).length&&this.emitOEvt(T.MESSAGE_READ_BY_PEER,n),this._convMap.has(e))&&!je(n=this._convMap.get(e).lastMessage)&&n.fromAccount===this.getMyUserID()&&n.lastTime<=t&&!n.isPeerRead&&(n.isPeerRead=!0,this.emitConvUpdate(!0,!1))}},{key:"updateMsgIsModifiedProp",value:function(e){this._msgListHandler.updateMsgIsModifiedProp(e)}},{key:"setCompleted",value:function(e){Re.l("".concat(this._n,".setCompleted convID:").concat(e)),this._completedMap.set(e,!0)}},{key:"updateRoamingMsgKeyAndTime",value:function(e,t,n){this._roamingMsgKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:"getConvList",value:function(e){var t,n=this,i="".concat(this._n,".").concat("getConvList"),o="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._convMap.size,", options:").concat(JSON.stringify(e));return Re.l("".concat(i,". ").concat(o)),this._pagingStatus===wn?((t=new ii("getConvList")).setMessage(o),this.syncConvList().then((function(){return t.end(),En({conversationList:n._getConvList(e),isSyncCompleted:n._isSyncCompleted()})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(i," failed. error:"),e),kn(e)}))):(o=this._getConvList(e),Re.l("".concat(i,". returned conversation count:").concat(o.length)),Tn({conversationList:o,isSyncCompleted:this._isSyncCompleted()}))}},{key:"_getConvList",value:function(e){var t,n,i,o,a,s=this;return dt(e)?this.getLocalConvList():We(e)?0===e.length?[]:this.getLocalConvList().filter((function(t){return e.includes(t.conversationID)})):$e(e)?(t=e.type,n=e.markType,i=e.groupName,o=e.hasUnreadCount,a=e.hasGroupAtInfo,this.getLocalConvList().filter((function(e){return s._filterType(e,t)&&s._filterMarkType(e,n)&&s._filterGroupName(e,i)&&s._filterUnreadCount(e,o)&&s._filterGroupAtInfo(e,a)}))):[]}},{key:"_filterType",value:function(e,t){return t!==k.CONV_C2C&&t!==k.CONV_GROUP||e.type===t}},{key:"_filterGroupName",value:function(e,t){return!lt(t)||(""===t?0===e.conversationGroupList.length:e.conversationGroupList.includes(t))}},{key:"_filterMarkType",value:function(e,t){return!ze(t)||(0===t?0===e.markList.length:e.markList.includes(t))}},{key:"_filterUnreadCount",value:function(e,t){var n=!0;return!0===t?n=1<=e.unreadCount:!1===t&&(n=0===e.unreadCount),n}},{key:"_filterGroupAtInfo",value:function(e,t){var n=!0;return!0===t?n=1<=e.groupAtInfoList.length:!1===t&&(n=0===e.groupAtInfoList.length),n}},{key:"_handleC2CPeerReadTime",value:function(){var e,t=s(this._convMap);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2),i=n[0],o=n[1];o.type===k.CONV_C2C&&this.recordPeerReadTime(i,o.peerReadTime)}}catch(a){t.e(a)}finally{t.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){var e=this.get(7);return!e||e.isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){var e=this.get(7);return e?e.getLocalGroupList().length:0}},{key:"_hasLocalGroup",value:function(e){var t=this.get(7);return!!t&&t.hasLocalGroup(e.replace(k.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(e){var t,n=this,i=!1;if(this._convMap.has(e)?t=this._convMap.get(e):(t=new zi({conversationID:e,type:kt(e)?k.CONV_C2C:k.CONV_GROUP},this.isIntl(),this.isUsingChatCore()),i=!0),t._isInfoCompleted||t.type===k.CONV_SYSTEM)return Tn({conversation:t});if(St(e)){if(!this.get(7))return kn({code:Bn.NO_MODULE});if(!this._hasLocalGroup(e))return Tn({conversation:t})}var o="".concat(this._n,".").concat("getConversationProfile"),a=new ii("getConversationProfile");return Re.l("".concat(o,". convID:").concat(e," remark:").concat(t.remark," lastMessage:"),t.lastMessage),this._getUserOrGroupProfile(t).then((function(s){a.setMessage("convID:".concat(e," unreadCount:").concat(s.data.conversation.unreadCount)).end();var r,c=n.get(8);if(c&&t.type===k.CONV_C2C&&(r=e.replace(k.CONV_C2C,""),c.isMyFriend(r))&&(c=c.getFriendRemark(r),t.remark!==c)&&(t.remark=c,Re.l("".concat(o,". convID:").concat(e," patch remark:").concat(t.remark))),Re.l("".concat(o," ok. isNewConv:").concat(i," convID:").concat(e)),i){if(t.type===k.CONV_C2C)return n._onNewC2CConv([e.replace(k.CONV_C2C,"")]).then((function(){return Tn({conversation:t})}));if(t.type===k.CONV_GROUP)return n._onNewGroupConv([e.replace(k.CONV_GROUP,"")]).then((function(){return Tn({conversation:t})}))}return s})).catch((function(t){return a.setError(t).setMessage("convID:".concat(e)).end(),Re.e("".concat(o," failed. error:"),t),kn(t)}))}},{key:"_getUserOrGroupProfile",value:function(e){var t=this;return e.type===k.CONV_C2C?this.get(4).getUserProfile({userIDList:[e.toAccount]}).then((function(n){return 0===(n=n.data).length?kn({code:Bn.USER_OR_GRP_NOT_FOUND}):(e.userProfile=n[0],e._isInfoCompleted=!0,t._insertConvAfterTopmost(e),Tn({conversation:e}))})):this.get(7).getGroupProfile({groupID:e.toAccount}).then((function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._insertConvAfterTopmost(e),Tn({conversation:e})}))}},{key:"_insertConvAfterTopmost",value:function(e){var t,n;e instanceof zi&&!this._convMap.has(e.conversationID)&&(n=(t=y(this._convMap)).findIndex((function(e){return!1===e[1].isPinned})),t.splice(n,0,[e.conversationID,e]),this._convMap=new Map(t),this._setStorageConvList(),this.emitConvUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(e){var t=this;e.data.forEach((function(e){var n=e.userID;n===t.getMyUserID()?t._onMyProfileModified({latestNick:e.nick,latestAvatar:e.avatar}):(n=t._convMap.get("".concat(k.CONV_C2C).concat(n)))&&(n.userProfile=e)}))}},{key:"_onCloudConfig",value:function(e){"0"===this.getCloudConfig("pull_on_invite")&&(this._bPullOnInvite=!1),Re.l("".concat(this._n,"._onCloudConfig bPullOnInvite:").concat(this._bPullOnInvite))}},{key:"disableMsgPullOnInvite",value:function(){this._bPullOnInvite=!1}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===Rn}},{key:"_errorLog",value:function(e,t,n,i){var o=new Error("Params validate failed."),a="".concat(this.getErrMsg("API_REFER")).concat(e);throw Re.w("[".concat(e,"] | ").concat(t," | ").concat(this.getErrMsg(n,i),", ").concat(a)),Re.e("[".concat(e,"] Invalid ").concat(t,": type check failed for ").concat(t,".")),o}},{key:"_isValidConvID",value:function(e){return kt(e)||St(e)||Dt(e)}},{key:"deleteConversation",value:function(e){var t=this,n="deleteConversation";return lt(e)||Ye(e)||this._errorLog(n,"options","StringOrObjectRequiredLog"),lt(e)?(this._isValidConvID(e)||this._errorLog(n,"options","InvalidConversationID",e),Re.l("".concat(this._n,".").concat(n," convID:").concat(e)),this.deleteConvList({conversationIDList:[e],flag:1})):(We(e.conversationIDList)||this._errorLog(n,"conversationIDList","ArrayRequiredLog"),0===e.conversationIDList.length&&this._errorLog(n,"conversationIDList","NonEmptyArrayLog"),e.conversationIDList.forEach((function(e){t._isValidConvID(e)||t._errorLog(n,"conversationIDList","InvalidConversationID",e)})),"clearHistoryMessage"in e&&"boolean"!=typeof e.clearHistoryMessage&&this._errorLog(n,"clearHistoryMessage","BooleanRequiredLog"),100<e.conversationIDList.length&&(e.conversationIDList=e.conversationIDList.slice(0,100)),this.deleteConvList(e))}},{key:"deleteConvList",value:function(e){var t=void 0===(t=e.conversationIDList)?[]:t,n=void 0===(n=e.clearHistoryMessage)||n,i=void 0===(e=e.flag)?0:e,o="".concat(this._n,".").concat("deleteConvList"),a=(e="convIDList:".concat(t," clearHistoryMessage:").concat(n),Re.l("".concat(o," ").concat(e)),new ii("deleteConvList"));return a.setMessage(e),Promise.all([this.rmLocalOnlyConvList(t),this.rmLocalAndRemoteConvList(t,n)]).then((function(e){return a.end(),0===(e=[].concat(y(e[0]),y(e[1]))).length?kn(new Fn({code:Bn.CONV_NOT_FOUND})):(Re.l("".concat(o," ok")),Tn(1===i?{conversationID:e[0]}:{conversationIDList:e}))})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)}))}},{key:"rmLocalOnlyConvList",value:function(e){var t=this;return e.filter((function(e){var n;return!!t._convMap.has(e)&&((n=t.getLocalConversation(e).type)!==k.CONV_GROUP||t._hasLocalGroup(e)?n===k.CONV_SYSTEM&&(t.get(7).deleteGroupSystemNotice({messageList:t._msgListHandler.getLocalMsgList(e)}),t.deleteLocalConv(e),!0):(t.deleteLocalConv(e),!0))}))}},{key:"rmLocalAndRemoteConvList",value:function(e,t){var n=this,i={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:t?1:0};return e.forEach((function(e){var t;n._convMap.has(e)&&((t=n.getLocalConversation(e).type)===k.CONV_C2C?i.conversationList.push({toAccount:e.replace(t,""),type:1}):t===k.CONV_GROUP&&n._hasLocalGroup(e)&&i.conversationList.push({toGroupID:e.replace(t,""),type:2}))})),0===i.conversationList.length?[]:this.req({P:jn.DEL_CONV,data:i}).then((function(e){var t=[];return 0<e.data.resultList.length&&e.data.resultList.map((function(e){0===e.code&&(e=1===e.type?"".concat(k.CONV_C2C).concat(e.to):"".concat(k.CONV_GROUP).concat(e.groupID),t.push(e))})),n.deleteLocalConvList(t),t}))}},{key:"setConvDraft",value:function(e){var t=e.conversationID,n=(e=e.draftText,"".concat(this._n,".").concat("setConvDraft"));return Re.l("".concat(n," convID:").concat(t," draftText:").concat(e)),this._convMap.has(t)?((n=this._convMap.get(t)).setDraftText(e),this.emitConvUpdate(),Tn({code:0,conversation:n})):kn({code:Bn.CONV_NOT_FOUND})}},{key:"clearHistoryMessage",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._convMap.has(e))return kn({code:Bn.CONV_NOT_FOUND});var i=this._convMap.get(e).type;if(i===k.CONV_C2C)n.type=1,n.toAccount=e.replace(k.CONV_C2C,"");else{if(i!==k.CONV_GROUP)return i===k.CONV_SYSTEM?(this.get(7).deleteGroupSystemNotice({messageList:this._msgListHandler.getLocalMsgList(e)}),Tn({conversationID:e})):kn({code:Bn.CONV_UN_RECORDED_TYPE});n.type=2,n.toGroupID=e.replace(k.CONV_GROUP,"")}var o="".concat(this._n,".").concat("clearHistoryMessage"),a=new ii("clearHistoryMessage");return a.setMessage("convID:".concat(e)),Re.l("".concat(o,". convID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.req({P:jn.CLEAR_HISTORY_MSG,data:n})})).then((function(){a.end(),Re.l("".concat(o," ok")),t.clearMemMsg(e);var n=t.getLocalConversation(e);return n&&(n.updateLastMessage(),t._sortConvListAndEmitEvent()),Tn({conversationID:e})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)}))}},{key:"pinConversation",value:function(e){var t,n,i,o=this,a=e.conversationID,s=e.isPinned,r=this.getLocalConversation(a);return r&&r.isPinned===s?Tn({conversationID:a}):Dt(a)?(r&&(r.isPinned=s),this._sortConvListAndEmitEvent(),Tn({conversationID:a})):(e=null,kt(a)?e={type:1,toAccount:a.replace(k.CONV_C2C,"")}:St(a)&&(e={type:2,groupID:a.replace(k.CONV_GROUP,"")}),null===e?kn({code:Bn.INVALID_CONV_ID}):(t="".concat(this._n,".").concat("pinConversation"),n="convID:".concat(a," isPinned:").concat(s),(i=new ii("pinConversation")).setMessage(n),Re.l("".concat(t,". ").concat(n)),this.req({P:jn.PIN_CONV,data:{fromAccount:this.getMyUserID(),operationType:!0===s?1:2,itemList:[e]}}).then((function(){return i.end(),Re.l("".concat(t," ok")),r?r.isPinned!==s&&(r.isPinned=s):o._convMap.set(a,new zi({conversationID:a,type:kt(a)?k.CONV_C2C:k.CONV_GROUP,isPinned:s},o.isIntl(),o.isUsingChatCore())),o._sortConvListAndEmitEvent(),En({conversationID:a})})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))))}},{key:"setMessageRemindType",value:function(e){return this._msgRemindHandler.set(e)}},{key:"patchMsgRemindType",value:function(e){var t=e.ID,n=e.isC2CConversation,i=e.messageRemindType,o=!1;return(n=this.getLocalConversation("".concat(n?k.CONV_C2C:k.CONV_GROUP).concat(t)))&&n.messageRemindType!==i&&(n.messageRemindType=i,o=!0),Re.l("".concat(this._n,".patchMsgRemindType options:"),e,"ret:".concat(o)),o}},{key:"onC2CMsgRemindTypeFetched",value:function(e){var t,n=this;We(e)&&0<e.length&&(t=0,e.forEach((function(e){var i=e.userID;e=e.muteFlag,e=n._transMsgRemindType(e),!0===n.patchMsgRemindType({ID:i,isC2CConversation:!0,messageRemindType:e})&&(t+=1)})),Re.l("".concat(this._n,".onC2CMsgRemindTypeFetched updateCount:").concat(t)),1<=t)&&this.emitConvUpdate(!0,!1)}},{key:"onC2CMsgRemindTypeSynced",value:function(e){var t=this,n="".concat(this._n,".onC2CMsgRemindTypeSynced");e.dataList.forEach((function(e){var i;je(e.muteNotificationsSync)||(i=(e=e.muteNotificationsSync).to,e=e.muteFlag,e=t._transMsgRemindType(e),t.patchMsgRemindType({ID:i,isC2CConversation:!(i=0),messageRemindType:e})&&(i+=1),Re.l("".concat(n," updateCount:").concat(i)),1<=i&&t.emitConvUpdate(!0,!1))}))}},{key:"onGroupMsgRemindTypeUpdated",value:function(e){this._msgRemindHandler.onGroupMsgRemindTypeUpdated(e)}},{key:"deleteLocalConv",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this._convMap.has(e);Re.l("".concat(this._n,".deleteLocalConv convID:").concat(e," has:").concat(n)),n&&(this._convMap.delete(e),this._convMapForDiff.delete(e),this.clearMemMsg(e),this._setStorageConvList(!0),t)&&(n=!this._isTopicConv(e),this.emitConvUpdate(n,!1))}},{key:"pullMsgOnInvite",value:function(e){var t,n,i,o,a,s=this.get(7);s&&(t="".concat(this._n,".pullMsgOnInvite"),Re.l("".concat(t," flag:").concat(this._bPullOnInvite)),this._bPullOnInvite)&&(a=this.getLocalLastMessage(e),n=this.getLocalSecondLastMessage(e),o=i=1,a&&(i=a.sequence),n&&(o=n.sequence),a=s.getGroupRemoteLastSeq(e.replace(k.CONV_GROUP,"")),Re.l("".concat(t," convID:").concat(e," localLastSeq:").concat(i," localSecondLastSeq:").concat(o," remoteLastSeq:").concat(a)),this.clearMemMsg(e),1<i-o?this._recursiveGetMsgList([],e,!1,i,o):1<a-i&&this._recursiveGetMsgList([],e,!0,a,i))}},{key:"_recursiveGetMsgList",value:function(e,t,n,i,o,a){var s=this;this.getMessageList({conversationID:t,nextReqMessageID:a}).then((function(a){var r=(a=a.data).messageList,c=a.isCompleted,u=(a=a.nextReqMessageID,r.filter((function(e){return n?e.sequence>o&&e.sequence<=i:e.sequence>o&&e.sequence<i})));e.unshift.apply(e,y(u)),!c&&0<r.length&&r[0].sequence>o&&e.length<60?s._recursiveGetMsgList(e,t,n,i,o,a):s._emitMsgReceived(t,e)}))}},{key:"_emitMsgReceived",value:function(e,t){var n,i,o=this;0<t.length&&(t=t.filter((function(e,t,n){return t===n.findIndex((function(t){return t.sequence===e.sequence}))})),n=this.hasLocalConversation(e),i=t.map((function(e){return e.sequence})),Re.l("".concat(this._n,"._emitMsgReceived convID:").concat(e," has:").concat(n," count:").concat(i.length," sequenceList:"),i),this.emitOEvt(T.MESSAGE_RECEIVED,t),n?this.patchConvLastMessage(e,!0):this.getConversationProfile(e).then((function(){o.patchConvLastMessage(e,!0)})))}},{key:"deleteLocalConvList",value:function(e){var t=this,n=!1;e.forEach((function(e){t._convMap.has(e)&&(t.deleteLocalConv(e,!1),n=!0)})),Re.l("".concat(this._n,".deleteLocalConvList convID:").concat(e," isConvIDExisted:").concat(n)),n&&this.emitConvUpdate(!0,!1)}},{key:"isMessageSentByCurrentInstance",value:function(e){return!(!this._msgListHandler.hasLocalMsg(e.conversationID,e.ID)&&!this._sll.has(e.random))}},{key:"modifyMessageList",value:function(e){var t,n;e.startsWith(k.CONV_C2C)&&this._convMap.has(e)&&(n=this._convMap.get(e),t=Date.now(),this._msgListHandler.modifyMsgSentByPeer({conversationID:e,latestNick:n.userProfile.nick,latestAvatar:n.userProfile.avatar}),n=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),this._msgListHandler.modifyMsgSentByMe({conversationID:e,latestNick:n.nick,latestAvatar:n.avatar}),Re.l("".concat(this._n,".modifyMessageList convID:").concat(e," cost:").concat(Yt(t))))}},{key:"updateUserProfileSpecifiedKey",value:function(e){Re.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),e);var t=e.conversationID,n=e.nick;e=e.avatar,this._convMap.has(t)&&(t=this._convMap.get(t).userProfile,lt(n)&&t.nick!==n&&(t.nick=n),lt(e)&&t.avatar!==e&&(t.avatar=e),this.emitConvUpdate(!0,!1))}},{key:"_onMyProfileModified",value:function(e){var t=this,n=this.getLocalConvList(),i=Date.now();n.forEach((function(n){t.modifyMessageSentByMe(f({conversationID:n.conversationID},e))})),Re.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost:").concat(Yt(i)))}},{key:"modifyMessageSentByMe",value:function(e){this._msgListHandler.modifyMsgSentByMe(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._msgListHandler.getLatestMsgSentByMe(e)}},{key:"modifyMessageSentByPeer",value:function(e){this._msgListHandler.modifyMsgSentByPeer(e)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._msgListHandler.getLatestMsgSentByPeer(e)}},{key:"pushIntoNoticeResult",value:function(e,t){return!(!this._msgListHandler.pushIn(t)||this._sll.has(t.random)||(e.push(t),0))}},{key:"getLocalLastMessage",value:function(e){return this._msgListHandler.getLocalLastMsg(e)}},{key:"getLocalSecondLastMessage",value:function(e){return this._msgListHandler.getLocalSecondLastMsg(e)}},{key:"checkAndPatchRemark",value:function(){var e,t,n=this.get(8);0!==this._convMap.size&&n&&0!==(e=y(this._convMap.values()).filter((function(e){return e.type===k.CONV_C2C}))).length&&(t=0,e.forEach((function(e){var i=e.conversationID.replace(k.CONV_C2C,"");n.isMyFriend(i)&&(i=n.getFriendRemark(i),e.remark!==i)&&(e.remark=i,t+=1)})),Re.l("".concat(this._n,".checkAndPatchRemark. c2cConvCount:").concat(e.length," patchedCount:").concat(t)),0<t)&&this.emitConvUpdate(!0,!1)}},{key:"updateTopicConversation",value:function(e){this._updateLocalConvList({conversationOptionsList:e,isFromGetConversations:!0,updateUnreadCount:!0})}},{key:"sendReadReceipt",value:function(e){var t=e[0],n=null;return t.conversationType===k.CONV_C2C?n=this._m.get(6):t.conversationType===k.CONV_GROUP&&(n=this._m.get(7)),n?n.sendReadReceipt(e):kn({code:Bn.NO_MODULE})}},{key:"getReadReceiptList",value:function(e){var t=e[0],n=null;return t.conversationType===k.CONV_C2C?n=this._m.get(6):t.conversationType===k.CONV_GROUP&&(n=this._m.get(7)),n?n.getReadReceiptList(e):kn({code:Bn.NO_MODULE})}},{key:"getLastMessageTime",value:function(e){return(e=this.getLocalConversation(e))?e.lastMessage.lastTime:0}},{key:"getTotalUnreadCount",value:function(){var e=this.getLocalConvList(),t=0;return e.forEach((function(e){e.type===k.CONV_SYSTEM||""!==e.messageRemindType&&e.messageRemindType!==k.MSG_REMIND_ACPT_AND_NOTE||(t+=e.unreadCount)})),t}},{key:"onTotalUnreadCountUpdate",value:function(){var e=this.getTotalUnreadCount();this._convTotalUnreadCount!==e&&(Re.l("".concat(this._n,".onTotalUnreadCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(e)),this._convTotalUnreadCount=e,this.emitOEvt(T.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"_isConvNeedShow",value:function(e){var t,n;return e=this.getLocalConversation(e),!(!dt(e)&&(t=e.type===k.CONV_TOPIC,n=e.type===k.CONV_GROUP&&e.groupProfile.type===k.GRP_ROOM,e=e.type===k.CONV_GROUP&&e.groupProfile.type===k.GRP_LIVE,t||n||e))}},{key:"setAllRcvMsgOpt",value:function(e){return this._msgRemindHandler.setAllRcvMsgOpt(e)}},{key:"getAllRcvMsgOpt",value:function(){return this._msgRemindHandler.getAllRcvMsgOpt()}},{key:"onAllRcvMsgOptNotify",value:function(e){this._msgRemindHandler.onAllRcvMsgOptNotify(e)}},{key:"clearUnreadCount",value:function(e){(e=this.getLocalConversation(e))&&0<e.unreadCount&&(e.unreadCount=0,this.emitConvUpdate(!0,!1))}},{key:"storeHoppingMessageList",value:function(e){this._msgListHandler.storeHoppingMsgList(e)}},{key:"clearMemMsg",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];Re.l("".concat(this._n,".clearMemMsg convID:").concat(e," isOverLimit:").concat(t)),this._msgListHandler.removeByConvID(e),this._completedMap.delete(e),this._roamingMsgKeyAndTimeMap.delete(e),this._everClearedMap.set(e,1)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._setStorageConvList(!0),this._pagingStatus=An,this._msgListHandler.reset(),this._msgRemindHandler.reset(),this._roamingMsgKeyAndTimeMap.clear(),this._sll.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._convMap.clear(),this._pagingTs=0,this._pagingStartIdx=0,this._pagingPinnedTs=0,this._pagingPinnedStartIdx=0,this._remoteGroupReadSeqMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this._pagingConvIDMap.clear(),this._convIDFromUnreadDBMap.clear(),this._pagingGetCostList.length=0,this._convMapForDiff.clear(),this._partialUpdatedConvMap.clear(),this._everClearedMap.clear(),this._bPullOnInvite=!0,this._convGroupHandler.reset(),this.resetReady()}}])),Xi=a((function e(t){i(this,e),this._grpM=t,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4}),[{key:"onCheckTimer",value:function(e){e%1==0&&0<this._cachedGroupTipsMap.size&&this._check()}},{key:"_check",value:function(){var e=this;this._cachedGroupTipsMap.forEach((function(t,n){var i=e._checkCountMap.get(n),o=e._grpM.hasLocalGroup(n);Re.l("".concat(e._n,"._check groupID:").concat(n," hasLocalGroup:").concat(o," checkCount:").concat(i)),o?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._grpM.deleteUnjoinedAVChatRoom(n)):i>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):e._checkCountMap.set(n,++i)}))}},{key:"onNewGroupTips",value:function(e){Re.l("".concat(this._n,".onNewGroupTips options:").concat(JSON.stringify(e.dataList)));var t=(e=this._assembly(e)).eventDataList,n=e.result;0<(e=e.AVChatRoomMessageList).length&&this._grpM.onAVChatRoomMessage(e),0<n.length&&(this._grpM.emitOEvt(T.MESSAGE_RECEIVED,n),this._handleTips(n)),0<t.length&&(this._grpM.updateNextMessageSeq(t),this._grpM.get(11).onNewMessage({conversationOptionsList:t,isInstantMessage:!0}))}},{key:"_assembly",value:function(e){for(var t=e.event,n=e.dataList,i=null,o=[],a=[],s={},r=[],c=0,u=n.length;c<u;c++){var l=ct(n[c]);if(6===t){if(this._grpM.isGroupAttributesUpdatedNotice(l))continue;if(this._grpM.isGroupCountersNotice(l))continue}var d=(m=l.groupProfile).groupID,h=void 0===(h=m.communityType)?0:h,p=void 0===(p=m.topicID)?void 0:p,g=m.invisible,m=void 0===(m=m.groupType)?void 0:m,_=void 0;if((y=this._grpM.isMessageFromTopic(h,p))&&(_=k.CONV_TOPIC,l.to=p),(v=this._grpM.hasLocalGroup(d))||!this._grpM.isUnjoinedAVChatRoom(d))if(v||y)if(this._grpM.isMessageFromOrToAVChatroom(d))l.event=t,r.push(l);else if(l.currentUser=this._grpM.getMyUserID(),l.conversationType=k.CONV_GROUP,(i=new ki(l)).setElement({type:k.MSG_GRP_TIP,content:f(f({},l.elements),{},{groupProfile:l.groupProfile})}),i.isSystemMessage=!1,1!==g){var v=this._grpM.get(11),y=(g=(y=i).conversationID,y.sequence);if(6===t)i._onlineOnlyFlag=!0,a.push(i);else if(!v.pushIntoNoticeResult(a,i))continue;this._grpM.isMessageFromCommunityOfTopic(h,p)||6===t&&v.getLocalConversation(g)||(6!==t&&this._qualityStat(i),h=v.isRemoteRead({conversationID:g,sequence:y}),dt(s[g])?(p=0,"in"!==i.flow||i._isExcludedFromUnreadCount||i._onlineOnlyFlag||h||(p=1),s[g]=o.push({conversationID:g,unreadCount:p,type:dt(_)?i.conversationType:_,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1):(o[v=s[g]].type=i.conversationType,o[v].subType=i.conversationSubType,o[v].lastMessage=i._isExcludedFromLastMessage?"":i,"in"!==i.flow||i._isExcludedFromUnreadCount||i._onlineOnlyFlag||h||o[v].unreadCount++))}else this._qualityStat(i);else this._cacheAndCompare({groupID:d,event:t,item:l,groupType:m})}return{eventDataList:o,result:a,AVChatRoomMessageList:r}}},{key:"_qualityStat",value:function(e){this._grpM.get(26).addMessageSequence({key:Jn,message:e})}},{key:"_handleTips",value:function(e){var t=this;e.forEach((function(e){switch(e.payload.operationType){case 1:t._onNewMemberComeIn(e);break;case 2:t._onMemberQuit(e);break;case 3:t._onMemberKickedOut(e);break;case 4:t._onMemberSetAdmin(e);break;case 5:t._onMemberCancelledAdmin(e);break;case 6:t._onGroupProfileModified(e);break;case 7:t._onMemberInfoModified(e);break;case 8:t._onTopicProfileUpdated(e);break;default:Re.w("".concat(t._n,"._handleTips unknown operationType:").concat(e.payload.operationType))}}))}},{key:"_onNewMemberComeIn",value:function(e){var t=(e=e.payload).memberNum;e=e.groupProfile.groupID,(e=this._grpM.getLocalGroupProfile(e))&&ze(t)&&e.memberCount!==t&&(e.memberCount=t,this._updateConvGroupProfile(e))}},{key:"_onMemberQuit",value:function(e){var t=(n=e.payload).memberNum,n=n.groupProfile.groupID,i=this._grpM.getLocalGroupProfile(n);i&&ze(t)&&i.memberCount!==t&&(i.memberCount=t,this._updateConvGroupProfile(i)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(n,e.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(e){var t=(n=e.payload).memberNum,n=n.groupProfile.groupID,i=this._grpM.getLocalGroupProfile(n);i&&ze(t)&&i.memberCount!==t&&(i.memberCount=t,this._updateConvGroupProfile(i)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(n,e.payload.userIDList)}},{key:"_updateConvGroupProfile",value:function(e){this._grpM.get(11).updateConvGroupProfile([e])}},{key:"_onMemberSetAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=(e=e.payload.userIDList,this._grpM.getGroupMemberHandler());e.forEach((function(e){(e=n.getLocalGroupMemberInfo(t,e))&&e.updateRole(k.GRP_MBR_ROLE_ADMIN)}))}},{key:"_onMemberCancelledAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=(e=e.payload.userIDList,this._grpM.getGroupMemberHandler());e.forEach((function(e){(e=n.getLocalGroupMemberInfo(t,e))&&e.updateRole(k.GRP_MBR_ROLE_MEMBER)}))}},{key:"_onGroupProfileModified",value:function(e){var t=this,n=(e=e.payload).newGroupProfile,i=e.groupProfile,o=e.operatorInfo,a=(e=i.groupID,this._grpM.getLocalGroupProfile(e));Object.keys(n).forEach((function(e){switch(e){case"ownerID":t._ownerChanged(a,n);break;case"groupName":a.name=n[e];break;default:a[e]=n[e]}})),dt(o)||Object.keys(o).forEach((function(e){var t;"nameCard"===e?a.updateSelfInfo({nameCard:o[e]}):"role"===e&&(t="",400===o[e]?t=k.GRP_MBR_ROLE_OWNER:300===o[e]?t=k.GRP_MBR_ROLE_ADMIN:200===o[e]&&(t=k.GRP_MBR_ROLE_MEMBER),a.updateSelfInfo({role:t}))})),i=!a.isSupportTopic,this._grpM.emitGroupListUpdate(!0,i)}},{key:"_ownerChanged",value:function(e,t){e=e.groupID;var n=this._grpM.getLocalGroupProfile(e),i=this._grpM.getMyUserID();i===t.ownerID&&(n.updateGroup({selfInfo:{role:k.GRP_MBR_ROLE_OWNER}}),n=(t=this._grpM.getGroupMemberHandler()).getLocalGroupMemberInfo(e,i),i=this._grpM.getLocalGroupProfile(e).ownerID,t=t.getLocalGroupMemberInfo(e,i),n&&n.updateRole(k.GRP_MBR_ROLE_OWNER),t)&&t.updateRole(k.GRP_MBR_ROLE_MEMBER)}},{key:"_onMemberInfoModified",value:function(e){var t=e.to,n=(i=e.payload).groupProfile,i=i.memberList,o=n.groupID,a=(Tt(t)&&this._updateTopicMuteTime(e),this._grpM.getGroupMemberHandler());i.forEach((function(e){var t=a.getLocalGroupMemberInfo(o,e.userID);t&&ze(e.muteTime)&&t.updateMuteUntil(e.muteTime)}))}},{key:"_updateTopicMuteTime",value:function(e){var t=e.to,n=(e=e.payload).groupProfile,i=void 0===(e=e.memberList)?[]:e,o=(e=this._grpM.get(10),n=n.groupID,e.getLocalTopic(n,t));if(o){for(var a=!1,s=0;s<i.length;s++){var r=i[s];if(r.userID===this._grpM.getMyUserID()&&0<=r.muteTime){o.updateSelfInfo({muteTime:r.muteTime}),a=!0;break}}a&&this._grpM.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:o})}}},{key:"_onTopicProfileUpdated",value:function(e){var t=(n=e.payload).groupProfile.groupID,n=n.newTopicInfo;this._grpM.get(10).onTopicProfileUpdated(f({groupID:t,topicID:e.to},n))}},{key:"_cacheGroupTips",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:"_deleteCachedGroupTips",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:"_notifyCachedGroupTips",value:function(e,t){var n=this,i=this._cachedGroupTipsMap.get(e)||[];Re.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(e," groupType:").concat(t," count:").concat(i.length)),i.forEach((function(e){n.onNewGroupTips(e)})),this._deleteCachedGroupTips(e)}},{key:"_cacheAndCompare",value:function(e){var t=e.groupID,n=e.event,i=e.item;e=e.groupType,Re.l("".concat(this._n,"._cacheAndCompare groupID:").concat(t," groupType:").concat(e)),this._cacheGroupTips(t,{event:n,dataList:[i]}),n={groupID:t,type:e},e===k.GRP_AVCHATROOM?this._grpM.hasLocalGroup(t)?this._notifyCachedGroupTips(t,e):this._grpM.setUnjoinedAVChatRoom(t):(this._grpM.updateGroupMap([n]),this._notifyCachedGroupTips(t,e)),this._checkCountMap.has(t)||this._checkCountMap.set(t,0)}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear()}}]),Zi=a((function e(t){i(this,e),this._grpM=t,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this.PAGING_GRP_COUNT_LIMIT=200,this._pagingStatus=An,this._pagingGetCostList=[],t.getIEmitInst().on(Oi.A2KEY_AND_TINYID_UPDATED,this.syncGroupList,this)}),[{key:"onCheckTimer",value:function(e){e%1==0&&0<this._cachedGroupMessageMap.size&&this._check()}},{key:"_check",value:function(){var e=this;this._cachedGroupMessageMap.forEach((function(t,n){var i=e._checkCountMap.get(n),o=e._grpM.hasLocalGroup(n);Re.l("".concat(e._n,"._check groupID:").concat(n," hasLocalGroup:").concat(o," checkCount:").concat(i)),o?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._grpM.deleteUnjoinedAVChatRoom(n)):i>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):e._checkCountMap.set(n,++i)}))}},{key:"updateLastMsg",value:function(e){var t="".concat(this._n,".updateLastMsg");if(0!==this._grpM.getGroupMap().size){for(var n,i,o,a,s=!1,r=e.length,c=0;c<r;c++)(n=e[c]).type===k.CONV_GROUP&&0!==n.lastMessage.lastSequence&&null!==n.lastMessage.payload&&(i=n.conversationID.split(/^GROUP/)[1],i=this._grpM.getLocalGroupProfile(i))&&(o=i.lastMessage,a=n.lastMessage,JSON.stringify(o)!==JSON.stringify(a))&&(i.lastMessage=f({},n.lastMessage),s=!0);Re.l("".concat(t," convCount:").concat(r," groupCount:").concat(this._grpM.getLocalGroupList().length," isUpdated:").concat(s)),s&&(this._grpM.sortLocalGroupList(),this._grpM.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:"onNewMessage",value:function(e){var t,n=(t=this._assembly(e)).conversationOptionsList,i=t.messageList;0<(0<(0<(t=t.AVChatRoomMessageList).length&&this._grpM.onAVChatRoomMessage(t),t=yt(i)).length&&this._grpM.emitOEvt(T.MESSAGE_MODIFIED,t),0<n.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:n,isInstantMessage:!1!==e.isInstantMessage,updateUnreadCount:!1!==e.updateUnreadCount}),this._grpM.updateNextMessageSeq(n)),t=Mt(i)).length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t),i.length=0}},{key:"_assembly",value:function(e){var t=e.dataList,n=e.event,i=e.isInstantMessage,o=null,a=[],s=[],r=[],c={},u=this._grpM.getFileDownloadProxy(),l=this._grpM.getDownloadFileAuthKey(),d=this._grpM.get(17).getFileDNList(),h=t.length;1<h&&t.sort((function(e,t){return e.sequence-t.sequence}));for(var p=this._grpM.get(11),g=this._grpM.get(4),f=0;f<h;f++){var m,_=ct(t[f]),v=(C=_.groupProfile).groupID,y=void 0===(y=C.communityType)?0:y,I=void 0===(I=C.topicID)?void 0:I,M=C.invisible,C=void 0===(C=C.groupType)?void 0:C,E=void 0,T=this._grpM.isMessageFromTopic(y,I),S=(T&&(E=k.CONV_TOPIC,_.to=I),this._grpM.hasLocalGroup(v));!S&&this._grpM.isUnjoinedAVChatRoom(v)||(S||T?this._grpM.isMessageFromOrToAVChatroom(v)?(_.event=n,r.push(_)):(_.currentUser=this._grpM.getMyUserID(),_.conversationType=k.CONV_GROUP,_.isSystemMessage=!!_.isSystemMessage,(o=new ki(_)).setElement(_.elements,u,l,d),1!==M?(S=1===t[f].isModified,p.isMessageSentByCurrentInstance(o)?o.isModified=S:S=!1,1===_.onlineOnlyFlag?(o._onlineOnlyFlag=!0,p.isMessageSentByCurrentInstance(o)||s.push(o)):this._grpM.isMessageFromCommunityOfTopic(y,I)?s.push(o):(o.from===this._grpM.getMyUserID()&&(T=p.getLatestMessageSentByMe(o.conversationID))&&(M=T.nick,y=T.avatar,M===o.nick&&y===o.avatar||(p.modifyMessageSentByMe({conversationID:m,latestNick:o.nick,latestAvatar:o.avatar}),g.mockOnNickAvatarModified(o.nick,o.avatar))),p.pushIntoMessageList(s,o,S)&&(this._qualityStat(i,o),m=(I=o).conversationID,T=I.sequence,M=p.isRemoteRead({conversationID:m,sequence:T}),dt(c[m])?(y=0,"in"!==o.flow||o._isExcludedFromUnreadCount||M||(y=1),c[m]=a.push({conversationID:m,unreadCount:y,type:dt(E)?o.conversationType:E,subType:o.conversationSubType,lastMessage:o._isExcludedFromLastMessage?"":o})-1):(a[S=c[m]].type=dt(E)?o.conversationType:E,a[S].subType=o.conversationSubType,a[S].lastMessage=o._isExcludedFromLastMessage?"":o,"in"!==o.flow||o._isExcludedFromUnreadCount||M||a[S].unreadCount++)))):this._qualityStat(i,o)):this._cacheAndCompare({groupID:v,event:n,item:_,groupType:C}))}return{conversationOptionsList:a,messageList:s,AVChatRoomMessageList:r}}},{key:"_qualityStat",value:function(e,t){var n=this._grpM.get(26);n.addMessageSequence({key:Jn,message:t}),e&&0<t.clientTime&&n.addMessageDelay(t.clientTime)}},{key:"onMsgRevoked",value:function(e,t){var n=this,i=this._grpM.get(11),o=[],a=[];e.dataList.forEach((function(e){var t=e.elements.revokedInfos,n=e.revokerInfo,s=e.groupProfile,r=!1;s&&(r=Et({groupID:s.groupID})||!je(s.topicID)),dt(t)||t.forEach((function(e){var t,c=je(e.topicID)?"GROUP".concat(e.groupID):"GROUP".concat(e.topicID),u=i.getLocalConversation(c),l=e.revokerInfo&&e.revokerInfo.revoker||n&&n.revoker,d=n&&n.reason||"";u&&Ct(u.type)?t={conversationID:c,sequence:e.sequence,ID:"".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)}:(u=i.revoke(c,e.sequence,e.random))?t=u:(t={conversationID:c,sequence:e.sequence},e.tinyID&&e.clientTime&&e.random&&(t.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)),e.time&&(t.time=e.time)),t&&(t.revoker=l,t.revokeReason=d,t.revokerInfo={userID:l,nick:"",avatar:""},(r?(t.revokerInfo.nick=s.nick,t.revokerInfo.avatar=s.avatar,o):a).push(t))}))})),0===a.length&&0===o.length||(i.onMessageRevoked([].concat(o,a),t),0<o.length&&this._grpM.emitOEvt(T.MESSAGE_REVOKED,o),0<a.length&&i.updateRevokerInfo(a).then((function(e){n._grpM.emitOEvt(T.MESSAGE_REVOKED,e)})))}},{key:"_groupListTreeShaking",value:function(e){for(var t=new Map(y(this._grpM.getGroupMap())),n=0,i=e.length;n<i;n++)t.delete(e[n].groupID);this._grpM.hasJoinedAVChatRoom()&&this._grpM.getJoinedAVChatRoom().forEach((function(e){t.delete(e)})),this._grpM.getGroupMap().forEach((function(e,n){e.isSupportTopic&&t.delete(n)}));for(var o=y(t.keys()),a=0,s=o.length;a<s;a++)this._grpM.deleteGroup(o[a])}},{key:"syncGroupList",value:function(){var e,t,n=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0],o=(this._pagingStatus===An&&this._grpM.clearGroupMap(),y(G)),a=this.PAGING_GRP_COUNT_LIMIT,s=[];return!0===i?this._pagingGetGroupListWithTopic({limit:a,offset:0,groupBaseInfoFilter:o,groupList:s}):(i="syncGroupList",e="".concat(this._n,".").concat(i),t=new ii(i),this._pagingGetGroupList({limit:a,offset:0,groupBaseInfoFilter:o,groupList:s}).then((function(){var i=zt(n._pagingGetCostList),o=Kt(n._pagingGetCostList),a=(n._pagingGetCostList.length=0,n._pagingStatus=Rn,n._groupListTreeShaking(s),n._grpM.updateGroupMap(s),n._grpM.getLocalGroupList().length);return a="count:".concat(a," sum:").concat(o," avg:").concat(i),Re.l("".concat(e," ok. ").concat(a)),t.setMessage(a).end(),n.tempConversationList&&(n.updateLastMsg(n.tempConversationList),n.tempConversationList=null),n._grpM.emitGroupListUpdate(!0,!0),En({groupList:n._grpM.getLocalGroupList()})})).catch((function(i){return n._pagingStatus=wn,t.setError(i).end(),Re.e("".concat(e," failed. error:"),i),kn(i)})))}},{key:"getGroupList",value:function(){var e,t=this,n="".concat(this._n,".").concat("getGroupList");return Re.l("".concat(n," pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===wn||this._pagingStatus===An?this.syncGroupList().then((function(){return En({groupList:t._grpM.getLocalGroupList(),isSyncCompleted:t.isPagingGetCompleted()})})).catch((function(e){return Re.e("".concat(n," failed. error:"),e),kn(e)})):(e=this._grpM.getLocalGroupList(),Re.l("".concat(n,". returned group count:").concat(e.length)),Tn({groupList:e,isSyncCompleted:this.isPagingGetCompleted()}))}},{key:"isPagingGetCompleted",value:function(){return this._pagingStatus===Rn}},{key:"_pagingGetGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("_pagingGetGroupList"),i=void 0!==(c=e.isCommunityRelay)&&c,o=e.limit,a=e.offset,s=e.groupBaseInfoFilter,r=e.groupList,c=void 0,u=(i&&(c=k.GRP_COMMUNITY,s.push("AtInfoList")),Date.now());return this._grpM.req({P:jn.GET_GRP_LIST,data:{type:c,memberAccount:this._grpM.getMyUserID(),limit:o,offset:a,responseFilter:{groupBaseInfoFilter:s,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then((function(e){var c=void 0===(c=(e=e.data).groups)?[]:c,l=(e=e.totalCount,r.push.apply(r,y(c)),t._handleGroupAtInfoWithoutTopic(i,c),!((c=a+o)<e));return e="offset:".concat(a," limit:").concat(o," total:").concat(e," isCompleted:").concat(l," ")+"current:".concat(r.length," isCommunityRelay:").concat(i),t._pagingGetCostList.push(Yt(u,!1)),Re.l("".concat(n," ok. ").concat(e," cost:").concat(Yt(u))),i||l?!i&&l?(Re.l("".concat(n," start to get community list")),a=0,t._pagingGetGroupList({limit:o,offset:a,groupBaseInfoFilter:s,groupList:r,isCommunityRelay:!0})):i&&!l?(a=c,t._pagingGetGroupList({limit:o,offset:a,groupBaseInfoFilter:s,groupList:r,isCommunityRelay:!0})):En({groupList:r}):(a=c,t._pagingGetGroupList({limit:o,offset:a,groupBaseInfoFilter:s,groupList:r}))})).catch((function(e){return 10018===e.code?(Re.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(o)),o=50,t._pagingGetGroupList({limit:o,offset:a,groupBaseInfoFilter:s,groupList:r,isCommunityRelay:i})):i?(11e3===e.code&&Re.l("".concat(n," ok. community unavailable")),Tn({groupList:r})):kn(e)}))}},{key:"_pagingGetGroupListWithTopic",value:function(e){var t=this,n="".concat(this._n,"._pagingGetGroupListWithTopic"),i=e.limit,o=e.offset,a=e.groupBaseInfoFilter,s=e.groupList,r=Date.now();return this._grpM.req({P:jn.GET_GRP_LIST,data:{type:k.GRP_COMMUNITY,memberAccount:this._grpM.getMyUserID(),limit:i,offset:o,responseFilter:{groupBaseInfoFilter:a,selfInfoFilter:y(x)},isSupportTopic:1,needAppDefineData:1}}).then((function(e){var c=(e=e.data).groups,u=(e=e.totalCount,s.push.apply(s,y(void 0===c?[]:c)),!((c=o+i)<e));return Re.l("".concat(n," ok. offset:").concat(o," limit:").concat(i," totalCount:").concat(e," isCompleted:").concat(u," currentCount:").concat(s.length," cost:").concat(Yt(r))),u?(t._grpM.updateGroupMap(s),t._grpM.emitGroupListUpdate(!0,!1),En({groupList:e=t._grpM.getLocalGroupList().filter((function(e){return!0===e.isSupportTopic}))})):(o=c,t._pagingGetGroupListWithTopic({limit:i,offset:o,groupBaseInfoFilter:a,groupList:s}))})).catch((function(e){return 10018===e.code?(Re.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(i)),i=50,t._pagingGetGroupListWithTopic({limit:i,offset:o,groupBaseInfoFilter:a,groupList:s})):kn(e)}))}},{key:"_cacheGroupMessage",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:"_deleteCachedGroupMessage",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:"_notifyCachedGroupMessage",value:function(e,t){var n=this,i=this._cachedGroupMessageMap.get(e)||[];Re.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(e," groupType:").concat(t," count:").concat(i.length)),i.forEach((function(e){n.onNewMessage(e)})),this._deleteCachedGroupMessage(e)}},{key:"_cacheAndCompare",value:function(e){var t=e.groupID,n=e.event,i=e.item;e=e.groupType,Re.l("".concat(this._n,"._cacheAndCompare groupID:").concat(t," groupType:").concat(e)),this._cacheGroupMessage(t,{event:n,dataList:[i]}),n={groupID:t,type:e},e===k.GRP_AVCHATROOM?this._grpM.hasLocalGroup(t)?this._notifyCachedGroupMessage(t,e):this._grpM.setUnjoinedAVChatRoom(t):(this._grpM.updateGroupMap([n]),this._notifyCachedGroupMessage(t,e)),this._checkCountMap.has(t)||this._checkCountMap.set(t,0)}},{key:"_handleGroupAtInfoWithoutTopic",value:function(e,t){var n=this;e&&0!==t.length&&t.forEach((function(e){var t=e.groupID,i=(e=e.groupAtInfoList,[]);dt(e)||(e.forEach((function(e){i.push(f(f({},e),{},{groupID:t}))})),n._grpM.get(11).onNewGroupAtTips({dataList:i}))}))}},{key:"setPagingGroupCount",value:function(e){dt(e)||(this.PAGING_GRP_COUNT_LIMIT=parseInt(e,10))}},{key:"reset",value:function(){this.PAGING_GRP_COUNT_LIMIT=200,this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._pagingStatus=An,this._pagingGetCostList=[]}}]),Qi=a((function e(t){i(this,e),this._grpM=t,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(Oi.CLOUD_CONFIG,this._onCloudConfig,this)}),[{key:"_onCloudConfig",value:function(){var e=this._grpM.getCloudConfig("grp_attr_cache_time");dt(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach((function(e){e.localMainSequence=0}))}},{key:"isGroupAttributesUpdatedNotice",value:function(e){var t=e.to,n=(e=e.elements.newGroupProfile,!dt(e)&&!je(e.groupAttributeOption));return n&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:e.groupAttributeOption}),n}},{key:"_onGroupAttributesUpdated",value:function(e){var t,n=this,i=e.groupID,o=(e=e.groupAttributeOption).mainSequence,a=e.isWithChangedAttributeInfo,s=void 0===(s=e.groupAttributeList)?[]:s;e=e.operationType,Re.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(i," isWithChangedAttributeInfo:").concat(a," operationType:").concat(e)),dt(e)||(this._groupAttributesCopy=this._getCachedAttributes({groupID:i}),0!=(t=o-this._getLocalGroupAttributes(i).localMainSequence)&&(1===a&&1==t?(this._refreshCachedGroupAttributes({groupID:i,remoteMainSequence:o,groupAttributeList:s,operationType:e}),this._emitGroupAttributesUpdated(i)):this._hasLocalGroupAttributes(i)&&(a=this._getLocalGroupAttributes(i).avChatRoomKey,this._getGroupAttributes({groupID:i,avChatRoomKey:a}).then((function(){n._emitGroupAttributesUpdated(i)})))))}},{key:"initGroupAttributesCache",value:function(e){var t=e.groupID;e=void 0===(e=e.avChatRoomKey)?void 0:e,this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:e}),Re.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(t," avChatRoomKey:").concat(e))}},{key:"initGroupAttributes",value:function(e){var t=this,n=e.groupID,i=e.groupAttributes,o=(e=this._getLocalGroupAttributes(n)).remoteMainSequence,a=(e=e.avChatRoomKey,new ii("initGroupAttributes"));return a.setMessage("groupID:".concat(n," avChatRoomKey:").concat(e," mainSequence:").concat(o)),this._grpM.req({P:jn.SET_GRP_ATTR,data:{groupID:n,avChatRoomKey:e,mainSequence:o,groupAttributeList:this._transformGroupAttributes(i)}}).then((function(e){Re.l("".concat(t._n,".").concat("initGroupAttributes"," ok. groupID:").concat(n));var o=(e=e.data).mainSequence;return(e=y(e.groupAttributeList)).forEach((function(e){e.value=i[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:o,groupAttributeList:e,operationType:1}),t._emitGroupAttributesUpdated(n),a.end(),En({groupAttributes:i})})).catch((function(e){return a.setError(e).end(),kn(e)}))}},{key:"setGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupAttributes"),i=e.groupID,o=e.groupAttributes,a=(e=this._getLocalGroupAttributes(i)).remoteMainSequence,s=e.avChatRoomKey,r=e.attributes,c=((e=this._transformGroupAttributes(o)).forEach((function(e){var t=e.key;e.sequence=0,r.has(t)&&(e.sequence=r.get(t).sequence)})),new ii("setGroupAttributes"));return c.setMessage("groupID:".concat(i," groupAttributes:").concat(JSON.stringify(o))),Re.l("".concat(n,". groupID:").concat(i," mainSequence:").concat(a)),this._grpM.req({P:jn.MODIFY_GRP_ATTR,data:{groupID:i,avChatRoomKey:s,mainSequence:a,groupAttributeList:e}}).then((function(e){Re.l("".concat(n," ok."));var a=(e=e.data).mainSequence;return(e=y(e.groupAttributeList)).forEach((function(e){e.value=o[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:i}),t._refreshCachedGroupAttributes({groupID:i,remoteMainSequence:a,groupAttributeList:e,operationType:2}),t._emitGroupAttributesUpdated(i),c.end(),En({groupAttributes:o})})).catch((function(e){return c.setError(e).end(),kn(e)}))}},{key:"deleteGroupAttributes",value:function(e){var t=this,n=e.groupID,i=(e=void 0===(e=e.keyList)?[]:e,(r=this._getLocalGroupAttributes(n)).remoteMainSequence),o=r.avChatRoomKey,a=r.attributes,s=y(a.keys()),r=jn.CLEAR_GRP_ATTR,c=3,u=(o={groupID:n,avChatRoomKey:o,mainSequence:i},[]),l=(0<e.length&&(s=[],r=jn.DEL_GRP_ATTR,c=4,e.forEach((function(e){var t=0;a.has(e)&&(t=a.get(e).sequence,s.push(e)),u.push({key:e,sequence:t})})),o.groupAttributeList=u),new ii("deleteGroupAttributes"));return l.setMessage("groupID:".concat(n," mainSequence:").concat(i," keyList:").concat(e," proto:").concat(r)),this._grpM.req({P:r,data:o}).then((function(e){return Re.l("".concat(t._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(n)),e=e.data.mainSequence,t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:e,groupAttributeList:u,operationType:c}),t._emitGroupAttributesUpdated(n),l.end(),En({keyList:s})})).catch((function(e){return l.setError(e).end(),kn(e)}))}},{key:"getGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupAttributes"),i=e.groupID,o=(r=this._getLocalGroupAttributes(i)).avChatRoomKey,a=r.lastUpdateTime,s=r.localMainSequence,r=r.remoteMainSequence,c=new ii("getGroupAttributes");return c.setMessage("groupID:".concat(i," localMainSequence:").concat(s," remoteMainSequence:").concat(r," keyList:").concat(e.keyList)),Date.now()-a>=this.CACHE_EXPIRE_TIME||s<r?this._getGroupAttributes({groupID:i,avChatRoomKey:o}).then((function(o){return c.setMoreMessage("get attributes from remote. count:".concat(o.length)).end(),Re.l("".concat(n," from remote. groupID:").concat(i)),En({groupAttributes:o=t._getCachedAttributes(e)})})).catch((function(e){return c.setError(e).end(),kn(e)})):(c.setMoreMessage("get attributes from cache").end(),Re.l("".concat(n," from cache. groupID:").concat(i)),Tn({groupAttributes:a=this._getCachedAttributes(e)}))}},{key:"_getGroupAttributes",value:function(e){var t=this,n=0;return dt(e.avChatRoomKey)||(n=1),this._grpM.req({P:jn.GET_GRP_ATTR,data:f(f({},e),{},{groupType:n})}).then((function(n){Re.l("".concat(t._n,"._getGroupAttributes ok. groupID:").concat(e.groupID));var i=(n=n.data).mainSequence,o=y(n=n.groupAttributeList);return dt(i)||t._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:i,groupAttributeList:o,operationType:5}),n})).catch((function(e){return kn(e)}))}},{key:"_refreshCachedGroupAttributes",value:function(e){var t=e.groupID,n=e.remoteMainSequence,i=e.groupAttributeList;if(e=e.operationType,this._hasLocalGroupAttributes(t)){var o=this._getLocalGroupAttributes(t),a=o.localMainSequence;if(5===e||n-a==1)o.remoteMainSequence=n,o.localMainSequence=n,o.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:o,groupAttributeList:i,operationType:e});else{if(a===n)return;o.remoteMainSequence=n}this._groupAttributesMap.set(t,o),i="operationType:".concat(e," localMainSequence:").concat(a," remoteMainSequence:").concat(n),Re.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(i))}}},{key:"_getCachedAttributes",value:function(e){var t=e.groupID,n=(e=void 0===(e=e.keyList)?[]:e,{});if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t).attributes;if(0<e.length)e.forEach((function(e){i.has(e)&&(n[e]=i.get(e).value)}));else{var o,a=s(i.keys());try{for(a.s();!(o=a.n()).done;){var r=o.value;n[r]=i.get(r).value}}catch(c){a.e(c)}finally{a.f()}}}return n}},{key:"_updateCachedAttributes",value:function(e){var t=e.groupAttributes,n=e.groupAttributeList;3!==(e=e.operationType)?4!==e?(1===e&&t.attributes.clear(),n.forEach((function(e){var n=e.key,i=e.value;e=e.sequence,t.attributes.set(n,{value:i,sequence:e})}))):n.forEach((function(e){t.attributes.delete(e.key)})):t.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(e){return this._groupAttributesMap.has(e)}},{key:"_getLocalGroupAttributes",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:"_transformGroupAttributes",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_emitGroupAttributesUpdated",value:function(e){var t=this._getCachedAttributes({groupID:e}),n=(i=this._computeAttrChangedInfo(t)).updatedKeyList,i=i.deletedKeyList;Re.l("".concat(this._n,"._emitGroupAttributesUpdated update:").concat(n.length,", delete:").concat(i.length)),0===n.length&&0===i.length||this._grpM.emitOEvt(T.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t,updatedKeyList:n,deletedKeyList:i})}},{key:"_computeAttrChangedInfo",value:function(e){var t=this,n=[],i=[];return Object.keys(e).forEach((function(i){e[i]!==t._groupAttributesCopy[i]&&n.push(i)})),Object.keys(this._groupAttributesCopy).forEach((function(t){dt(e[t])&&i.push(t)})),this._groupAttributesCopy={},{updatedKeyList:n,deletedKeyList:i}}},{key:"deleteLocalGroupAttributes",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),eo=a((function e(t){i(this,e),this._grpM=t,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(Oi.CLOUD_CONFIG,this._onCloudConfig,this)}),[{key:"_onCloudConfig",value:function(){var e=this._grpM.getCloudConfig("grp_counter_expire_time");dt(e)||(this.EXPIRE_TIME=Number(e))}},{key:"isGroupCountersNotice",value:function(e){var t=e.to,n=!1;return je(e=e.elements.groupCounterInfo)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:e}),n=!0),n}},{key:"_onGroupCountersUpdated",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach((function(e){var i=e.type,o=e.groupCounterSeq;e=void 0===(e=e.counterList)?[]:e,0!==i&&2!==i||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:o,counterList:e}),e.forEach((function(e){t._grpM.emitOEvt(T.GROUP_COUNTER_UPDATED,{groupID:n,key:e.key,value:e.value})}))),1===i&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:o,counterList:e})})),Re.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(n))}},{key:"initGroupCountersCache",value:function(e){var t=e.groupID;e=e.avChatRoomKey,this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:e}),Re.l("".concat(this._n,".initGroupCountersCache groupID:").concat(t," avChatRoomKey:").concat(e))}},{key:"setGroupCounters",value:function(e){var t,n,i,o,a;return this._grpM.canIUse(P.GRP_COUNTER)?(t="".concat(this._n,".").concat("setGroupCounters"),n=e.groupID,e=e.counters,e=this._convertObjectToList(e),i=this._getLocalGroupCounters(n).avChatRoomKey,o="groupID:".concat(n," count:").concat(e.length),(a=new ii("setGroupCounters")).setMessage("".concat(o)),Re.l("".concat(t,". ").concat(o)),this._updateGroupCounters({groupID:n,counterList:e,avChatRoomKey:i,mode:"Set"}).then((function(e){return a.end(),Re.l("".concat(t," ok.")),En({counters:e})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._grpM.noUse("setGroupCounters")}},{key:"increaseGroupCounter",value:function(e){var t,n,i,o,a,s,r="increaseGroupCounter";return this._grpM.canIUse(P.GRP_COUNTER)?(t="".concat(this._n,".").concat(r),n=e.groupID,i=e.key,e=e.value,o=this._getLocalGroupCounters(n).avChatRoomKey,a="groupID:".concat(n," key:").concat(i," value:").concat(e),(s=new ii(r)).setMessage("".concat(a)),Re.l("".concat(t,". ").concat(a)),this._updateGroupCounters({groupID:n,counterList:[{key:i,value:e}],avChatRoomKey:o,mode:"Increase"}).then((function(e){return s.end(),Re.l("".concat(t," ok.")),En({counters:e})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._grpM.noUse(r)}},{key:"decreaseGroupCounter",value:function(e){var t,n,i,o,a,s,r="decreaseGroupCounter";return this._grpM.canIUse(P.GRP_COUNTER)?(t="".concat(this._n,".").concat(r),n=e.groupID,i=e.key,e=e.value,o=this._getLocalGroupCounters(n).avChatRoomKey,a="groupID:".concat(n," key:").concat(i," value:").concat(e),(s=new ii(r)).setMessage("".concat(a)),Re.l("".concat(t,". ").concat(a)),this._updateGroupCounters({groupID:n,counterList:[{key:i,value:e}],avChatRoomKey:o,mode:"Decrease"}).then((function(e){return s.end(),Re.l("".concat(t," ok.")),En({counters:e})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._grpM.noUse(r)}},{key:"getGroupCounters",value:function(e){var t=this;if(!this._grpM.canIUse(P.GRP_COUNTER))return this._grpM.noUse("getGroupCounters");var n="".concat(this._n,".").concat("getGroupCounters"),i=e.groupID,o=void 0===(e=e.keyList)?[]:e,a=(e=this._getLocalGroupCounters(i)).avChatRoomKey,s=(e=e.lastUpdateTime,new ii("getGroupCounters"));return s.setMessage("groupID:".concat(i)),Date.now()-e>=this.EXPIRE_TIME?this._getRemoteGroupCounters({groupID:i,avChatRoomKey:a}).then((function(e){return s.setMoreMessage("from remote. count:".concat(e.length)).end(),Re.l("".concat(n," from remote. groupID:").concat(i)),En({counters:e=t._getLocalCounters(i,o)})})).catch((function(e){return s.setError(e).end(),kn(e)})):(s.setMoreMessage("from cache").end(),Re.l("".concat(n," from cache. groupID:").concat(i)),Tn({counters:e=this._getLocalCounters(i,o)}))}},{key:"_getRemoteGroupCounters",value:function(e){var t=this;return this._grpM.req({P:jn.GET_GRP_COUNTER,data:f({},e)}).then((function(n){var i=void 0===(i=(n=n.data).counterList)?[]:i;return n=n.groupCounterSeq,t._updateLocalGroupCounters({groupID:e.groupID,counterList:i,groupCounterSeq:n}),Re.l("".concat(t._n,"._getRemoteGroupCounters ok. groupID:").concat(e.groupID)),i})).catch((function(e){return kn(e)}))}},{key:"_convertObjectToList",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_updateGroupCounters",value:function(e){var t="".concat(this._n,"._updateGroupCounters"),n=e.groupID,i=e.avChatRoomKey,o=e.mode;return Re.l("".concat(t,". groupID:").concat(n," avChatRoomKey:").concat(i," mode:").concat(o)),this._grpM.req({P:jn.UPDATE_GRP_COUNTER,data:f({},e)}).then((function(e){Re.l("".concat(t," ok.")),e=e.data.counterList;var n={};return(void 0===e?[]:e).forEach((function(e){var t=e.key;e=e.value,n[t]=e})),n})).catch((function(e){return kn(e)}))}},{key:"_hasLocalGroupCounters",value:function(e){return this._groupCountersMap.has(e)}},{key:"_getLocalGroupCounters",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:"_updateLocalGroupCounters",value:function(e){var t,n,i,o=e.groupID,a=void 0===(a=e.counterList)?[]:a;e=e.groupCounterSeq,this._hasLocalGroupCounters(o)&&(i=this._getLocalGroupCounters(o),t=i.counters,n=i.avChatRoomKey,i=i.groupCounterSeq,0<e&&e<i||(a.forEach((function(e){var n=e.key;e=e.value,t.set(n,e)})),this._groupCountersMap.set(o,{lastUpdateTime:Date.now(),groupCounterSeq:e,counters:t,avChatRoomKey:n})))}},{key:"_deleteLocalGroupCounters",value:function(e){var t,n,i=e.groupID,o=void 0===(o=e.counterList)?[]:o;e=e.groupCounterSeq,this._hasLocalGroupCounters(i)&&(n=this._getLocalGroupCounters(i),t=n.counters,n=n.avChatRoomKey,o.forEach((function(e){t.delete(e.key)})),this._groupCountersMap.set(i,{lastUpdateTime:Date.now(),groupCounterSeq:e,counters:t,avChatRoomKey:n}))}},{key:"_getLocalCounters",value:function(e,t){var n={};if(this._hasLocalGroupCounters(e)){var i=this._getLocalGroupCounters(e).counters;if(0<t.length)t.forEach((function(e){i.has(e)&&(n[e]=i.get(e))}));else{var o,a=s(i.keys());try{for(a.s();!(o=a.n()).done;){var r=o.value;n[r]=i.get(r)}}catch(c){a.e(c)}finally{a.f()}}}return n}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),to=a((function e(t){i(this,e);var n=t.manager,o=t.groupID,a=t.onInit,s=t.onSuccess;t=t.onFail,this._n="Polling",this._manager=n,this._grpM=n._grpM,this._onInit=a,this._onSuccess=s,this._onFail=t,this._groupID=o,this._timeoutID=-1,this._isRunning=!1,this._proto=jn.AV_POLLING}),[{key:"start",value:function(){var e=this._grpM.isLoggedIn();e||(this._proto=jn.AV_NOAUTH_POLLING),Re.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(e)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var e=this,t=this._onInit(this._groupID);this._grpM.req({P:this._proto,data:t}).then((function(t){e._onSuccess(e._groupID,t),e.isRunning()&&(-1<e._timeoutID&&clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))})).catch((function(t){e._onFail(e._groupID,t),e.isRunning()&&(-1<e._timeoutID&&clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))}))}},{key:"stop",value:function(){Re.l("".concat(this._n,".stop")),-1<this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:"getPollingTimerID",value:function(){return this._timeoutID}}]),no={3:!0,4:!0,5:!0,6:!0,17:!0,20:!0,21:!0,100:!0},io=a((function e(t){i(this,e),this._grpM=t,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this._seqSll=new qi(200),this._IDSll=new qi(100),this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0}),[{key:"hasJoinedAVChatRoom",value:function(){var e=[];return 0<(e=0<this._joinedGroupMap.size?y(this._joinedGroupMap.values()).filter((function(e){return e.type===k.GRP_AVCHATROOM})):e).length}},{key:"getJoinedLiveList",value:function(){var e=[];return 0<this._joinedGroupMap.size?y(this._joinedGroupMap.values()).filter((function(e){return e.type===k.GRP_LIVE})):e}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._joinedGroupMap.has(e)}},{key:"getJoinedAVChatRoom",value:function(){return 0<this._joinedGroupMap.size?y(this._joinedGroupMap.keys()):[]}},{key:"_updatedata",value:function(e){var t=this._pollingRequestInfoMap.get(e);return e===y(this._pollingInstanceMap.keys())[0]?f(f({},t),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):f(f({},t),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:"_handleSuccess",value:function(e,t){var n,i=(c=t.data).key,o=c.nextSeq,a=c.rspMsgList,s=c.errorCode,r=c.nextBroadcastSeq,c=c.broadcastMessageList;0!==s?(s=this._pollingRequestInfoMap.get(e),n=new ii("longPollingAVError"),s=s?"".concat(s.key,"-").concat(s.startSeq):"requestInfo is undefined",n.setMessage("".concat(e,"-").concat(s,"-").concat(t.errorInfo)).setCode(t.errorCode).end(!0)):this.checkJoinedAVChatRoomByID(e)&&(lt(i)&&ze(o)&&this._pollingRequestInfoMap.set(e,{key:i,startSeq:o}),ze(r)&&r>this._startBroadcastSeq&&(this._startBroadcastSeq=r),We(a)&&0<a.length?(a.forEach((function(e){e.to=e.groupID})),this.onMessage(a,e)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(c))}},{key:"_handleFailure",value:function(e,t){}},{key:"onMessage",value:function(e,t){if(We(e)&&0!==e.length){var n="".concat(this._n,".onMessage"),i=(t&&(n+=" groupID:".concat(t)),0!==this._pollingNoMessageCount&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL),null),o=[],a=this._get(11),s=this._get(26),r=e.length,c=(1<r&&e.sort((function(e,t){return e.sequence-t.sequence})),this._get(12).isUnlimitedAVChatRoom()),u=!1;Re.getLevel()<=0&&(t=e.map((function(e){return e.sequence})),Re.l("".concat(n," count:").concat(t.length," sequenceList:").concat(t)),t.length=0);for(var l=0;l<r;l++){var d=this.restoreMessageFromSimplified(e[l]);if(no[d.event]){if(6===d.event){if(this._grpM.isGroupAttributesUpdatedNotice(d))continue;if(this._grpM.isGroupCountersNotice(d))continue}if(20!==d.event)if(21!==d.event)if(100!==d.event){i=this.packMessage(d,d.event);var h=1===d.isModified;if(u=1===d.isHistoryMessage,!c){if(this._seqSll.has(i.sequence))continue;this._seqSll.set(i.sequence)}var p=this._IDSll.has(i.ID);p?Re.w("".concat(n," ID:").concat(i.ID," has:").concat(p)):(this._IDSll.set(i.ID),p=!1,!u&&this._isMessageSentByCurrentInstance(i)?h&&(p=!0,i.isModified=h,a.updateMsgIsModifiedProp(i)):p=!0,p&&(i.conversationType===k.CONV_SYSTEM&&5===i.payload.operationType&&this._onGroupDismissed(i.payload.groupProfile.groupID),u||i.conversationType===k.CONV_SYSTEM||(h=i.conversationID.replace(k.CONV_GROUP,""),this._pollingInstanceMap.has(h)?this._grpM.isLoggedIn()&&s.addMessageSequence({key:Zn,message:i}):(i.type!==k.MSG_GRP_TIP&&0<i.clientTime&&s.addMessageDelay(i.clientTime),s.addMessageSequence({key:Xn,message:i}))),o.push(i)))}else this.onRoomCustomData(d);else this._get(34).onMessageReactionNotify({event:21,dataList:d.elements.messageReactionNotifyList});else this.handleMessageRevokedNotice(d)}else Re.w("".concat(n,". unknown event:").concat(d.event))}0!==o.length&&(0<(t=yt(o)).length&&this._grpM.emitOEvt(T.MESSAGE_MODIFIED,t),u||0<(t=this.packConversationOption(o)).length&&a.onNewMessage({conversationOptionsList:t,isInstantMessage:!0}),this._checkMessageStacked(o),0<(t=Mt(o)).length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t),o.length=0)}}},{key:"handleMessageRevokedNotice",value:function(e){var t=this,n=e.groupID,i=e.elements.revokeMsgList,o=e.revokerInfo,a=[];i.forEach((function(e){var t=e.tinyID,i=e.clientTime,s=e.random;e=e.sequence,t={conversationID:"".concat(k.CONV_GROUP).concat(n),ID:"".concat(t,"-").concat(i,"-").concat(s),revoker:o.revoker,revokeReason:o.reason||"",revokerInfo:{userID:o.revoker,nick:"",avatar:""},sequence:e},a.push(t)})),0!==a.length&&this._get(11).updateRevokerInfo(a).then((function(e){t._grpM.emitOEvt(T.MESSAGE_REVOKED,e)}))}},{key:"isBroadcastOrNormal",value:function(e){return 3===e||17===e}},{key:"isGroupTip",value:function(e){return 4===e||6===e}},{key:"isGroupSystemNotice",value:function(e){return 5===e}},{key:"restoreGroupTipElements",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=e.operatorInfo)?{}:t,n=e.operatorID,i=void 0===(i=e.userIDList)?[]:i,o=e.operationType,a=(ze(e.groupJoinType)||1!==o&&2!==o||(e.groupJoinType=2===o?0:1),o=t.userID,t.avatar);return t=t.nick,e.operatorInfo={userID:void 0===o?n:o,avatar:void 0===a?"":a,nick:void 0===t?"":t},n=i.map((function(e){return{userID:e}})),e.memberInfoList=e.memberInfoList||n,e}},{key:"restoreMessageFromSimplified",value:function(e){var t,n,i,o=e.event;return this.isBroadcastOrNormal(o)&&(e.cloudCustomData=e.cloudCustomData||"",e.elements=e.elements.map((function(e){var t;return e.type===k.MSG_CUSTOM&&(t=e.content,e.content=f({data:"",description:"",extension:""},void 0===t?{}:t)),e}))),(this.isGroupTip(o)||this.isGroupSystemNotice(o))&&(e.from=e.from||"@TIM#SYSTEM"),this.isGroupTip(o)&&(e.elements=this.restoreGroupTipElements(e.elements),n=(i=void 0===(i=e.elements)?{}:i).operationType,t=i.operatorInfo,1===n)&&(n=[{userID:(void 0===t?{}:t).userID}],i.memberInfoList=i.memberInfoList||n),this.isGroupSystemNotice(o)&&(i=(t=e.elements).memberInfoList,n=t.operatorInfo,e.elements.memberInfoList=f({userID:e.elements.operatorID,avatar:"",nick:""},i=i||(void 0===n?{}:n)),e.elements=f({authentication:"",remarkInfo:"",messageKey:1e3*e.time},e.elements),o=Object.keys(e.elements).filter((function(e){return"operatorInfo"!==e})).reduce((function(t,n){return f(f({},t),{},r({},n,e.elements[n]))}),{}),e.elements=o),e}},{key:"_onGroupDismissed",value:function(e){Re.l("".concat(this._n,"._onGroupDismissed groupID:").concat(e)),this._grpM.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"_checkMessageStacked",value:function(e){var t="MessageStacked";100<=(e=e.length)&&(this._grpM.warn(t,e),this._reportMessageStackedCount<5)&&(new ii(t).setMessage("count:".concat(e," groupID:").concat(y(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1)}},{key:"_isMessageSentByCurrentInstance",value:function(e){return!!this._get(11).isMessageSentByCurrentInstance(e)}},{key:"packMessage",value:function(e,t){e.currentUser=this._grpM.getMyUserID(),e.conversationType=5===t?k.CONV_SYSTEM:k.CONV_GROUP,e.isSystemMessage=!!e.isSystemMessage;var n=new ki(e),i=(e=this.packElements(e,t),t=this._grpM.getFileDownloadProxy(),this._grpM.getDownloadFileAuthKey()),o=this._get(17).getFileDNList();return n.setElement(e,t,i,o),n}},{key:"packElements",value:function(e,t){return 4===t||6===t?(this._updateMemberCountByGroupTips(e),{type:k.MSG_GRP_TIP,content:f(f({},e.elements),{},{groupProfile:e.groupProfile})}):5===t?{type:k.MSG_GRP_SYS_NOTICE,content:f(f({},e.elements),{},{groupProfile:f(f({},e.groupProfile),{},{groupID:e.groupID})})}:e.elements}},{key:"packConversationOption",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var i,o=e[n],a=o.conversationID;t.has(a)?"in"===((i=t.get(a)).lastMessage=o).flow&&i.unreadCount++:t.set(a,{conversationID:o.conversationID,unreadCount:"out"===o.flow?0:1,type:o.conversationType,subType:o.conversationSubType,lastMessage:o})}return y(t.values())}},{key:"_updateMemberCountByGroupTips",value:function(e){var t,n,i,o=e.groupProfile.groupID;je(e=void 0===(e=e.elements.onlineMemberInfo)?void 0:e)||(t=void 0===(t=e.onlineMemberNum)?0:t,e=void 0===(e=e.expireTime)?this.DEFAULT_EXPIRE_TIME:e,n=this._onlineMemberCountMap.get(o)||{},i=Date.now(),je(n)?Object.assign(n,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:i,memberCount:t,expireTime:e}):(n.latestUpdateTime=i,n.memberCount=t),this._onlineMemberCountMap.set(o,n))}},{key:"_onBroadcastMessage",value:function(e){if(!je(e)){for(var t=[],n=e.length,i=null,o=0;o<n;o++){var a=this.restoreMessageFromSimplified(e[o]);no[a.event]?((i=this.packMessage(a,a.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(i.ID)||(t.push(i),this._broadcastMessageIDMap.set(i.ID,1))):Re.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(a.event))}0<t.length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t)}}},{key:"start",value:function(e){var t;this._pollingInstanceMap.has(e)?(t=this._pollingInstanceMap.get(e)).isRunning()||t.start():((t=new to({manager:this,groupID:e,onInit:this._updatedata.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)})).start(),this._pollingInstanceMap.set(e,t),Re.l("".concat(this._n,".start groupID:").concat(e)))}},{key:"handleJoinResult",value:function(e){var t=this;return this._preCheck(e.group).then((function(){var n=e.longPollingKey,i=e.group,o=i.groupID;return t._joinedGroupMap.set(o,i),t._grpM.updateGroupMap([i]),t._grpM.deleteUnjoinedAVChatRoom(o),t._grpM.emitGroupListUpdate(!0,!1),dt(n)?Tn({status:xe,group:i}):Promise.resolve()}))}},{key:"startRunLoop",value:function(e){var t=this;return this.handleJoinResult(e).then((function(){var n=e.longPollingKey,i=e.group,o=e.startSeq,a=i.groupID;return t._pollingRequestInfoMap.set(a,{key:n,startSeq:void 0===o?0:o}),t.start(a),t._grpM.isLoggedIn()?Tn({status:xe,group:i}):Tn({status:xe})}))}},{key:"_preCheck",value:function(e){if(!this._get(12).isUnlimitedAVChatRoom()&&this.hasJoinedAVChatRoom()&&e.type!==k.GRP_LIVE){var t=(e=v(this._joinedGroupMap.entries().next().value,2))[0];if(e=e[1],this._grpM.isLoggedIn()&&e.selfInfo.role!==k.GRP_MBR_ROLE_OWNER&&e.ownerID!==this._grpM.getMyUserID())return this._grpM.quitGroup(t);this._grpM.deleteLocalGroupAndConversation(t),this.reset(t)}return Promise.resolve()}},{key:"joinWithoutAuth",value:function(e){var t=this,n=e.groupID,i="".concat(this._n,".").concat("joinWithoutAuth"),o=new ii("joinWithoutAuth");return this._grpM.req({P:jn.APPLY_JOIN_GRP_NOAUTH,data:e}).then((function(e){if(e=e.data.longPollingKey,o.setMessage("groupID:".concat(n," longPollingKey:").concat(e)).end(!0),dt(e))return kn({code:Bn.CANNOT_JOIN_NON_AV_WITHOUT_LOGIN});Re.l("".concat(i," ok. groupID:").concat(n)),t._get(11).setCompleted("".concat(k.CONV_GROUP).concat(n));var a=new Ki({groupID:n});return t.startRunLoop({group:a,longPollingKey:e}),En({status:xe})})).catch((function(e){return Re.e("".concat(i," failed. groupID:").concat(n," error:"),e),o.setError(e).setMessage("groupID:".concat(n)).end(!0),kn(e)})).finally((function(){t._grpM.get(14).reportAtOnce()}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return je(t)||n-t.lastSyncTime>1e3*t.expireTime&&1e4<n-t.latestUpdateTime&&3e3<n-t.lastReqTime?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then((function(e){return En({memberCount:e.memberCount})})).catch((function(e){return kn(e)}))):Tn({memberCount:t.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".").concat("_getGroupOnlineMemberCount"),i=new ii("_getGroupOnlineMemberCount");return this._grpM.requestOnlineCount(e).then((function(i){var o=t._onlineMemberCountMap.get(e)||{},a=void 0===(a=(i=i.data).memberCount)?0:a,s=(i=void 0===(i=i.expireTime)?t.DEFAULT_EXPIRE_TIME:i,Re.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(a," expireTime:").concat(i)),Date.now());return je(o)&&(o.lastReqTime=s),t._onlineMemberCountMap.set(e,Object.assign(o,{lastSyncTime:s,latestUpdateTime:s,memberCount:a,expireTime:i})),{memberCount:a}})).catch((function(t){return Re.w("".concat(n," failed. error:"),t),i.setCode(t.code).setMessage("groupID:".concat(e," error:").concat(JSON.stringify(t))).end(),Promise.reject(t)}))}},{key:"_get",value:function(e){return this._grpM.get(e)}},{key:"setPollingInterval",value:function(e){dt(e)||(ze(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:"setPollingIntervalPlus",value:function(e){dt(e)||(ze(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:"setPollingNoMessageCount",value:function(e){dt(e)||(ze(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:"setPollingSimplifiedMessage",value:function(e){dt(e)||"0"!==e&&"1"!==e||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(e,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(e){e=e.payload.groupProfile.groupID,Re.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(e)),this._grpM.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"restartPolling",value:function(){Re.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var e,t=s(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(i){t.e(i)}finally{t.f()}}},{key:"getPollingTimerID",value:function(e){var t;return this._pollingInstanceMap.has(e)?(t=this._pollingInstanceMap.get(e).getPollingTimerID(),Re.l("".concat(this._n,".getPollingTimerID groupID:").concat(e," timerID:").concat(t)),t):-1}},{key:"hasPollingInstance",value:function(e){return this._pollingInstanceMap.has(e)}},{key:"onRoomCustomData",value:function(e){var t=e.groupID,n=e.sequence,i=e.time;e=(e=e.elements)&&e.content,this._get(30).onRoomCustomDataReceived(e),Re.l("".concat(this._n,".onRoomCustomData groupID:").concat(t," sequence:").concat(n," time:").concat(i," data:").concat(e))}},{key:"reset",value:function(e){if(e){Re.l("".concat(this._n,".reset groupID:").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{Re.l("".concat(this._n,".reset all"));var n,i=s(this._pollingInstanceMap.values());try{for(i.s();!(n=i.n()).done;)n.value.stop()}catch(o){i.e(o)}finally{i.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this._seqSll.reset(),this._IDSll.reset(),this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),oo=a((function e(t){i(this,e),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this.isOnline=!1,this.updateMember(t)}),[{key:"updateMember",value:function(e){dt(e.onlineStatus)||(this.isOnline="Online"===e.onlineStatus);var t=[null,void 0,"",0,NaN];e.memberCustomField&&vt(this.memberCustomField,e.memberCustomField),et(this,e,["memberCustomField","marks","onlineStatus"],t)}},{key:"updateRole",value:function(e){["Owner","Admin","Member"].indexOf(e)<0||(this.role=e)}},{key:"updateMuteUntil",value:function(e){dt(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:"updateNameCard",value:function(e){dt(e)||(this.nameCard=e)}},{key:"updateMemberCustomField",value:function(e){e&&vt(this.memberCustomField,e)}}]),ao=a((function e(t){i(this,e),this._grpM=t,this._n="GroupMemberHandler",this.groupMemberListMap=new Map,this.DEFAULT_MEMBER_INFO_FILTER=["Role","JoinTime","NameCard","ShutUpUntil","OnlineStatus"],this._grpM.getIEmitInst().on(Oi.PROFILE_UPDATED,this._onProfileUpdated,this)}),[{key:"_onProfileUpdated",value:function(e){for(var t=this,n=e.data,i=0;i<n.length;i++)!function(){var e=n[i];t.groupMemberListMap.forEach((function(t){t.has(e.userID)&&t.get(e.userID).updateMember({nick:e.nick,avatar:e.avatar})}))}()}},{key:"deleteGroupMemberList",value:function(e){this.groupMemberListMap.delete(e)}},{key:"getGroupMemberList",value:function(e){var t,n=this,i=e.groupID,o=void 0===(o=e.role)?void 0:o,a=void 0===(c=e.offset)?0:c,s=void 0===(c=e.count)?15:c,r=(e=void 0===(c=e.filter)?void 0:c,"".concat(this._n,".").concat("getGroupMemberList")),c=this._grpM.hasLocalGroup(i);if(Re.l("".concat(r," groupID:").concat(i," role:").concat(o," offset:").concat(a," count:").concat(s," hasLocalGroup:").concat(c)),!c)return Tn({memberList:[],offset:0});if(this._grpM.getLocalGroupProfile(i).type===k.GRP_AVCHATROOM){if(this._grpM.canIUse(P.AV_MBR_LIST))return this._getAVChatRoomMemberList({groupID:i,offset:a,filter:e});this._grpM.warn("LiveOnlineMember")}o!==k.GRP_MBR_ROLE_ADMIN&&o!==k.GRP_MBR_ROLE_OWNER&&o!==k.GRP_MBR_ROLE_MEMBER||(t=o);var u=new ii("getGroupMemberList"),l=0,d=(c={groupID:i,limit:100<s?100:s,memberRoleFilter:t?[t]:void 0,memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER},Et({groupID:i})?c.next="".concat(a):l=(c.offset=a)+s,[]);return this._grpM.req({P:jn.GET_GRP_MBR_LIST,data:c}).then((function(e){var t=(e=e.data).members,o=e.memberNum;return e=e.next,dt(e=void 0===e?void 0:e)||(l=je(e)?0:e),We(t)&&0!==t.length?(n._grpM.hasLocalGroup(i)&&(n._grpM.getLocalGroupProfile(i).memberNum=o),d=n._updateLocalGroupMemberMap(i,t),n._grpM.get(4).getUserProfile({userIDList:t.map((function(e){return e.userID})),tagList:[Oe.NICK,Oe.AVATAR]})):(l=0,Promise.resolve([]))})).then((function(e){return We(e=e.data)&&0!==e.length?(e=e.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}})),n._updateLocalGroupMemberMap(i,e),d.length<s&&(l=0),u.setMessage("groupID:".concat(i," offset:").concat(a," count:").concat(s)).end(),Re.l("".concat(r," ok.")),En({memberList:d,offset:l})):Tn({memberList:[],offset:l})})).catch((function(e){return u.setError(e).end(),Re.e("".concat(r," failed. error:"),e),kn(e)}))}},{key:"_getAVChatRoomMemberList",value:function(e){var t=this,n=e.groupID,i=e.offset,o=(e=e.filter,"".concat(this._n,".").concat("_getAVChatRoomMemberList")),a=new ii("_getAVChatRoomMemberList");return a.setMessage("groupID:".concat(n," offset:").concat(i," filter:").concat(e)),this._grpM.req({P:jn.GET_AV_MBR_LIST,data:{groupID:n,offset:i,filter:e}}).then((function(e){var i=void 0===(i=(e=e.data).memberList)?[]:i;return e=void 0===(e=e.offset)?0:e,a.end(),Re.l("".concat(o," ok. member count:").concat(i.length,", next request timestamp:").concat(e)),i=i.map((function(e){return f(f({},e),{},{onlineStatus:"Online"})})),En({memberList:i=t._updateLocalGroupMemberMap(n,i),offset:e})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)}))}},{key:"getGroupMemberProfile",value:function(e){var t,n=this,i="getGroupMemberProfile",o="".concat(this._n,".").concat(i),a="groupID:".concat(e.groupID),s=(5<e.userIDList.length?a+=" userIDList.length:".concat(e.userIDList.length):a+=" userIDList:".concat(e.userIDList),Re.l("".concat(o," ").concat(a)),50<e.userIDList.length&&(e.userIDList=e.userIDList.slice(0,50)),e.groupID),r=e.userIDList;return(o=this._grpM.getLocalGroupProfile(s))&&Ct(o.type)?kn({code:o=Bn.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(o,i)}):((t=new ii(i)).setMessage(a),this._getGroupMemberProfileAdvance(f(f({},e),{},{userIDList:r})).then((function(e){return We(e=e.data.members)&&0!==e.length?(n._updateLocalGroupMemberMap(s,e),n._grpM.get(4).getUserProfile({userIDList:e.map((function(e){return e.userID})),tagList:[Oe.NICK,Oe.AVATAR]})):Tn([])})).then((function(e){return e=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}})),n._updateLocalGroupMemberMap(s,e),e=r.filter((function(e){return n.hasLocalGroupMember(s,e)})).map((function(e){return n.getLocalGroupMemberInfo(s,e)})),t.end(),En({memberList:e})})))}},{key:"addGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("addGroupMember"),i=e.groupID,o=this._grpM.getLocalGroupProfile(i),a=o.type,s=new ii("addGroupMember");return s.setMessage("groupID:".concat(i," groupType:").concat(a)),Ct(a)?(a=new Fn({code:Bn.CANNOT_ADD_MEMBER_IN_AV}),s.setError(a).end(),kn(a)):(e.userIDList=e.userIDList.map((function(e){return{userID:e}})),Re.l("".concat(n," groupID:").concat(i)),this._grpM.req({P:jn.ADD_GRP_MBR,data:e}).then((function(i){i=i.data.members;var a=(Re.l("".concat(n," ok")),i.filter((function(e){return 1===e.result})).map((function(e){return e.userID}))),r=i.filter((function(e){return 0===e.result})).map((function(e){return e.userID})),c=i.filter((function(e){return 2===e.result})).map((function(e){return e.userID})),u=(i=i.filter((function(e){return 4===e.result})).map((function(e){return e.userID})),"groupID:".concat(e.groupID,", ")+"successUserIDList:".concat(a,", ")+"failureUserIDList:".concat(r,", ")+"existedUserIDList:".concat(c,", ")+"overLimitUserIDList:".concat(i));return s.setMoreMessage(u).end(),0===a.length?En({successUserIDList:a,failureUserIDList:r,existedUserIDList:c,overLimitUserIDList:i}):(t._updateConvGroupProfile(o),En({successUserIDList:a,failureUserIDList:r,existedUserIDList:c,overLimitUserIDList:i,group:o}))})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)})))}},{key:"deleteGroupMember",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("deleteGroupMember"),a=e.groupID,s=e.userIDList,r=this._grpM.getLocalGroupProfile(a);return dt(r)?kn({code:Bn.CANNOT_FIND_GRP}):Ct(r.type)?this._grpM.canIUse(P.AV_BAN_MBR)?this._banAVChatRoomMember(e):this._grpM.noUse("deleteGroupMember"):(t="groupID:".concat(a," ").concat(5<s.length?"userIDList.length:".concat(s.length):"userIDList:".concat(s)),Re.l("".concat(o," groupID:").concat(a," userIDList:"),s),(n=new ii("deleteGroupMember")).setMessage(t),this._grpM.req({P:jn.DEL_GRP_MBR,data:e}).then((function(){return n.end(),Re.l("".concat(o," ok")),i._updateConvGroupProfile(r),i.deleteLocalGroupMembers(a,s),En({group:r,userIDList:s})})).catch((function(e){return n.setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)})))}},{key:"_updateConvGroupProfile",value:function(e){this._grpM.get(11).updateConvGroupProfile([e])}},{key:"_banAVChatRoomMember",value:function(e){var t=this,n="".concat(this._n,".").concat("_banAVChatRoomMember"),i=e.groupID,o=e.userIDList,a="groupID:".concat(i," ").concat(5<o.length?"userIDList.length:".concat(o.length):"userIDList:".concat(o)),s=new ii("_banAVChatRoomMember"),r=(s.setMessage(a),Re.l("".concat(n," groupID:").concat(i," userIDList:"),o),this._grpM.getLocalGroupProfile(i));return dt(e.duration)||0===e.duration?kn({code:Bn.BAN_DURATION_INVALID}):this._grpM.req({P:jn.BAN_AV_MBR,data:e}).then((function(){return s.end(),Re.l("".concat(n," ok")),t.deleteLocalGroupMembers(i,o),En({group:r,userIDList:o})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"setGroupMemberMuteTime",value:function(e){var t,n,i=this,o=e.groupID,a=e.userID,s=(e=e.muteTime,"".concat(this._n,".").concat("setGroupMemberMuteTime"));return a===this._grpM.getMyUserID()?kn({code:Bn.CANNOT_MUTE_SELF}):(t="groupID:".concat(o," userID:").concat(a," muteTime:").concat(e),Re.l("".concat(s," ").concat(t)),(n=new ii("setGroupMemberMuteTime")).setMessage(t),this.modifyGroupMemberInfo({groupID:o,userID:a,muteTime:e}).then((function(e){return n.end(),Re.l("".concat(s," ok")),En({group:i._grpM.getLocalGroupProfile(o),member:e})})).catch((function(e){return n.setError(e).end(),Re.e("".concat(s," failed. error:"),e),kn(e)})))}},{key:"setGroupMemberRole",value:function(e){var t,n,i="".concat(this._n,".").concat("setGroupMemberRole"),o=e.groupID,a=e.userID,s=(e=e.role,"groupID:".concat(o," userID:").concat(a," role:").concat(e)),r=this._grpM.getLocalGroupProfile(o);return r&&r.selfInfo.role!==k.GRP_MBR_ROLE_OWNER?kn({code:Bn.NOT_OWNER}):(t=[k.GRP_MBR_ROLE_ADMIN,k.GRP_MBR_ROLE_MEMBER],Et({groupID:o})&&t.push(k.GRP_MBR_ROLE_CUSTOM),t.indexOf(e)<0?kn({code:Bn.INVALID_MEMBER_ROLE}):a===this._grpM.getMyUserID()?kn({code:Bn.CANNOT_SET_SELF_MEMBER_ROLE}):((n=new ii("setGroupMemberRole")).setMessage(s),Re.l("".concat(i," ").concat(s)),this.modifyGroupMemberInfo({groupID:o,userID:a,role:e}).then((function(e){return n.end(),Re.l("".concat(i," ok")),En({group:r,member:e})})).catch((function(e){return n.setError(e).end(),Re.e("".concat(i," failed. error:"),e),kn(e)}))))}},{key:"_filterProfanity",value:function(e,t){var n,i=this._grpM.get(29);return!i||(n=(i=i.filterText(t[e],"group_member_profile")).isAllowedToSend,i=i.modifiedText,!0===n&&(t[e]=i,!0))}},{key:"setGroupMemberNameCard",value:function(e){var t,n,i,o,a,s=this,r="setGroupMemberNameCard",c="".concat(this._n,".").concat(r);return e.nameCard&&!1===this._filterProfanity("nameCard",e)?kn({code:Bn.PROFANITY_FOUND}):(t=e.groupID,o=e.userID,n=void 0===o?this._grpM.getMyUserID():o,i=e.nameCard,o="groupID:".concat(t," userID:").concat(n," nameCard:").concat(i),Re.l("".concat(c," ").concat(o)),(e=this._grpM.getLocalGroupProfile(t))&&Ct(e.type)?kn({code:e=Bn.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(e,r)}):((a=new ii(r)).setMessage(o),this.modifyGroupMemberInfo({groupID:t,userID:n,nameCard:i}).then((function(e){Re.l("".concat(c," ok")),a.end();var o=s._grpM.getLocalGroupProfile(t);return n===s._grpM.getMyUserID()&&o&&o.setSelfNameCard(i),En({group:o,member:e})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(c," failed. error:"),e),kn(e)}))))}},{key:"setGroupMemberCustomField",value:function(e){var t,n=this,i="setGroupMemberCustomField",o="".concat(this._n,".").concat(i),a=e.groupID,s=void 0===(s=e.userID)?this._grpM.getMyUserID():s,r=(e=e.memberCustomField,"groupID:".concat(a," userID:").concat(s," memberCustomField:").concat(JSON.stringify(e))),c=(Re.l("".concat(o," ").concat(r)),this._grpM.getLocalGroupProfile(a));return c&&Ct(c.type)?kn({code:c=Bn.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(c,i)}):((t=new ii(i)).setMessage(r),this.modifyGroupMemberInfo({groupID:a,userID:s,memberCustomField:e}).then((function(e){return t.end(),Re.l("".concat(o," ok")),En({group:n._grpM.getLocalGroupProfile(a),member:e})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)})))}},{key:"modifyGroupMemberInfo",value:function(e){var t=this,n=e.groupID,i=e.userID,o=void 0;return Tt(n)&&(n=Ft(o=n)),this._grpM.req({P:jn.MODIFY_GRP_MBR_INFO,data:f(f({},e),{},{groupID:n,topicID:o})}).then((function(){var o;return t.hasLocalGroupMember(n,i)?(o=t.getLocalGroupMemberInfo(n,i),dt(e.muteTime)||o.updateMuteUntil(e.muteTime),dt(e.role)||o.updateRole(e.role),dt(e.nameCard)||o.updateNameCard(e.nameCard),dt(e.memberCustomField)||o.updateMemberCustomField(e.memberCustomField),o):(o=t._grpM.getLocalGroupProfile(n))&&!Ct(o.type)?t.getGroupMemberProfile({groupID:n,userIDList:[i]}).then((function(e){return v(e.data.memberList,1)[0]})):void 0}))}},{key:"markGroupMemberList",value:function(e){var t="".concat(this._n,".").concat("markGroupMemberList"),n=e.groupID,i=e.markType,o=e.enableMark,a=void 0===(e=e.userIDList)?[]:e,s=(e="groupID:".concat(n," markType:").concat(i," enableMark:").concat(o," userIDList count:").concat(a.length),Re.l("".concat(t," ").concat(e)),2),r=[],c=(!0===o&&(s=1),o=y(a),500<a.length&&(o=a.slice(0,500),Re.w("".concat(t," ").concat(Ht(500)))),o.forEach((function(e){r.push({userID:e,markType:[i]})})),o=null,new ii("markGroupMemberList"));return c.setMessage(e),this._grpM.req({P:jn.MARK_AV_MBR_INFO,data:{groupID:n,operationType:s,memberList:r}}).then((function(e){e=e.data.memberList;var n=[],i=[];return(e=void 0===e?[]:e).length===a.length?n.push.apply(n,y(a)):(e.forEach((function(e){n.push(e.userID)})),a.forEach((function(e){n.includes(e)||i.push(e)}))),e="success count:".concat(n.length," fail count:").concat(i.length),c.setMessage(e).end(),Re.l("".concat(t," ok. ").concat(e)),En({successUserIDList:n,failureUserIDList:i})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))}},{key:"_getGroupMemberProfileAdvance",value:function(e){return this._grpM.req({P:jn.GET_GRP_MBR_PROFILE,data:f(f({},e),{},{memberInfoFilter:e.memberInfoFilter||this.DEFAULT_MEMBER_INFO_FILTER})})}},{key:"_updateLocalGroupMemberMap",value:function(e,t){var n=this;return We(t)&&0!==t.length?t.map((function(t){return n.hasLocalGroupMember(e,t.userID)?n.getLocalGroupMemberInfo(e,t.userID).updateMember(t):n.setLocalGroupMember(e,new oo(t)),n.getLocalGroupMemberInfo(e,t.userID)})):[]}},{key:"deleteLocalGroupMembers",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach((function(e){n.delete(e)}))}},{key:"getLocalGroupMemberInfo",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:"setLocalGroupMember",value:function(e,t){this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).set(t.userID,t):(t=(new Map).set(t.userID,t),this.groupMemberListMap.set(e,t))}},{key:"getLocalGroupMemberList",value:function(e){return this.groupMemberListMap.get(e)}},{key:"hasLocalGroupMember",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:"hasLocalGroupMemberMap",value:function(e){return this.groupMemberListMap.has(e)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),so=[17,18,20],ro=a((function e(t){i(this,e),this._grpM=t,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}),[{key:"onNewGroupSystemNotice",value:function(e){var t=e.dataList,n=e.isSyncingEnded,i=(e=e.isInstantMessage,(Re.d("".concat(this._n,".onReceiveSystemNotice count:").concat(t.length)),t=this._assembly({notifiesList:t,isInstantMessage:e})).eventDataList);t=t.result,0<i.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:i,isInstantMessage:e}),this._onReceivedGroupSystemNotice({result:t,isInstantMessage:e})),e?0<t.length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t):!0===n&&this._clearGroupSystemNotice()}},{key:"_assembly",value:function(e){var t=e.notifiesList,n=e.isInstantMessage,i=null,o=t.length,a=0,s=[],r={conversationID:k.CONV_SYSTEM,unreadCount:0,type:k.CONV_SYSTEM,subType:null,lastMessage:null};for(a=0;a<o;a++){var c=t[a],u=(l=c.groupProfile).communityType,l=void 0===(l=l.topicID)?void 0:l,d=void 0===(d=(h=c.elements).topicIDList)?void 0:d,h=h.operationType;if(!(2!==(void 0===u?0:u)||je(l)&&je(d))){if(so.includes(h)){this._handleTopicSystemNotice(c);continue}je(l)||(c.to=l)}15!==c.elements.operationType&&(c.currentUser=this._grpM.getMyUserID(),c.conversationType=k.CONV_SYSTEM,c.conversationID=k.CONV_SYSTEM,(i=new ki(c)).setElement({type:k.MSG_GRP_SYS_NOTICE,content:f(f({},c.elements),{},{groupProfile:f({},c.groupProfile)})}),i.isSystemMessage=!0,(1===i.sequence&&1===i.random||2===i.sequence&&2===i.random)&&(i.sequence=ot(),i.random=ot(),i.generateMessageID(),Re.l("".concat(this._n,"._assembly regenerate ID:").concat(i.ID))),this._grpM.get(11).pushIntoNoticeResult(s,i))&&(n?r.unreadCount++:i.setIsRead(!0),r.subType=i.conversationSubType)}return r.lastMessage=s[s.length-1],{eventDataList:0<s.length?[r]:[],result:s}}},{key:"_clearGroupSystemNotice",value:function(){var e=this;this._getPendencyList().then((function(t){t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t)})),t=e._grpM.get(11).getLocalMessageList(k.CONV_SYSTEM);var n=[];t.forEach((function(t){var i=(a=t.payload).operatorID,o=a.operationType,a=a.groupProfile;1===o&&(o="".concat(i,"_").concat(a.groupID,"_").concat(a.to),i=e.pendencyMap.get(o))&&ze(i.handled)&&0!==i.handled&&n.push(t)})),e.deleteGroupSystemNotice({messageList:n})}))}},{key:"deleteGroupSystemNotice",value:function(e){var t=this,n="".concat(this._n,".deleteGroupSystemNotice");return We(e.messageList)&&0!==e.messageList.length?(Re.l("".concat(n," ")+e.messageList.map((function(e){return e.ID}))),this._grpM.req({P:jn.DEL_GRP_SYSTEM_NOTICE,data:{messageListToDelete:e.messageList.map((function(e){return{from:k.CONV_SYSTEM,messageSeq:e.clientSequence,messageRandom:e.random}}))}}).then((function(){Re.l("".concat(n," ok"));var i=t._grpM.get(11);return e.messageList.forEach((function(e){i.deleteLocalMessage(e)})),En()})).catch((function(e){return Re.e("".concat(n," error:"),e),kn(e)}))):Tn()}},{key:"_getPendencyList",value:function(){var e=this,t=(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,n=i.startTime,i=i.limit;return this._grpM.req({P:jn.GET_GRP_PENDENCY,data:{type:void 0===t?void 0:t,startTime:void 0===n?0:n,limit:void 0===i?20:i,handleAccount:this._grpM.getMyUserID()}}).then((function(t){var n=t.data.pendencyList;return 0!==t.data.nextStartTime?e._getPendencyList({startTime:t.data.nextStartTime}).then((function(e){return[].concat(y(n),y(e))})):n}))}},{key:"getGroupApplicationList",value:function(){var e=this;return this._getPendencyList().then((function(t){return e._getPendencyList({type:k.GRP_COMMUNITY}).then((function(n){return t.push.apply(t,y(n)),e._handlePendencyResult(t)})).catch((function(n){return e._handlePendencyResult(t)}))}))}},{key:"_handlePendencyResult",value:function(e){var t=this,n=[];return e.forEach((function(e){t.pendencyMap.set("".concat(e.from,"_").concat(e.groupID,"_").concat(e.to),e),0===e.handled&&n.push({applicant:e.from,applicantNick:e.fromUserNickName,groupName:e.groupName,groupID:e.groupID,authentication:e.authentication,messageKey:e.time,applicationType:e.applicationType,userID:e.userID,note:e.note})})),Tn({applicationList:n})}},{key:"_onReceivedGroupSystemNotice",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach((function(e){switch(e.payload.operationType){case 1:case 3:case 6:case 11:case 12:case 15:break;case 2:t._onApplyJoinGroup(e);break;case 4:t._onMemberKicked(e);break;case 5:t._onGroupDismissed(e);break;case 7:t._onInviteGroup(e);break;case 8:t._onQuitGroup(e);break;case 9:t._onSetManager(e);break;case 10:t._onDeleteManager(e);break;case 20:t._onMessageRemindTypeSynced(e);break;case 21:t._grpM.onAVChatRoomMemberBanned(e)}}))}},{key:"_onApplyJoinGroup",value:function(e){var t=this,n=(e=e.payload.groupProfile).groupID,i=(e=e.groupType,this._grpM.hasLocalGroup(n));Re.l("".concat(this._n,"._onApplyJoinGroup groupID:").concat(n," groupType:").concat(e," hasGroup:").concat(i)),i||Ct(e)||this._grpM.getGroupProfile({groupID:n}).then((function(e){(e=e.data.group)&&(t._grpM.updateGroupMap([e]),e=!e.isSupportTopic,t._grpM.emitGroupListUpdate(!0,e))}))}},{key:"_onMemberKicked",value:function(e){e=e.payload.groupProfile.groupID,this._grpM.hasLocalGroup(e)&&this._grpM.deleteLocalGroupAndConversation(e)}},{key:"_onGroupDismissed",value:function(e){e=e.payload.groupProfile.groupID;var t=(this._grpM.hasLocalGroup(e)&&this._grpM.deleteLocalGroupAndConversation(e),this._grpM._AVChatRoomHandler);t&&t.checkJoinedAVChatRoomByID(e)&&t.reset(e)}},{key:"_onInviteGroup",value:function(e){var t=this,n=e.payload.groupProfile.groupID;e=this._grpM.hasLocalGroup(n),Re.l("".concat(this._n,"._onInviteGroup groupID:").concat(n," hasGroup:").concat(e)),this._grpM.getGroupProfile({groupID:n}).then((function(){t._grpM.emitGroupListUpdate(),t._grpM.get(11).pullMsgOnInvite("".concat(k.CONV_GROUP).concat(n))}))}},{key:"_onQuitGroup",value:function(e){var t=(e=e.payload.groupProfile).groupID,n=(e=e.groupType,this._grpM.hasLocalGroup(t));Re.l("".concat(this._n,"._onQuitGroup groupID:").concat(t," groupType:").concat(e," hasGroup:").concat(n)),n&&this._grpM.deleteLocalGroupAndConversation(t)}},{key:"_onSetManager",value:function(e){var t=(e=e.payload.groupProfile).to;e=e.groupID,(e=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(e,t))&&e.updateRole(k.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(e){var t=(e=e.payload.groupProfile).to;e=e.groupID,(e=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(e,t))&&e.updateRole(k.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(e){var t=e.payload.groupProfile.groupID;e=e.payload.messageRemindType,this._grpM.get(11).onGroupMsgRemindTypeUpdated({groupID:t,messageRemindType:e})}},{key:"_handleTopicSystemNotice",value:function(e){var t=(n=e.groupProfile).groupID,n=n.topicID,i=(e=e.elements).operationType,o=e.topicIDList,a=(e=e.messageRemindType,this._grpM.get(10));17===i?a.onTopicCreated({groupID:t,topicID:n}):18===i?a.onTopicDeleted({groupID:t,topicIDList:o}):20===i&&a.onMessageRemindTypeUpdated({groupID:t,topicID:n,messageRemindType:e})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),co=["relayFlag"],lo=(l(So,Nn),a(So,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("polling_interval"),t=this.getCloudConfig("polling_interval_plus"),n=this.getCloudConfig("polling_no_msg_count"),i=this.getCloudConfig("polling_simplified_msg"),o=this.getCloudConfig("paging_grp_count");Re.l("".concat(this._n,"._onCloudConfig pollingInterval:").concat(e)+" pollingIntervalPlus:".concat(t," pollingNoMessageCount:").concat(n)+" pollingSimplifiedMessage:".concat(i," pagingGroupCount:").concat(o)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n),this._AVChatRoomHandler.setPollingSimplifiedMessage(i),this._commonGroupHandler.setPagingGroupCount(o)}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:"guardForAVChatRoom",value:function(e){var t,n=this;return e.conversationType!==k.CONV_GROUP||(t=Tt(e.to)?Ft(e.to):e.to,this.hasLocalGroup(t))?Tn():this.getGroupProfile({groupID:t}).then((function(i){return i=i.data.group.type,Re.l("".concat(n._n,".guardForAVChatRoom. groupID:").concat(t," type:").concat(i)),i===k.GRP_AVCHATROOM?kn(new Fn({code:i=Bn.MSG_SEND_FAIL_NOT_IN_AV,message:n.getErrMsg(i,e.from,t),data:{message:e}})):Tn()}))}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"onNewMessage",value:function(e){this._commonGroupHandler.onNewMessage(e)}},{key:"updateNextMessageSeq",value:function(e){var t,n=this;We(e)&&(t=this.get(10),e.forEach((function(e){var i=e.conversationID.replace(k.CONV_GROUP,"");Tt(i)&&t.updateUnreadCountAndLastMsg(i,e.lastMessage),n.groupMap.has(i)&&(n.groupMap.get(i).nextMessageSeq=e.lastMessage.sequence+1)})))}},{key:"onNewGroupTips",value:function(e){this._groupTipsHandler.onNewGroupTips(e)}},{key:"onMsgRevoked",value:function(e){this._commonGroupHandler.onMsgRevoked(e,!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}},{key:"onNewGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:"onMsgReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n;e=e.elements.groupMessageReadNotice,dt(e)||(n=t.get(11),e.forEach((function(e){var i=e.groupID,o=void 0===(o=e.topicID)?void 0:o,a=(e=e.lastMessageSeq,Re.l("".concat(t._n,".onMsgReadNotice groupID:").concat(i," lastMessageSeq:").concat(e)),i="".concat(k.CONV_GROUP).concat(i),!0);je(o)||(i="".concat(k.CONV_GROUP).concat(o),a=!1),n.updateIsReadAfterReadReport({conversationID:i,lastMessageSeq:e}),n.updateUnreadCount(i,a),n.clearGroupAtInfoList(i,a)})))}))}},{key:"onReadReceiptList",value:function(e){var t=this;Re.l("".concat(this._n,".onReadReceiptList options:"),e),e.dataList.forEach((function(e){var n=e.groupProfile,i=(e=e.elements,n=n.groupID,t.get(11));e=e.readReceiptList,i.updateReadReceiptInfo({groupID:n,readReceiptList:e})}))}},{key:"onMsgModified",value:function(e){Re.l("".concat(this._n,".onMsgModified options:"),e);var t=this.get(11);e.dataList.forEach((function(e){t.onMessageModified(f(f({},e),{},{conversationType:k.CONV_GROUP,to:e.topicID||e.groupID}))}))}},{key:"deleteGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:"initGroupMap",value:function(e){this.groupMap.set(e.groupID,new Ki(e))}},{key:"clearGroupMap",value:function(){this.groupMap.clear()}},{key:"deleteGroup",value:function(e){this.groupMap.delete(e)}},{key:"updateGroupMap",value:function(e){var t,n=this,i=this.get(11);e.forEach((function(e){t=e.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(e):(n.groupMap.set(t,new Ki(e)),i.deleteGroupRoamingInfo(t))}));var o,a=this.getMyUserID(),r=s(this.groupMap);try{for(r.s();!(o=r.n()).done;){var c=v(o.value,2)[1];c.selfInfo.userID=a,"Owner"===c.selfInfo.role&&(c.ownerID=a)}}catch(u){r.e(u)}finally{r.f()}}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return y(this.groupMap.values()).filter((function(e){return e.type!==k.GRP_ROOM&&e.type!==k.GRP_LIVE}))}},{key:"getLocalGroupProfile",value:function(e){return this.groupMap.get(e)}},{key:"sortLocalGroupList",value:function(){var e=y(this.groupMap).filter((function(e){return(e=v(e,2))[0],!je(e[1].lastMessage)}));e.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})),this.groupMap=new Map(y(e))}},{key:"updateGroupLastMessage",value:function(e){this._commonGroupHandler.updateLastMsg(e)}},{key:"emitGroupListUpdate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.getLocalGroupList();e&&this.emitOEvt(T.GROUP_LIST_UPDATED),t&&(e=JSON.parse(JSON.stringify(n)),this.get(11).updateConvGroupProfile(e))}},{key:"getMyNameCardByGroupID",value:function(e){return(e=this.getLocalGroupProfile(e))?e.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return this._commonGroupHandler.isPagingGetCompleted()}},{key:"getMsgRemindType",value:function(e){var t=this;return We(e)&&0!==e.length&&0!==(e=e.filter((function(e){return!Ct(t.getLocalGroupProfile(e).type)}))).length?(Re.l("".concat(this._n,".getMsgRemindType groupIDList:").concat(e)),this.getGroupProfileAdvance({groupIDList:e,responseFilter:{memberInfoFilter:["MsgFlag"]}}).then((function(e){e=e.data.successGroupList;var n=t.get(11);e.forEach((function(e){n.onGroupMsgRemindTypeUpdated({groupID:e.groupID,messageRemindType:We(e.members)?e.members[0].messageRemindType:""})}))}))):Promise.resolve()}},{key:"getGroupList",value:function(){return this._commonGroupHandler.getGroupList()}},{key:"syncCommunityWithTopic",value:function(){return this._commonGroupHandler.syncGroupList(!0)}},{key:"getGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupProfile"),i=new ii("getGroupProfile"),o=e.groupID,a=e.groupCustomFieldFilter;return Re.l("".concat(n," groupID:").concat(o)),a={groupIDList:[o],responseFilter:{groupBaseInfoFilter:y(G),groupCustomFieldFilter:a,memberInfoFilter:[].concat(y(x),["NameCard"])}},this.getGroupProfileAdvance(a).then((function(e){var a=(e=e.data).successGroupList;return e=e.failureGroupList,Re.l("".concat(n," ok")),0<e.length?kn(e[0]):((e=Ct(a[0].type)&&!t.hasLocalGroup(o)?new Ki(a[0]):(t.updateGroupMap(a),t.getLocalGroupProfile(o))).isSupportTopic||t.get(11).updateConvGroupProfile([e]),i.setMessage("groupID:".concat(o," type:").concat(e.type," muteAllMembers:").concat(e.muteAllMembers," ownerID:").concat(e.ownerID)).end(),En({group:e}))})).catch((function(t){return i.setError(t).setMessage("groupID:".concat(e.groupID)).end(),Re.e("".concat(n," failed. error:"),t),kn(t)}))}},{key:"getGroupProfileAdvance",value:function(e){var t,n="".concat(this._n,".getGroupProfileAdvance"),i=(We(a=e.groupIDList)&&50<a.length&&(this.warn("GetGroupProfileLimit"),a.length=50),[]),o=[],a=(a.forEach((function(e){(Et({groupID:e})?o:i).push(e)})),[]);return 0<i.length&&(t=this._getGroupProfileAdvance(f(f({},e),{},{groupIDList:i})),a.push(t)),0<o.length&&(t=this._getGroupProfileAdvance(f(f({},e),{},{groupIDList:o,relayFlag:0<i.length})),a.push(t)),Promise.all(a).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push.apply(t,y(e.successGroupList)),n.push.apply(n,y(e.failureGroupList))})),En({successGroupList:t,failureGroupList:n})})).catch((function(e){return Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"_getGroupProfileAdvance",value:function(e){var t=this,n=e.relayFlag,i=void 0!==n&&n,o=m(e,co);return this.req({P:jn.GET_GRP_PROFILE,data:o}).then((function(e){return Re.l("".concat(t._n,"._getGroupProfileAdvance ok. options:"),o),{successGroupList:(e=e.data.groups).filter((function(e){return dt(e.errorCode)||0===e.errorCode})),failureGroupList:e.filter((function(e){return e.errorCode&&0!==e.errorCode})).map((function(e){return new Fn({code:e.errorCode,message:e.errorInfo,data:{groupID:e.groupID}})}))}})).catch((function(t){return i&&Et({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:kn(t)}))}},{key:"createGroup",value:function(e){var t=this,n=[k.GRP_PUBLIC,k.GRP_WORK,k.GRP_MEETING,k.GRP_AVCHATROOM,k.GRP_COMMUNITY],i="".concat(this._n,".").concat("createGroup"),o=e.type,a=e.groupID;if(e.name&&!1===this._filterProfanity("name",e))return kn({code:Bn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return kn({code:Bn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return kn({code:Bn.PROFANITY_FOUND});if(!n.includes(o))return kn({code:Bn.ILLEGAL_GRP_TYPE});if(!Et({type:o})){if(!je(a)&&Et({groupID:a}))return kn({code:Bn.ILLEGAL_GRP_ID});e.isSupportTopic=void 0}if(Ct(o)&&!dt(e.memberList)&&0<e.memberList.length&&(e.memberList=void 0),this._canIUseJoinOption(o)||dt(e.joinOption)||(e.joinOption=void 0),Et({type:o})){if(!je(a)&&!Et({groupID:a}))return kn({code:Bn.ILLEGAL_GRP_ID});e.isSupportTopic=!0===e.isSupportTopic?1:0}var s=new ii("createGroup"),r=(Re.l("".concat(i," options:"),e),null),c=[];return this.req({P:jn.CREATE_GRP,data:f(f({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then((function(n){var o,a,u,l=(n=n.data).groupID,d=void 0===(n=n.overLimitUserIDList)?[]:n;return r=l,c=d,n="groupType:".concat(e.type," groupID:").concat(l," overLimitUserIDList:").concat(d),s.setMessage(n).end(),Re.l("".concat(i," ok. ").concat(n)),e.type===k.GRP_AVCHATROOM||e.type===k.GRP_COMMUNITY&&1===e.isSupportTopic||(je(e.memberList)||je(d)||(e.memberList=e.memberList.filter((function(e){return-1===d.indexOf(e.userID)}))),t.updateGroupMap([f(f({},e),{},{groupID:l})]),n=t.get(2),u="",o=0,e.type===k.GRP_COMMUNITY?(u=t.isIntl()?"Create Community":"创建社群",o=1):u=t.isIntl()?"Create Group":"创建群组",a=t.get(4).getMyNick(),u=n.createCustomMessage({to:l,conversationType:k.CONV_GROUP,payload:{data:JSON.stringify({businessID:"group_create",content:u,cmd:o,opUser:a||t.getMyUserID(),version:4})}}),n.sendMessageInstance(u),t.emitGroupListUpdate()),t.getGroupProfile({groupID:l})})).then((function(e){var t=(n=(e=e.data.group).selfInfo).nameCard,n=n.joinTime;return e.updateSelfInfo({nameCard:t,joinTime:n,messageRemindType:k.MSG_REMIND_ACPT_AND_NOTE,role:k.GRP_MBR_ROLE_OWNER}),En({group:e,overLimitUserIDList:c})})).catch((function(n){var o;return s.setMessage("groupType:".concat(e.type)).setError(n).end(),10010===n.code||10007===n.code?(t._silentlyGetGroupProfile(n.code,r),t.updateGroupMap([f(f({},e),{},{groupID:r})]),(o=t.getLocalGroupProfile(r)).selfInfo.role=k.GRP_MBR_ROLE_OWNER,En({group:o,overLimitUserIDList:c})):(Re.e("".concat(i," failed. error:"),n),kn(n))}))}},{key:"dismissGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("dismissGroup"),i="groupID:".concat(e),o=new ii("dismissGroup");return o.setMessage(i),Re.l("".concat(n," ").concat(i)),this.req({P:jn.DISMISS_GRP,data:{groupID:e}}).then((function(){return o.end(),Re.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),En({groupID:e})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"updateGroupProfile",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("updateGroupProfile");return this.hasLocalGroup(e.groupID)&&(t=this.getLocalGroupProfile(e.groupID).type,this._canIUseJoinOption(t)||dt(e.joinOption)||(Re.w("".concat(o," joinOption is unavailable for Work/Meeting/AVChatRoom")),e.joinOption=void 0)),dt(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers="On":e.muteAllMembers="Off"),e.name&&!1===this._filterProfanity("name",e)||e.introduction&&!1===this._filterProfanity("introduction",e)||e.notification&&!1===this._filterProfanity("notification",e)?kn({code:Bn.PROFANITY_FOUND}):((n=new ii("updateGroupProfile")).setMessage(JSON.stringify(e)),Re.l("".concat(o," groupID:").concat(e.groupID)),this.req({P:jn.UPDATE_GRP_PROFILE,data:e}).then((function(){return n.end(),Re.l("".concat(o," ok")),i.hasLocalGroup(e.groupID)&&i.groupMap.get(e.groupID).updateGroup(e),En({group:i.groupMap.get(e.groupID)})})).catch((function(e){return n.setError(e).end(),Re.l("".concat(o," failed. error:"),e),kn(e)})))}},{key:"_filterProfanity",value:function(e,t){var n,i=this.get(29);return!i||(n=(i=i.filterText(t[e],U)).isAllowedToSend,i=i.modifiedText,!0===n&&(t[e]=i,!0))}},{key:"joinGroup",value:function(e){var t,n=this,i=e.groupID,o="".concat(this._n,".joinGroup");return this.deleteUnjoinedAVChatRoom(i),this.hasLocalGroup(i)?this.isLoggedIn()?(t=new ii("applyJoinGroup"),this.getGroupProfile({groupID:i}).then((function(){return t.setMessage("groupID:".concat(i," joinedStatus:").concat(k.JOIN_STATUS_ALREADY_IN_GROUP)).end(),Tn({status:k.JOIN_STATUS_ALREADY_IN_GROUP})})).catch((function(a){return t.setMessage("groupID:".concat(i," unjoined")).end(),Re.w("".concat(o," ").concat(i," was unjoined, now join!")),n.groupMap.delete(i),n.applyJoinGroup(e)}))):Tn({status:k.JOIN_STATUS_ALREADY_IN_GROUP}):(Re.l("".concat(o," groupID:").concat(i)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e))}},{key:"applyJoinGroup",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("applyJoinGroup"),a=e.groupID;return je(e.applyMessage)||!1!==this._filterProfanity("applyMessage",e)?(t=new ii("applyJoinGroup"),e=f({},e),(n=this.canIUse(P.AV_HISTORY_MSG))&&(e.historyMessageFlag=1),this.get(11).deleteTopicRoamingInfo(a),this.req({P:jn.APPLY_JOIN_GRP,data:e}).then((function(e){var s=(e=e.data).joinedStatus,r=e.longPollingKey,c=e.startSeq,u=e.avChatRoomFlag,l=e.avChatRoomKey,d=e.messageList;switch(e="groupID:".concat(a," joinedStatus:").concat(s," longPollingKey:").concat(r," startSeq:").concat(c)+" avChatRoomFlag:".concat(u," canGetAVChatRoomHistoryMsg:").concat(n,",")+" historyMsgCount:".concat(je(d)?0:d.length),t.setMessage(e).end(),Re.l("".concat(o," ok. ").concat(e)),s){case Fe:return En({status:Fe});case xe:return i.getGroupProfile({groupID:a}).then((function(e){return e=e.data.group,i._handleJoinResult({group:e,avChatRoomFlag:u,longPollingKey:r,startSeq:c,avChatRoomKey:l,messageList:d})})).catch((function(e){var t;return 10010===e.code||10007===e.code?(i._silentlyGetGroupProfile(e.code,a),t=new Ki({groupID:a}),i.updateGroupMap([t]),i._handleJoinResult({group:t,avChatRoomFlag:u,longPollingKey:r,startSeq:c,avChatRoomKey:l,messageList:d})):(Re.e("".concat(o," failed. error:"),e),kn(e))}));default:var h=new Fn({code:Bn.JOIN_GRP_FAIL});return Re.e("".concat(o," failed. error:"),h),kn(h)}})).catch((function(e){return t.setMessage("groupID:".concat(a)).setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)}))):kn({code:Bn.PROFANITY_FOUND})}},{key:"_handleJoinResult",value:function(e){var t=this,n=e.group,i=e.avChatRoomFlag,o=e.longPollingKey,a=e.startSeq,s=e.avChatRoomKey,r=e.messageList,c=n.groupID;return 1===i?(this.get(11).setCompleted("".concat(k.CONV_GROUP).concat(c)),this._groupAttributesHandler.initGroupAttributesCache({groupID:c,avChatRoomKey:s}),this._groupCountersHandler.initGroupCountersCache({groupID:c,avChatRoomKey:s}),(e=dt(o)?this._AVChatRoomHandler.handleJoinResult({group:n}):this._AVChatRoomHandler.startRunLoop({group:n,longPollingKey:o,startSeq:a})).then((function(){t._onAVChatRoomHistoryMessage(r,c)})),e):(this.emitGroupListUpdate(!0,!1),En({status:xe,group:n}))}},{key:"quitGroup",value:function(e){var t,n=this,i="".concat(this._n,".").concat("quitGroup"),o="groupID:".concat(e),a=(Re.l("".concat(i," ").concat(o)),this.checkJoinedAVChatRoomByID(e));return a||this.hasLocalGroup(e)?a&&!this.isLoggedIn()?(Re.l("".concat(i," anonymously ok. ").concat(o)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),Tn({groupID:e})):((t=new ii("quitGroup")).setMessage(o),this.req({P:jn.QUIT_GRP,data:{groupID:e}}).then((function(){return t.end(),Re.l("".concat(i," ok")),n.deleteLocalGroupAndConversation(e),a&&n._AVChatRoomHandler.reset(e),n._groupAttributesHandler.deleteLocalGroupAttributes(e),En({groupID:e})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(i," failed. error:"),e),kn(e)}))):kn({code:Bn.MEMBER_NOT_IN_GRP})}},{key:"searchGroupByID",value:function(e){var t="".concat(this._n,".").concat("searchGroupByID"),n={groupIDList:[e]},i=new ii("searchGroupByID");return i.setMessage("groupID:".concat(e)),Re.l("".concat(t," groupID:").concat(e)),this.req({P:jn.SEARCH_GRP,data:n}).then((function(e){if(0!==(e=e.data.groupProfile)[0].errorCode)throw new Fn({code:e[0].errorCode,message:e[0].errorInfo});return i.end(),Re.l("".concat(t," ok")),En({group:new Ki(e[0])})})).catch((function(e){return i.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"changeGroupOwner",value:function(e){var t,n=this,i="".concat(this._n,".").concat("changeGroupOwner");return this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===k.GRP_AVCHATROOM?kn({code:Bn.CANNOT_CHANGE_OWNER_IN_AV}):e.newOwnerID===this.getMyUserID()?kn({code:Bn.CANNOT_CHANGE_OWNER_TO_SELF}):((t=new ii("changeGroupOwner")).setMessage("groupID:".concat(e.groupID," newOwnerID:").concat(e.newOwnerID)),Re.l("".concat(i," groupID:").concat(e.groupID)),this.req({P:jn.CHANGE_GRP_OWNER,data:e}).then((function(){t.end(),Re.l("".concat(i," ok"));var o,a=e.groupID,s=e.newOwnerID,r=(n.groupMap.get(a).ownerID=s,n._groupMemberHandler.getLocalGroupMemberList(a));return r instanceof Map&&(o=r.get(n.getMyUserID()),dt(o)||(o.updateRole("Member"),n.groupMap.get(a).selfInfo.role="Member"),o=r.get(s),dt(o)||o.updateRole("Owner")),n.emitGroupListUpdate(!0,!1),En({group:n.groupMap.get(a)})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(i," failed. error:"),e),kn(e)})))}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){var t,n,i,o,a,s=this,r="".concat(this._n,".").concat("handleGroupApplication"),c=e.handleAction,u=e.handleMessage,l=e.message,d=e.application,h=(l?(t=l.payload.operatorID,n=l.payload.groupProfile.groupID,i=l.payload.authentication,o=l.payload.messageKey):d&&(t=d.applicant,n=d.groupID,i=d.authentication,o=d.messageKey),jn.HANDLE_GRP_APPLICATION),p=(d&&2===d.applicationType&&(h=jn.HANDLE_INVITE_JOIN_GRP,a=d.userID),new ii("handleGroupApplication"));return p.setMessage("groupID:".concat(n)),Re.l("".concat(r," groupID:").concat(n)),this.req({P:h,data:{handleAction:c,handleMessage:u,applicant:t,invitee:a,groupID:n,authentication:i,messageKey:o}}).then((function(){return p.end(),Re.l("".concat(r," ok")),l&&s._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),En({group:s.getLocalGroupProfile(n)})})).catch((function(e){return p.setError(e).end(),Re.e("".concat(r," failed. error"),e),kn(e)}))}},{key:"handleGroupInvitation",value:function(e){var t=this,n="".concat(this._n,".").concat("handleGroupInvitation"),i=(s=e.message.payload).groupProfile.groupID,o=s.authentication,a=s.messageKey,s=s.operatorID,r=e.handleAction,c=new ii("handleGroupInvitation");return c.setMessage("groupID:".concat(i," inviter:").concat(s," handleAction:").concat(r)),Re.l("".concat(n," groupID:").concat(i," inviter:").concat(s," handleAction:").concat(r)),this.req({P:jn.HANDLE_GRP_INVITATION,data:f(f({},e),{},{inviter:s,groupID:i,authentication:o,messageKey:a})}).then((function(){return c.end(),Re.l("".concat(n," ok")),t._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),En({group:t.getLocalGroupProfile(i)})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(n," failed. error"),e),kn(e)}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".getGroupOnlineMemberCount"),i=this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e),o=this.hasLocalGroup(e);if(Re.l("".concat(n," groupID:").concat(e," isAVChatRoom:").concat(i," has:").concat(o)),i)return this._AVChatRoomHandler.getGroupOnlineMemberCount(e);if(!o)return Tn({memberCount:0});if(i=Date.now(),this._onlineMemberCountMap.has(e)){if(i-(o=this._onlineMemberCountMap.get(e)).lastReqTime<=6e4)return Tn({memberCount:o.memberCount});o.lastReqTime=i}return this.requestOnlineCount(e).then((function(i){return i=void 0===(i=i.data.memberCount)?0:i,t._onlineMemberCountMap.set(e,{lastReqTime:Date.now(),memberCount:i}),Re.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(i)),Tn({memberCount:i})})).catch((function(e){return Re.w("".concat(n," failed. error:"),e),Promise.reject(e)}))}},{key:"requestOnlineCount",value:function(e){return this.req({P:jn.GET_ONLINE_MBR_NUM,data:{groupID:e}})}},{key:"hasLocalGroup",value:function(e){return this.groupMap.has(e)}},{key:"deleteLocalGroupAndConversation",value:function(e){var t=this.checkJoinedAVChatRoomByID(e),n=(Re.l("".concat(this._n,".deleteLocalGroupAndConversation groupID:").concat(e," isJoinedAVChatRoom:").concat(t)),this.get(11)),i="".concat(k.CONV_GROUP).concat(e);t&&(this.stopMessageLongPolling({groupID:e}),n.deleteLocalConv(i)),Et({groupID:e})&&(t=this.getLocalGroupProfile(e))&&!0===t.isSupportTopic&&this.get(10).deleteTopicListInCommunity(e),n.clearUnreadCount(i),n.setCompleted(i),this._deleteLocalGroup(e),this._onlineMemberCountMap.delete(e),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(e){this.groupMap.delete(e),this._groupMemberHandler.deleteGroupMemberList(e)}},{key:"sendMessage",value:function(e,t){return We(e._receiverList)&&0<e._receiverList.length&&!this.canIUse(P.MSG_TO_SPECIFIED_GRP_MBR)?this.noUse("Targeted Group Message"):(e=this.createGroupMessagePack(e,t),this.req(e))}},{key:"createGroupMessagePack",value:function(e,t){var n=null,i=(t&&t.offlinePushInfo&&(n=t.offlinePushInfo),""),o=(lt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(i=e.cloudCustomData),[]),a=void($e(t)&&$e(t.messageControlInfo)&&(a=(r=t.messageControlInfo).excludedFromUnreadCount,s=r.excludedFromLastMessage,r=r.excludedFromContentModeration,!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===r)&&o.push("NoMsgCheck")),s=(We(e._receiverList)&&0<e._receiverList.length&&(a=e._receiverList,50<e._receiverList.length)&&(a=e._receiverList.slice(0,50),this.warn("ReceiverListLimit")),this.isOnlineMessage(e,t)?1:0),r=JSON.parse(JSON.stringify(e.getElements())),c=this.get(17).getFileDNList(),u=e.getGroupAtInfoList();return r={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:ci(e.type,r,c),cloudCustomData:i,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==k.MSG_TEXT||je(u)?void 0:u,onlineOnlyFlag:s,clientTime:e.clientTime,offlinePushInfo:Ri(n),messageControlInfo:0==s?o:void 0,needReadReceipt:!0!==e.needReadReceipt||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:a,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0,cmConfigID:e._cmConfigID,forbidCallbackControl:It(t)},Tt(e.to)&&(r.groupID=Ft(e.to),r.topicID=e.to),{P:jn.SEND_GRP_MSG,data:r}}},{key:"revokeMessage",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return Tt(e.to)&&(t.groupID=Ft(e.to),t.topicID=e.to),this.req({P:jn.REVOKE_GRP_MSG,data:t})}},{key:"deleteMessage",value:function(e){var t=e.to;return e=e.keyList,Re.l("".concat(this._n,".deleteMessage groupID:").concat(t," count:").concat(e.length)),e={groupID:t,deleter:this.getMyUserID(),keyList:e},Tt(t)&&(e.groupID=Ft(t),e.topicID=t),this.req({P:jn.DEL_GRP_MSG,data:e})}},{key:"modifyRemoteMessage",value:function(e){var t=e.to,n=e.sequence,i=e.payload,o=e.type,a=void 0===(a=e.version)?0:a,s=e.cloudCustomData,r=(e=e._elements,t),c=void 0;return t=void(Tt(t)&&(r=Ft(t),c=t)),Vt(o)&&(1<e.length&&e.splice(0,1,{type:o,content:i}),t=e),this.req({P:jn.MODIFY_GRP_MSG,data:{groupID:r,topicID:c,sequence:n,version:a,elements:t,cloudCustomData:s}})}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessage"),i=e.conversationID,o=e.groupID,a=(e=e.sequence,new ii("getRoamingMessage")),s=0,r=void 0;return Tt(o)&&(o=Ft(r=o)),this._computeLastSequence({groupID:o,topicID:r,sequence:e}).then((function(e){return s=e,Re.l("".concat(n," groupID:").concat(o," startSequence:").concat(s)),t.req({P:jn.GET_GRP_ROAMING_MSG,data:{groupID:o,count:21,sequence:s,topicID:r}})})).then((function(e){var c=(l=e.data).messageList,u=l.complete,l=void 0===(l=l.invisibleSequenceList)?[]:l,d=(e=void 0===(e=e.data.nextSequence)?0:e,dt(c)?Re.l("".concat(n," ok. complete:").concat(u," nextSequence:").concat(e," but messageList is undefined!")):Re.l("".concat(n," ok. complete:").concat(u," nextSequence:").concat(e," count:").concat(c.length)),a.setMessage("groupID:".concat(o," topicID:").concat(r," startSequence:").concat(s," complete:").concat(u," nextSequence:").concat(e)).end(),t.get(11)),h=[],p=[];return je(c)||(h=d.onRoamingMessage(c,i,!0,p),d.updateIsRead(i),d.patchConvLastMessage(i)),(c=2===u||e<1)&&(d.setCompleted(i),e=""),Re.l("".concat(n," isPullingCompleted:").concat(c," nextReqID:").concat(e," storedMsgCount:").concat(h.length)+" invisibleSeqCount:".concat(l.length)),{nextReqID:e+"",storedMessageList:h,assembledMessageList:p,isPullingCompleted:c}})).catch((function(e){return a.setError(e).setMessage("groupID:".concat(o," topicID:").concat(r," startSequence:").concat(s)).end(),Re.w("".concat(n," failed. error:"),e),kn(e)}))}},{key:"_getGroupIDOfMessage",value:function(e){return e.conversationID.replace(k.CONV_GROUP,"")}},{key:"getReadReceiptList",value:function(e){var t,n="".concat(this._n,".").concat("getReadReceiptList"),i=this._getGroupIDOfMessage(e[0]),o=this.getMyUserID(),a=e.filter((function(e){return e.from===o&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));return Re.l("".concat(n," groupID:").concat(i," sequenceList:").concat(JSON.stringify(a))),0===a.length?Tn({messageList:e}):((t=new ii("getReadReceiptList")).setMessage("groupID:".concat(i)),this.req({P:jn.GET_READ_RECEIPT,data:{groupID:i,sequenceList:a}}).then((function(i){return t.end(),Re.l("".concat(n," ok")),We(i=i.data.readReceiptList)&&i.forEach((function(t){e.forEach((function(e){0===t.code&&t.sequence===e.sequence&&(e.readReceiptInfo.readCount=t.readCount,e.readReceiptInfo.unreadCount=t.unreadCount)}))})),En({messageList:e})})).catch((function(e){return t.setError(e).end(),Re.w("".concat(n," failed. error:"),e),kn(e)})))}},{key:"sendReadReceipt",value:function(e){var t="".concat(this._n,".").concat("sendReadReceipt"),n=this._getGroupIDOfMessage(e[0]),i=new ii("sendReadReceipt"),o=(i.setMessage("groupID:".concat(n)),this.getMyUserID());return 0===(e=e.filter((function(e){return e.from!==o&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}))).length?kn({code:Bn.READ_RECEIPT_MSG_LIST_EMPTY}):(Re.l("".concat(t,". sequenceList:").concat(JSON.stringify(e))),this.req({P:jn.SEND_READ_RECEIPT,data:{groupID:n,sequenceList:e}}).then((function(e){return i.end(),Re.l("".concat(t," ok")),En()})).catch((function(e){return i.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)})))}},{key:"getReadReceiptDetail",value:function(e){var t=this,n=e.message,i=e.filter,o=e.cursor,a=(e=e.count,this._getGroupIDOfMessage(n)),s=n.ID,r=(n=n.sequence,"".concat(this._n,".").concat("getReadReceiptDetail")),c=this._receiptDetailCompleteMap.get(s)||!1,u=0!==i&&1!==i?0:i,l=(i=lt(o)?o:"",o=!ze(e)||e<=0||100<=e?100:e,e="groupID:".concat(a," sequence:").concat(n," cursor:").concat(i," filter:").concat(u," completeFlag:").concat(c),Re.l("".concat(r," ").concat(e)),{cursor:"",isCompleted:!1,messageID:s,unreadUserIDList:[],readUserIDList:[]}),d=new ii("getReadReceiptDetail");return d.setMessage(e),this.req({P:jn.GET_READ_RECEIPT_DETAIL,data:{groupID:a,sequence:n,flag:u,cursor:i,count:o}}).then((function(e){d.end();var n=(e=e.data).cursor,i=e.isCompleted,o=e.unreadUserIDList;return e=e.readUserIDList,l.cursor=n,1===i&&(l.isCompleted=!0,t._receiptDetailCompleteMap.set(s,!0)),0===u?l.readUserIDList=e.map((function(e){return e.userID})):1===u&&(l.unreadUserIDList=o.map((function(e){return e.userID}))),Re.l("".concat(r," ok")),En(l)})).catch((function(e){return d.setError(e).end(),Re.w("".concat(r," failed. error:"),e),kn(e)}))}},{key:"getGroupReceiptsByUsers",value:function(e){var t="".concat(this._n,".").concat("getGroupReceiptsByUsers"),n=e.groupID,i=(e=void 0===(e=e.dataList)?[]:e,"groupID:".concat(n," dataList length:").concat(e.length));return Re.l("".concat(t," ").concat(i)),0===e.length&&Re.w("".concat(t," dataList is empty.")),this.req({P:jn.GET_GRP_RECEIPTS_BY_USERS,data:{groupID:n,dataList:e}}).then((function(e){return e=void 0===(e=e.data.dataList)?[]:e,Re.l("".concat(t," ok.")),En({dataList:e})})).catch((function(e){return Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessagesHopping"),i=e.groupID,o=e.count,a=e.sequence,s=e.direction,r=void 0;return dt(a)&&1===s?Tn({messageList:[],isCompleted:!0,nextMessageSeq:""}):(Tt(i)&&(i=Ft(r=i)),this._computeReqSeqHopping({groupID:i,topicID:r,sequence:a}).then((function(c){dt(a)||1!==s||(c=a+o-1);var u="".concat(r?"topicID:".concat(r):"groupID:".concat(i)," sequence:").concat(a," reqSeq:").concat(c," direction:").concat(s),l=(Re.l("".concat(n," ").concat(u)),new ii("getRoamingMessagesHopping"));return t.req({P:jn.GET_GRP_ROAMING_MSG,data:{groupID:i,topicID:r,count:o,sequence:c}}).then((function(i){var o=void 0===(o=(i=i.data).messageList)?[]:o,r=i.complete,c=void 0===(c=i.nextSequence)?0:c,d=(i=void 0===(i=i.invisibleSequenceList)?[]:i,"complete:".concat(r," nextSequence:").concat(c," remoteMsgCount:").concat(o.length," invisibleSequenceList:").concat(i)),h=(l.setMessage("".concat(u," ").concat(d)).end(),Re.l("".concat(n," ok. ").concat(d)),d="".concat(k.CONV_GROUP).concat(e.groupID),t.get(11));return d=h.onRoamingMessage(o,d,!1),o=t._computeResult({groupID:e.groupID,direction:s,sequence:a,remoteMessageList:o,processedMessageList:d,complete:r,nextSequence:c,invisibleSequenceList:i}),h.storeHoppingMessageList(o.messageList),En(o)})).catch((function(e){return l.setError(e).setMessage("groupID:".concat(i," sequence:").concat(a," count:").concat(o)).end(),Re.w("".concat(n," failed. error:"),e),kn(e)}))})))}},{key:"_computeReqSeqHopping",value:function(e){var t=this,n=e.groupID,i=void 0===(i=e.topicID)?void 0:i;return 0<(e=void 0===(e=e.sequence)?void 0:e)?Promise.resolve(e):dt(i)?this.getGroupProfileAdvance({groupIDList:[n],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then((function(e){var i=0;return je(e=e.data.successGroupList)||(i=e[0].nextMessageSeq-1),Re.l("".concat(t._n,"._computeReqSeqHopping groupID:").concat(n," lastSequence:").concat(i," from remote")),i})).catch((function(e){return kn(e)})):Promise.resolve(0)}},{key:"_computeResult",value:function(e){var t={messageList:[],isCompleted:!1,nextMessageSeq:""},n=e.groupID,i=e.direction,o=e.sequence,a=void 0===(a=e.remoteMessageList)?[]:a,s=void 0===(s=e.processedMessageList)?[]:s,r=e.complete,c=e.nextSequence;if(e=e.invisibleSequenceList,0===i)return t.nextMessageSeq=c,(2===r||c<1)&&(t.isCompleted=!0,t.nextMessageSeq=""),t.messageList=s,t;if(1===i){if(je(a)){if(je(e))return t.isCompleted=!0,t.nextMessageSeq="",t;t.nextMessageSeq=e[0]+1}else r=a[0].sequence,c=e[0]||0,t.nextMessageSeq=c<r?r+1:c+1;return s.forEach((function(e){e.sequence>=o&&t.messageList.push(e)})),(Et({groupID:n})||Tt(n))&&0===t.messageList.length&&a[0].sequence<o&&(t.isCompleted=!0,t.nextMessageSeq=""),t}}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,i=e.lastMessageSeq,o="".concat(this._n,".").concat("setMessageRead"),a=(e="convID:".concat(n," lastMessageSeq:").concat(i),Re.l("".concat(o," ").concat(e)),ze(i)||this.warn("DoNotModifyLastSeq"),new ii("setMessageRead")),s=(a.setMessage(e),n.replace(k.CONV_GROUP,"")),r=void 0;return Tt(s)&&(s=Ft(r=s)),this.req({P:jn.SET_GRP_MSG_READ,data:{groupID:s,topicID:r,messageReadSeq:i}}).then((function(){a.end(),Re.l("".concat(o," ok"));var e,c=t.get(11),u=(c.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:i}),!0);return!dt(r)&&(u=!1,e=t.get(10).getLocalTopic(s,r))&&e.updateSelfInfo({readedSequence:i}),c.updateUnreadCount(n,u),En()})).catch((function(e){return a.setError(e).end(),Re.l("".concat(o," failed. error:"),e),kn(e)}))}},{key:"_computeLastSequence",value:function(e){var t=e.groupID,n=void 0===(n=e.topicID)?void 0:n;return 0<(e=e.sequence)?Promise.resolve(e):dt(n)?this.getGroupLastSequence(t):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(e){var t="".concat(this._n,".").concat("getGroupLastSequence"),n=new ii("getGroupLastSequence"),i=0,o="",a="groupID:".concat(e);if(this.hasLocalGroup(e)){var s=this.getLocalGroupProfile(e),r=s.lastMessage;if(0<r.lastSequence&&!1===r.onlineOnlyFlag)return i=r.lastSequence,o="".concat(a,", ").concat(i," from group.lastMessage.lastSequence"),Re.l("".concat(t," ").concat(o)),n.setMessage(o).end(),Promise.resolve(i);if(1<s.nextMessageSeq)return i=s.nextMessageSeq-1,o="".concat(a,", ").concat(i," from group.nextMessageSeq"),Re.l("".concat(t," ").concat(o)),n.setMessage(o).end(),Promise.resolve(i)}return(r=this.get(11).getLocalConversation("GROUP".concat(e)))&&r.lastMessage.lastSequence&&!1===r.lastMessage.onlineOnlyFlag?(i=r.lastMessage.lastSequence,o="".concat(a,", ").concat(i," from conversation.lastMessage.lastSequence"),Re.l("".concat(t," ").concat(o)),n.setMessage(o).end(),Promise.resolve(i)):this.getGroupProfileAdvance({groupIDList:[e],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then((function(e){return je(e=e.data.successGroupList)?Re.w("".concat(t," ").concat(a,", empty successGroupList")):(i=e[0].nextMessageSeq-1,o="".concat(a,", ").concat(i," from remote"),Re.l("".concat(t," ").concat(o))),n.setMessage(o).end(),i})).catch((function(e){return n.setError(e).setMessage(a).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"isMessageFromOrToAVChatroom",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.hasJoinedAVChatRoom()}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.getJoinedAVChatRoom()}},{key:"getGroupRemoteLastSeq",value:function(e){return(e=this.getLocalGroupProfile(e))?e.nextMessageSeq-1:1}},{key:"isOnlineMessage",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||!0!==t.onlineUserOnly)}},{key:"_canIUseOnlineOnlyFlag",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==k.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(e,t){var n;je(e)||(Re.l("".concat(this._n,"._onAVChatRoomHistoryMessage groupID:").concat(t," count:").concat(e.length)),n=[],e.forEach((function(e){n.push(f(f({},e),{},{isHistoryMessage:1}))})),this.onAVChatRoomMessage(n,t))}},{key:"onAVChatRoomMessage",value:function(e){this._AVChatRoomHandler.onMessage(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")}},{key:"onAVChatRoomMemberBanned",value:function(e){this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:"setUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:"isUnjoinedAVChatRoom",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:"isGroupAttributesUpdatedNotice",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:"isMessageFromTopic",value:function(e,t){return 2===e&&!je(t)}},{key:"isMessageFromCommunityOfTopic",value:function(e,t){return 2===e&&je(t)}},{key:"getMessageExtensions",value:function(e,t){return Re.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.req({P:jn.GET_GRP_MSG_EXT,data:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return Re.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),this.req({P:jn.MODIFY_GRP_MSG_EXT,data:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"_genNotifyReqList",value:function(e){for(var t,n,i,o,a=[],s=0,r=e.length;s<r;s++)t=e[s],o=this.getLocalGroupProfile(t).type,n=this._getGroupLastRevokedTime(t),i=1e3*De(),o={notifyType:1,limit:20,type:Et({type:o,groupID:t})?k.GRP_COMMUNITY:void 0,groupID:t,beginTime:n,endTime:i},a.push(o);return a}},{key:"getNotice",value:function(e){var t=this,n="".concat(this._n,".getNotice");0!==(e=e.filter((function(e){var n;return!!t.hasLocalGroup(e)&&(n=(e=t.getLocalGroupProfile(e)).type,e=e.isSupportTopic,!Ct(n))&&!e}))).length&&(Re.l("".concat(n," list:").concat(e)),this.req({P:jn.GET_GRP_NOTIFY,data:{notifyReqList:this._genNotifyReqList(e)}}).then((function(e){e=e.data.notifyRspList;var i,o,a=[];We(e)&&(i={dataList:[]},o="".concat(n," ok."),e.forEach((function(e){var n=e.nextRevokedTime,s=e.groupID,r=e.notifyList;o+=" groupID:".concat(s," nextRevokedTime:").concat(n," count:").concat(r.length,"\n"),i.dataList.push({elements:{revokedInfos:t._genRevokedInfos(e)}}),0!==n?(t._setGroupLastRevokedTime(s,n),a.push(s)):t._setGroupLastRevokedTime(s,1e3*De())})),Re.l(o),t.onMsgRevoked(i,!1)),0<a.length&&t.getNotice(a)})).catch((function(e){Re.e("".concat(n," failed. error:"),e)})))}},{key:"_genRevokedInfos",value:function(e){var t=e.notifyList,n=e.groupID,i=[];return We(t)&&t.forEach((function(e){i.push({groupID:n,sequence:e.sequence,random:e.random,revokerInfo:f({},e.revokerInfo)})})),i}},{key:"_getGroupLastRevokedTime",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:"isGroupCountersNotice",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:"setGroupCounters",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:"getGroupMemberHandler",value:function(){return this._groupMemberHandler}},{key:"getGroupMemberList",value:function(e){return this._groupMemberHandler.getGroupMemberList(e)}},{key:"getGroupMemberProfile",value:function(e){return this._groupMemberHandler.getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){return this._groupMemberHandler.addGroupMember(e)}},{key:"deleteGroupMember",value:function(e){return this._groupMemberHandler.deleteGroupMember(e)}},{key:"setGroupMemberMuteTime",value:function(e){return this._groupMemberHandler.setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this._groupMemberHandler.setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this._groupMemberHandler.setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this._groupMemberHandler.setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this._groupMemberHandler.markGroupMemberList(e)}},{key:"modifyGroupMemberInfo",value:function(e){return this._groupMemberHandler.modifyGroupMemberInfo(e)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler.restartPolling()}},{key:"getPollingTimerID",value:function(e){var t;return e&&(t=this.getLocalGroupProfile(e))&&Ct(t.type)?this._AVChatRoomHandler.getPollingTimerID(e):-1}},{key:"_canIUseJoinOption",value:function(e){return e===k.GRP_PUBLIC||Et({type:e})}},{key:"_silentlyGetGroupProfile",value:function(e,t){var n=setTimeout(this.getGroupProfile.bind(this,{groupID:t}),3e3);this._timeoutIDs.push(n),Re.l("".concat(this._n,"._silentlyGetGroupProfile errorCode:").concat(e," groupID:").concat(t," timeoutIDs:").concat(this._timeoutIDs))}},{key:"_clearTimeoutIDs",value:function(){this._timeoutIDs.forEach((function(e){e&&clearTimeout(e)})),this._timeoutIDs=[]}},{key:"startMessageLongPolling",value:function(e){var t,n=e.groupID,i=e.longPollingKey,o=(e=void 0===(e=e.longPollingSequence)?1:e,this.get(12).isUnlimitedAVChatRoom());if(!je(i))return this._AVChatRoomHandler.hasPollingInstance(n)&&this.stopMessageLongPolling({groupID:n}),t=this._AVChatRoomHandler.getJoinedLiveList(),!o&&0<t.length&&this.stopMessageLongPolling({groupID:t[0]}),o=new Ki({groupID:n,type:k.GRP_LIVE}),Re.l("".concat(this._n,".startMessageLongPolling groupID:").concat(n," longPollingKey:").concat(i," longPollingSequence:").concat(e)),this._AVChatRoomHandler.startRunLoop({group:o,longPollingKey:i,startSeq:e});c("warn","at node_modules/@tencentcloud/chat/index.js:1","".concat(this._n,".startMessageLongPolling longPollingKey is empty."))}},{key:"stopMessageLongPolling",value:function(e){e=e.groupID;var t=this.get(11);return this._AVChatRoomHandler.reset(e),this._deleteLocalGroup(e),t.deleteLocalConv("".concat(k.CONV_GROUP).concat(e)),Re.l("".concat(this._n,".stopMessageLongPolling ok, groupID:").concat(e)),Tn({groupID:e})}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._onlineMemberCountMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler.reset(),this._groupMemberHandler.reset(),this._clearTimeoutIDs()}}])),ho=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],po=a((function e(t,n){i(this,e),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=xi(t.lastMessage,n),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(t)}),[{key:"_initTopic",value:function(e){for(var t in e)ho.indexOf(t)<0||("selfInfo"===t?this.updateSelfInfo(e[t]):this[t]="muteAllMembers"===t?1===e[t]:e[t])}},{key:"updateUnreadCount",value:function(){this.unreadCount=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0}},{key:"updateNextMessageSeq",value:function(e){this.nextMessageSeq=e}},{key:"updateLastMessage",value:function(e){this.lastMessage=xi(e)}},{key:"updateGroupAtInfoList",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:"updateTopic",value:function(e){dt(e.selfInfo)||this.updateSelfInfo(e.selfInfo),dt(e.muteAllMembers)||(this.muteAllMembers=1===e.muteAllMembers),et(this,e,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(e){return 0===et(this.selfInfo,e,[],[""])}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),go=(l(ko,Nn),a(ko,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("topic_cache_time"),t=this.getCloudConfig("topic_last_active_time");dt(e)||(this.TOPIC_CACHE_TIME=Number(e)),dt(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:"onTopicCreated",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOEvt(T.TOPIC_CREATED,e)}},{key:"onTopicDeleted",value:function(e){var t=this,n=e.groupID,i=e.topicIDList;(void 0===i?[]:i).forEach((function(e){t._deleteLocalTopic(n,e)})),this.emitOEvt(T.TOPIC_DELETED,e)}},{key:"onTopicProfileUpdated",value:function(e){var t=e.groupID,n=e.topicID;(n=this.getLocalTopic(t,n))&&(n.updateTopic(e),this.emitOEvt(T.TOPIC_UPDATED,{groupID:t,topic:n}))}},{key:"onTopicLatestMsg",value:function(e){var t,n,i=(e=e||{}).topicLatestMessage;e=e.excludedUnreadSequenceList,je(i)||(t=i.groupProfile.topicID,i.conversationType=k.CONV_GROUP,i.to=t,(n=new ki(i)).setElement(i.elements),this.updateUnreadCountAndLastMsg(t,n,e))}},{key:"onMessageRemindTypeUpdated",value:function(e){var t,n=e.groupID,i=e.topicID,o=(e=e.messageRemindType,this.getLocalTopic(n,i));o&&((t=o.updateSelfInfo({messageRemindType:e}))&&this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:o}),Re.l("".concat(this._n,".onMessageRemindTypeUpdated topicID:").concat(i," messageRemindType:").concat(e," isUpdated:").concat(t)))}},{key:"onAtInfoUpdated",value:function(e){var t=e.topicID,n=(e=e.groupAtInfoList,Ft(t));(t=this.getLocalTopic(n,t))&&!dt(e)&&(t.updateGroupAtInfoList(e),this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:t}))}},{key:"onUnreadCountUpdatedFromConv",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=Ft(e);(e=this.getLocalTopic(n,e))&&e.unreadCount!==t&&(e.updateUnreadCount(t),0===t&&e.updateSelfInfo({readedSequence:e.lastMessage.lastSequence}),this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:e}))}},{key:"onMessageSent",value:function(e){var t,n,i=e.groupID,o=e.topicID;e=e.lastMessage,(o=this.getLocalTopic(i,o))&&(n=(t=void 0===(t=e.sequence)?0:t)+1)>o.nextMessageSeq&&(o.updateNextMessageSeq(n),o.updateLastMessage(e),o.updateSelfInfo({readedSequence:t}),o.updateUnreadCount(0),this.emitOEvt(T.TOPIC_UPDATED,{groupID:i,topic:o}))}},{key:"onMessageModified",value:function(e){var t,n=e.to,i=e.time,o=e.sequence,a=e.elements,s=e.cloudCustomData,r=e.messageVersion,c=Ft(n),u=this.getLocalTopic(c,n);u&&(t=u.lastMessage,Re.d("".concat(this._n,".onMessageModified topicID:").concat(n," lastMessage:"),JSON.stringify(t),"options:",JSON.stringify(e)),t)&&(null===t.payload||t.lastTime===i&&t.lastSequence===o&&t.version!==r)&&(t.type=a[0].type,t.payload=a[0].content,t.messageForShow=Bt(t.type,t.payload,this.isIntl()),t.cloudCustomData=s,t.version=r,t.lastSequence=o,t.lastTime=i,this.emitOEvt(T.TOPIC_UPDATED,{groupID:c,topic:u}))}},{key:"onMessageRevoked",value:function(e){var t,n,i,o=this;0!==e.length&&(n=t=null,i=!1,e.forEach((function(e){var a=e.to;n=Ft(a),(t=o.getLocalTopic(n,a))&&(t.reduceUnreadCount()&&(i=!0),t.isLastMessageRevoked(e)&&(t.setLastMessageRevoked(!0),t.setLastMessageRevoker(e.revoker),i=!0),(a=t.selfInfo.excludedUnreadSequenceList||[]).push(e.sequence),t.updateSelfInfo({excludedUnreadSequenceList:a}))})),i)&&this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:t})}},{key:"isLastMessageRevoked",value:function(e){var t=e.topicID,n=(e=e.sequence,Ft(t));return n=this.getLocalTopic(n,t),t=!1,n?n.isLastMessageRevoked({sequence:e}):t}},{key:"updateUnreadCountAndLastMsg",value:function(e,t,n){var i,o=Ft(e),a=this.getLocalTopic(o,e);a&&(i=a.selfInfo.excludedUnreadSequenceList||[],dt(n)||(i=n),t._isExcludedFromUnreadCount&&i.push(t.sequence),a.updateSelfInfo({excludedUnreadSequenceList:i}),Re.l("".concat(this._n,".updateUnreadCountAndLastMsg seq:").concat(t.sequence," lastSeq:").concat(a.lastMessage.lastSequence)),t.sequence>a.lastMessage.lastSequence)&&(a.updateLastMessage(t),n=t.sequence+1,a.updateNextMessageSeq(n),i=this._computeUnreadCount(a),a.updateUnreadCount(i),(t=this.get(11).getLocalConversation("".concat(k.CONV_GROUP).concat(e)))&&t.updateUnreadCount({nextUnreadCount:i,isFromGetConversations:!0}),this.emitOEvt(T.TOPIC_UPDATED,{groupID:o,topic:a}))}},{key:"getJoinedCommunityList",value:function(){return this.get(7).syncCommunityWithTopic()}},{key:"createTopicInCommunity",value:function(e){var t,n=this,i="".concat(this._n,".").concat("createTopicInCommunity"),o=e.topicID;return dt(o)||Tt(o)?e.topicName&&!1===this._filterProfanity("topicName",e)||e.introduction&&!1===this._filterProfanity("introduction",e)||e.notification&&!1===this._filterProfanity("notification",e)?kn({code:Bn.PROFANITY_FOUND}):(t=new ii("createTopicInCommunity"),this.req({P:jn.CREATE_TOPIC,data:f({},e)}).then((function(o){return o=o.data.topicID,t.setMessage("topicID:".concat(o)).end(),Re.l("".concat(i," ok. topicID:").concat(o)),n._updateTopicMap([f(f({},e),{},{topicID:o})]),En({topicID:o})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(i," failed. error:"),e),kn(e)}))):kn({code:Bn.ILLEGAL_TOPIC_ID})}},{key:"deleteTopicFromCommunity",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteTopicFromCommunity"),i=e.groupID,o=(e=void 0===(e=e.topicIDList)?[]:e,new ii("deleteTopicFromCommunity"));return o.setMessage("groupID:".concat(i," topicIDList:").concat(e)),this.req({P:jn.DEL_TOPIC,data:{groupID:i,topicIDList:e}}).then((function(e){e=e.data.resultList;var a=[],s=[];return(void 0===e?[]:e).forEach((function(e){var t=e.topicID,n=e.errorCode;e=e.errorInfo,0===n?a.push({topicID:t}):s.push({topicID:t,code:n,message:e})})),e="success count:".concat(a.length,", fail count:").concat(s.length),o.setMoreMessage(e).end(),Re.l("".concat(n," ok. ").concat(e)),a.forEach((function(e){t._deleteLocalTopic(i,e.topicID)})),En({successTopicList:a,failureTopicList:s})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"updateTopicProfile",value:function(e){var t,n=this,i="".concat(this._n,".").concat("updateTopicProfile");return Re.l("".concat(i," options:"),e),e.topicName&&!1===this._filterProfanity("topicName",e)||e.introduction&&!1===this._filterProfanity("introduction",e)||e.notification&&!1===this._filterProfanity("notification",e)?kn({code:Bn.PROFANITY_FOUND}):((t=new ii("updateTopicProfile")).setMessage("groupID:".concat(e.groupID," topicID:").concat(e.topicID)),dt(e.muteAllMembers)||(e.muteAllMembers=!0===e.muteAllMembers?"On":"Off"),this.req({P:jn.UPDATE_TOPIC_PROFILE,data:f({},e)}).then((function(){return t.end(),Re.l("".concat(i," ok")),n._updateTopicMap([e]),En({topic:n.getLocalTopic(e.groupID,e.topicID)})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(i," failed. error:"),e),kn(e)})))}},{key:"getTopicList",value:function(e){var t=this,n="".concat(this._n,".").concat("getTopicList"),i=e.groupID,o=0===(e=void 0===(e=e.topicIDList)?[]:e).length,a=new ii("getTopicList");if(a.setMessage("groupID:".concat(i)),this._getTopicTimeMap.has(i)){var s=(r=this._getTopicTimeMap.get(i)).isGetAll,r=r.time;if((s||!s&&!o)&&Date.now()-r<1e3*this.TOPIC_CACHE_TIME&&(s=this._getLocalTopicList(i,e),o||s.length===e.length))return a.setMoreMessage("from cache, topic count:".concat(s.length)).end(),Re.l("".concat(n," groupID:").concat(i," from cache, topic count:").concat(s.length)),Tn({successTopicList:s,failureTopicList:[]})}return this.req({P:jn.GET_TOPIC_LIST,data:{groupID:i,topicIDList:e}}).then((function(e){e=e.data.topicInfoList;var s=[],r=[],c=[];return(void 0===e?[]:e).forEach((function(e){var t=e.topic,n=e.selfInfo,i=e.errorCode,o=(e=e.errorInfo,t.topicID);0===i?(s.push(f(f({},t),{},{selfInfo:n})),r.push(o)):c.push({topicID:o,code:i,message:e})})),t._updateTopicMap(s),t._handleTopicAtInfo(s),e="success count:".concat(r.length,", fail count:").concat(c.length),a.setMoreMessage(e).end(),Re.l("".concat(n," groupID:").concat(i," from remote, ").concat(e)),e=[],je(r)||(t._getTopicTimeMap.set(i,{time:Date.now(),isGetAll:o}),e=t._getLocalTopicList(i,r)),En({successTopicList:e,failureTopicList:c})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"hasLocalTopic",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:"getLocalTopic",value:function(e,t){var n=null;return this._topicMap.has(e)?this._topicMap.get(e).get(t):n}},{key:"_getLocalTopicList",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=[];return(e=this._topicMap.get(e))&&(n=y(e.values())),0===t.length?n:n.filter((function(e){return t.includes(e.topicID)}))}},{key:"_deleteLocalTopic",value:function(e,t){this._topicMap.has(e)&&this._topicMap.get(e).has(t)&&(this._topicMap.get(e).delete(t),Re.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(e," topicID:").concat(t)))}},{key:"_updateTopicMap",value:function(e){var t=this,n=[];e.forEach((function(e){var i=e.groupID,o=e.topicID,a=null;t._topicMap.has(i)||t._topicMap.set(i,new Map),t._topicMap.get(i).has(o)?(a=t._topicMap.get(i).get(o)).updateTopic(e):(t._getTopicLastMessage(e),a=new po(e,t.isIntl()),t._topicMap.get(i).set(o,a)),e=t._computeUnreadCount(a),a.updateUnreadCount(e),n.push({conversationID:"".concat(k.CONV_GROUP).concat(o),type:k.CONV_TOPIC,unreadCount:e})})),0<n.length&&this.get(11).updateTopicConversation(n)}},{key:"resetGetTopicTime",value:function(e){var t=this;dt(e)?y(this._getTopicTimeMap.keys()).forEach((function(e){t._getTopicTimeMap.set(e,0)})):this._getTopicTimeMap.set(e,0)}},{key:"getTopicListOnReconnected",value:function(){var e=this,t=y(this._topicMap.keys()),n=[],i=this.get(11);t.forEach((function(t){var o=[],a=e._getLocalTopicList(t);i.deleteTopicRoamingInfo(t),a.forEach((function(t){var n=void 0===(n=t.lastMessage.lastTime)?0:n;Date.now()-1e3*n<1e3*e.TOPIC_LAST_ACTIVE_TIME&&o.push(t.topicID)})),0<o.length&&n.push({groupID:t,topicIDList:o})})),Re.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(n.length)),this._relayGetTopicList(n)}},{key:"_relayGetTopicList",value:function(e){var t,n,i,o=this;0!==e.length&&(n=5<(t=e.shift()).topicIDList.length?"topicIDList.length:".concat(t.topicIDList.length):"topicIDList:".concat(t.topicIDList),(i=new ii("relayGetTopicList")).setMessage(n),Re.l("".concat(this._n,"._relayGetTopicList. ").concat(n)),this.getTopicList(t).then((function(){i.end(),o._relayGetTopicList(e)})).catch((function(t){i.setError(t).end(),o._relayGetTopicList(e)})))}},{key:"_handleTopicAtInfo",value:function(e){var t=this;0!==e.length&&e.forEach((function(e){var n=e.groupID,i=e.topicID,o=(e=e.groupAtInfoList,[]);dt(e)||(e.forEach((function(e){o.push(f(f({},e),{},{groupID:n,topicID:i}))})),t.get(11).onNewGroupAtTips({dataList:o}))}))}},{key:"_getTopicLastMessage",value:function(e){var t;dt(e.lastMsg)||(t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:"",nick:e.lastMsg.nick,avatar:e.lastMsg.avatar,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:2===e.lastMsg.isPlaceMessage,revoker:je(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker},e.lastMessage=t)}},{key:"deleteTopicListInCommunity",value:function(e){var t=this,n=this._getLocalTopicList(e),i=this.get(11);n.forEach((function(n){n=n.topicID,t._deleteLocalTopic(e,n),t._getTopicTimeMap.delete(e),i.deleteLocalConv("".concat(k.CONV_GROUP).concat(n))}))}},{key:"_computeUnreadCount",value:function(e){var t,n=(o=e.selfInfo).excludedUnreadSequenceList,i=o.readedSequence,o=e.nextMessageSeq-e.selfInfo.readedSequence-1;return We(n)&&(t=0,n.forEach((function(n){i<n&&n<=e.nextMessageSeq-1&&(t+=1)})),1<=t)&&(o-=t),o<0?0:o}},{key:"_filterProfanity",value:function(e,t){var n,i=this.get(29);return!i||(n=(i=i.filterText(t[e],U)).isAllowedToSend,i=i.modifiedText,!0===n&&(t[e]=i,!0))}},{key:"getMessageExtensions",value:function(e,t){Re.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t));var n=Ft(e.to);return this.req({P:jn.GET_GRP_MSG_EXT,data:{groupID:n,topicID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=(Re.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),Ft(e.to));return this.req({P:jn.MODIFY_GRP_MSG_EXT,data:{groupID:i,topicID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}])),fo=a((function e(t){i(this,e),this._userM=t,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}),[{key:"setExpirationTime",value:function(e){this.expirationTime=e}},{key:"getUserProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getUserProfile"),i=e.userIDList;e.fromAccount=this._userM.getMyAccount(),100<i.length&&(Re.w("".concat(n," ").concat(Ht(100))),i.length=100);for(var o,a=[],s=[],r=0,c=i.length;r<c;r++)o=i[r],this._userM.isMyFriend(o)&&this._contains(o)?s.push(this._getProfileFromMap(o)):a.push(o);if(0===a.length)return Tn(s);e.toAccount=a;var u=e.bFromGetMyProfile||!1,l=[],d=(e.toAccount.forEach((function(e){l.push({toAccount:e,standardSequence:0,customSequence:0})})),e.userItem=l,new ii("getUserProfile"));return d.setMessage(5<i.length?"userIDList.length:".concat(i.length):"userIDList:".concat(i)),this._userM.req({P:jn.GET_USER_PROFILE,data:e}).then((function(e){return d.end(),Re.i("".concat(n," ok")),e=t._handleResponse(e).concat(s),En(u?e[0]:e)})).catch((function(e){return d.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"getMyProfile",value:function(){var e,t=this._userM.getMyAccount(),n="".concat(this._n,".getMyProfile");return Re.l("".concat(n," myAccount:").concat(t)),this._fill(),this._contains(t)?(e=this._getProfileFromMap(t),Re.d("".concat(n," from cache, myProfile:").concat(JSON.stringify(e))),Tn(e)):this.getUserProfile({fromAccount:t,userIDList:[t],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(e){var t=e.data.userProfileItem;if(!We(t))return[];for(var n=[],i=(e=Date.now(),0),o=t.length;i<o;i++){var a=(s=t[i]).to,s=s.profileItem;"@TLS#NOT_FOUND"!==a&&""!==a&&(a=this._update(a,this._getLatestProfileFromResponse(a,s)).latestProfile,n.push(a))}return Re.l("".concat(this._n,"._handleResponse cost:").concat(Yt(e))),n}},{key:"_getLatestProfileFromResponse",value:function(e,t){var n={userID:e,profileCustomField:[]};if(!je(t))for(var i=0,o=t.length;i<o;i++)if(-1<t[i].tag.indexOf("Tag_Profile_Custom"))n.profileCustomField.push({key:t[i].tag,value:t[i].value});else switch(t[i].tag){case Oe.NICK:n.nick=t[i].value;break;case Oe.GENDER:n.gender=t[i].value;break;case Oe.BIRTHDAY:n.birthday=t[i].value;break;case Oe.LOCATION:n.location=t[i].value;break;case Oe.SELFSIGNATURE:n.selfSignature=t[i].value;break;case Oe.ALLOWTYPE:n.allowType=t[i].value;break;case Oe.LANGUAGE:n.language=t[i].value;break;case Oe.AVATAR:n.avatar=t[i].value;break;case Oe.MESSAGESETTINGS:n.messageSettings=t[i].value;break;case Oe.ADMINFORBIDTYPE:n.adminForbidType=t[i].value;break;case Oe.LEVEL:n.level=t[i].value;break;case Oe.ROLE:n.role=t[i].value;break;default:Re.w("".concat(this._n,"._getLatestProfileFromResponse unknown tag:"),t[i].tag,t[i].value)}return n}},{key:"updateMyProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateMyProfile");if(e.nick&&!1===this._userM.filterProfanity("nick",e))return kn({code:Bn.PROFANITY_FOUND});if(e.selfSignature&&!1===this._userM.filterProfanity("selfSignature",e))return kn({code:Bn.PROFANITY_FOUND});var i=new ii("updateMyProfile"),o=(i.setMessage(JSON.stringify(e)),(new ji).validate(e));if(!o.valid)return i.setCode(Bn.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage("info:".concat(o.tips)).end(),Re.e("".concat(n," info:").concat(o.tips)),kn({code:Bn.UPDATE_PROFILE_INVALID_PARAM});var a,s,r=[];for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&("profileCustomField"===a?e.profileCustomField.forEach((function(e){r.push({tag:e.key,value:e.value})})):r.push({tag:Oe[a.toUpperCase()],value:e[a]}));return 0===r.length?(o=new Fn({code:Bn.UPDATE_PROFILE_NO_KEY}),i.setError(o).end(),Re.e("".concat(n," failed. error:"),o),kn(o)):(s=this._userM.getMyAccount(),this._userM.req({P:jn.UPDATE_MY_PROFILE,data:{fromAccount:s,profileItem:r}}).then((function(o){i.end(),Re.i("".concat(n," ok"));var a=(r=t._update(s,e)).isProfileUpdated,r=r.latestProfile;return!0===a&&t._userM.emitOEvt(T.PROFILE_UPDATED,[r]),Tn(r)})).catch((function(e){return i.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)})))}},{key:"onProfileModified",value:function(e){var t=e.dataList;if(!je(t)){var n=t.length;Re.d("".concat(this._n,".onProfileModified count:").concat(n," dataList:"),e.dataList);for(var i=[],o=0;o<n;o++){var a=t[o].userID,s=(a=this._update(a,this._getLatestProfileFromResponse(a,t[o].profileList))).isProfileUpdated;a=a.latestProfile,!0===s&&i.push(a)}0<i.length&&(this._userM.emitIEvt(Oi.PROFILE_UPDATED,i),this._userM.emitOEvt(T.PROFILE_UPDATED,i))}}},{key:"_fill",value:function(){if(0===this.accountProfileMap.size){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,i=e.length;n<i;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);Re.l("".concat(this._n,"._fill from cache, size:").concat(this.accountProfileMap.size))}}},{key:"_update",value:function(e,t){var n,i=!1,o=Date.now();return this._contains(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&!0===vt(n.profileCustomField,t.profileCustomField)&&(n.lastUpdatedTime=o,i=!0),0<et(n,t,["profileCustomField"])&&(n.lastUpdatedTime=o,i=!0)):(n=new ji(t),!this._userM.isMyFriend(e)&&e!==this._userM.getMyAccount()||(n.lastUpdatedTime=o,i=!0,this.accountProfileMap.set(e,n))),this._flush(e===this._userM.getMyAccount()),!0===i&&Re.l("".concat(this._n,"._update account:").concat(e," isUpdated:").concat(i)),{isProfileUpdated:i,latestProfile:n}}},{key:"_flush",value:function(e){var t=y(this.accountProfileMap.values()),n=this._userM.getStorageModule();Re.d("".concat(this._n,"._flush length:").concat(t.length," flushAtOnce:").concat(e)),n.setItem(this.TAG,t,e)}},{key:"_contains",value:function(e){return this.accountProfileMap.has(e)}},{key:"_getProfileFromMap",value:function(e){return this.accountProfileMap.get(e)}},{key:"_getCachedProfiles",value:function(){var e=this._userM.getStorageModule().getItem(this.TAG);return je(e)?[]:e}},{key:"onConvProfileUpdated",value:function(e){for(var t,n,i=[],o=0,a=e.length;o<a;o++)n=(t=e[o]).userID,this._userM.isMyFriend(n)&&(this._contains(n)?0<et(this._getProfileFromMap(n),t)&&i.push(n):i.push(t.userID));0!==i.length&&(Re.l("".concat(this._n,".onConvProfileUpdated toAccountList:").concat(i)),this.getUserProfile({userIDList:i}))}},{key:"getNickAndAvatarByUserID",value:function(e){return this._contains(e)?{nick:(e=this._getProfileFromMap(e)).nick,avatar:e.avatar}:{nick:"",avatar:""}}},{key:"getUserNickAndAvatar",value:function(e){var t,n=this,i=y(new Set(e)),o=(Re.l("".concat(this._n,".getUserNickAndAvatar userIDList.length:").concat(e.length," uniqueUserIDList.length:").concat(i.length)),[]);return 0===e.length?Promise.resolve(o):(e=this._createUserIDListGroup(i),t=[],e.forEach((function(e){t.push(n.getUserProfile({userIDList:e}))})),Promise.all(t).then((function(e){return e.forEach((function(e){e=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}})),o.push.apply(o,y(e))})),o})))}},{key:"_createUserIDListGroup",value:function(e){for(var t=[],n=0;n<e.length;)t.push(e.slice(n,n+=100));return t}},{key:"reset",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),mo=a((function e(t){i(this,e)})),_o=a((function e(t){i(this,e),this._userM=t,this._n="BlacklistHandler",this._blacklistMap=new Map,this._startIndex=0}),[{key:"getLocalBlacklist",value:function(){return y(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var e=this,t="".concat(this._n,".getBlacklist"),n={fromAccount:this._userM.getMyAccount(),maxLimited:100,startIndex:this._startIndex},i=new ii("getBlacklist");return this._userM.req({P:jn.GET_BL,data:n}).then((function(n){var o=(n=n.data).blackListItem,a=(n=n.startIndex,je(o)?0:o.length);i.setMessage("count:".concat(a)).end(),Re.i("".concat(t," ok")),e._startIndex=n,e._handleResponse(o,!0),e._userM.emitOEvt(T.BLACKLIST_UPDATED,y(e._blacklistMap.keys())),0!==e._startIndex&&e.getBlacklist()})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))}},{key:"addBlacklist",value:function(e){var t,n,i=this,o=new ii("addToBlacklist"),a="".concat(this._n,".addBlacklist"),s=this._userM.getMyAccount();return 1===e.userIDList.length&&e.userIDList[0]===s?(n=this._userM.getErrMsg(t=Bn.CANNOT_ADD_SELF_TO_BLACKLIST),o.setCode(t).setMessage(n).end(),n=new Fn({code:t}),Re.e("".concat(a," failed. error:"),n),kn(n)):(e.userIDList.includes(s)&&(e.userIDList=e.userIDList.filter((function(e){return e!==s}))),e.fromAccount=this._userM.getMyAccount(),e.toAccount=e.userIDList,this._userM.req({P:jn.ADD_TO_BL,data:e}).then((function(t){return o.setMessage(5<e.userIDList.length?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Re.i("".concat(a," ok")),i._handleResponse(t.resultItem,!0),En(y(i._blacklistMap.keys()))})).catch((function(e){return o.setError(e).end(),Re.e("".concat(a," failed. error:"),e),kn(e)})))}},{key:"_handleResponse",value:function(e,t){if(!je(e))for(var n,i,o,a=0,s=e.length;a<s;a++)i=e[a].to,o=e[a].resultCode,!dt(o)&&0!==o||(t?((n=this._blacklistMap.has(i)?this._blacklistMap.get(i):new mo).userID=i,je(e[a].addBlackTimeStamp)||(n.timeStamp=e[a].addBlackTimeStamp),this._blacklistMap.set(i,n)):this._blacklistMap.has(i)&&(n=this._blacklistMap.get(i),this._blacklistMap.delete(i)));Re.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(t))}},{key:"deleteBlacklist",value:function(e){var t=this,n="".concat(this._n,".deleteBlacklist"),i=new ii("removeFromBlacklist");return e.fromAccount=this._userM.getMyAccount(),e.toAccount=e.userIDList,this._userM.req({P:jn.RM_FROM_BL,data:e}).then((function(o){return i.setMessage(5<e.userIDList.length?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Re.i("".concat(n," ok")),t._handleResponse(o.data.resultItem,!1),En(y(t._blacklistMap.keys()))})).catch((function(e){return i.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))}},{key:"onAccountDeleted",value:function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];this._blacklistMap.has(i)&&this._blacklistMap.delete(i)}var o=e.length;0<o&&(Re.l("".concat(this._n,".onAccountDeleted count:").concat(o," ").concat(o<30?"userIDList:".concat(e):"")),this._userM.emitOEvt(T.BLACKLIST_UPDATED,y(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(e){for(var t,n=[],i=0,o=e.length;i<o;i++)t=e[i],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new mo({userID:t})),n.push(t));0<n.length&&(Re.l("".concat(this._n,".onAccountAdded count:").concat(n.length," userIDList:"),n),this._userM.emitOEvt(T.BLACKLIST_UPDATED,y(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this._startIndex=0}}]),vo=a((function e(t){i(this,e),this._userM=t,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userM.getIEmitInst().on(Oi.CLOUD_CONFIG,this._onCloudConfig,this)}),[{key:"_onCloudConfig",value:function(){var e=this._userM.getCloudConfig("status_query_count"),t=this._userM.getCloudConfig("status_sub_count"),n=this._userM.getCloudConfig("status_unsub_count");Re.l("".concat(this._n,"._onCloudConfig statusQueryCount:").concat(e," statusSubscribeCount:").concat(t)+" statusUnsubscribeCount:".concat(n)),dt(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),dt(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),dt(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:"onUserStatusUpdated",value:function(e){e=e.dataList;var t=this._userM.getMyUserID(),n=this._userM.get(12);e=e.map((function(e){var i=e.to,o=e.statusType;return e=Fi(e=e.customStatus),i===t&&n.setCustomStatus(e),{userID:i,statusType:o,customStatus:e}})),Re.l("".concat(this._n,".onUserStatusUpdated list:").concat(JSON.stringify(e))),this._userM.emitOEvt(T.USER_STATUS_UPDATED,e)}},{key:"setSelfStatus",value:function(e){var t,n,i=this,o="".concat(this._n,".setSelfStatus");return!1===this._userM.filterProfanity("customStatus",e)?kn({code:Bn.PROFANITY_FOUND}):(t=new ii("setSelfStatus"),n=e.customStatus,this._userM.req({P:jn.SET_SELF_STATUS,data:{customStatus:n}}).then((function(e){return t.setMessage("customStatus:".concat(n)).end(),Re.l("".concat(o," ok. customStatus:").concat(n)),i._userM.get(12).setCustomStatus(n),En({userID:i._userM.getMyUserID(),statusType:1,customStatus:n})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(o," failed. error:"),e),kn(e)})))}},{key:"getUserStatus",value:function(e){var t="".concat(this._n,".").concat("getUserStatus"),n=void 0===(e=e.userIDList)?[]:e,i=(e=this._userM.getMyUserID(),y(n)),o=void 0,a=i.indexOf(e);if(-1<a&&(i.splice(a,1),o={userID:e,statusType:1,customStatus:this._userM.get(12).getCustomStatus()}),0===i.length)return Tn({successUserList:[o],failureUserList:[]});if(!this._userM.canIUse(P.USER_STATUS))return this._userM.noUse("getUserStatus");i.length>this.MAX_QUERY_USER_COUNT&&(Re.w("".concat(t," ").concat(Ht(this.MAX_QUERY_USER_COUNT))),i=n.slice(0,this.MAX_QUERY_USER_COUNT));var s=new ii("getUserStatus");return this._userM.req({P:jn.GET_USER_STATUS,data:{userIDList:i}}).then((function(e){var i=void 0===(i=(e=e.data).successUserList)?[]:i,a=(e=void 0===(e=e.failureUserList)?[]:e,i=i.map((function(e){return{userID:e.userID,statusType:e.statusType,customStatus:Fi(e=e.customStatus)}})),e=e.map((function(e){var t=e.userID,n=e.invalidUserID,i=e.errorCode;return e=e.errorInfo,{userID:je(n)?t:n,code:i,message:e}})),dt(o)||i.unshift(o),"userID count:".concat(n.length,", success count:").concat(i.length,", fail count:").concat(e.length));return s.setMessage("".concat(a)).end(),Re.l("".concat(t," ok. ").concat(a,".")),En({successUserList:i,failureUserList:e})})).catch((function(e){return s.setMessage("userID count:".concat(n.length)).setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))}},{key:"subscribeUserStatus",value:function(e){var t,n,i,o,a="subscribeUserStatus";return this._userM.canIUse(P.USER_STATUS)?(t="".concat(this._n,".").concat(a),(n=y(e=void 0===(e=e.userIDList)?[]:e)).length>this.MAX_SUBSCRIBE_USER_COUNT&&(Re.w("".concat(t," ").concat(Ht(this.MAX_SUBSCRIBE_USER_COUNT))),n=e.slice(0,this.MAX_SUBSCRIBE_USER_COUNT)),i=new ii(a),o="userID count:".concat(e.length),Re.l("".concat(t," ").concat(o)),this._userM.req({P:jn.SUB_USER_STATUS,data:{userIDList:n}}).then((function(e){return e=(void 0===(e=e.data.failureUserList)?[]:e).map((function(e){var t=e.userID,n=e.invalidUserID,i=e.errorCode;return e=e.errorInfo,{userID:je(n)?t:n,code:i,message:e}})),i.setMessage("".concat(o," fail count:").concat(e.length)).end(),Re.l("".concat(t," ok. fail count:").concat(e.length,".")),En({failureUserList:e})})).catch((function(e){return i.setMessage(o).setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._userM.noUse(a)}},{key:"unsubscribeUserStatus",value:function(e){var t,n,i,o,a="unsubscribeUserStatus";return this._userM.canIUse(P.USER_STATUS)?(t="".concat(this._n,".").concat(a),n=y(e=void 0===(e=(e||{}).userIDList)?[]:e),e.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(Re.w("".concat(t," ").concat(Ht(this.MAX_UNSUBSCRIBE_USER_COUNT))),n=e.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT)),i=new ii(a),o="userID count:".concat(e.length),Re.l("".concat(t," ").concat(o)),e={userIDList:n},0===n.length&&(e.userIDList=void 0,e.unsubscribeAll=1),this._userM.req({P:jn.UNSUB_USER_STATUS,data:e}).then((function(e){return e=(void 0===(e=e.data.failureUserList)?[]:e).map((function(e){var t=e.userID,n=e.invalidUserID,i=e.errorCode;return e=e.errorInfo,{userID:je(n)?t:n,code:i,message:e}})),i.setMessage("".concat(o," fail count:").concat(e.length)).end(),Re.l("".concat(t," ok. fail count:").concat(e.length,".")),En({failureUserList:e})})).catch((function(e){return i.setMessage("".concat(o)).setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this._userM.noUse(a)}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),yo=(l(To,Nn),a(To,[{key:"onContextUpdated",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"mockOnNickAvatarModified",value:function(e,t){Re.l("".concat(this._n,"._mockOnNickAvatarModified nick:").concat(e," avatar:").concat(t)),this.onProfileModified({dataList:[{pushType:1,userID:this.getMyUserID(),profileList:[{tag:Oe.NICK,value:e},{tag:Oe.AVATAR,value:t}]}]})}},{key:"onProfileModified",value:function(e){this._profileHandler.onProfileModified(e)}},{key:"onRelationChainModified",value:function(e){var t,n;je(e=e.dataList)||(t=[],e.forEach((function(e){e.blackListDelAccount&&t.push.apply(t,y(e.blackListDelAccount))})),0<t.length&&this._blacklistHandler.onAccountDeleted(t),n=[],e.forEach((function(e){e.blackListAddAccount&&n.push.apply(n,y(e.blackListAddAccount))})),0<n.length&&this._blacklistHandler.onAccountAdded(n))}},{key:"onConvProfileUpdated",value:function(e){this._profileHandler.onConvProfileUpdated(e)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyNick",value:function(){return this._profileHandler.getNickAndAvatarByUserID(this.getMyUserID()).nick}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.get(13)}},{key:"filterProfanity",value:function(e,t){var n,i=this.get(29);return!i||(n=(i=i.filterText(t[e],"user_profile")).isAllowedToSend,i=i.modifiedText,!0===n&&(t[e]=i,!0))}},{key:"isMyFriend",value:function(e){var t=this.get(8);return!!t&&t.isMyFriend(e)}},{key:"getUserProfile",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:"getNickAndAvatarByUserID",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:"getUserNickAndAvatar",value:function(e){return this._profileHandler.getUserNickAndAvatar(e)}},{key:"getLocalBlacklist",value:function(){return Tn(this._blacklistHandler.getLocalBlacklist())}},{key:"addBlacklist",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:"deleteBlacklist",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:"onUserStatusUpdated",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:"setSelfStatus",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}])),Io=a((function e(t,n){i(this,e),this._m=t,this._isLoggedIn=!1,this._SDKAppID=n.SDKAppID,this._userID=n.userID||"",this._userSig=n.userSig||"",this._version="3.5.5",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=n.unlimitedAVChatRoom,this._scene=n.scene||"",this._oversea=n.oversea,this._instanceID=n.instanceID,this._statusInstanceID=0,this._isDevMode=n.devMode,this._isTestEnv=n.testEnv,this._proxyServer=n.proxyServer,this._fileUploadProxy=n.fileUploadProxy,this._fileDownloadProxy=n.fileDownloadProxy,this._applicationID=0,this._isPartialUpdatedConvs=n.partialUpdatedConversations,this._isIndependentDomainDisabled=n.disableIndependentDomain,this._isUsingChatCore=!1,this._uiPlatform=0,this._authKey="",this._customLoginInfo=""}),[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isTestEnv",value:function(){return this._isTestEnv}},{key:"isPartialUpdatedConvs",value:function(){return this._isPartialUpdatedConvs}},{key:"isIndependentDomainDisabled",value:function(){return this._isIndependentDomainDisabled}},{key:"isSingaporeSite",value:function(){return 2e7<=this._SDKAppID&&this._SDKAppID<3e7||172e7<=this._SDKAppID&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return 3e7<=this._SDKAppID&&this._SDKAppID<4e7||173e7<=this._SDKAppID&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return 4e7<=this._SDKAppID&&this._SDKAppID<5e7||174e7<=this._SDKAppID&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return 5e7<=this._SDKAppID&&this._SDKAppID<6e7||175e7<=this._SDKAppID&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return 6e7<=this._SDKAppID&&this._SDKAppID<7e7||176e7<=this._SDKAppID&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return 7e7<=this._SDKAppID&&this._SDKAppID<8e7||177e7<=this._SDKAppID&&this._SDKAppID<178e7}},{key:"isIndonesiaSite",value:function(){return 8e7<=this._SDKAppID&&this._SDKAppID<9e7||178e7<=this._SDKAppID&&this._SDKAppID<179e7}},{key:"isIntl",value:function(){return 0===(e=this._SDKAppID)||2e7<=e&&e<9e7||172e7<=e&&e<179e7;var e}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"isUsingChatCore",value:function(){return this._isUsingChatCore}},{key:"setUsingChatCore",value:function(e){this._isUsingChatCore=e}},{key:"getUIPlatform",value:function(){return this._uiPlatform}},{key:"setUIPlatform",value:function(e){this._uiPlatform=e}},{key:"setUserID",value:function(e){this._userID=e}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(e){this._userSig=e}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(e){this._customStatus=e}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return me?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(e){this._statusInstanceID=e}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(e){this._a2Key=e}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"getFileUploadProxy",value:function(){return this._fileUploadProxy}},{key:"getFileDownloadProxy",value:function(){return this._fileDownloadProxy}},{key:"setApplicationID",value:function(e){this._applicationID=e}},{key:"getApplicationID",value:function(){return this._applicationID}},{key:"setDowloadFileAuthKey",value:function(e){this._authKey=e}},{key:"getDownloadFileAuthKey",value:function(){return this._authKey}},{key:"setCustomLoginInfo",value:function(e){this._customLoginInfo=e}},{key:"getCustomLoginInfo",value:function(){return this._customLoginInfo}},{key:"_isTUIKit",value:function(){var e=!1,t=!1,n=!1,i=!1,o=[];Q&&(o=Object.keys(ie));for(var a=0,s=(o=ne?Z?Object.keys(uni):Object.keys(window):o).length;a<s;a++)if(o[a].toLowerCase().includes("uikit")){e=!0;break}o=null;var r,c=(Q&&!Xe(ie.createGamePortal)&&Xe(getApp)&&!dt(getApp())&&$e(r=getApp().globalData)&&!0===r.isTUIKit&&(t=!0),!0===this._m.get(13).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))&&(n=!0),null);if(q&&!z&&"undefined"==typeof uni&&__wxConfig&&(c=__wxConfig.pages),K&&"undefined"==typeof uni&&__qqConfig&&(c=__qqConfig.pages),We(c)&&0<c.length){for(var u=0,l=c.length;u<l;u++)if(c[u].toLowerCase().includes("tui")){i=!0;break}c=null}return e||t||n||i}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),Mo={"k-vue2-pc":1,"k-vue2-h5":2,"k-vue2-h5-uni":3,"k-vue2-app-uni":4,"k-vue2-mp-uni":5,"k-vue2-pc-uni":6,"k-vue3-pc":7,"k-vue3-h5":8,"k-vue3-h5-uni":9,"k-vue3-app-uni":10,"k-vue3-mp-uni":11,"k-vue3-pc-uni":12,"k-rn":13},Co=(l(Eo,Nn),a(Eo,[{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:"getPushModule",value:function(){var e=void 0,t=this.get(36),n=this.get(28);return t.canIUseTIMPush()?e=t:n.canIUseOfflinePush()&&(e=n),e}},{key:"login",value:function(e){if(this.isLoggedIn())return n=this.getMyUserID(),(n=this.getErrMsg("RepeatLogin",n))&&Re.w(n),Tn({actionStatus:"OK",errorCode:0,errorInfo:n,repeatLogin:!0});if(Date.now()-this._lastLoginTs<=15e3)return this.warn("LoggingIn",e.userID),kn({code:Bn.REPEAT_LOGIN});Re.l("".concat(this._n,".login userID:").concat(e.userID));var t,n=this._checkLoginInfo(e);return 0!==n.code?kn(n):(n=this.get(12),t=e.userID,e=e.userSig,n.setUserID(t),n.setUserSig(e),this.get(20).updateProtocolConfig(),this._login())}},{key:"_login",value:function(){var e=this,t=this.get(12),n=t.getScene(),i=0,o=n,a=(n&&n.startsWith("k-")&&(o=Mo[n],n="tuikit"),new ii("login")),s=(a.setMessage("".concat(o)).setMoreMessage("identifier:".concat(this.getMyUserID())),"tuikit"===n),r=0,c=(Z?r=s?3===o||4===o||5===o||6===o?31:9===o||10===o||11===o||12===o?32:4:3:Q?r=H?36:"tuikit"===n?12:11:ne?r=me?"flutter_web_uikit"===n?21:20:this._isReactUIKit()?fe?25:24:s?1===o||2===o?29:7===o||8===o?30:fe?17:14:fe?16:13:13===o&&(r=38),a.setUIPlatform(r),t.setUIPlatform(r),(s=this.getPushModule())&&(this._isWebUniapp=s.getUniAppPlatform(),o=this._getStatusInstanceID(),t.setStatusInstanceID(o),this.get(20).updateProtocolConfig(),i=s.getDeviceBrand()),"".concat(this._n,"._login"));return this._lastLoginTs=Date.now(),this.req({P:jn.LOGIN,data:{deviceBrand:i,isWebUniapp:this._isWebUniapp,customInfo:t.getCustomLoginInfo()}}).then((function(i){e._lastLoginTs=0;var o=Date.now(),s=null,r=(f=i.data).a2Key,u=f.tinyID,l=f.helloInterval,d=f.instanceID,h=f.timeStamp,p=void 0===(p=f.customStatus)?"":p,g=f.purchaseBits,f=void 0===(f=f.authKey)?"":f,m=1e3*h,_=o-a.getStartTs();if(_=m+parseInt(_/2)-o,o=a.getStartTs()+_,a.start(o),o=m,Se=_,(m=new Date).setTime(o),Re.i("baseTime from server:".concat(m," offset:").concat(Se)),u){if(r)return o=e.get(21).getSocketID(),m=Fi(p),p="socketID:".concat(o," scene:").concat(n," helloInterval:").concat(l," instanceID:").concat(d," timeStamp:").concat(h)+" offset:".concat(_," customStatus:").concat(m," isWebUniapp:").concat(e._isWebUniapp),Re.l("".concat(c," ok. ").concat(p)),h=o="",q&&Xe(ie.getAccountInfoSync)&&(_=ie.getAccountInfoSync().miniProgram)&&(o=_.appId,h=_.envVersion),a.setMoreMessage("".concat(p," href:").concat(ne?window.location.href:""," mpAppId:").concat(o," envVersion:").concat(h," authKey:").concat(f)).end(),t.setA2Key(r),t.setTinyID(u),t.setStatusInstanceID(d),t.setCustomStatus(m),t.setDowloadFileAuthKey(f),g&&e.get(27).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:g}),e.get(20).updateProtocolConfig(),e.emitIEvt(Oi.A2KEY_AND_TINYID_UPDATED),e._helloInterval=l,e.triggerReady(),(_=e.getPushModule())&&(uni.setStorageSync("timUniAppInstanceID",d),_.init()),e._fetchCloudControlConfig(),e.get(29).init(),i;s=new Fn({code:Bn.NO_A2KEY})}else s=new Fn({code:Bn.NO_TINYID});throw a.setError(s).end(),s})).catch((function(t){return a.setError(t).end(!0),e._m.setNotReadyReason(Bn.LOGIN_FAILED),Re.e("".concat(c," failed. error:"),t),e._lastLoginTs=0,e._m.onLoginFailed(),kn(t)}))}},{key:"logout",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n="".concat(this._n,".logout"),i=this.isLoggedIn();return Re.i("".concat(n," type:").concat(t," isLoggedIn:").concat(i," isWebUniapp:").concat(this._isWebUniapp)),i?(new ii("logout").setMessage("identifier:".concat(this.getMyUserID())).end(!0),0===t&&this._m.setNotReadyReason(Bn.LOGGED_OUT),this.req({P:jn.LOGOUT,data:{type:t,isWebUniapp:this._isWebUniapp}}).then((function(){return e.resetReady(),Tn({})})).catch((function(t){return Re.e("".concat(n," error:"),t),e.resetReady(),Tn({})}))):kn({code:Bn.USER_NOT_LOGGED_IN})}},{key:"getLoginUser",value:function(){return this.isLoggedIn()?this.getMyUserID():""}},{key:"_fetchCloudControlConfig",value:function(){this.get(23).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")||0}},{key:"_hello",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.req({P:jn.HELLO,data:{isWebUniapp:this._isWebUniapp}}).catch((function(t){Re.w("".concat(e._n,"._hello error:"),t)}))}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(e){var t=0;return je(this.get(12).getSDKAppID())?t=Bn.NO_SDKAPPID:je(e.userID)?t=Bn.NO_IDENTIFIER:je(e.userSig)&&(t=Bn.NO_USERSIG),{code:t}}},{key:"_isReactUIKit",value:function(){return ne&&void 0!==window.tencent_cloud_im_csig_react_uikit_23F_xa}},{key:"onMultipleAccountKickedOut",value:function(e){var t=this;new ii("kickedOut").setMessage("type:".concat(k.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Re.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOEvt(T.KICKED_OUT,{type:k.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(Bn.KICKED_OUT_MULT_ACCOUNT),t._m.reset()}))}},{key:"onMultipleDeviceKickedOut",value:function(e){var t=this;new ii("kickedOut").setMessage("type:".concat(k.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Re.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOEvt(T.KICKED_OUT,{type:k.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(Bn.KICKED_OUT_MULT_DEVICE),t._m.reset()}))}},{key:"onUserSigExpired",value:function(){new ii("kickedOut").setMessage(k.KICKED_OUT_USERSIG_EXPIRED).end(!0),Re.w("".concat(this._n,".onUserSigExpired userID:").concat(this.getMyUserID())),0!==this.get(12).getStatusInstanceID()&&(this.emitOEvt(T.KICKED_OUT,{type:k.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(Bn.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:"onRestApiKickedOut",value:function(e){new ii("kickedOut").setMessage("type:".concat(k.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Re.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),0!==this.get(12).getStatusInstanceID()&&(this.emitOEvt(T.KICKED_OUT,{type:k.KICKED_OUT_REST_API}),this._m.setNotReadyReason(Bn.KICKED_OUT_REST_API),this._m.reset(),this.get(21).onRestApiKickedOut())}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]));function Eo(e){return i(this,Eo),(e=n(this,Eo,[e]))._n="SignModule",e._helloInterval=120,e._lastLoginTs=0,e._lastWsHelloTs=0,e._isWebUniapp=0,Ui.mixin(e),e}function To(e){return i(this,To),(e=n(this,To,[e]))._n="UserModule",e._profileHandler=new fo(e),e._blacklistHandler=new _o(e),e._userStatusHandler=new vo(e),e.getIEmitInst().on(Oi.A2KEY_AND_TINYID_UPDATED,e.onContextUpdated,e),e}function ko(e){return i(this,ko),(e=n(this,ko,[e]))._n="TopicModule",e._topicMap=new Map,e._getTopicTimeMap=new Map,e.TOPIC_CACHE_TIME=300,e.TOPIC_LAST_ACTIVE_TIME=3600,e.getIEmitInst().on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function So(e){return i(this,So),(e=n(this,So,[e]))._n="GroupModule",e._commonGroupHandler=new Zi(e),e._groupAttributesHandler=new Qi(e),e._groupCountersHandler=new eo(e),e._AVChatRoomHandler=new io(e),e._groupTipsHandler=new Xi(e),e._groupSystemNoticeHandler=new ro(e),e._groupMemberHandler=new ao(e),e.groupMap=new Map,e._unjoinedAVChatRoomList=new Map,e._receiptDetailCompleteMap=new Map,e._onlineMemberCountMap=new Map,e._timeoutIDs=[],e.getIEmitInst().on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function Do(e){return i(this,Do),(e=n(this,Do,[e]))._n="ConvModule",Ui.mixin(e),e._msgListHandler=new Ni(e),e._msgRemindHandler=new $i(e),e._convGroupHandler=new Wi(e),e._sll=new qi(100),e._pagingStatus=An,e._pagingTs=0,e._pagingStartIdx=0,e._pagingPinnedTs=0,e._pagingPinnedStartIdx=0,e._pagingConvIDMap=new Map,e._convIDFromUnreadDBMap=new Map,e._convMap=new Map,e._tmpGroupList=[],e._tmpGroupAtTipsList=[],e._peerReadTimeMap=new Map,e._completedMap=new Map,e._roamingMsgKeyAndTimeMap=new Map,e._remoteGroupReadSeqMap=new Map,e._convTotalUnreadCount=0,e._pagingGetCostList=[],e._convMapForDiff=new Map,e._partialUpdatedConvMap=new Map,e._everClearedMap=new Map,e._bPullOnInvite=!0,e._initListeners(),e}function bo(){return null}function Ao(e){var t=e.get(12);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:De()}}var Lo=a((function e(t){i(this,e),this._m=t,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}),[{key:"_errorTolerantHandle",value:function(){Q||"undefined"!=typeof window&&this._canIUseCookies()||(this.getItem=bo,this.setItem=bo,this.removeItem=bo,this.clear=bo)}},{key:"onCheckTimer",value:function(e){e%20==0&&0!==this._storageQueue.size&&this._doFlush()}},{key:"_doFlush",value:function(){try{var e,t=s(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2),i=n[0],o=n[1];this._setStorageSync(this._getKey(i),o)}}catch(a){t.e(a)}finally{t.f()}this._storageQueue.clear()}catch(a){Re.w("".concat(this._n,"._doFlush error:"),a)}}},{key:"_getPrefix",value:function(){var e=this._m.get(12);return"TIM_".concat(e.getSDKAppID(),"_").concat(e.getUserID(),"_")}},{key:"_getKey",value:function(e){return"".concat(this._getPrefix()).concat(e)}},{key:"getItem",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(i){return Re.w("".concat(this._n,".getItem error:"),i),{}}}},{key:"setItem",value:function(e,t){var n;2<arguments.length&&void 0!==arguments[2]&&arguments[2]?(n=3<arguments.length&&void 0!==arguments[3]&&!arguments[3]?e:this._getKey(e),this._setStorageSync(n,t)):this._storageQueue.set(e,t)}},{key:"clear",value:function(){try{Q?ie.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(e){Re.w("".concat(this._n,".clear error:"),e)}}},{key:"removeItem",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(i){Re.w("".concat(this._n,".removeItem error:"),i)}}},{key:"getSize",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"b";try{var i={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(i,"leftSize",{enumerable:!0,get:function(){return i.limitSize-i.size}}),Q&&(i.limitSize=1024*ie.getStorageInfoSync().limitSize),e)i.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if(Q)ie.getStorageInfoSync().keys.forEach((function(e){i.size+=JSON.stringify(t.getStorageSync(e)).length+t._getKey(e).length}));else if(this._canIUseCookies())for(var o in localStorage)localStorage.hasOwnProperty(o)&&(i.size+=localStorage.getItem(o).length+o.length);return this._convertUnit(i)}catch(a){Re.w("".concat(this._n," error:"),a)}}},{key:"_convertUnit",value:function(e){var t,n={},i=e.unit;for(t in n.unit=i,e)"number"==typeof e[t]&&("kb"===i.toLowerCase()?n[t]=Math.round(e[t]/1024):"mb"===i.toLowerCase()?n[t]=Math.round(e[t]/1024/1024):n[t]=e[t]);return n}},{key:"_setStorageSync",value:function(e,t){Q?$?my.setStorageSync({key:e,data:t}):ie.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorageSync",value:function(e){return Q?$?my.getStorageSync({key:e}).data:ie.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:"_removeStorageSync",value:function(e){Q?$?my.removeStorageSync({key:e}):ie.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:"_canIUseCookies",value:function(){return"undefined"!=typeof window&&navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._doFlush()}}]),Ro=a((function e(t){i(this,e),this._n="SSOLogBody",this._report=[]}),[{key:"pushIn",value:function(e){Re.d("".concat(this._n,".pushIn"),this._report.length,e),this._report.push(e)}},{key:"backfill",value:function(e){var t;We(e)&&0!==e.length&&(Re.d("".concat(this._n,".backfill"),this._report.length,e.length),(t=this._report).unshift.apply(t,y(e)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return 0===this._report.length}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var e=this._report.slice();return this._reset(),e}}]),wo=(l(Uo,Nn),a(Uo,[{key:"reportAtOnce",value:function(){this._report()}},{key:"_onLoginSuccess",value:function(){var e=this,t=this.get(13),n=t.getItem(this.TAG,!1);!je(n)&&Xe(n.forEach)&&(Re.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach((function(t){e._reportBody.pushIn(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("evt_rpt_threshold"),t=this.getCloudConfig("evt_rpt_waiting"),n=this.getCloudConfig("evt_rpt_level"),i=this.getCloudConfig("evt_rpt_sdkappid_bl"),o=this.getCloudConfig("evt_rpt_tinyid_wl");dt(e)||(this.MIN_THRESHOLD=Number(e)),dt(t)||(this.WAITING_TIME=Number(t)),dt(n)||(this.REPORT_LEVEL=n.split(",").map((function(e){return Number(e)}))),dt(i)||(this.REPORT_SDKAPPID_BLACKLIST=i.split(",").map((function(e){return Number(e)}))),dt(o)||(this.REPORT_TINYID_WHITELIST=o.split(","))}},{key:"pushIn",value:function(e){e instanceof ii&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD)&&this._report()}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(e){var t=this,n=(i=this.get(12)).getSDKAppID(),i=i.getTinyID();return Gt(this.REPORT_SDKAPPID_BLACKLIST,n)&&!xt(this.REPORT_TINYID_WHITELIST,i)?[]:e.filter((function(e){return t.REPORT_LEVEL.includes(e.level)}))}},{key:"_report",value:function(){var e,t,n=this;this._reportBody.isEmpty()||(e=this._reportBody.getLogsInMemory(),0!==(t=this._filterLogs(e)).length?(t={header:Ao(this),event:t},this.req({P:jn.SSO_STAT,data:f({},t)}).then((function(){n._lastReportTime=Date.now()})).catch((function(t){Re.w("".concat(n._n,"._report failed. error:"),t),n._lastReportTime=Date.now(),n._reportBody.backfill(e),n._reportBody.getLogsNumInMemory()>n.MAX_THRESHOLD&&n._flushAtOnce()}))):this._lastReportTime=Date.now())}},{key:"_flushAtOnce",value:function(){var e=this.get(13),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),i="".concat(this._n,"._flushAtOnce");je(t)?(Re.l("".concat(i," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)):((n=n.concat(t)).length>this.MAX_THRESHOLD&&(n=n.slice(0,this.MAX_THRESHOLD)),Re.l("".concat(i," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}])),Oo="none",No="online",Po=a((function e(t){i(this,e),this._m=t,this._networkType=No,this._n="NetMonitorModule",this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null,this._removeListener=null,this._m.getIEmitInst().on(Oi.A2KEY_AND_TINYID_UPDATED,this._startRN,this)}),[{key:"_startRN",value:function(){var e,t=this;te&&(e=this._m.get(18).getPlugin("chat-network-monitor"))&&(this._removeListener=e.addEventListener((function(e){var n=e.isConnected;e=e.type,t._networkType!==e&&t._onNetworkStatusChange({isConnected:void 0!==n&&n,networkType:e})})))}},{key:"start",value:function(){var e=this,t="".concat(this._n,".start");Q?(ie.getNetworkType({success:function(n){e._networkType=n.networkType||n.subtype||"",n.networkType===Oo?Re.w("".concat(t," no network, please check!")):Re.i("".concat(t," networkType:").concat(n.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),ie.onNetworkStatusChange(this._mpNetworkStatusCallback)):ne&&(this._networkType=No,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:No})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:Oo})}},{key:"_onNetworkStatusChange",value:function(e){var t=e.isConnected,n=(e=e.networkType,"".concat(this._n,"._onNetworkStatusChange")),i=!1,o="previous:".concat(this._networkType," current:").concat(e);t?(Re.i("".concat(n," ").concat(o)),this._networkType!==e&&(i=!0,this._networkType=e,this._m.get(21).reConnect(!0))):this._networkType!==e&&(i=!0,this._networkType=e,Re.w("".concat(n," no network, please check!")),this._m.get(21).offline()),i&&new ii("networkChange").setMessage("isConnected:".concat(t," ").concat(o)).end()}},{key:"isOnline",value:function(){return this._networkType!==Oo}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),Q?null!==this._mpNetworkStatusCallback&&(ie.offNetworkStatusChange&&ie.offNetworkStatusChange(this._mpNetworkStatusCallback),this._mpNetworkStatusCallback=null):ne?(null!==this._webOnlineCallback&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),null!==this._onWebOffline&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null)):te&&this._removeListener&&(this._removeListener(),this._removeListener=null)}}]);function Uo(e){i(this,Uo),(e=n(this,Uo,[e]))._n="EventStatModule",e.TAG="im-ssolog-event",e._reportBody=new Ro,e.MIN_THRESHOLD=20,e.MAX_THRESHOLD=100,e.WAITING_TIME=6e4,e.REPORT_LEVEL=[4,5,6],e.REPORT_SDKAPPID_BLACKLIST=[],e.REPORT_TINYID_WHITELIST=[],e._lastReportTime=Date.now();var t=e.getIEmitInst();return t.on(Oi.A2KEY_AND_TINYID_UPDATED,e._onLoginSuccess,e),t.on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function Go(e,t){return e(t={exports:{}},t.exports),t.exports}var xo=Go((function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,i,a,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");return i=new o(i,a||e,s),a=n?n+t:t,e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],i]:e._events[a].push(i):(e._events[a]=i,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function r(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),r.prototype.eventNames=function(){var e,i,o=[];if(0===this._eventsCount)return o;for(i in e=this._events)t.call(e,i)&&o.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},r.prototype.listeners=function(e){e=n?n+e:e;var t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var i=0,o=t.length,a=new Array(o);i<o;i++)a[i]=t[i].fn;return a},r.prototype.listenerCount=function(e){return e=n?n+e:e,(e=this._events[e])?e.fn?1:e.length:0},r.prototype.emit=function(e,t,i,o,a,s){var r=n?n+e:e;if(!this._events[r])return!1;var c,u=this._events[r],l=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),l){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,o),!0;case 5:return u.fn.call(u.context,t,i,o,a),!0;case 6:return u.fn.call(u.context,t,i,o,a,s),!0}for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];u.fn.apply(u.context,c)}else for(var d,h=u.length,p=0;p<h;p++)switch(u[p].once&&this.removeListener(e,u[p].fn,void 0,!0),l){case 1:u[p].fn.call(u[p].context);break;case 2:u[p].fn.call(u[p].context,t);break;case 3:u[p].fn.call(u[p].context,t,i);break;case 4:u[p].fn.call(u[p].context,t,i,o);break;default:if(!c)for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];u[p].fn.apply(u[p].context,c)}return!0},r.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},r.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},r.prototype.removeListener=function(e,t,i,o){if(e=n?n+e:e,this._events[e])if(t){var a=this._events[e];if(a.fn)a.fn!==t||o&&!a.once||i&&a.context!==i||s(this,e);else{for(var r=0,c=[],u=a.length;r<u;r++)(a[r].fn!==t||o&&!a[r].once||i&&a[r].context!==i)&&c.push(a[r]);c.length?this._events[e]=1===c.length?c[0]:c:s(this,e)}}else s(this,e);return this},r.prototype.removeAllListeners=function(e){return e?(e=n?n+e:e,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=n,e.exports=r.EventEmitter=r})),Fo=["rich.my-imcloud.com","imrich.qcloud.com"],Bo=["requestSnapshotUrl"],Vo=(l(zo,Nn),a(zo,[{key:"_init",value:function(){this._fileDownloadProxy=this.getFileDownloadProxy(),this._authKey=this.getDownloadFileAuthKey();var e=this.get(18);this.TIMUploadPlugin=e.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin?this._initUploaderMethod():(this.COSSDK=e.getPlugin(e=Q?"cos-wx-sdk":"cos-js-sdk"),this.COSSDK?(this._getAuthorizationKey(),this.warn("CosReplacement",e)):this.warn("PluginUndetected"))}},{key:"_onCloudConfig",value:function(){var e=this,t="".concat(this._n,"._onCloudConfig"),n=this.getCloudConfig("upload_size_limit"),i=this.getCloudConfig("simple_cos"),o=this.getCloudConfig("file_dn_list");if(Re.l("".concat(t," uploadSizeLimit:").concat(n," simpleCos:").concat(i)),!dt(n))try{var a=JSON.parse(n);this.UPLOAD_SIZE_LIMIT={A:a.a?1048576*parseInt(a.a):this.UPLOAD_SIZE_LIMIT.A,F:a.f?1048576*parseInt(a.f):this.UPLOAD_SIZE_LIMIT.F,I:a.i?1048576*parseInt(a.i):this.UPLOAD_SIZE_LIMIT.I,V:a.v?1048576*parseInt(a.v):this.UPLOAD_SIZE_LIMIT.V}}catch(s){}if(dt(i)||(this.isSimpleCos="1"===i),!dt(o))try{JSON.parse(o).forEach((function(t){e._fileDNList.includes(t)||e._fileDNList.push(t)}))}catch(s){}}},{key:"_getAuthorizationKey",value:function(){var e=this,t="".concat(this._n,".").concat("_getAuthorizationKey"),n=new ii("_getAuthorizationKey"),i=Math.ceil(Date.now()/1e3);this.req({P:jn.COS_SIGN,data:{duration:this.expiredTimeLimit}}).then((function(o){o=o.data;var a=(Re.l("".concat(t," ok. data:"),o),o.expiredTime-i);n.setMessage("requestId:".concat(o.requestId," requestTime:").concat(i," expiredTime:").concat(o.expiredTime," diff:").concat(a,"s")).end(),!Q&&o.region&&(e.region=o.region),e.appid=o.appid,e.bucketName=o.bucketName,e.ciUrl=o.ciUrl,e.directory=o.directory,e.downloadUrl=o.downloadUrl,e.uploadUrl=o.uploadUrl,e.cosOptions={secretId:o.secretId,secretKey:o.secretKey,sessionToken:o.sessionToken,expiredTime:o.expiredTime},Re.l("".concat(t," ok. region:").concat(e.region," bucketName:").concat(e.bucketName)),e._initUploaderMethod()})).catch((function(e){n.setError(e).end(),Re.w("".concat(t," failed. error:"),e)}))}},{key:"_getCosPreSigUrl",value:function(e){var t=this,n="".concat(this._n,".").concat("_getCosPreSigUrl"),i=Math.ceil(Date.now()/1e3),o=new ii("_getCosPreSigUrl"),a={uploadMethod:e.uploadMethod,platform:this.getPlatform(),SDKAppID:this.getSDKAppID(),userID:e.userID,conversationType:e.conversationType,uploadConfig:[{fileID:1,fileType:e.fileType,fileName:e.fileName}]},s=jn.SIMPLE_COS_PRE_SIG;return this.isSimpleCos||(a={fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration},s=jn.COS_PRE_SIG),this.req({P:s,data:a}).then((function(e){t.tryCount=0,e=e.data||{};var a,s,r=(Re.l("".concat(n," ok. isSimpleCos:").concat(t.isSimpleCos," data:"),e),"");return r=t.isSimpleCos?(a=(s=e.preSig[0]).uploadUrl,s=s.fileKey,"uploadIP:".concat(e.uploadIP," uploadUrl:").concat(a," fileKey:").concat(s," cost:").concat(Yt(i))):"requestId:".concat(e.requestId," expiredTime:").concat(e.expiredTime," diff:").concat(e.expiredTime-i,"s"),o.setMessage(r).end(),e})).catch((function(i){return-1===i.code&&(i.code=Bn.COS_GET_SIG_FAIL),o.setError(i).end(),Re.w("".concat(n," failed. error:"),i),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,kn({code:Bn.COS_GET_SIG_FAIL}))}))}},{key:"_initUploaderMethod",value:function(){var e=this;this.TIMUploadPlugin?(this.timUploadPlugin=new this.TIMUploadPlugin,this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)}):this.appid&&(this.cos=Q?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=Q?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:"onCheckTimer",value:function(e){!this.COSSDK||this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey()}},{key:"getFileDNList",value:function(){return this._fileDNList}},{key:"_getAuthorization",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(e){if(!0===e._relayFlag)return Promise.resolve();var t=this.get(26);switch(e.type){case k.MSG_IMAGE:return t.addTotalCount(Wn),this._uploadImage(e);case k.MSG_FILE:return t.addTotalCount(Wn),this._uploadFile(e);case k.MSG_AUDIO:return t.addTotalCount(Wn),this._uploadAudio(e);case k.MSG_VIDEO:return t.addTotalCount(Wn),this._uploadVideo(e);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(e){var t=this,n=this.get(2),i=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadImage({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(i.updatePercent(e),Xe(o.onProgress))try{o.onProgress(e)}catch(t){return kn({code:Bn.MSG_ONPROGRESS_ERR})}}}).then((function(n){var o=n.location,a=n.fileType,s=n.fileSize,r=n.width,c=n.height,u=n.smallImageUrl,l=n.smallImageWidth,d=n.smallImageHeight,h=n.largeImageUrl,p=n.largeImageWidth,g=n.largeImageHeight,m=n.imageInfoArray;n=t.isPrivateNetWork()?o:rt(o),i.updateImageFormat(a);var _,v,y={size:s,url:n,width:r,height:c};if(m&&0<m.length)for(var I=0;I<m.length;I++){var M=m[I];1===M.type?_=M:2===M.type?v=M:y=f(f({},y),M)}else v=u&&h?(_={url:u,width:l,height:d},{url:h,width:p,height:g}):(_=Ot({originUrl:n,originWidth:r,originHeight:c,min:198}),Ot({originUrl:n,originWidth:r,originHeight:c,min:720}));return i.updateImageInfoArray([f({},y),f({},v),f({},_)]),e}))}},{key:"_uploadFile",value:function(e){var t=this,n=this.get(2),i=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(i.updatePercent(e),Xe(o.onProgress))try{o.onProgress(e)}catch(t){return kn({code:Bn.MSG_ONPROGRESS_ERR})}}}).then((function(n){var o=n=n.location;return t.isPrivateNetWork()||(o=ri(o=rt(n),t._fileDownloadProxy,t._authKey,t._fileDNList)),i.updateFileUrl(o),e}))}},{key:"_uploadAudio",value:function(e){var t=this,n=this.get(2),i=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(i.updatePercent(e),Xe(o.onProgress))try{o.onProgress(e)}catch(t){return kn({code:Bn.MSG_ONPROGRESS_ERR})}}}).then((function(n){return n=n.location,n=t.isPrivateNetWork()?n:rt(n),i.updateAudioUrl(n),e}))}},{key:"_uploadVideo",value:function(e){var t=this,n=this.get(2),i=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(i.updatePercent(e),Xe(o.onProgress))try{o.onProgress(e)}catch(t){return kn({code:Bn.MSG_ONPROGRESS_ERR})}}}).then((function(n){var o=n.location;return n=n.snapshotInfo,o=t.isPrivateNetWork()?o:rt(o),i.updateVideoUrl(o),je(n)||i.updateSnapshotInfo(n),e}))}},{key:"_checkSizeError",value:function(e){var t="";return"A"===e?t="audio":"I"===e?t="image":"V"===e?t="video":"F"===e&&(t="file"),kn({code:Bn["MSG_".concat(e,"_SIZE_LIMIT")],message:this.getErrMsg("UploadSizeLimit",t,"".concat(this.UPLOAD_SIZE_LIMIT[e]/1048576,"MB"))})}},{key:"doUploadImage",value:function(e){var t,n,i=this;return!e.file||this._isEmptyFileList(e.file.files)?kn({code:Bn.MSG_I_SELECT_F_FIRST}):!0!==(t=this._checkImageType(e.file))||!0!==(t=this._checkImageSize(e.file))?t:(n=null,this._setUploadFileType(1),this.uploadByCOS(e).then((function(t){if(n=t,i.isPrivateNetWork())return At(a);if(We(n.imageInfoArray)){var o=n.imageInfoArray.find((function(e){return 3===e.type}));if(o)return o}var a;return te?{width:e.file.width,height:e.file.height}:(a=rt(t.location),i.COSSDK?At(a):At(a=ri(a,i._fileDownloadProxy,i._authKey,i._fileDNList)))})).then((function(e){return n.width=e.width,n.height=e.height,Promise.resolve(n)})))}},{key:"_checkImageType",value:function(e){var t="";return t=Q?e.url.slice(e.url.lastIndexOf(".")+1):te?e.type.split("/")[1]:e.files[0].name.slice(e.files[0].name.lastIndexOf(".")+1),0<=Bi.indexOf(t.toLowerCase())||kn({code:Bn.MSG_I_TYPES_LIMIT})}},{key:"_checkImageSize",value:function(e){return 0===(e=(Q||te?e:e.files[0]).size)?kn({code:Bn.MSG_F_IS_EMPTY}):e<this.UPLOAD_SIZE_LIMIT.I||this._checkSizeError("I")}},{key:"doUploadFile",value:function(e){return!e.file||this._isEmptyFileList(e.file.files)?kn({code:Bn.MSG_F_SELECT_F_FIRST}):e.file.files[0].size>this.UPLOAD_SIZE_LIMIT.F?this._checkSizeError("F"):0===e.file.files[0].size?kn({code:Bn.MSG_F_IS_EMPTY}):(this._setUploadFileType(255),this.uploadByCOS(e))}},{key:"doUploadVideo",value:function(e){return e.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.V?this._checkSizeError("V"):0===e.file.videoFile.size?kn({code:Bn.MSG_F_IS_EMPTY}):-1===Vi.indexOf(e.file.videoFile.type)?kn({code:Bn.MSG_V_TYPES_LIMIT}):(this._setUploadFileType(2),Q||te?this.handleVideoUpload(f(f({},e),{},{file:e.file.videoFile})):ne?this.handleVideoUpload(e):void 0)}},{key:"handleVideoUpload",value:function(e){var t=this;return new Promise((function(n,i){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){i(new Fn({code:Bn.MSG_V_UPLOAD_FAIL}))}))}))}))}},{key:"doUploadAudio",value:function(e){return e.file?e.file.size>this.UPLOAD_SIZE_LIMIT.A?this._checkSizeError("A"):0===e.file.size?kn({code:Bn.MSG_F_IS_EMPTY}):(this._setUploadFileType(3),this.uploadByCOS(e)):kn({code:Bn.MSG_A_UPLOAD_FAIL})}},{key:"uploadByCOS",value:function(e){var t,n,i,o,a=this;return Xe(this._cosUploadMethod)?this.timUploadPlugin?this._uploadWithPreSigUrl(e):(t=new ii("upload"),n="".concat(this._n,".uploadByCOS"),i=Date.now(),o=this._getFile(e),new Promise((function(s,r){var c=Q?a._createCosOptionsWXMiniApp(e):a._createCosOptionsWeb(e),u=a;a._cosUploadMethod(c,(function(e,c){var l,d,h=Object.create(null);c?e||We(c.files)&&c.files[0].error?(l=new Fn({code:Bn.MSG_F_UPLOAD_FAIL}),t.setError(l).end(),Re.l("".concat(n," failed. error:"),c.files[0].error),403===c.files[0].error.statusCode&&a._getAuthorizationKey(),r(l)):(h.fileName=o.name,h.fileSize=o.size,h.fileType=o.type.slice(o.type.indexOf("/")+1).toLowerCase(),h.location=(Q?c:c.files[0].data).Location,l=Date.now()-i,c=u._formatFileSize(o.size),d=u._formatSpeed(1e3*o.size/l),c="size:".concat(c," time:").concat(l,"ms speed:").concat(d),Re.l("".concat(n," success. name:").concat(o.name," ").concat(c)),s(h),(d=a.get(26)).addCost(Wn,l),d.addFileSize(Wn,o.size),t.setMessage(c).end()):(h=new Fn({code:Bn.MSG_F_UPLOAD_FAIL}),t.setError(h).end(),Re.w("".concat(n," failed. error:"),e),403===e.statusCode&&a._getAuthorizationKey(),r(h))}))}))):(this.warn("PluginUndetected"),kn({code:Bn.COS_UNDETECTED}))}},{key:"_uploadWithPreSigUrl",value:function(e){var t=this,n="".concat(this._n,"._uploadWithPreSigUrl"),i=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then((function(e){return new Promise((function(o,a){var s=new ii("upload"),r=e.requestSnapshotUrl,c=void 0===r?void 0:r,u=m(e,Bo),l=Date.now();t._cosUploadMethod(u,(function(r,d){if(r||403===d.statusCode)s.setError(new Fn(r)).end(),p={HttpStatusCode:9999,CostTime:Yt(l,!1),error:r,url:e.url},d.data&&d.data.uploadIP&&(p.uploadIP=d.data.uploadIP),t._uploadSSOLog(p),Re.l("".concat(n," failed, error:"),r),a(new Fn({code:Bn.MSG_F_UPLOAD_FAIL}));else{var h=Object.create(null),p=d.data.location||"",g=(t.isPrivateNetWork()||0!==p.indexOf("https://")&&0!==p.indexOf("http://")||(p=p.split("//")[1]),h.fileName=i.name,h.fileSize=i.size,h.fileType=i.type.slice(i.type.indexOf("/")+1).toLowerCase(),h.location=p,r=Yt(l,!1),p=t._formatFileSize(i.size),t._formatSpeed(1e3*i.size/r));if(p="size:".concat(p," time:").concat(r,"ms speed:").concat(g," res:").concat(JSON.stringify(d.data)),Re.l("".concat(n," ok. name:").concat(i.name," ").concat(p)),s.setMessage(p).end(),g={HttpStatusCode:d.statusCode,FileSize:i.size,CostTime:r,url:e.url},(d.data&&d.data.uploadIP&&(g.uploadIP=d.data.uploadIP),t._uploadSSOLog(g),p=t.get(26)).addCost(Wn,r),p.addFileSize(Wn,i.size),g=[],u.thumbUrl&&u.largeUrl&&g.push.apply(g,[t._getSmallImageInfoByUrl(u.thumbUrl,h),t._getLargeImageInfoByUrl(u.largeUrl,h)]),1===t.uploadFileType&&t.isSimpleCos&&!t.isPrivateNetWork()&&(g.push(t._getImageInfoArray(u.downloadUrl,h)),d.data.uploadIP)&&g.push(t._getDownloadIP(u.downloadUrl.split("//")[1].split("/")[0],h)),c&&g.push(t._getSnapshotInfoByUrl(c,h)),0<g.length)return Promise.all(g).then((function(){o(h)}));o(h)}}))}))}))}},{key:"_getDownloadIP",value:function(e,t){var n="".concat(this._n,"._getDownloadIP"),i=Date.now();return this.req({P:jn.GET_IP,data:{domainName:e}}).then((function(e){var o;e.data&&e.data.ip&&(Re.l("".concat(n," ok. downloadIP:").concat(e.data.ip," cost:").concat(Yt(i))),(o=t.location.split("/"))[0]=e.data.ip,t.location=o.join("/"))})).catch((function(e){}))}},{key:"_getImageInfoArray",value:function(e,t){var n=this,i="".concat(this._n,"._getImageInfoArray"),o=Date.now();return this.req({P:jn.GET_IMAGE_INFO,data:{imageUrl:e}}).then((function(e){return e=e.data||{},Re.l("".concat(i," ok. data: ").concat(JSON.stringify(e)," cost:").concat(Yt(o))),t.imageInfoArray=e.imageInfoArray,e})).catch((function(i){t.imageInfoArray=void 0,n._uploadSSOLog({HttpStatusCode:1e4,CostTime:Yt(o,!1),url:e})}))}},{key:"_uploadSSOLog",value:function(e){var t,n;this.isSimpleCos&&((t=new ii).setEventType(18),e.error&&t.setError(new Fn(e.error)),n="HttpStatusCode:".concat(e.HttpStatusCode,"|CosRequestId:").concat(e.CosRequestId||"","|")+"FileAlreadyExist:".concat(e.FileAlreadyExist||0,"|FileSize:").concat(e.FileSize||0,"|CostTime:").concat(e.CostTime),e.uploadIP&&(n+="|FinalIP:".concat(e.uploadIP)),t.setMessage("OK").setMoreMessage(e.url).setExtension(n).end())}},{key:"_getRawOrUploadProxyUrl",value:function(e){var t=this.get(12).getFileUploadProxy(),n=e;return t?e.replace(/^https:\/\/[^/]+/,t):n}},{key:"_getFile",value:function(e){return We(e.file.files)||Ze(e.file.files)?e.file.files[0]:e.file}},{key:"_formatFileSize",value:function(e){return e<1024?e+"B":e<1048576?Math.floor(e/1024)+"KB":Math.floor(e/1048576)+"MB"}},{key:"_formatSpeed",value:function(e){return e<=1048576?Ut(e/1024,1)+"KB/s":Ut(e/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(e){var t=this._getFile(e),n=(n=t.name).slice(n.lastIndexOf("."));return n=this._genFileName("".concat(ot(999999)).concat(n)),{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),Body:t}],SliceSize:1048576,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Re.w("onProgress callback error:",n)}},onFileFinish:function(e,t,n){}}}},{key:"_createCosOptionsWXMiniApp",value:function(e){var t=this._getFile(e),n=this._genFileName(t.name);return t=t.url,{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),FilePath:t,onProgress:function(t){if(Re.l(JSON.stringify(t)),"function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Re.w("onProgress callback error:",n)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(e){var t,n=this,i="",o="",a=0,s=this._getFile(e);return a=Q||te?(i=e.message.type===k.MSG_FILE?(t=(t=s.name).slice(t.lastIndexOf(".")),this._genFileName("".concat(ot(999999)).concat(t))):this._genFileName(s.name),o=s.url,1):(t=(t=s.name).slice(t.lastIndexOf(".")),i=this._genFileName("".concat(ot(999999)).concat(t)),o=s,0),this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:i,uploadMethod:a,duration:this.duration,userID:e.message.from,conversationType:kt(e.message.conversationID)?1:2}).then((function(t){var a=(l=n.isSimpleCos?t.preSig[0]:t).uploadUrl,s=l.downloadUrl,r=void 0===(r=l.requestSnapshotUrl)?void 0:r,c=l.thumbUrl,u=l.largeUrl,l=l.fileKey;return t=void 0===(t=t.uploadIP)?"":t,{url:n._getRawOrUploadProxyUrl(a),fileType:n.uploadFileType,fileName:i,resources:o,downloadUrl:s,requestSnapshotUrl:r,thumbUrl:c,largeUrl:u,fileKey:l,uploadIP:!n.isPrivateNetWork()&&t,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Re.w("onProgress callback error:",n),Re.e(n)}}}}))}},{key:"_genFileName",value:function(e){return"".concat(Lt(),"-").concat(e)}},{key:"_setUploadFileType",value:function(e){this.uploadFileType=e}},{key:"_getSnapshotInfoByUrl",value:function(e,t){var n=this,i="_getSnapshotInfoByUrl",o=new ii(i);return this.req({P:jn.VIDEO_COVER,data:{platform:this.getPlatform(),coverName:this._genFileName(ot(99999)),requestSnapshotUrl:e}}).then((function(e){var a;return e=(e.data||{}).snapshotUrl,Re.l("".concat(n._n,".").concat(i," ok. snapshotUrl:").concat(e)),o.setMessage("snapshotUrl:".concat(e)).end(),je(e)?{}:At(a=ri(e,n._fileDownloadProxy,n._authKey,n._fileDNList)).then((function(e){t.snapshotInfo={snapshotUrl:a,snapshotWidth:e.width,snapshotHeight:e.height}}))})).catch((function(e){return Re.w("".concat(n._n,".").concat(i," failed. error:"),e),o.setCode(e.errorCode).setMessage(e.errorInfo).end(),{}}))}},{key:"_getSmallImageInfoByUrl",value:function(e,t){return At(ri(e,this._fileDownloadProxy,this._authKey,this._fileDNList)).then((function(n){t.smallImageUrl=e,t.smallImageWidth=n.width,t.smallImageHeight=n.height}))}},{key:"_getLargeImageInfoByUrl",value:function(e,t){return At(ri(e,this._fileDownloadProxy,this._authKey,this._fileDNList)).then((function(n){t.largeImageUrl=e,t.largeImageWidth=n.width,t.largeImageHeight=n.height}))}},{key:"_isEmptyFileList",value:function(e){return!(!Ze(e)||0!==e.length)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}])),jo=["downloadKey","pbDownloadKey","messageList"],qo=a((function e(t){i(this,e),this._n="MergerMessageHandler",this._msgM=t}),[{key:"uploadMergerMessage",value:function(e,t){var n="".concat(this._n,".").concat("uploadMergerMessage"),i=(Re.d("".concat(n," message:"),e,"messageBytes:".concat(t)),e=JSON.parse(JSON.stringify(e.payload)).messageList).length,o=this._msgM.get(17).getFileDNList(),a=new ii("uploadMergerMessage");return e.forEach((function(e){ci(e.messageBody[0].type,e.messageBody,o)})),this._msgM.req({P:jn.UPLOAD_MERGER_MSG,data:{messageList:e}}).then((function(e){Re.d("".concat(n," ok. response:"),e.data);var o={pbDownloadKey:o=(e=e.data).pbDownloadKey,downloadKey:e=e.downloadKey,messageNumber:i};return a.setMessage("".concat(i,"-").concat(t,"-").concat(e)).end(),o})).catch((function(e){throw Re.w("".concat(n," failed. error:"),e),a.setError(e).end(),e}))}},{key:"downloadMergerMessage",value:function(e){var t=this,n="".concat(this._n,".").concat("downloadMergerMessage"),i=(Re.d("".concat(n," message:"),e),e.payload.downloadKey),o=this._msgM.getFileDownloadProxy(),a=this._msgM.getDownloadFileAuthKey(),s=new ii("downloadMergerMessage");return s.setMessage("downloadKey:".concat(i)),this._msgM.req({P:jn.DOWNLOAD_MERGER_MSG,data:{downloadKey:i}}).then((function(i){Re.d("".concat(n," ok. response:"),i.data);var r,c,u=t._msgM.get(17).getFileDNList();return Xe(e.clearElement)?((r=e.payload).downloadKey,r.pbDownloadKey,r.messageList,r=m(r,jo),e.clearElement(),e.setElement({type:e.type,content:f({messageList:i.data.messageList},r)},o,a,u)):(c=[],i.data.messageList.forEach((function(e){je(e)||(e=new Ci(e,o,a,u),c.push(e))})),e.payload.messageList=c,e.payload.downloadKey="",e.payload.pbDownloadKey=""),s.end(),e})).catch((function(e){throw Re.w("".concat(n," failed. key:").concat(i," error:"),e),s.setError(e).end(),e}))}},{key:"createMergerMessagePack",value:function(e,t,n){return e.conversationType===k.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:"_createC2CMergerMessagePack",value:function(e,t,n){var i=null,o=(t&&(t.offlinePushInfo&&(i=t.offlinePushInfo),!0===t.onlineUserOnly)&&(i?i.disablePush=!0:i={disablePush:!0}),[]),a=($e(t)&&$e(t.messageControlInfo)&&(a=(r=t.messageControlInfo).excludedFromUnreadCount,s=r.excludedFromLastMessage,r=r.excludedFromContentModeration,!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===r)&&o.push("NoMsgCheck"),""),s=(lt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(a=e.cloudCustomData),n.pbDownloadKey),r=n.downloadKey,c=(n=n.messageNumber,(l=e.payload).title),u=l.abstractList,l=l.compatibleText,d=(d=this._msgM.get(6))&&d.isOnlineMessage(e,t)?0:void 0;return{P:jn.SEND_C2C_MSG,data:{fromAccount:this._msgM.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:s,downloadKey:r,title:c,abstractList:u,compatibleText:l,messageNumber:n}}],cloudCustomData:a,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:d,offlinePushInfo:Ri(i),messageControlInfo:0!==d?o:void 0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(e,t,n){var i=null,o=(t&&t.offlinePushInfo&&(i=t.offlinePushInfo),[]),a=($e(t)&&$e(t.messageControlInfo)&&(a=(r=t.messageControlInfo).excludedFromUnreadCount,s=r.excludedFromLastMessage,r=r.excludedFromContentModeration,!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===r)&&o.push("NoMsgCheck"),""),s=(lt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(a=e.cloudCustomData),n.pbDownloadKey),r=n.downloadKey,c=(n=n.messageNumber,(l=e.payload).title),u=l.abstractList,l=l.compatibleText,d=this._msgM.get(7);return t=d&&d.isOnlineMessage(e,t)?1:0,{P:jn.SEND_GRP_MSG,data:{fromAccount:this._msgM.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:s,downloadKey:r,title:c,abstractList:u,compatibleText:l,messageNumber:n}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:a,onlineOnlyFlag:t,offlinePushInfo:Ri(i),clientTime:e.clientTime,needReadReceipt:!0!==e.needReadReceipt||d.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:0==t?o:void 0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}}]),Ho={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MSG_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},Ko=[Bn.MSG_ONPROGRESS_ERR,Bn.MSG_I_SELECT_F_FIRST,Bn.MSG_I_TYPES_LIMIT,Bn.MSG_F_IS_EMPTY,Bn.MSG_I_SIZE_LIMIT,Bn.MSG_F_SELECT_F_FIRST,Bn.MSG_F_SIZE_LIMIT,Bn.MSG_V_SIZE_LIMIT,Bn.MSG_V_TYPES_LIMIT,Bn.MSG_A_UPLOAD_FAIL,Bn.MSG_A_SIZE_LIMIT,Bn.COS_UNDETECTED];function zo(e){i(this,zo),(e=n(this,zo,[e]))._n="UploadModule",e.TIMUploadPlugin=null,e.timUploadPlugin=null,e.COSSDK=null,e._cosUploadMethod=null,e.expiredTimeLimit=600,e.appid=0,e.bucketName="",e.ciUrl="",e.directory="",e.downloadUrl="",e.uploadUrl="",e.region="ap-shanghai",e.cos=null,e.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},e.uploadFileType="",e.duration=900,e.tryCount=0,e.UPLOAD_SIZE_LIMIT={A:20971520,F:104857600,I:20971520,V:104857600},e.isSimpleCos=!1,e._fileDownloadProxy="",e._authKey="",e._fileDNList=Fo;var t=e.getIEmitInst();return t.on(Oi.A2KEY_AND_TINYID_UPDATED,e._init,e),t.on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function Yo(e){var t=!1;return Object.values(Ho).includes(e)&&(t=!0),120001<=e&&e<=13e4||10100<=e&&e<=10200||t}l(sa,Nn);var $o=a(sa,[{key:"createTextMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new ki(e));return e=lt(e.payload)?e.payload:e.payload.text,e=new oi({text:e}),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createImageMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new ki(e));if(Q){if(Ke(o=e.payload.file))return void this.warn("FileUnsupportedInMP","createImageMessage");var i=o.tempFiles[0].path||o.tempFiles[0].tempFilePath,o={url:i,name:i.slice(i.lastIndexOf("/")+1),size:o.tempFiles&&o.tempFiles[0].size||1,type:i.slice(i.lastIndexOf(".")+1).toLowerCase()};e.payload.file=o}else te?(o={url:(i=e.payload.file).uri,name:i.fileName,size:i.fileSize||1,type:i.type,width:i.width,height:i.height},e.payload.file=o):ne&&(Ke(e.payload.file)?(i=e.payload.file,e.payload.file={files:[i]}):$e(e.payload.file)&&"undefined"!=typeof uni&&(o=e.payload.file.tempFiles[0],e.payload.file={files:[o]}));return i=this.get(17).getFileDNList(),o=new di({imageFormat:we.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file},this.getFileDownloadProxy(),this.getDownloadFileAuthKey(),i),i=this._getNickAndAvatarByUserID(t),n.setElement(o),n.setNickAndAvatar(i),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createAudioMessage",value:function(e){var t=e.payload.file,n=(Q&&(n={url:t.tempFilePath,name:t.tempFilePath.slice(t.tempFilePath.lastIndexOf("/")+1),size:t.fileSize,second:parseInt(t.duration)/1e3,type:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(".")+1).toLowerCase()},e.payload.file=n),te&&(n={url:t.uri,name:t.uri.slice(t.uri.lastIndexOf("/")+1),size:t.fileSize||1,second:Math.floor(t.duration/1e3),type:t.uri.slice(t.uri.lastIndexOf(".")+1).toLowerCase()},e.payload.file=n,je(t.uri))&&this.warn("VoiceFileInRN"),this.getMyUserID()),i=(e.currentUser=n,e.senderTinyID=this.getMyTinyID(),this.get(17).getFileDNList()),o=new ki(e);return t=new pi({second:Math.floor(t.duration/1e3),size:t.fileSize||t.size||1,url:t.tempFilePath||t.uri,uuid:this._generateUUID(e.payload.file)},this.getFileDownloadProxy(),this.getDownloadFileAuthKey(),i),i=this._getNickAndAvatarByUserID(n),o.setElement(t),o.setNickAndAvatar(i),o.setNameCard(this._getNameCardByGroupID(o)),this._messageOptionsMap.set(o.clientSequence,e),o}},{key:"createVideoMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl="",e.payload.file.thumbSize=0,{});if(Q){if($)return void this.warn("VideoUnsupportedInAlipay");if(Ke(e.payload.file))return void this.warn("FileUnsupportedInMP","createVideoMessage");We((i=e.payload.file).tempFiles)&&(i=i.tempFiles[0]),n.url=i.tempFilePath,n.name=i.tempFilePath.slice(i.tempFilePath.lastIndexOf("/")+1),n.size=i.size||1,n.second=i.duration||0,n.type=i.tempFilePath.slice(i.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else te?(i=e.payload.file,n.url=i.uri,n.name=i.fileName,n.size=i.fileSize||1,n.second=i.duration||0,n.type=i.type.split("/")[1]):ne&&(Ke(e.payload.file)?(i=e.payload.file,e.payload.file.files=[i]):$e(e.payload.file)&&"undefined"!=typeof uni&&(i=e.payload.file.tempFile,e.payload.file.files=[i]),i=e.payload.file,n.url=window.URL.createObjectURL(i.files[0]),n.name=i.files[0].name,n.size=i.files[0].size||1,n.second=i.files[0].duration||0,n.type=i.files[0].type.split("/")[1]);e.payload.file.videoFile=n;var i=this.get(17).getFileDNList(),o=new ki(e);return n=new Ii({videoFormat:n.type,videoSecond:Ut(n.second,0),videoSize:n.size,remoteVideoUrl:"",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile,"jpg"),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:"jpg"},this.getFileDownloadProxy(),this.getDownloadFileAuthKey(),i),i=this._getNickAndAvatarByUserID(t),o.setElement(n),o.setNickAndAvatar(i),o.setNameCard(this._getNameCardByGroupID(o)),this._messageOptionsMap.set(o.clientSequence,e),o}},{key:"createCustomMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new ki(e));return e=new yi({data:e.payload.data,description:e.payload.description,extension:e.payload.extension}),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createFaceMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new ki(e));return e=new hi(e.payload),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createMergerMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),t=this._getNickAndAvatarByUserID(t),new ki(e));return e=new Ei(e.payload),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n.setRelayFlag(!0),n}},{key:"createForwardMessage",value:function(e){var t,n,i=e.to,o=e.conversationType,a=e.priority,s=e.payload,r=e.needReadReceipt,c=e.receiverList;return We(s._elements)?(t=this.getMyUserID(),n=this._getNickAndAvatarByUserID(t),s.type===k.MSG_GRP_TIP?kn({code:Bn.MSG_FORWARD_TYPE_INVALID}):(o={to:i,conversationType:o,conversationID:"".concat(o).concat(i),priority:a,isPlaceMessage:0,status:Sn,currentUser:t,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||s.cloudCustomData||"",needReadReceipt:r,receiverList:c,isSupportExtension:e.isSupportExtension||!1},(i=new ki(o)).setElement(s._elements[0]),i.setNickAndAvatar(n),i.setNameCard(this._getNameCardByGroupID(s)),i.setRelayFlag(!0),i)):kn({code:Bn.MSG_FORWARD_INVALID_ELEMENTS})}},{key:"downloadMergerMessage",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:"createFileMessage",value:function(e){if(Q){if(!q&&!K&&!J)return;var t=ie.getSystemInfoSync().SDKVersion;if(q&&wt(t,"2.5.0")<0)return void this.warn("WXChooseMessageFile");if(K&&wt(t,"1.18.0")<0)return void this.warn("QQChooseMessageFile")}ne||J?Ke(e.payload.file)?(t=e.payload.file,e.payload.file={files:[t]}):$e(e.payload.file)&&"undefined"!=typeof uni&&(i=(t=e.payload.file).tempFiles,t=t.files,n=null,We(i)?n=i[0]:We(t)&&(n=t[0]),e.payload.file={files:[n]}):q||K?(t=f(f({},(i=e.payload.file.tempFiles)[0]),{},{url:i[0].path}),e.payload.file={files:[t]}):te&&(i=f(f({},n=e.payload.file),{},{url:n.uri}),e.payload.file={files:[i]}),t=this.getMyUserID();var n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new ki(e)),i=new vi({uuid:this._generateUUID(e.payload.file),file:e.payload.file});return t=this._getNickAndAvatarByUserID(t),n.setElement(i),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createLocationMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new ki(e));return e=new Mi(e.payload),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"_onNoModule",value:function(){return kn({code:Bn.NO_MODULE})}},{key:"sendMessageInstance",value:function(e,t){var n=this;if(!1===this.get(29).filterMessage(e,t))return e.hasRiskContent=!0,this._onSendMessageFailed(e,new Fn({code:Bn.PROFANITY_FOUND}));var i,o,a,s,r=null;if(e.conversationType===k.CONV_C2C)r=this.get(6);else{if(e.conversationType!==k.CONV_GROUP)return kn({code:Bn.MSG_INVALID_CONV_TYPE});r=this.get(7)}return r?(o="".concat(this._n,".sendMessageInstance"),a=this.get(11),s=r.isOnlineMessage(e,t),this.get(17).upload(e).then((function(){return n._getSendMessageSpecifiedKey(e)===$n&&n.get(26).addSuccessCount(Wn),n._guardForGroup(e).then((function(){if(!e.isSendable())return kn({code:Bn.MSG_F_URL_IS_EMPTY});n._addSendMessageTotalCount(e),i=Date.now();var o=function(e){var t="utf-8";ne&&document&&(t=document.charset.toLowerCase());var n,i=0,o=e.length;if("utf-8"===t||"utf8"===t)for(var a=0;a<o;a++)(n=e.codePointAt(a))<=127?i+=1:n<=2047?i+=2:n<=65535?i+=3:(i+=4,a++);else if("utf-16"===t||"utf16"===t)for(var s=0;s<o;s++)(n=e.codePointAt(s))<=65535?i+=2:(i+=4,s++);else i=e.replace(/[^\x00-\xff]/g,"aa").length;return i}(JSON.stringify(e));return e.type===k.MSG_MERGER&&11264<o?n._mergerMessageHandler.uploadMergerMessage(e,o).then((function(i){return i=n._mergerMessageHandler.createMergerMessagePack(e,t,i),n.req(i)})):(a.setMessageRandom(e),r.sendMessage(e,t))})).then((function(r){var c=(r=r.data).time,u=r.sequence,l=r.readReceiptCode;return r=r.messageDropReason,ze(l)&&0!==l&&(new ii("sendMessageWithReceipt").setMessage("from:".concat(e.from," to:").concat(e.to," sequence:").concat(u," readReceiptCode:").concat(l)).end(),Re.w("".concat(o," readReceiptCode:").concat(l," message:").concat(n.getErrMsg(l)))),r&&(l=new ii("messageDropReason"),r="from:".concat(e.from," to:").concat(e.to," sequence:").concat(u," messageDropReason:").concat(r),l.setMessage(r).end(),Re.w("".concat(o," ").concat(r))),n._addSendMessageSuccessCount(e,i),n._messageOptionsMap.delete(e.clientSequence),!0===e.isResend&&(l=a.findMessage(e.ID))&&(Re.l("".concat(o," resend ok. ID:").concat(l.ID)),a.deleteLocalMessage(l)),e.status=Dn,e.time=c,r=!1,e.conversationType===k.CONV_GROUP?e.sequence=u:e.conversationType===k.CONV_C2C&&(l=a.getLatestMessageSentByMe(e.conversationID))&&(c=l.nick,u=l.avatar,c===e.nick&&u===e.avatar||(r=!0)),r&&a.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),!0===s?e._onlineOnlyFlag=!0:(a.appendToMessageList(e),l=e,$e(t)&&$e(t.messageControlInfo)&&(!0===t.messageControlInfo.excludedFromLastMessage&&(e._isExcludedFromLastMessage=!0,l=""),!0===t.messageControlInfo.excludedFromUnreadCount)&&(e._isExcludedFromUnreadCount=!0),c=e.conversationType,Tt(e.to)&&(c=k.CONV_TOPIC,n.get(10).onMessageSent({groupID:Ft(e.to),topicID:e.to,lastMessage:l})),a.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:c,subType:e.conversationSubType,lastMessage:l}]})),e._relayFlag||"TIMImageElem"!==e.type||Nt(e.payload.imageInfoArray),En({message:e})}))})).catch((function(t){return n._onSendMessageFailed(e,t,s)}))):this._onNoModule()}},{key:"_guardForGroup",value:function(e){if(e.conversationType!==k.CONV_GROUP)return Promise.resolve();var t=this.get(7);if(!t)return this._onNoModule();if(Et({groupID:e.to})){var n=t.getLocalGroupProfile(e.to);if(n&&n.isSupportTopic)return kn({code:Bn.MSG_SEND_GRP_WITH_TOPIC_FAIL})}return t.guardForAVChatRoom(e)}},{key:"_onSendMessageFailed",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i="".concat(this._n,"._onSendMessageFailed"),o=(e.status=bn,80001!==t.code&&80004!==t.code||(e.hasRiskContent=!0),this.get(11)),a=(o.deleteMessageRandom(e),10100<=t.code&&t.code<=10200||120001<=t.code&&t.code<=13e4);return n||a||!0===o.appendToMessageList(e)&&Re.l("".concat(i," message stored, ID:").concat(e.ID)),this._addSendMessageFailCountOnUser(e,t),n=new ii("sendMessage"),a="head.seq:".concat(t.data.headSeq," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to),ne&&("connection"in navigator&&(o=navigator.connection,a+=" downlink:".concat(o.downlink," effectiveType:").concat(o.effectiveType," rtt:").concat(o.rtt)),"memory"in window.performance)&&(o=window.performance.memory,a+=" usedJSHeapSize:".concat(o.usedJSHeapSize," totalJSHeapSize:").concat(o.totalJSHeapSize," jsHeapSizeLimit:").concat(o.jsHeapSizeLimit)),n.setMessage(a).setError(t).end(),Re.e("".concat(i," ").concat(a," error:"),t),kn(new Fn({code:t&&t.code?t.code:Bn.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if([k.MSG_IMAGE,k.MSG_AUDIO,k.MSG_VIDEO,k.MSG_FILE].includes(e.type))return $n;if(e.conversationType===k.CONV_C2C)return Kn;if(e.conversationType===k.CONV_GROUP){var t=this.get(7);if(t&&(t=t.getLocalGroupProfile(e.to)))return Ct(e=t.type)?Yn:zn}}},{key:"_addSendMessageTotalCount",value:function(e){(e=this._getSendMessageSpecifiedKey(e))&&this.get(26).addTotalCount(e)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n;(e=this._getSendMessageSpecifiedKey(e))&&((n=this.get(26)).addSuccessCount(e),n.addCost(e,Yt(t,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){t=void 0===(t=t.code)?-1:t;var n,i=this.get(26);(e=this._getSendMessageSpecifiedKey(e))===$n&&(n=!1,n=!!Ko.includes(t)||n)?i.addFailedCountOfUserSide(Wn):Yo(t)&&e&&i.addFailedCountOfUserSide(e)}},{key:"resendMessage",value:function(e,t){return e.isResend=!0,e.status=Sn,this.sendMessageInstance(e,t)}},{key:"revokeMessage",value:function(e){var t,n,i=this,o=null;return e.conversationType===k.CONV_C2C?o=this.get(6):e.conversationType===k.CONV_GROUP&&(o=this.get(7)),o?((t=new ii("revokeMessage")).setMessage("type:".concat(e.type," from:").concat(e.from," to:").concat(e.to)),n="".concat(this._n,".").concat("revokeMessage"),o.revokeMessage(e).then((function(o){return je(o=o.data.recallRetList)||0===o[0].retCode?(Re.i("".concat(n," ok. ID:").concat(e.ID)),e.isRevoked=!0,t.end(),i.get(11).onMessageRevoked([e]),En({message:e})):(o=new Fn({code:o[0].retCode,data:{message:e}}),t.setCode(o.code).setMoreMessage(o.message).end(),kn(o))})).catch((function(i){t.setError(i).end();var o=new Fn({code:i&&i.code?i.code:Bn.MSG_REVOKE_FAIL,message:i&&i.message?i.message:void 0,data:{message:e}});return Re.w("".concat(n," failed. error:"),i),kn(o)}))):this._onNoModule()}},{key:"deleteMessage",value:function(e){var t=this,n=null,i=e[0],o=i.conversationID,a="",s=[],r=[];if(i.conversationType===k.CONV_C2C)n=this.get(6),a=o.replace(k.CONV_C2C,""),e.forEach((function(e){e&&e.status===Dn&&e.conversationID===o&&(e._onlineOnlyFlag||s.push("".concat(e.sequence,"_").concat(e.random,"_").concat(e.time)),r.push(e))}));else if(i.conversationType===k.CONV_GROUP)n=this.get(7),a=o.replace(k.CONV_GROUP,""),e.forEach((function(e){e&&e.status===Dn&&e.conversationID===o&&(e._onlineOnlyFlag||s.push("".concat(e.sequence)),r.push(e))}));else if(i.conversationType===k.CONV_SYSTEM)return kn({code:Bn.CANNOT_DELETE_GRP_SYSTEM_NOTICE});if(!n)return this._onNoModule();if(0===s.length)return this._onMessageDeleted(r);30<s.length&&(s=s.slice(0,30),r=r.slice(0,30));var c=new ii("deleteMessage"),u=(c.setMessage("to:".concat(a," count:").concat(s.length)),"".concat(this._n,".").concat("deleteMessage"));return n.deleteMessage({to:a,keyList:s}).then((function(e){return c.end(),Re.i("".concat(u," ok")),t._onMessageDeleted(r)})).catch((function(e){return c.setError(e).end(),Re.w("".concat(u," failed. error:"),e),kn(e=new Fn({code:e&&e.code?e.code:Bn.MSG_DELETE_FAIL,message:e&&e.message?e.message:void 0}))}))}},{key:"_onMessageDeleted",value:function(e){return this.get(11).onMessageDeleted(e),Tn({messageList:e})}},{key:"translateText",value:function(e){var t="".concat(this._n,".").concat("translateText"),n=e.sourceTextList,i=e.sourceLanguage,o=(e=e.targetLanguage,new ii("translateText"));return o.setMessage("sourceLanguage:".concat(i," targetLanguage:").concat(e)),this.req({P:jn.TRANSLATE_TEXT,data:{sourceTextList:n,source:i||"auto",target:e,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then((function(e){var n=(e=e.data).error,i=e.requestID;if(e=e.translatedTextList,0===n.code)return o.end(),Re.i("".concat(t," ok. requestID:").concat(i)),En({translatedTextList:e});throw f(f({},n),{},{requestID:i})})).catch((function(e){return o.setCode(e.code).setMoreMessage(e.requestID).end(),Re.w("".concat(t," failed. error:"),e),kn({code:e.code||Bn.TRANSLATE_TEXT_FAIL,message:e.message})}))}},{key:"convertVoiceToText",value:function(e){var t,n,i,o=e.message,a=(e=e.language,o.payload.url);return(o.from===this.getMyUserID()&&"out"===o.flow&&(a=o.payload.remoteAudioUrl),o=/\.(wav|pcm|ogg-opus|speex|silk|mp3|m4a|aac|amr)/).test(a)?(o=o.exec(a)[1]||"mp3",t="16k_zh-PY",e?"zh (cmn-Hans-CN)"===e?t="16k_zh":"en-US"===e?t="16k_en":"yue-Hant-HK"===e?t="16k_yue":"ja-JP"===e&&(t="16k_ja"):t="16k_zh-PY",e="serviceType:".concat(t," url:").concat(a),n="".concat(this._n,".").concat("convertVoiceToText"),Re.i("".concat(n," ").concat(e)),(i=new ii("convertVoiceToText")).setMessage(e),this.req({P:jn.VOICE_TO_TEXT,data:{url:a,language:t,SDKAppID:this.getSDKAppID(),format:o}}).then((function(e){var t=(e=e.data).error,o=e.requestID;if(e=e.result,0===t.code)return i.end(),Re.i("".concat(n," ok. requestID:").concat(o)),En({result:e});throw f(f({},t),{},{requestID:o})})).catch((function(e){return i.setCode(e.code).setMoreMessage(e.requestID||"").end(),Re.w("".concat(n," failed. error:"),e),kn({code:Bn.VOICE_TO_TEXT_FAIL})}))):kn({code:Bn.UNSUPPORTED_VOICE_FORMAT})}},{key:"modifyRemoteMessage",value:function(e){var t=this;if(!1===this.get(29).filterMessage(e))return e.hasRiskContent=!0,kn({code:Bn.PROFANITY_FOUND,data:{message:e}});var n=null,i=e.conversationType,o=e.to;if(i===k.CONV_C2C)n=this.get(6);else if(i===k.CONV_GROUP){if(!(n=this.get(7)))return this._onNoModule();if(n.isMessageFromOrToAVChatroom(o))return kn({code:Bn.MSG_MODIFY_DISABLED_IN_AV,data:{message:e}})}var a=new ii("modifyMessage"),s=(a.setMessage("to:".concat(o)),"".concat(this._n,".modifyRemoteMessage"));return n.modifyRemoteMessage(e).then((function(n){return a.end(),Re.i("".concat(s," ok")),En({message:n=t._onModifyRemoteMessageResp(e,n.data)})})).catch((function(n){var i;return a.setCode(n.code).setMoreMessage(n.message).end(),Re.w("".concat(s," failed. error:"),n),20027===n.code?(i=t._onModifyRemoteMessageResp(e,n.data),kn({code:Bn.MSG_MODIFY_CONFLICT,data:{message:i}})):kn({code:n.code,message:n.message,data:{message:e}})}))}},{key:"_onModifyRemoteMessageResp",value:function(e,t){Re.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),t);var n=e.conversationType,i=e.from,o=e.to,a=e.random,s=e.sequence,r=(e=e.time,t.elements),c=t.messageVersion;return t=void 0===(t=t.cloudCustomData)?"":t,this.get(11).onMessageModified({conversationType:n,from:i,to:o,time:e,random:a,sequence:s,elements:r,cloudCustomData:t,messageVersion:c})}},{key:"_generateUUID",value:function(e,t){var n=this.get(12);return n="".concat(n.getSDKAppID(),"-").concat(n.getUserID(),"-").concat(at()),t?"".concat(n,".").concat(t):(e=(t=e.name||e.value||e.url||e.tempFilePath)&&t.slice(t.lastIndexOf(".")+1))?"".concat(n,".").concat(e):n}},{key:"getMessageOption",value:function(e){return this._messageOptionsMap.get(e)}},{key:"_getNickAndAvatarByUserID",value:function(e){return this.get(4).getNickAndAvatarByUserID(e)}},{key:"_getNameCardByGroupID",value:function(e){if(e.conversationType===k.CONV_GROUP){var t=this.get(7);if(t)return t.getMyNameCardByGroupID(e.to)}return""}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]),Wo=(l(aa,Nn),a(aa,[{key:"onMsgExtNotify",value:function(e){var t=this,n=(e=e.dataList).messageInfo,i=e.operateType,o=e.operateResultList,a=e.tinyID,s=(e=e.globalSequence,n.clientTime),r=(n=n.random,"".concat(a,"-").concat(s,"-").concat(n)),c=[],u=[],l=(Re.l("".concat(this._n,".onMsgExtNotify messageID:").concat(r," operateType:").concat(i," globalSequence:").concat(e)),this._updateGlobalSeq(r,e),!1),d=!1;o.forEach((function(e){var n=void 0===(n=e.extensions)?[]:n,o=e.clearSequence;1===i?(l=!0,n.forEach((function(e){c.push({key:e.key,value:e.value})})),t._updateLocalExt(r,n)):2===i?(d=!0,n.forEach((function(e){u.push(e.key)})),t._updateLocalExt(r,n)):3===i&&(d=!0,t._hasLocalExt(r)&&t._getLocalExt(r).forEach((function(e,t){e.seq<=o&&!je(e.value)&&u.push(t)})),t._clearLocalExt(r,o))})),l&&this.emitOEvt(T.MESSAGE_EXTENSIONS_UPDATED,{messageID:r,extensions:c}),d&&this.emitOEvt(T.MESSAGE_EXTENSIONS_DELETED,{messageID:r,keyList:u})}},{key:"setMessageExtensions",value:function(e,t){var n,i,o,a,s,r,c,u="setMessageExtensions";return this.canIUse(P.MSG_EXT)?(n="".concat(this._n,".").concat(u),i=e.ID,o=e.conversationID,a=e.sequence,s=e.time,r=y(t),20<t.length&&(r=t.slice(0,20),Re.w("".concat(n,". the length of extensions cannot exceed 20."))),t="convID:".concat(o," messageID:").concat(i," sequence:").concat(a," time:").concat(s," count:").concat(r.length),(c=new ii(u)).setMessage(t),Re.l("".concat(n," ").concat(t)),this._modifyMsgExts(e,r).then((function(e){var t=e.resultList,i=e.successCount;return e=e.failureCount,i="successCount:".concat(i," failCount:").concat(e),c.setMoreMessage(i).end(),Re.l("".concat(n," ok. ").concat(i)),En({extensions:t})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))):this.noUse(u)}},{key:"getMessageExtensions",value:function(e){var t,n,i,o,a,s,r,c=this,u="getMessageExtensions";return this.canIUse(P.MSG_EXT)?(t="".concat(this._n,".").concat(u),n=e.ID,a=e.conversationID,i=e.sequence,o=e.time,a="convID:".concat(a," messageID:").concat(n," sequence:").concat(i," time:").concat(o),(s=new ii(u)).setMessage(a),r=void Re.l("".concat(t," ").concat(a)),this.getMsgExtsMap.has(n)&&(r=this._getGlobalSeq(n)),this._getMsgExts(e,r).then((function(e){return s.end(),Re.l("".concat(t," ok. extCount:").concat(e.length)),dt(r)&&0<e.length&&c.getMsgExtsMap.set(n,1),En({extensions:e})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this.noUse(u)}},{key:"deleteMessageExtensions",value:function(e,t){var n,i,o,a,s,r,c,u="deleteMessageExtensions";return this.canIUse(P.MSG_EXT)?(n="".concat(this._n,".").concat(u),i=[],o=3,je(t)||(o=2,t.forEach((function(e){i.push({key:e,value:"",seq:0})}))),t=e.ID,r=e.conversationID,a=e.sequence,s=e.time,r="convID:".concat(r," messageID:").concat(t," sequence:").concat(a," time:").concat(s," operateType:").concat(o),(c=new ii(u)).setMessage(r),Re.l("".concat(n," ").concat(r)),this._modifyMsgExts(e,i,o).then((function(e){var t=e.resultList,i=e.successCount,a=(e=e.failureCount,"");return 2===o&&(a="success count:".concat(i," fail count:").concat(e)),c.setMoreMessage("".concat(a)).end(),Re.l("".concat(n," ok. ").concat(a)),En({extensions:t})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))):this.noUse(u)}},{key:"_modifyMsgExts",value:function(e,t){var n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=Tt(e.to)?k.CONV_TOPIC:e.conversationType,a=void 0,s=(3!==i&&(a=this._getReqExts(e,t)),null);switch(o){case k.CONV_C2C:s=this.get(6);break;case k.CONV_GROUP:s=this.get(7);break;case k.CONV_TOPIC:s=this.get(10);break;default:return kn({code:Bn.NO_MODULE})}return s.modifyMsgExts(e,a,i).then((function(t){var i=(t=t.data).extensions,o=(t=t.seq,[]),a=0,s=0,r=[];return(i=je(i)?[]:i).forEach((function(e){var t=e.errorCode,n=(e=e.extension).key,i=e.value;e=e.seq,o.push({code:t,key:n,value:i}),0===t?a++:s++,r.push({key:n,value:i,seq:e})})),n._updateGlobalSeq(e.ID,t),0<r.length&&(n._updateLocalExt(e.ID,r),r=null),{resultList:o,successCount:a,failureCount:s}})).catch((function(e){return kn(e)}))}},{key:"_getReqExts",value:function(e,t){var n,i=[];return this._hasLocalExt(e.ID)?(n=this._getLocalExt(e.ID),t.forEach((function(e){var t=e.key,o=(e=e.value,0);n.has(t)&&(o=n.get(t).seq),i.push({key:t,value:e,seq:o})}))):t.forEach((function(e){var t=e.key;e=e.value,i.push({key:t,value:e,seq:0})})),i}},{key:"_getMsgExts",value:function(e,t){var n=this,i="".concat(this._n,"._getMsgExts"),o=e.ID,a=null;switch(Tt(e.to)?k.CONV_TOPIC:e.conversationType){case k.CONV_C2C:a=this.get(6);break;case k.CONV_GROUP:a=this.get(7);break;case k.CONV_TOPIC:a=this.get(10);break;default:return kn({code:Bn.NO_MODULE})}return a.getMessageExtensions(e,t).then((function(t){var a=(t=t.data).extensions,s=t.completeFlag,r=t.globalSequence;return t=t.clearSequence,a=je(a)?[]:a,Re.l("".concat(i," ok. completeFlag:").concat(s," globalSequence:").concat(r," clearSequence:").concat(t," count:").concat(a.length)),n._updateLocalExt(o,a),n._clearLocalExt(o,t),n._updateGlobalSeq(o,r),1!==s?(t=a.slice(-1)[0].seq+1,n._getMsgExts(e,t)):n._getLocalExtList(o)})).catch((function(e){return kn(e)}))}},{key:"_hasLocalExt",value:function(e){return this.msgExtMap.has(e)}},{key:"_getLocalExt",value:function(e){return this.msgExtMap.get(e)}},{key:"_updateLocalExt",value:function(e,t){this._hasLocalExt(e)||this.msgExtMap.set(e,new Map);var n=this._getLocalExt(e);t.forEach((function(e){var t=e.key,i=e.value;e=e.seq,n.set(t,{value:void 0===i?"":i,seq:e})}))}},{key:"_clearLocalExt",value:function(e,t){var n;t<=0||!this._hasLocalExt(e)||(n=this._getLocalExt(e)).forEach((function(e,i){e.seq<=t&&n.delete(i)}))}},{key:"_getLocalExtList",value:function(e){var t=[];return this._hasLocalExt(e)&&this._getLocalExt(e).forEach((function(e,n){je(e=e.value)||t.push({key:n,value:e})})),t}},{key:"_getGlobalSeq",value:function(e){return this.globalSeqMap.get(e)}},{key:"_updateGlobalSeq",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this.msgExtMap.clear(),this.globalSeqMap.clear(),this.getMsgExtsMap.clear()}}])),Jo=(l(oa,Nn),a(oa,[{key:"onReactionNotifyList",value:function(e){var t=this;(void 0===(e=(e||{}).dataList)?[]:e).forEach((function(e){var n=e.C2CMessageInfo,i=void 0===(i=e.groupMessageInfo)?{}:i,o=(e=void 0===(e=e.reactionList)?[]:e,i=(n=f(f({},void 0===n?{}:n),i)).tinyID,n.clientTime),a=(n=n.random,i="".concat(i,"-").concat(o,"-").concat(n),[]);e.forEach((function(e){dt(e.userIDList)&&(e.userIDList=[],e.count=0),a.push.apply(a,y(e.userIDList))})),Re.l("".concat(t._n,".onReactionNotifyList messageID:").concat(i," reactionList:").concat(e.length)),t._handleReactionSummary([{messageID:i,reactionList:e}],a).then((function(e){t.emitOEvt(T.MESSAGE_REACTIONS_UPDATED,f({},e[0]))}))}))}},{key:"onReactionNotify",value:function(e){var t=(e=e.dataList||{}).C2CMessageInfo,n=void 0===(n=e.groupMessageInfo)?{}:n,i=e.reactionID,o=(e=e.operateType,n=(t=f(f({},void 0===t?{}:t),n)).tinyID,t.clientTime);t=t.random,n="".concat(n,"-").concat(o,"-").concat(t),Re.l("".concat(this._n,".onReactionNotify messageID:").concat(n," reactionID:").concat(i," operateType:").concat(e)),1===e?this._addReactedByMyselfMap(n,i):this._removeReactedByMyselfMap(n,i),o="".concat(n,"-").concat(i),this._reactionInfoMap.has(o)&&((t=this._reactionInfoMap.get(o)).reactedByMyself=1===e,this.emitOEvt(T.MESSAGE_REACTIONS_UPDATED,{messageID:n,reactionList:[t]}))}},{key:"addMessageReaction",value:function(e,t){var n,i,o,a,s=this,r="addMessageReaction";return this.canIUse(P.MSG_REACTION)?(n="".concat(this._n,".").concat(r),a=e.ID,i=e.conversationID,i="convID:".concat(i," messageID:").concat(a," reactionID:").concat(t),(o=new ii(r)).setMessage(i),Re.l("".concat(n," ").concat(i)),a=this._createReactionOperationPack(e,t,1),this._addReactedByMyselfMap(e.ID,t),this.req(a).then((function(){return o.end(),Re.l("".concat(n," ok.")),En()})).catch((function(i){return s._removeReactedByMyselfMap(e.ID,t),o.setError(i).end(),Re.e("".concat(n," failed. error:"),i),kn(i)}))):this.noUse(r)}},{key:"removeMessageReaction",value:function(e,t){var n,i,o,a,s="removeMessageReaction";return this.canIUse(P.MSG_REACTION)?(n="".concat(this._n,".").concat(s),a=e.ID,i=e.conversationID,i="convID:".concat(i," messageID:").concat(a," reactionID:").concat(t),(o=new ii(s)).setMessage(i),Re.l("".concat(n," ").concat(i)),a=this._createReactionOperationPack(e,t,2),this._removeReactedByMyselfMap(e.ID,t),this.req(a).then((function(){return o.end(),Re.l("".concat(n," ok.")),En()})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),kn(e)}))):this.noUse(s)}},{key:"getMessageReactions",value:function(e){var t,n,i,o,a,s,r=this,c="getMessageReactions";return this.canIUse(P.MSG_REACTION)?(t="".concat(this._n,".").concat(c),n=e.messageList,s=e.maxUserCountPerReaction,i=n[0].conversationID,i="convID:".concat(i," maxUserCountPerReaction:").concat(s," msgCount:").concat(n.length),(o=new ii(c)).setMessage(i),Re.l("".concat(t," ").concat(i)),a=new Map,s=this._createReactionSummaryPack(f(f({},e),{},{messageIDMap:a})),this.req(s).then((function(e){e=e.data.resultList;var t=[],n=[];return(void 0===e?[]:e).forEach((function(e){var i=void 0===(i=e.messageKey)?void 0:i,o=void 0===(o=e.messageSequence)?void 0:o;e=void 0===(e=e.reactionList)?[]:e,o=dt(i)?a.get(o):a.get(i),t.push({messageID:o,reactionList:e}),e.forEach((function(e){n.push.apply(n,y(e.userIDList))}))})),r._handleReactionSummary(t,n)})).then((function(e){return o.end(),Re.l("".concat(t," ok.")),a.clear(),En({resultList:e})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this.noUse(c)}},{key:"getAllUserListOfMessageReaction",value:function(e){var t,n,i,o,a,s,r,c,u=this,l="getAllUserListOfMessageReaction";return this.canIUse(P.MSG_REACTION)?(t="".concat(this._n,".").concat(l),a=e.message,n=e.reactionID,i=e.nextSeq,o=e.count,c=a.ID,a=a.conversationID,a="convID:".concat(a," messageID:").concat(c," reactionID:").concat(n," nextSeq:").concat(i," count:").concat(o),(s=new ii(l)).setMessage(a),Re.l("".concat(t," ").concat(a)),r={userList:[],nextSeq:0,isCompleted:!1},c=this._createReactionUserListPack(e),this.req(c).then((function(e){var t=void 0===(t=(e=e.data).userIDList)?[]:t;return e=void 0===(e=e.nextSeq)?0:e,r.nextSeq=e,r.isCompleted=0===e,u.get(4).getUserNickAndAvatar(t)})).then((function(e){return r.userList=e,s.end(),Re.l("".concat(t," ok.")),En(r)})).catch((function(e){return s.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this.noUse(l)}},{key:"_createReactionOperationPack",value:function(e,t,n){var i,o,a=void 0;return t={reactionID:t,userIDList:[this.getMyUserID()]},e.conversationType===k.CONV_C2C&&(i=this.get(6),a=1===n?jn.ADD_C2C_MSG_REACTION:jn.RM_C2C_MSG_REACTION,t.from=e.from,t.to=e.to,t.messageKey=i.getMessageKey(e)),e.conversationType===k.CONV_GROUP&&(i=void 0,o=e.to,Tt(e.to)&&(o=Ft(i=e.to)),a=1===n?jn.ADD_GRP_MSG_REACTION:jn.RM_GRP_MSG_REACTION,t.groupID=o,t.topicID=i,t.messageSequence=e.sequence),{P:a,data:t}}},{key:"_createReactionSummaryPack",value:function(e){var t,n,i,o=e.messageList,a=void 0===(a=e.maxUserCountPerReaction)?10:a,s=e.messageIDMap,r=void 0,c=void 0;return(e=o[0]).conversationType===k.CONV_C2C&&(t=this.get(6),n=o.map((function(e){var n=t.getMessageKey(e);return s.set(n,e.ID),n})),r=jn.GET_C2C_MSG_REACTIONS,c={from:e.from,to:e.to,messageKeyList:n,count:a}),e.conversationType===k.CONV_GROUP&&(n=void 0,i=e.to,Tt(e.to)&&(i=Ft(n=e.to)),e=o.map((function(e){return s.set(e.sequence,e.ID),e.sequence})),r=jn.GET_GRP_MSG_REACTIONS,c={groupID:i,topicID:n,messageSequenceList:e,count:a}),{P:r,data:c}}},{key:"_createReactionUserListPack",value:function(e){var t=e.message,n=e.reactionID,i=e.nextSeq,o=void 0;return n={reactionID:n,nextSeq:void 0===i?0:i,count:100<(e=void 0===(e=e.count)?100:e)?100:e},t.conversationType===k.CONV_C2C&&(i=this.get(6),o=jn.GET_C2C_MSG_REACTION_USER_LIST,n.from=t.from,n.to=t.to,n.messageKey=i.getMessageKey(t)),t.conversationType===k.CONV_GROUP&&(e=void 0,i=t.to,Tt(t.to)&&(i=Ft(e=t.to)),o=jn.GET_GRP_MSG_REACTION_USER_LIST,n.groupID=i,n.topicID=e,n.messageSequence=t.sequence),{P:o,data:n}}},{key:"_handleReactionSummary",value:function(e,t){var n=this;return this.get(4).getUserNickAndAvatar(t).then((function(t){var i=[];return e.forEach((function(e){var o=[];e.reactionList.forEach((function(i){var a=i.reactionID,s=i.count,r=i.userIDList,c=(i=void 0===(i=i.reactedByMyself)?void 0:i,[]);r.forEach((function(e){t.forEach((function(t){e===t.userID&&c.push(t)}))})),r={reactionID:a,totalUserCount:s,partialUserList:c,reactedByMyself:n._computeReactedByMyself({reactedByMyself:i,messageID:e.messageID,reactionID:a})},o.push(r),dt(i)&&!n._reactedByMyselfMap.has(e.messageID)&&(s="".concat(e.messageID,"-").concat(a),n._reactionInfoMap.set(s,r))})),i.push({messageID:e.messageID,reactionList:o})})),i}))}},{key:"_addReactedByMyselfMap",value:function(e,t){this._reactedByMyselfMap.has(e)||this._reactedByMyselfMap.set(e,[]),-1===(e=this._reactedByMyselfMap.get(e)).indexOf(t)&&e.push(t)}},{key:"_removeReactedByMyselfMap",value:function(e,t){this._reactedByMyselfMap.has(e)&&-1<(t=(e=this._reactedByMyselfMap.get(e)).indexOf(t))&&e.splice(t,1)}},{key:"_computeReactedByMyself",value:function(e){var t=e.reactedByMyself,n=e.messageID;return e=e.reactionID,dt(t)?!!this._reactedByMyselfMap.has(n)&&this._reactedByMyselfMap.get(n).includes(e):1===t}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._reactedByMyselfMap.clear(),this._reactionInfoMap.clear()}}])),Xo=(l(ia,Nn),a(ia,[{key:"sendMessage",value:function(e){var t=this,n=this._createMsg(e);if(null===n)return kn({code:Bn.MSG_SEND_FAIL});this._addSendMessageTotalCount(n);var i=Date.now();return this.get(11).setMessageRandom(n),this._sendComboMessage(n,e).then((function(e){var o=(e=e.data).time,a=e.sequence;return ze(e=e.readReceiptCode)&&0!==e&&(new ii("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(a," readReceiptCode:").concat(e)).end(),Re.w("".concat(t._n,".sendMessage readReceiptCode:").concat(e," message:").concat(t.getErrMsg(e)))),t._addSendMessageSuccessCount(n,i),e=t.get(11),n.status=Dn,n.time=o,n.conversationType===k.CONV_GROUP&&(n.sequence=a),e.appendToMessageList(n),o=n,!0===n._isExcludedFromLastMessage&&(o=""),e.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:o}]}),En({message:n})})).catch((function(e){return t._onSendMessageFailed(n,e)}))}},{key:"_sendComboMessage",value:function(e,t){var n=this._m.get(20),i="";return e.conversationType===k.CONV_C2C&&(i="".concat(N.NAME.OPEN_IM,".").concat(jn.SEND_C2C_MSG)),e.conversationType===k.CONV_GROUP&&(i="".concat(N.NAME.GRP,".").concat(jn.SEND_GRP_MSG)),n.sendComboMessage({servcmd:i,data:t})}},{key:"_createMsg",value:function(e){var t="".concat(this._n,"._createMsg"),n=null;try{var i,o=this.getMyUserID(),a={};a.senderTinyID=this.getMyTinyID(),a.currentUser=o,a.from=e.From_Account||o,e.GroupId?(a.conversationID="".concat(k.CONV_GROUP).concat(e.GroupId),a.conversationType=k.CONV_GROUP,a.to=e.GroupId):e.To_Account&&(a.conversationID="".concat(k.CONV_C2C).concat(e.To_Account),a.conversationType=k.CONV_C2C,a.to=e.To_Account),a.time=e.MsgTimeStamp||0,a.random=e.Random||e.MsgRandom||0,a.priority=e.MsgPriority,lt(e.CloudCustomData)&&0<e.CloudCustomData.length&&(a.cloudCustomData=e.CloudCustomData),We(e.SendMsgControl)&&(a.messageControlInfo={},e.SendMsgControl.includes("NoUnread")&&(a.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes("NoLastMsg"))&&(a.messageControlInfo.excludedFromLastMessage=1),a.conversationType===k.CONV_GROUP&&We(e.To_Account)&&0<e.To_Account.length&&(i=e.To_Account,50<e.To_Account.length&&(i=e.To_Account.slice(0,50),Re.w("".concat(t," To_Account must be less than or equal to 50."))),a.receiverList=y(i),e.To_Account=y(i)),1!==e.IsNeedReadReceipt&&1!==e.NeedReadReceipt||(a.needReadReceipt=!0),1===e.SupportMessageExtension&&(a.isSupportExtension=!0),(n=new ki(a)).status=Sn,e.MsgClientTime=n.clientTime,n.conversationType===k.CONV_C2C&&(e.MsgSeq=n.sequence);for(var s,r=e.MsgBody.length,c=0;c<r;c++)"TIMTextElem"===(s=e.MsgBody[c]).MsgType?n.setTextElement(s.MsgContent.Text):"TIMCustomElem"===s.MsgType?n.setCustomElement({data:s.MsgContent.Data||"",description:s.MsgContent.Desc||"",extension:s.MsgContent.Ext||""}):"TIMFaceElem"===s.MsgType&&n.setFaceElement({index:s.MsgContent.Index,data:s.MsgContent.Data});var u=n.getElements();n.payload=u[0].content,n.type=u[0].type}catch(l){n=null,Re.e("".concat(t," failed. error:"),l)}return n}},{key:"_onSendMessageFailed",value:function(e,t){e.status=bn,this.get(11).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new ii("sendMessage"),i="head.seq:".concat(t.data.headSeq,"  type:").concat(e.type," from:").concat(e.from," to:").concat(e.to);return n.setMessage(i).setError(t).end(),Re.e("".concat(this._n,"._onSendMessageFailed ").concat(i," error:"),t),kn(new Fn({code:t&&t.code?t.code:Bn.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){return e.conversationType===k.CONV_C2C?Kn:e.conversationType===k.CONV_GROUP&&(e=this.get(7).getLocalGroupProfile(e.to))?Ct(e=e.type)?Yn:zn:void 0}},{key:"_addSendMessageTotalCount",value:function(e){(e=this._getSendMessageSpecifiedKey(e))&&this.get(26).addTotalCount(e)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n;(e=this._getSendMessageSpecifiedKey(e))&&((n=this.get(26)).addSuccessCount(e),n.addCost(e,Yt(t,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){t=void 0===(t=t.code)?-1:t;var n=this.get(26);e=this._getSendMessageSpecifiedKey(e),Yo(t)&&e&&n.addFailedCountOfUserSide(e)}}])),Zo=(l(na,Nn),a(na,[{key:"registerPlugin",value:function(e){var t=this,n="0";Object.keys(e).forEach((function(i){t.plugins[i]=e[i],"tim-upload-plugin"===i&&"function"==typeof e[i].getVersion&&(n=e[i].getVersion())})),new ii("registerPlugin").setMessage("".concat(Object.keys(e))).setMoreMessage("version:".concat(n)).end()}},{key:"getPlugin",value:function(e){return this.plugins[e]}},{key:"reset",value:function(){}}])),Qo=(l(ta,Nn),a(ta,[{key:"_init",value:function(){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(e){var t=this,n=e.cookie,i=e.syncFlag,o=e.isOnlineSync,a="".concat(this._n,"._startSync"),s=(Re.l("".concat(a," options:"),e),new ii("syncUnread"));s.setMessage(JSON.stringify(e)),this.req({P:jn.SYNC_UNREAD_MSG,data:{cookie:n,syncFlag:i,isOnlineSync:o}}).then((function(e){var n=(i=e.data).cookie,i=i.syncFlag,o="$cookie:".concat(n," syncFlag:").concat(i);Re.l("".concat(a," ok. ").concat(o)),t._cookie=n,s.setMoreMessage(o).end(),je(n)||(0===i||1===i?(t._dispatch(f(f({},e.data),{},{isSyncingEnded:!1})),t._startSync({cookie:n,syncFlag:i,isOnlineSync:0})):2===i&&t._dispatch(f(f({},e.data),{},{isSyncingEnded:!0})))})).catch((function(e){s.setError(e).end(),Re.e("".concat(a," failed. error:"),e)}))}},{key:"_dispatch",value:function(e){e.eventArray&&this.get(20).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}}),this.get(6).onNewMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList,isSyncingEnded:e.isSyncingEnded})}},{key:"syncOnNeed",value:function(){Re.l("".concat(this._n,".syncOnNeed cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"syncOnReconnected",value:function(){Re.l("".concat(this._n,".syncOnReconnected cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}])),ea={req:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq",simplifiedMessage:"DownsizeFlag",isRelayMessage:"IsRelayMsg",reactionID:"Reaction",messageSequenceList:"MsgSeqList",messageKeyList:"MsgKeyList",cmConfigID:"CustomModerationConfigID"},res:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence",InviteJoinOption:"inviteOption",MemberList_Account:"inviteeList",MsgMemberExtraInfoList:"inviteeInfoList",E:"event",GInf:"groupProfile",MCT:"clientTime",MR:"random",MP:"priority",MTS:"time",GId:"groupID",MS:"sequence",CCD:"cloudCustomData",F_Account:"from",F_Hd:"avatar",F_NN:"nick",GN:"groupName",GT:"groupType",IsSys:"isSystemMessage",OpInf:"operatorInfo",Img:"avatar",NN:"nick",OnlineInf:"onlineMemberInfo",ET:"expireTime",Num:"onlineMemberNum",Opt:"operationType",O_Account:"operatorID",RT:"operationType",UDF:"userDefinedField",L_Account:"userIDList",IsPlaceMsg:"isPlaceMessage",MsgCheckResult:"checkResult",Results:"resultList",Reaction:"reactionID",Reaction_Account:"userIDList",MsgReactionNotifyList:"messageReactionNotifyList",MsgReactionNotify:"messageReactionNotify",MsgReactionSummary:"reactionList",C2CMsgInfo:"C2CMessageInfo",GroupMsgInfo:"groupMessageInfo",int32_err_code:"errorCode",str_err_msg:"errorMsg",MsgDropReason:"messageDropReason",ReactedByMe:"reactedByMyself",Level:"messageRemindType",PeerReadTime:"timestamp",NoUnreadSeqList:"excludedUnreadSequenceList",NewMsg:"topicLatestMessage"},ignoreKeyWord:["C2C","ID","USP"]};function ta(e){return i(this,ta),(e=n(this,ta,[e]))._n="SyncUnreadMsgModule",e._cookie="",e._onlineSyncFlag=!1,e.getIEmitInst().on(Oi.A2KEY_AND_TINYID_UPDATED,e._init,e),e}function na(e){return i(this,na),(e=n(this,na,[e]))._n="PluginModule",e.plugins={},e}function ia(e){return i(this,ia),(e=n(this,ia,[e]))._n="ComboMsgModule",e}function oa(e){return i(this,oa),(e=n(this,oa,[e]))._n="MsgReactionModule",e._reactedByMyselfMap=new Map,e._reactionInfoMap=new Map,e}function aa(e){return i(this,aa),(e=n(this,aa,[e]))._n="MsgExtModule",e.msgExtMap=new Map,e.globalSeqMap=new Map,e.getMsgExtsMap=new Map,e}function sa(e){return i(this,sa),(e=n(this,sa,[e]))._n="MessageModule",e._messageOptionsMap=new Map,e._mergerMessageHandler=new qo(e),e}function ra(e,t){if("string"==typeof e||Array.isArray(e))return t=Object.assign({pascalCase:!1},t),0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e=e=(e=e!==e.toLowerCase()?ca(e):e).replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(e,t){return t.toUpperCase()})).replace(/\d+(\w|$)/g,(function(e){return e.toUpperCase()})),t.pascalCase?e.charAt(0).toUpperCase()+e.slice(1):e);throw new TypeError("Expected the input to be `string | string[]`")}var ca=function(e){for(var t=!1,n=!1,i=!1,o=0;o<e.length;o++){var a=e[o];t&&/[a-zA-Z]/.test(a)&&a.toUpperCase()===a?(e=e.slice(0,o)+"-"+e.slice(o),i=n,n=!(t=!1),o++):n&&i&&/[a-zA-Z]/.test(a)&&a.toLowerCase()===a?(e=e.slice(0,o-1)+"-"+e.slice(o-1),i=n,t=!(n=!1)):(t=a.toLowerCase()===a&&a.toUpperCase()!==a,i=n,n=a.toUpperCase()===a&&a.toLowerCase()!==a)}return e};function ua(e,t){var n=0;return function e(t,i){var o,a,s,r;return 100<++n?(n--,t):We(t)?(o=t.map((function(t){return Ye(t)?e(t,i):t})),n--,o):Ye(t)?(a=t,s=function(e,t){if(!Qe(t))return!1;if(t!==ra(t))for(var n=0;n<ea.ignoreKeyWord.length&&!t.includes(ea.ignoreKeyWord[n]);n++);var o;return dt(i[t])?(o=t)[0].toUpperCase()+ra(o).slice(1):i[t]},r=Object.create(null),Object.keys(a).forEach((function(e){var t=s(a[e],e);t&&(r[t]=a[e])})),o=bt(o=r,(function(t,n){return We(t)||Ye(t)?e(t,i):t})),n--,o):void 0}(e,t)}for(var la=String.fromCharCode,da=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320)if(56320<=(e=0|e.charCodeAt(1))&&e<=57343){if(65535<(t=(t<<10)+e-56613888|0))return la(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533;else t<=57343&&(t=65533);return t<=2047?la(192|t>>>6,128|63&t):la(224|t>>>12,128|t>>>6&63,128|63&t)},ha=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,da),n=0|t.length,i=new Uint8Array(n),o=0;o<n;o=o+1|0)i[o]=0|t.charCodeAt(o);return i},pa=a((function e(t){i(this,e);var n,o,a=(this._handler=t).getURL();this._socket=null,this._workerSocket=null,this._id=ot(),this._handler.getIsWorkerEnabled()?(n=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen", extensions: _socket.extensions });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"})),this._workerSocket=new Worker(n),(o=this)._workerSocket.onmessage=function(e){var t=(i=e.data).callback,n=i.e,i=i.extensions;"onOpen"===t?o._onOpen(i):"onClose"===t?o._onClose(n):"onError"===t?o._onError(n):"onMessage"===t&&o._onMessage(e.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:a})):Q?$?(ie.connectSocket({url:a,header:{"content-type":"application/json"}}),ie.onSocketClose(this._onClose.bind(this)),ie.onSocketOpen(this._onOpen.bind(this)),ie.onSocketMessage(this._onMessage.bind(this)),ie.onSocketError(this._onError.bind(this))):(this._socket=ie.connectSocket({url:a,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):(this._socket=new WebSocket(a),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this,this._socket.extensions),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this)),this._canIUseBinaryFrame=t.canIUseBinaryFrame()}),[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(e){this._handler.onOpen({id:this._id,res:JSON.stringify(e)})}},{key:"_onClose",value:function(e){this._handler.onClose({id:this._id,e:e})}},{key:"_onMessage",value:function(e){e=this._canIUseBinaryFrame?this._isAppCompressedData(e.data)?this._handler.inflate(e.data):function(e){for(var t=new Uint8Array(e),n="",i=0,o=t.length;i<o;){var a=t[i],s=0,r=0;if(a<=127?(s=0,r=255&a):a<=223?(s=1,r=31&a):a<=239?(s=2,r=15&a):a<=244&&(s=3,r=7&a),0<o-i-s)for(var c=0;c<s;)r=r<<6|63&(a=t[i+c+1]),c+=1;else r=65533,s=o-i;n+=String.fromCodePoint(r),i+=s+1}return n}(e.data):e.data,this._handler.onMessage({data:e})}},{key:"_isAppCompressedData",value:function(e){return 67===(e=new Uint8Array(e))[0]&&79===e[1]&&77===e[2]&&80===e[3]}},{key:"_onError",value:function(e){this._handler.onError({id:this._id,e:e})}},{key:"setIsWorkerEnabled",value:function(e){this._isWorkerEnabled=!0}},{key:"close",value:function(e){this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:e}),this._workerSocket.terminate(),this._workerSocket=null),$?(ie.offSocketClose(),ie.offSocketMessage(),ie.offSocketOpen(),ie.offSocketError(),ie.closeSocket()):this._socket&&(Q?(this._socket.onClose((function(){})),this._socket.onOpen((function(){})),this._socket.onMessage((function(){})),this._socket.onError((function(){}))):(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),Y?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:"send",value:function(e){this._workerSocket?this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?ha(e.data).buffer:e.data}):$?ie.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):this._socket&&(Q?this._socket.send({data:this._canIUseBinaryFrame?ha(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):this._socket.send(this._canIUseBinaryFrame?ha(e.data):e.data))}}]),ga=["keyMap"],fa=["keyMap"],ma="connected",_a="connecting",va="disconnected",ya=a((function e(t){i(this,e),this._chM=t,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=va,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=ot(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._currentSite=O,this._setWebsocketHost(),this._initConnection()}),[{key:"_setWebsocketHost",value:function(){var e=this._chM.get(12);this._currentSite=O,this._chM.isOversea()&&(this._currentSite="OVERSEA"),e.isSingaporeSite()?this._currentSite="SINGAPORE":e.isKoreaSite()?this._currentSite="KOREA":e.isGermanySite()?this._currentSite="GERMANY":e.isIndiaSite()?this._currentSite="IND":e.isJapanSite()?this._currentSite="JPN":e.isUSASite()?this._currentSite="USA":e.isIndonesiaSite()&&(this._currentSite="INDONESIA"),N.HOST.setCurrent(this._currentSite)}},{key:"_initConnection",value:function(){var e=this._chM.get(12).getSDKAppID()+"",t=this._chM.get(12).isIndependentDomainDisabled();je(e=(dt(N.HOST.CURRENT.BACKUP)?this._url=N.HOST.CURRENT.DEFAULT:""===this._url?this._url=t?N.HOST.CURRENT.DEFAULT:N.HOST.CURRENT.DEFAULT0.replace("*",e):-1<this._url.indexOf(e)?this._url=N.HOST.CURRENT.DEFAULT:this._url===N.HOST.CURRENT.DEFAULT?this._url=N.HOST.CURRENT.IPV6:this._url===N.HOST.CURRENT.IPV6?this._url=ne?this._genRandomDomain():N.HOST.CURRENT.BACKUP:this._isWebBackupUrl(this._url)||this._url===N.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?N.HOST.CURRENT.ANYCAST:N.HOST.CURRENT.DEFAULT:this._url===N.HOST.CURRENT.ANYCAST&&(N.HOST.CURRENT.ANYCAST="",this._url=N.HOST.CURRENT.DEFAULT),t=this._chM.get(12)).getProxyServer())||(this._url=e),t.isTestEnv()&&(this._url=A.TEST[this._currentSite].DEFAULT),this._connect(),this._nextPingTs=0}},{key:"_genRandomDomain",value:function(){var e=Math.floor(10001*Math.random())+1e4;return N.HOST.CURRENT.BACKUP_WEB.replace("*",e)}},{key:"_isWebBackupUrl",value:function(e){return e.includes("my-cpaas.com")}},{key:"_canIUseAnyCast",value:function(){return ne&&N.HOST.CURRENT.ANYCAST}},{key:"onCheckTimer",value:function(e){e%1==0&&(this._checkPromiseMap(),this._checkNativeAppWS())}},{key:"_checkPromiseMap",value:function(){var e=this;0!==this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var i=t.reject,o=t.timestamp,a=(t=t.headSeq,15e3);-1!==n.indexOf(jn.LOGIN)?a=9e4:-1!==n.indexOf(jn.PING)&&(a=3e3),Date.now()-o>=a&&(Re.l("".concat(e._n,"._checkPromiseMap request timeout, delete requestID:").concat(n)),e._promiseMap.delete(n),i(new Fn({code:Bn.NETWORK_TIMEOUT,data:{headSeq:t}})),e._chM.onRequestTimeout())}))}},{key:"_checkNativeAppWS",value:function(){J&&!this.isConnected()&&this._reConnect()}},{key:"onOpen",value:function(e){var t,n;this._readyState!==va&&(this._onOpenTs=Date.now(),n=e.id,e=e.res,this._socketID=n,t=Yt(this._startTs,!1),n="socketID:".concat(n," res:").concat(e),Re.l("".concat(this._n,"._onOpen cost:").concat(t," ms. ").concat(n)),new ii("wsOnOpen").setMessage(t).setCostTime(t).setMoreMessage(n).end(),this._readyState=ma,this._reConnectCount=0,this._resend(),!0===this._reConnectFlag&&(this._chM.onReconnected(),this._reConnectFlag=!1),this._chM.onOpen())}},{key:"onClose",value:function(e){var t=new ii("wsOnClose"),n=e.id,i=(e=e.e,"sourceSocketID:".concat(n," currentSocketID:").concat(this._socketID," code:").concat(e.code," reason:").concat(e.reason)),o=0;0!==this._onOpenTs&&(o=Date.now()-this._onOpenTs),t.setMessage(o).setCostTime(o).setMoreMessage(i).setCode(e.code).end(!0),Re.l("".concat(this._n,"._onClose ").concat(i," onlineTime:").concat(o)),n===this._socketID&&(this._readyState=va,o<1e3?this._chM.onReconnectFailed():this._chM.onClose())}},{key:"onError",value:function(e){var t=e.id,n=(e=e.e,"sourceSocketID:".concat(t," currentSocketID:").concat(this._socketID));new ii("wsOnError").setMessage(e.errMsg||JSON.stringify(e,["message","code"])).setMoreMessage(n).setLevel("error").end(!0),Re.w("".concat(this._n,"._onError"),e,n),t===this._socketID&&(this._readyState=va,this._chM.onError())}},{key:"onMessage",value:function(e){var t,n,i,o,a,s;try{t=JSON.parse(e.data)}catch(r){new ii("jsonParseError").setMessage(e.data).end()}t&&t.head&&(e=this._getRequestIDFromHead(t.head),n=t.body,this._chM.get(30).isTRTCCommand(e)||(s=Pt(t.head),n=function e(t,n){var i,o,a;return We(t)?t.map((function(t){return Ye(t)?e(t,n):t})):Ye(t)?(i=t,o=function(e,t){return dt(n[t])?ra(t):n[t]},a={},Object.keys(i).forEach((function(e){a[o(i[e],e)]=i[e]})),bt(a,(function(t){return We(t)||Ye(t)?e(t,n):t}))):void 0}(t.body,this._getResKeyMap(s))),Re.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(n)," requestID:").concat(e," has:").concat(this._promiseMap.has(e))),this._setNextPingTs(),this._promiseMap.has(e)?(i=(s=this._promiseMap.get(e)).resolve,o=s.reject,a=s.timestamp,s=s.headSeq,this._promiseMap.delete(e),this._calcRTT(a),n.errorCode&&0!==n.errorCode?(this._chM.onErrorCodeNotZero(n),o(new Fn({code:n.errorCode,message:n.errorInfo||"",data:e.includes(jn.MODIFY_C2C_MSG)||e.includes(jn.MODIFY_GRP_MSG)?{elements:n.elements,messageVersion:n.messageVersion,cloudCustomData:n.cloudCustomData,headSeq:s}:{headSeq:s}}))):i(En(n))):this._chM.onMessage({head:t.head,body:n}))}},{key:"_calcRTT",value:function(e){e=Date.now()-e,this._chM.get(26).addRTT(e)}},{key:"_connect",value:function(){this._readyState!==_a&&this._readyState!==ma&&(this._startTs=Date.now(),this._onOpenTs=0,this._readyState=_a,this._socket=new pa(this),this._socketID=this._socket.getID(),Re.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new ii("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end())}},{key:"getURL",value:function(){this._chM.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=Rt(),t=(($||q&&"windows"===e||J)&&(this._canIUseBinaryFrame=!1),-1),n=("ios"===e?t=re||-1:"android"===e&&(t=ue||-1),this._chM.get(12)),i=this._chM.getPlatform(),o=n.getSDKAppID();return n=n.getInstanceID(),o="sdkappid=".concat(o,"&instanceid=").concat(n,"&random=").concat(this._getRandom(),"&platform=").concat(i,"&host=").concat(e)+"&version=".concat(t,"&sdkversion=").concat("3.5.5"),H&&(o+="&isminigame=1"),this._chM.canIUseInflate()&&(o+="&compress=gzip"),(this._canIUseBinaryFrame?"".concat(this._url,"/binfo?"):"".concat(this._url,"/info?")).concat(o)}},{key:"_closeConnection",value:function(e){Re.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=va)}},{key:"_resend",value:function(){var e=this;if(Re.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),0<this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var i=t.uplinkData,o=t.resolve;t=t.reject,-1!==n.indexOf(jn.AV_POLLING)?e._promiseMap.delete(n):(e._promiseMap.set(n,{resolve:o,reject:t,timestamp:Date.now(),uplinkData:i}),e._execute(n,i))})),0<this._simpleRequestMap.size){var t,n=s(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var i=v(t.value,2),o=i[0],a=i[1];this._execute(o,a)}}catch(r){n.e(r)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(e){var t=this,n=(e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.head.cs=this._calcCheckSum(e.head.servcmd,e.body),e.keyMap,m(e,ga)),i=this._getRequestIDFromHead(e.head),o=JSON.stringify(n);return new Promise((function(a,s){t._promiseMap.set(i,{resolve:a,reject:s,timestamp:Date.now(),uplinkData:o,headSeq:e.head.seq}),Re.d("".concat(t._n,".send uplinkData:").concat(JSON.stringify(n)," requestID:").concat(i," readyState:").concat(t._readyState)),t._readyState!==ma?t._reConnect():(t._execute(i,o),t._chM.get(26).addRequestCount())}))}},{key:"simplySend",value:function(e){e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var t=m(e,fa);e=this._getRequestIDFromHead(e.head),t=JSON.stringify(t),this._readyState!==ma?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(e,t):Re.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(e,t)}},{key:"_execute",value:function(e,t){this._socket.send({data:t,fail:Q?this._onSendFail.bind(this):void 0,requestID:e})}},{key:"_onSendFail",value:function(e){Re.l("".concat(this._n,"._onSendFail requestID:").concat(e)),this._chM.onSendFail()}},{key:"_getSequence",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,2415919103===this._startSequence&&(this._startSequence=ot()),e}},{key:"_getRequestIDFromHead",value:function(e){return e.servcmd+e.seq}},{key:"_getResKeyMap",value:function(e){return e=this._chM.getKeyMap(e),f(f({},ea.res),e.res)}},{key:"_reConnect",value:function(){this._readyState!==ma&&this._readyState!==_a&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var e="".concat(this._n,".forcedReconnect");Re.l("".concat(e," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(4001),this._initConnection()):(this._reConnectCount=0,this._chM.get(15).isOnline()?(Re.w("".concat(e," disconnected from wsserver but network is ok, continue...")),this._closeConnection(4001),this._initConnection()):this._chM.onReconnectFailed())}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=J?Date.now()+5e3:Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===ma}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"getSocketID",value:function(){return this._socketID}},{key:"inflate",value:function(e){if(this._chM.canIUseInflate())return this._chM.get(37).inflate(e)}},{key:"setIsWorkerEnabled",value:function(e){Re.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(e)),this._isWorkerEnabled=e}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&ge}},{key:"_getRandom",value:function(){return 0===this._random&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"_calcCheckSum",value:function(e,t){if(-1!==e.indexOf(jn.PING)||-1!==e.indexOf(jn.LOGIN)||-1!==e.indexOf(jn.LOGOUT)||-1!==e.indexOf(jn.AV_POLLING)||-1!==e.indexOf(jn.AV_NOAUTH_POLLING))return 0;for(var n=ha(JSON.stringify(t)),i=4294967295,o=0,a=n.length;o<a;o++){i^=n[o];for(var s=0;s<8;s++)1&~i?i>>>=1:i=i>>>1^3988292384}return(4294967295^i)>>>0}},{key:"close",value:function(){Re.l("".concat(this._n,".close")),this._closeConnection(4e3),this._promiseMap.clear(),this._startSequence=ot(),this._readyState=va,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),Ia=function(e,t,n){return new Promise((function(i,o){var a,s,r="application/x-www-form-urlencoded;charset=UTF-8";Q?ie.request({url:t,data:n,method:e,timeout:3e3,header:{"content-type":r},success:function(e){e&&e.data&&e.data.NetCheckInfo&&Re.l("".concat("getconninfo ok in"," miniapp. ret:"),e.data),i()},fail:function(){o(new Fn({code:Bn.NETWORK_ERROR}))}}):(a=new XMLHttpRequest,s=setTimeout((function(){a.abort(),o(new Fn({code:Bn.NETWORK_TIMEOUT}))}),3e3),a.onreadystatechange=function(){4===a.readyState&&(s&&clearTimeout(s),200===a.status||304===a.status?(a.responseText&&-1<a.responseText.indexOf("NetCheckInfo")&&Re.l("".concat("getconninfo ok in"," web. ret:"),JSON.parse(a.responseText)),i()):o(new Fn({code:Bn.NETWORK_ERROR})))},a.open(e,t,!0),a.setRequestHeader("Content-type",r),n?a.send(n):a.send())}))},Ma=(l(wa,Nn),a(wa,[{key:"onCheckTimer",value:function(e){this._socketHandler&&(this.isLoggedIn()?(0<this._timerForNotLoggedIn&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(e){this.get(20).onErrorCodeNotZero(e)}},{key:"onMessage",value:function(e){this.get(20).onMessage(e)}},{key:"send",value:function(e){return this._socketHandler?this._previousState!==k.NET_STATE_CONNECTED&&e.head.servcmd.includes(jn.SSO_STAT)?(this.reConnect(),this.isPrivateNetWork()?Promise.resolve():this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(e){var t=N.HOST.CURRENT.STAT;return t="".concat(t,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(e.head.sdkappid,"&reqtime=").concat(Date.now()),e=JSON.stringify(e.body),Ia("POST",t,e)}},{key:"simplySend",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){Q&&!J&&this.warn("DomainNameInMP"),this._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(e){return this.get(20).getKeyMap(e)}},{key:"onRequestTimeout",value:function(){3e4<=Date.now()-this._lastDiagnoseTS&&this.diagnose()}},{key:"onSendFail",value:function(){this._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED)}},{key:"onReconnected",value:function(){Re.l("".concat(this._n,".onReconnected cost:").concat(Yt(this._disconnectedTS,!0,!0))),this._m.restartTimer(),this.get(20).onReconnected(Yt(this._disconnectedTS,!1,!1)),this._disconnectedTS=0,this._emitNetStateChangeEvent(k.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){Re.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1,n=(this._socketHandler&&(t=this._socketHandler.getReconnectFlag()),"forcedFlag:".concat(e," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(t));Re.l("".concat(this._n,".reConnect ").concat(n)),this._fatalErrorFlag||!this._socketHandler||!0!==e&&this._previousState===k.NET_STATE_CONNECTING&&t||(this._socketHandler.forcedReconnect(),this._emitNetStateChangeEvent(k.NET_STATE_CONNECTING))}},{key:"_emitNetStateChangeEvent",value:function(e){this._previousState!==e&&(Re.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(e)),e===k.NET_STATE_DISCONNECTED&&0===this._disconnectedTS&&(this._disconnectedTS=Date.now(),this.diagnose()),this._previousState=e,this.emitOEvt(T.NET_STATE_CHANGE,{state:e}))}},{key:"_ping",value:function(){var e,t=this;!0!==this._probing&&(this._probing=!0,e=this.get(20).getProtocolData({P:jn.PING}),this.send(e).then((function(){t._probing=!1})).catch((function(e){t._probing=!1;var n=t.get(15).isOnline();Re.w("".concat(t._n,"._ping failed. bOnline:").concat(n," error:"),e),e&&60002===e.code?(new ii("error").setMessage("code:".concat(e.code," message:").concat(e.message)).end(),t._fatalErrorFlag=!0,t._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED)):n?t.reConnect():t._emitNetStateChangeEvent(k.NET_STATE_DISCONNECTED)})))}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),-1<this._timerForNotLoggedIn&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"canIUseInflate",value:function(){return this._m.canIUseInflate()}},{key:"getSocketID",value:function(){if(this._socketHandler)return this._socketHandler.getSocketID()}},{key:"diagnose",value:function(){this.isPrivateNetWork()||(this._lastDiagnoseTS=Date.now(),this._diagnoseBySSO(),this._diagnoseByCDN())}},{key:"_diagnoseBySSO",value:function(){var e=this,t=this._socketHandler.getURL(),n=t.split("/")[2];n.startsWith("ws")&&(t=t.slice(t.indexOf("info?")+5),n="https://".concat(n,"/v3/netcheck/getconninfo?").concat(t,"&reqtime=").concat(Date.now()),Ia("GET",n).catch((function(t){Re.w("".concat(e._n,"._diagnoseBySSO failed. error:"),t)})))}},{key:"_diagnoseByCDN",value:function(){var e=this,t=(t=this._socketHandler.getURL()).slice(t.indexOf("info?")+5);t="https://boce-cdn.my-imcloud.com/v3/netcheck/getconninfo?".concat(t,"&reqtime=").concat(Date.now()),Ia("GET",t).catch((function(t){Re.w("".concat(e._n,"._diagnoseByCDN failed. error:"),t)}))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._previousState=k.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3),this._disconnectedTS=0,this._lastDiagnoseTS=0}}])),Ca=["a2","tinyid"],Ea=["a2","tinyid"],Ta=a((function e(t){i(this,e),this._n="PHandler",this._sessionM=t,this._map=new Map,this._fillMap()}),[{key:"_fillMap",value:function(){this._map.clear();var e=this._sessionM.genCommonHead(),t=this._sessionM.genCosSpecifiedHead(),n=this._sessionM.genSSOReportHead();this._map.set(jn.LOGIN,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0,customInfo:""},keyMap:{req:{deviceBrand:"InstType"},res:{InstId:"instanceID",HelloInterval:"helloInterval",RichMsgAuthKey:"authKey"}}}),this._map.set(jn.LOGOUT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.LOGOUT)}),body:{type:0,isWebUniapp:0},keyMap:{req:{type:"wslogout_type"}}}),this._map.set(jn.HELLO,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.HELLO)}),body:{isWebUniapp:0},keyMap:{res:{NewInstInfo:"newInstanceInfo"}}}),this._map.set(jn.KICK_OTHER,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.STAT_SERVICE,".").concat(jn.KICK_OTHER)}),body:{}}),this._map.set(jn.COS_SIGN,{head:f(f({},t),{},{servcmd:"".concat(N.NAME.IM_COS_SIGN,".").concat(jn.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{req:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},res:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}),this._map.set(jn.COS_PRE_SIG,{head:f(f({},t),{},{servcmd:"".concat(N.NAME.CUSTOM_UPLOAD,".").concat(jn.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{req:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},res:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}),this._map.set(jn.SIMPLE_COS_PRE_SIG,{head:f(f({},t),{},{servcmd:"".concat(N.NAME.CUSTOM_UPLOAD,".").concat(jn.SIMPLE_COS_PRE_SIG)}),body:{uploadMethod:0,platform:2,SDKAppID:0,userID:"",conversationType:1,uploadConfig:[{fileID:1,fileType:1,fileName:""}]},keyMap:{req:{platform:"uint32_platform",SDKAppID:"uint32_sdkappid",userID:"str_user_id",uploadMethod:"uint32_upload_method",conversationType:"uint32_scene",uploadConfig:"rpt_upload_object",fileID:"uint32_file_id",fileType:"uint32_file_type",fileName:"str_file_name"},res:{str_final_ip:"uploadIP",rpt_pre_sig:"preSig",uint32_file_id:"fileID",uint32_exist_flag:"existFlag",str_download_url:"downloadUrl",str_upload_url:"uploadUrl",str_snapshot_url:"requestSnapshotUrl",str_file_key:"fileKey"}}}),this._map.set(jn.GET_IMAGE_INFO,{head:f(f({},t),{},{servcmd:"".concat(N.NAME.CUSTOM_UPLOAD,".").concat(jn.GET_IMAGE_INFO)}),body:{imageUrl:""},keyMap:{req:{imageUrl:"str_image_url"},res:{rpt_msg_image_info:"imageInfoArray",uint32_image_type:"type",str_url:"url",uint32_width:"width",uint32_height:"height",str_image_format:"imageFormat"}}}),this._map.set(jn.GET_IP,{head:f(f({},t),{},{servcmd:"".concat(N.NAME.CUSTOM_UPLOAD,".").concat(jn.GET_IP)}),body:{domainName:""},keyMap:{req:{domainName:"str_domain"},res:{str_final_ip:"ip"}}}),this._map.set(jn.VIDEO_COVER,{head:f(f({},t),{},{servcmd:"".concat(N.NAME.CUSTOM_UPLOAD,".").concat(jn.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{req:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},res:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}),this._map.set(jn.FETCH_COMMERCIAL_CONFIG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_CONFIG_MANAGER,".").concat(jn.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{req:{SDKAppID:"uint32_sdkappid"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(jn.PUSHED_COMMERCIAL_CONFIG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_CONFIG_MANAGER,".").concat(jn.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(jn.FETCH_CLOUD_CTRL_CONFIG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_CONFIG_MANAGER,".").concat(jn.FETCH_CLOUD_CTRL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{req:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(jn.PUSHED_CLOUD_CTRL_CONFIG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_CONFIG_MANAGER,".").concat(jn.PUSHED_CLOUD_CTRL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(jn.OVERLOAD_NOTIFY,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OVERLOAD_PUSH,".").concat(jn.OVERLOAD_NOTIFY)}),body:{},keyMap:{res:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}),this._map.set(jn.SYNC_UNREAD_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.SYNC_UNREAD_MSG)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1,needCachedMsg:1},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},res:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}),this._map.set(jn.GET_PROFANITY_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_MSG_AUDIT_MGR,".").concat(jn.GET_PROFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{req:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},res:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}),this._map.set(jn.SEND_C2C_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.SEND_C2C_MSG)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:"",interruptionLevel:"active",contentAvailable:0},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:"",MeizuNotifyType:void 0}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance",MeizuNotifyType:"MeiZuNoticeMsgType"}}}),this._map.set(jn.SEND_GRP_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.SEND_GRP_MSG)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:"",interruptionLevel:"active",contentAvailable:0},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:"",MeizuNotifyType:void 0}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance",MeizuNotifyType:"MeiZuNoticeMsgType"},res:{MsgTime:"time",MsgSeq:"sequence"}}}),this._map.set(jn.REVOKE_C2C_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.REVOKE_C2C_MSG)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{req:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}),this._map.set(jn.REVOKE_GRP_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.REVOKE_GRP_MSG)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{req:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}),this._map.set(jn.GET_C2C_ROAMING_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.GET_C2C_ROAMING_MSG)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{req:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},res:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}),this._map.set(jn.MODIFY_C2C_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.MODIFY_C2C_MSG)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(jn.GET_GRP_ROAMING_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_ROAMING_MSG)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{req:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},res:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",NextReqMsgSeq:"nextSequence"}}}),this._map.set(jn.SET_C2C_MSG_READ,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.SET_C2C_MSG_READ)}),body:{C2CMsgReaded:void 0},keyMap:{req:{lastMessageTime:"LastedMsgTime"}}}),this._map.set(jn.SET_C2C_PEER_MUTE_NOTIFICATIONS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{req:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}),this._map.set(jn.GET_C2C_PEER_MUTE_NOTIFICATIONS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{toAccount:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Peer_Account"},res:{MuteNotificationsList:"muteFlagList"}}}),this._map.set(jn.SET_GRP_MSG_READ,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.SET_GRP_MSG_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{req:{messageReadSeq:"MsgReadedSeq"}}}),this._map.set(jn.SET_ALL_MSG_READ,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.SET_ALL_MSG_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{req:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},res:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}),this._map.set(jn.DEL_C2C_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.DEL_C2C_MSG)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{req:{keyList:"MsgKeyList"}}}),this._map.set(jn.DEL_GRP_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.DEL_GRP_MSG)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{req:{deleter:"Deleter_Account",keyList:"Seqs"}}}),this._map.set(jn.TRANSLATE_TEXT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_TRANSLATE,".").concat(jn.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{req:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},res:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(jn.VOICE_TO_TEXT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_SPEECH,".").concat(jn.VOICE_TO_TEXT)}),body:{url:"",SDKAppID:0,format:"",sourceType:0,language:""},keyMap:{req:{url:"BytesUrl",SDKAppID:"Uint32Sdkappid",format:"BytesVoiceFormat",sourceType:"Uint64SourceType",language:"BytesEngServiceType"},res:{BytesRequestid:"requestID",BytesResult:"result",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(jn.MODIFY_GRP_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.MODIFY_GRP_MSG)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(jn.GET_READ_RECEIPT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequence:"MsgSeq"}}}),this._map.set(jn.SEND_C2C_READ_RECEIPT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{req:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}),this._map.set(jn.SEND_READ_RECEIPT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}),this._map.set(jn.GET_READ_RECEIPT_DETAIL,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{req:{sequence:"MsgSeq",count:"Num"},res:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}),this._map.set(jn.GET_GRP_RECEIPTS_BY_USERS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_RECEIPTS_BY_USERS)}),body:{groupID:"",dataList:void 0},keyMap:{req:{dataList:"MemberReadMsgList",sequence:"MsgSeq",userIDList:"MemberList_Account"},res:{MsgReadList:"dataList",Read_Account:"userID",Read_Time:"readTime"}}}),this._map.set(jn.MODIFY_C2C_MSG_EXT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.MODIFY_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(jn.GET_C2C_MSG_EXT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}),this._map.set(jn.MODIFY_GRP_MSG_EXT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.MODIFY_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(jn.GET_GRP_MSG_EXT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}),this._map.set(jn.ADD_C2C_MSG_REACTION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.ADD_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(jn.RM_C2C_MSG_REACTION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.RM_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(jn.GET_C2C_MSG_REACTIONS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_C2C_MSG_REACTIONS)}),body:{from:void 0,to:void 0,messageKeyList:void 0,count:void 0}}),this._map.set(jn.GET_C2C_MSG_REACTION_USER_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_C2C_MSG_REACTION_USER_LIST)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,count:void 0}}),this._map.set(jn.ADD_GRP_MSG_REACTION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.ADD_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(jn.RM_GRP_MSG_REACTION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.RM_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(jn.GET_GRP_MSG_REACTIONS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_GRP_MSG_REACTIONS)}),body:{groupID:void 0,topicID:void 0,messageSequenceList:void 0,count:void 0},keyMap:{res:{MsgSeq:"messageSequence"}}}),this._map.set(jn.GET_GRP_MSG_REACTION_USER_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_GRP_MSG_REACTION_USER_LIST)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,nextSeq:void 0,count:void 0}}),this._map.set(jn.GET_C2C_PEER_READ_TIME,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.GET_C2C_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{req:{userIDList:"To_Account"},res:{ReadTime:"peerReadTimeList"}}}),this._map.set(jn.PAGING_GET_CONV_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.PAGING_GET_CONV_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:15,assistFlag:31},keyMap:{req:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},res:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID",C2cRemark:"friendRemark",MsgRecvOption:"messageRemindType",GroupIgnoredUnreadSeqCount:"noUnreadCount",GroupNextMsgSeq:"nextMessageSeq"}}}),this._map.set(jn.DEL_CONV,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.DEL_CONV)}),body:{fromAccount:"",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{req:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble",conversationList:"ContactItem"},res:{ResultItem:"resultList",ToGroupid:"groupID",ResultCode:"code",ResultInfo:"info"}}}),this._map.set(jn.CLEAR_HISTORY_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.CLEAR_HISTORY_MSG)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{req:{toGroupID:"ToGroupid"}}}),this._map.set(jn.PIN_CONV,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.PIN_CONV)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{req:{itemList:"RecentContactItem"}}}),this._map.set(jn.DEL_GROUP_AT_TIPS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.DEL_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(jn.SET_CONV_CUSTOM_DATA,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(jn.MARK_CONV,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(jn.CREATE_CONV_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.CREATE_CONV_GRP)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"GroupContactItem",groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(jn.DEL_CONV_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.DEL_CONV_GRP)}),body:{fromAccount:"",groupName:void 0},keyMap:{res:{GroupId:"convGroupID"}}}),this._map.set(jn.RENAME_CONV_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{req:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},res:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}),this._map.set(jn.ADD_CONV_TO_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}}}),this._map.set(jn.DEL_CONV_FROM_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0}}),this._map.set(jn.GET_CONV_GRP_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.GET_CONV_GRP_LIST)}),body:{fromAccount:"",startIndex:void 0},keyMap:{res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}),this._map.set(jn.SEARCH_CONV_GRP_MARK,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.RECENT_CONTACT,".").concat(jn.SEARCH_CONV_GRP_MARK)}),body:{fromAccount:"",contactItem:void 0},keyMap:{req:{groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList",ContactResultItem:"contactItem"}}}),this._map.set(jn.GET_USER_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.PROFILE,".").concat(jn.GET_USER_PROFILE)}),body:{fromAccount:"",userItem:[]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(jn.UPDATE_MY_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.PROFILE,".").concat(jn.UPDATE_MY_PROFILE)}),body:{fromAccount:"",profileItem:[{tag:Oe.NICK,value:""},{tag:Oe.GENDER,value:""},{tag:Oe.ALLOWTYPE,value:""},{tag:Oe.AVATAR,value:""}]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(jn.GET_BL,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.GET_BL)}),body:{fromAccount:"",startIndex:0,maxLimited:30}}),this._map.set(jn.ADD_TO_BL,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.ADD_TO_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(jn.RM_FROM_BL,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.RM_FROM_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(jn.SET_SELF_STATUS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.SET_SELF_STATUS)}),body:{customStatus:""}}),this._map.set(jn.GET_USER_STATUS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}),this._map.set(jn.SUB_USER_STATUS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.SUB_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(jn.UNSUB_USER_STATUS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.UNSUB_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(jn.GET_FD_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.GET_FD_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{res:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}),this._map.set(jn.ADD_FD,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.ADD_FD)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{req:{source:"AddSource",wording:"AddWording",type:"AddType"},res:{ResultItem:"resultList"}}}),this._map.set(jn.UPDATE_FD,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.UPDATE_FD)}),body:{fromAccount:"",updateItem:void 0},keyMap:{req:{snsItem:"SnsItem"},res:{ResultItem:"resultList"}}}),this._map.set(jn.DEL_FD,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.DEL_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"DeleteType"},res:{ResultItem:"resultList"}}}),this._map.set(jn.GET_FD_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.GET_FD_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{res:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}),this._map.set(jn.CHECK_FD,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.CHECK_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"CheckType"},res:{InfoItem:"resultList"}}}),this._map.set(jn.GET_FD_APPLICATION_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.GET_FD_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{res:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}),this._map.set(jn.RESPOND_FD_APPLICATION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.RESPOND_FD_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{req:{tag:"TagName",action:"ResponseAction"},res:{ResultItem:"resultList"}}}),this._map.set(jn.DEL_FD_APPLICATION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.DEL_FD_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{req:{type:"PendencyType",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(jn.REPORT_FD_APPLICATION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.REPORT_FD_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{req:{latestTimeStamp:"LatestPendencyTimeStamp"}}}),this._map.set(jn.CREATE_FD_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.CREATE_FD_GRP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{req:{groupName:"GroupName",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(jn.DEL_FD_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.DEL_FD_GRP)}),body:{fromAccount:"",nameList:void 0},keyMap:{req:{nameList:"GroupName"}}}),this._map.set(jn.GET_FD_GRP_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.GET_FD_GRP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{res:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}),this._map.set(jn.UPDATE_FD_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FD,".").concat(jn.UPDATE_FD_GRP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{req:{oldName:"GroupOldName",newName:"GroupNewName"},res:{UpdateType:"type",ResultItem:"resultList"}}}),this._map.set(jn.GET_GRP_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_LIST)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0,needAppDefineData:1},keyMap:{req:{memberAccount:"Member_Account"},res:{GroupIdList:"groups",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime",AppDefinedData:"groupCustomField"}}}),this._map.set(jn.GET_GRP_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_PROFILE)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:void 0,groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{req:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(jn.CREATE_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.CREATE_GRP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0,inviteOption:void 0},keyMap:{req:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",inviteOption:"InviteJoinOption"},res:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}),this._map.set(jn.DISMISS_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.DISMISS_GRP)}),body:{groupID:void 0}}),this._map.set(jn.UPDATE_GRP_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.UPDATE_GRP_PROFILE)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{req:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl",inviteOption:"InviteJoinOption"},res:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(jn.APPLY_JOIN_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{req:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},res:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}),this._map.set(jn.APPLY_JOIN_GRP_NOAUTH,(e.a2,e.tinyid,{head:f(f({},m(e,Ca)),{},{servcmd:"".concat(N.NAME.BIG_GRP_NO_AUTH,".").concat(jn.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{req:{applyMessage:"ApplyMsg"},res:{HugeGroupFlag:"avChatRoomFlag"}}})),this._map.set(jn.QUIT_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.QUIT_GRP)}),body:{groupID:void 0}}),this._map.set(jn.SEARCH_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.SEARCH_GRP)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption","InviteJoinOption"]}}}),this._map.set(jn.CHANGE_GRP_OWNER,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.CHANGE_GRP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{req:{newOwnerID:"NewOwner_Account"}}}),this._map.set(jn.HANDLE_GRP_APPLICATION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.HANDLE_GRP_APPLICATION)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(jn.HANDLE_INVITE_JOIN_GRP,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.HANDLE_INVITE_JOIN_GRP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",invitee:"Invited_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg"}}}),this._map.set(jn.HANDLE_GRP_INVITATION,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.HANDLE_GRP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(jn.GET_GRP_PENDENCY,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_PENDENCY)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{req:{handleAccount:"Handle_Account"},res:{To_Account:"userID",ApplyInviteMsg:"note"}}}),this._map.set(jn.DEL_GRP_SYSTEM_NOTICE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.DEL_GRP_SYSTEM_NOTICE)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(jn.AV_POLLING,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.BIG_GRP_POLLING,".").concat(jn.AV_POLLING)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}),this._map.set(jn.AV_NOAUTH_POLLING,(e.a2,e.tinyid,{head:f(f({},m(e,Ea)),{},{servcmd:"".concat(N.NAME.BIG_GRP_POLLING_NO_AUTH,".").concat(jn.AV_POLLING)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}})),this._map.set(jn.GET_ONLINE_MBR_NUM,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_ONLINE_MBR_NUM)}),body:{groupID:void 0},keyMap:{res:{OnlineMemberNum:"memberCount"}}}),this._map.set(jn.SET_GRP_ATTR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.SET_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(jn.MODIFY_GRP_ATTR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.MODIFY_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(jn.DEL_GRP_ATTR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.DEL_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key"}}}),this._map.set(jn.CLEAR_GRP_ATTR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.CLEAR_GRP_ATTR)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}),this._map.set(jn.GET_GRP_ATTR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_ATTR,".").concat(jn.GET_GRP_ATTR)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{req:{avChatRoomKey:"Key",groupType:"GroupType"}}}),this._map.set(jn.GET_GRP_NOTIFY,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_NOTIFY)}),body:{notifyReqList:[]},keyMap:{req:{notifyReqList:"NotifyReqList"},res:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList",NotifyRspList:"notifyRspList"}}}),this._map.set(jn.UPDATE_GRP_COUNTER,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.UPDATE_GRP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{req:{counterList:"GroupCounter"}}}),this._map.set(jn.GET_GRP_COUNTER,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{req:{keyList:"GroupCounterKeys"}}}),this._map.set(jn.CREATE_TOPIC,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_COMMUNITY,".").concat(jn.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{req:{avatar:"FaceUrl"}}}),this._map.set(jn.DEL_TOPIC,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_COMMUNITY,".").concat(jn.DEL_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{req:{topicIDList:"TopicIdList"},res:{DestroyResultItem:"resultList"}}}),this._map.set(jn.UPDATE_TOPIC_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_COMMUNITY,".").concat(jn.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{req:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}),this._map.set(jn.GET_TOPIC_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_COMMUNITY,".").concat(jn.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{req:{topicIDList:"TopicIdList"},res:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence"}}}),this._map.set(jn.GET_GRP_MBR_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_MBR_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}),this._map.set(jn.GET_AV_MBR_LIST,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_AV,".").concat(jn.GET_AV_MBR_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{req:{offset:"Timestamp",filter:"Mark"},res:{NextTimestamp:"offset"}}}),this._map.set(jn.GET_GRP_MBR_PROFILE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.GET_GRP_MBR_PROFILE)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}),this._map.set(jn.ADD_GRP_MBR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.ADD_GRP_MBR)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{req:{userID:"Member_Account",userIDList:"MemberList"},res:{MemberList:"members"}}}),this._map.set(jn.DEL_GRP_MBR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.DEL_GRP_MBR)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{req:{userIDList:"MemberToDel_Account"}}}),this._map.set(jn.BAN_AV_MBR,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.BAN_AV_MBR)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{req:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}),this._map.set(jn.MODIFY_GRP_MBR_INFO,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP,".").concat(jn.MODIFY_GRP_MBR_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{req:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}),this._map.set(jn.MARK_AV_MBR_INFO,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_AV,".").concat(jn.MARK_AV_MBR_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{req:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},res:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}),this._map.set(jn.CS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.MSG_SEARCH,".").concat(jn.CS)}),body:{keywordList:void 0,keywordListMatchType:"or",account:void 0,groupID:void 0,count:100,cursor:void 0,messageTypeList:void 0,senderUserIDList:void 0,startTime:void 0,endTime:void 0},keyMap:{req:{keywordListMatchType:"MatchType",account:"PeerAccount",groupID:"GroupID",messageTypeList:"MsgTypeList",senderUserIDList:"SendUserIDList",keywords:"Keywords",keywordMatchType:"KeywordMatchType",count:"Count",miniBirthday:"UserBirthStart",maxBirthday:"UserBirthEnd",gender:"UserGenderType",groupTypeList:"GroupType",groupIDList:"GroupIdList"},res:{GroupID:"groupID",UserID:"userID",ErrorCode:"code",ErrorInfo:"message",TotalCount:"totalCount",Count:"messageCount",LastMsgTime:"lastMessageTime",ConversationMsgs:"searchResult",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer",MsgSeq:"sequence",ReqMsgSeq:"sequence",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgContent:"content",ClientSeq:"clientSequence",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",Users:"userList",ProfileItems:"profileItems",StrValue:"value",IntValue:"value",Groups:"groupList",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupOwnerUserID:"ownerID",GroupOwnerUserName:"ownerNick",GroupOwnerTinyID:"ownerTinyID",GroupMemberNum:"memberNum",GroupName:"name",GroupType:"type",GroupMembers:"groupMemberList",GroupMemberUserID:"userID",GroupMemberTinyID:"userTinyID",GroupMemberUserName:"nick",GroupMemberNameCard:"nameCard"}}}),this._map.set(jn.USER_CS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.USER_SEARCH,".").concat(jn.CS)}),body:{keywords:void 0,keywordMatchType:0,miniBirthday:void 0,maxBirthday:void 0,gender:void 0,count:20,cursor:void 0}}),this._map.set(jn.GRP_CS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_SEARCH,".").concat(jn.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,count:20,cursor:void 0}}),this._map.set(jn.MBR_CS,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.GRP_MEMBER_SEARCH,".").concat(jn.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,groupIDList:void 0,count:20,cursor:void 0}}),this._map.set(jn.SSO_STAT,{head:f(f({},n),{},{servcmd:"".concat(N.NAME.IM_OPEN_STAT,".").concat(jn.SSO_STAT)}),body:{header:{},event:[],quality:[]},keyMap:{req:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}),this._map.set(jn.PING,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.HEARTBEAT,".").concat(jn.PING)}),body:{}}),this._map.set(jn.MSG_PUSH,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_PUSH,".").concat(jn.MSG_PUSH)}),body:{},keyMap:{res:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType"}}}),this._map.set(jn.MULTI_MSG_PUSH,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_PUSH,".").concat(jn.MULTI_MSG_PUSH)}),body:{},keyMap:{res:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}),this._map.set(jn.MSG_PUSH_ACK,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OPEN_IM,".").concat(jn.MSG_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{req:{sessionData:"SessionData"}}}),this._map.set(jn.STATUS_FORCE_OFFLINE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{res:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}),this._map.set(jn.DOWNLOAD_MERGER_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_LONG_MSG,".").concat(jn.DOWNLOAD_MERGER_MSG)}),body:{downloadKey:""},keyMap:{res:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}),this._map.set(jn.UPLOAD_MERGER_MSG,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_LONG_MSG,".").concat(jn.UPLOAD_MERGER_MSG)}),body:{messageList:[]},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}),this._map.set(jn.FOLLOW,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FOLLOW,".").concat(jn.FOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"FollowItem"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(jn.UNFOLLOW,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FOLLOW,".").concat(jn.UNFOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(jn.GET_FOLLOW_INFO,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FOLLOW,".").concat(jn.GET_FOLLOW_INFO)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{FollowInfo:"followInfoList",To_Account:"userID",FollowerCount:"followersCount",FollowingCount:"followingCount",MutualFollowingCount:"mutualFollowersCount"}}}),this._map.set(jn.GET_FOLLOW,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FOLLOW,".").concat(jn.GET_FOLLOW)}),body:{fromAccount:"",type:1,nextCursor:"",count:500},keyMap:{req:{type:"FollowType",nextCursor:"StartCursor",count:"WantNum"},res:{FollowItem:"resultList",To_Account:"userID",ProfileItem:"profileList"}}}),this._map.set(jn.CHECK_FOLLOW_TYPE,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.FOLLOW,".").concat(jn.CHECK_FOLLOW_TYPE)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(jn.SET_TOKEN,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0,notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:""},keyMap:{req:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns",notificationStatus:"NotificationStatus",deviceModel:"DeviceModel",systemVersion:"SystemVersion",pushVersion:"PushPluginVersion"}}}),this._map.set(jn.STAT_FOREGROUND,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.STAT_FOREGROUND)}),body:{isWebUniapp:0}}),this._map.set(jn.STAT_BACKGROUND,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_OPEN_STATUS,".").concat(jn.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{req:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}),this._map.set(jn.PUSH_REPORT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.OFFLINE_PUSH_REPORT,".").concat(jn.PUSH_REPORT)}),body:{eventList:[]},keyMap:{req:{eventList:"UinappPushEvents",type:"EventType",time:"EventTime",pushId:"ClickExt"}}}),this._map.set(jn.SET_ALL_RECEIVE_MSG_OPT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_MSG_LOGIC,".").concat(jn.SET_ALL_RECEIVE_MSG_OPT)}),body:{startTime:0,endTime:0,isRepeated:0,messageRemindType:0},keyMap:{req:{messageRemindType:"Level"}}}),this._map.set(jn.GET_ALL_RECEIVE_MSG_OPT,{head:f(f({},e),{},{servcmd:"".concat(N.NAME.IM_MSG_LOGIC,".").concat(jn.GET_ALL_RECEIVE_MSG_OPT)}),body:{toAccount:void 0}})}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"update",value:function(){this._fillMap()}},{key:"getKeyMap",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(Re.w("".concat(this._n,".getKeyMap unknown P:").concat(e)),{})}},{key:"getProtocolData",value:function(e){var t=e.P,n=e.data;if(e=this.get(t),t=null,n){var i,o=this._simpleDeepCopy(e),a=(o=this._updateService(n,o)).body,s=Object.create(null);for(i in a)if(Object.prototype.hasOwnProperty.call(a,i)){if(s[i]=a[i],void 0===n[i])continue;s[i]=n[i]}o.body=s,t=this._getUplinkData(o)}else t=this._getUplinkData(e);return t}},{key:"_getUplinkData",value:function(e){var t=Pt((e=this._dataCleaner(e)).head);return t=ua(e.body,this._getReqKeyMap(t)),e.body=t,e}},{key:"_updateService",value:function(e,t){var n,i,o=Pt(t.head);return this._isFromGroupRequest(t)&&(n=e.type,i=e.groupID,e=void 0===(e=e.groupIDList)?[]:e,dt(i=void 0===i?void 0:i)&&(i=e[0]||""),Et({type:n,groupID:i}))&&(t.head.servcmd="".concat(N.NAME.GRP_COMMUNITY,".").concat(o)),t}},{key:"_isFromGroupRequest",value:function(e){return e.head.servcmd.includes(N.NAME.GRP)||e.head.servcmd.includes(N.NAME.GRP_ATTR)}},{key:"_getReqKeyMap",value:function(e){return e=this.getKeyMap(e),f(f({},ea.req),e.req)}},{key:"_dataCleaner",value:function(e){var t,n=Array.isArray(e)?[]:Object.create(null);for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&Qe(t)&&null!==e[t]&&void 0!==e[t]&&("object"!==M(e[t])?n[t]=e[t]:n[t]=this._dataCleaner.bind(this)(e[t]));return n}},{key:"_simpleDeepCopy",value:function(e){for(var t,n=Object.keys(e),i={},o=0,a=n.length;o<a;o++)We(e[t=n[o]])?i[t]=Array.from(e[t]):Ye(e[t])?i[t]=this._simpleDeepCopy(e[t]):i[t]=e[t];return i}}]),ka=[jn.MSG_PUSH_ACK],Sa=a((function e(t){i(this,e),this._sessionM=t,this._n="MsgDispatcher",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._onC2CMsgArray.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._onGroupMsgArray.bind(this)),this._eventHandlerMap.set("groupTips",this._onGroupTips.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._onC2CNotifyMsgArray.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._onC2CReadReceiptArray.bind(this)),this._eventHandlerMap.set("profileModify",this._onProfileModified.bind(this)),this._eventHandlerMap.set("friendListMod",this._onRelationChainModified.bind(this)),this._eventHandlerMap.set("recentContactMod",this._onRecentContact.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._onAllMsgRead.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._onC2CMsgModified.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._onGroupMsgModified.bind(this)),this._eventHandlerMap.set("userStatusList",this._onUserStatusList.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._onMsgExtNotify.bind(this)),this._eventHandlerMap.set("messageReactionNotifyList",this._onMsgReactionNotifyList.bind(this)),this._eventHandlerMap.set("messageReactionNotify",this._onMsgReactionNotify.bind(this)),this._eventHandlerMap.set("followChangeList",this._onFollowNotify.bind(this)),this._keys=y(this._eventHandlerMap.keys())}),[{key:"_onC2CMsgArray",value:function(e){var t=this._sessionM.get(6);e.dataList.forEach((function(e){var t;1===e.isSyncMessage&&(t=e.from,e.from=e.to,e.to=t)})),1===e.needSync&&this._sessionM.get(19).syncOnNeed(),t.onNewMessage({dataList:e.dataList,isInstantMessage:!0})}},{key:"_onC2CMsgModified",value:function(e){this._sessionM.get(6).onMsgModified(e)}},{key:"_onGroupMsgArray",value:function(e){var t=this._sessionM.get(7);t&&t.onNewMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:"_onGroupMsgModified",value:function(e){var t=this._sessionM.get(7);t&&t.onMsgModified(e)}},{key:"_onGroupTips",value:function(e){var t=this._sessionM.get(7);if(t){var n=e.event,i=e.dataList,o=e.isInstantMessage,a=void 0===o||o,s=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:i});break;case 5:for(var r=0;r<i.length;r++)if(We(i[r].elements.revokedInfos))t.onMsgRevoked({dataList:i});else if(We(i[r].elements.groupMessageReadNotice))t.onMsgReadNotice({dataList:i});else{if(!We(i[r].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:i,isInstantMessage:a,isSyncingEnded:s});break}t.onReadReceiptList({dataList:i})}break;case 12:this._sessionM.get(11).onNewGroupAtTips({dataList:i});break;default:Re.l("".concat(this._n,"._onGroupTips unknown event:").concat(n," dataList:"),i)}}}},{key:"_onC2CNotifyMsgArray",value:function(e){var t,n=this,i=e.dataList;We(i)&&(t=this._sessionM.get(6),i.forEach((function(e){var o,a;$e(e)&&(e.hasOwnProperty("kickoutMsgNotify")?(o=(a=e.kickoutMsgNotify).kickType,a=void 0===(a=a.newInstanceInfo)?{}:a,1===o?n._sessionM.onMultipleAccountKickedOut(a):2===o?n._sessionM.onMultipleDeviceKickedOut(a):3===o&&n._sessionM.onRestApiKickedOut(a)):e.hasOwnProperty("c2cMessageRevokedNotify")?t&&t.onMsgRevoked({dataList:i},!0):e.hasOwnProperty("c2cMessageReadReceipt")?t&&t.onMsgReadReceipt({dataList:i}):e.hasOwnProperty("c2cMessageReadNotice")?t&&t.onMsgReadNotice({dataList:i}):e.hasOwnProperty("muteNotificationsSync")&&n._sessionM.get(11).onC2CMsgRemindTypeSynced({dataList:i}))})))}},{key:"_onC2CReadReceiptArray",value:function(e){this._sessionM.get(6).onReadReceiptList(e)}},{key:"_onProfileModified",value:function(e){this._sessionM.get(4).onProfileModified({dataList:e.dataList});var t=this._sessionM.get(8);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:"_onRelationChainModified",value:function(e){this._sessionM.get(4).onRelationChainModified({dataList:e.dataList});var t=this._sessionM.get(8);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:"_onRecentContact",value:function(e){var t;We(e=e.dataList)&&(t=this._sessionM.get(11))&&e.forEach((function(e){var n,i,o=e.pushType;1===o?(n=e.recentContactDeleteItem,t.onConvDeleted(n.recentContactList)):2===o?(n=e.recentContactTopItem,t.onConvPinnedStatus(n.recentContactList,!0)):3===o?(n=e.recentContactTopItem,t.onConvPinnedStatus(n.recentContactList,!1)):4===o?(n=e.recentContactMarkContact,t.onConvMarkUpdated(n.recentContactMarkContactItem)):5===o?(n=e.recentContactCreateContactGroup,t.onConvGroupCreated(n.msgContactGroupContactItem)):6===o?(n=e.recentContactDelContactGroup,t.onConvGroupDeleted(n.msgGroupItem)):7===o&&(o=(n=e.recentContactUpdateContactGroup).updateType,e=n.msgUpdateGroup,n=n.msgUpdateContact,1===o?1===(i=e.updateGroupType)?t.onConvGroupNameUpdated(e):2===i&&t.onConvInGroupUpdated(e):2===o&&t.onConvAddedToOrDeletedFromGroup(n))}))}},{key:"_onAllMsgRead",value:function(e){e=e.dataList;var t=this._sessionM.get(11);t&&t.onPushedAllMessageRead(e)}},{key:"_onUserStatusList",value:function(e){this._sessionM.get(4).onUserStatusUpdated(e)}},{key:"_onMsgExtNotify",value:function(e){this._sessionM.get(3).onMsgExtNotify(e)}},{key:"_onMsgReactionNotifyList",value:function(e){this._sessionM.get(34).onReactionNotifyList(e)}},{key:"_onMsgReactionNotify",value:function(e){this._sessionM.get(34).onReactionNotify(e)}},{key:"_onFollowNotify",value:function(e){this._sessionM.get(35).onFollowNotify(e)}},{key:"_onTopicLatestMsg",value:function(e){this._sessionM.get(10).onTopicLatestMsg(e)}},{key:"onMessage",value:function(e){var t=this,n=e.body;if(this._filterMsgFromIMOpenPush(e)){var i,o=n.eventArray,a=n.isInstantMessage,s=n.isSyncingEnded,r=n.needSync;if(We(o))for(var c,u,l,d=0,h=o.length;d<h;d++)100!==(l=(c=o[d]).event)?24!==l?26!==l?(i=Object.keys(c).find((function(e){return-1!==t._keys.indexOf(e)})))?(u=14===l?{readAllC2CMessage:c[i],groupMessageReadInfoList:c.groupMessageReadNotice||[]}:16===l?{userID:c.userID,timestamp:c.timestamp,readReceiptList:c[i]}:c[i],this._eventHandlerMap.get(i)({event:l,dataList:u,isInstantMessage:a,isSyncingEnded:s,needSync:r})):Re.l("".concat(this._n,".onMessage unknown eventItem:"),c):this._onTopicLatestMsg(c):this._onAllRcvMsgOptNotify(c):this._onRoomCustomData(c.content)}}},{key:"_onRoomCustomData",value:function(e){this._sessionM.get(30).onRoomCustomDataReceived(e),Re.l("".concat(this._n,"._onRoomCustomData data:").concat(e))}},{key:"_onAllRcvMsgOptNotify",value:function(e){this._sessionM.get(11).onAllRcvMsgOptNotify(e)}},{key:"_filterMsgFromIMOpenPush",value:function(e){var t=e.head,n=(e=e.body,t=t.servcmd,!1);return!(n=dt(t)?n:t.includes(N.NAME.IM_CONFIG_MANAGER)||t.includes(N.NAME.OVERLOAD_PUSH)||t.includes(N.NAME.STAT_SERVICE))||(t.includes(jn.PUSHED_CLOUD_CTRL_CONFIG)?this._sessionM.get(23).onPushedConfig(e):t.includes(jn.PUSHED_COMMERCIAL_CONFIG)?this._sessionM.get(27).onPushedConfig(e):t.includes(jn.OVERLOAD_NOTIFY)?this._sessionM.onPushedServerOverload(e):t.includes(jn.KICK_OTHER)&&(n=Date.now(),this._sessionM.reLoginOnKickOther(),e=new ii("kickOther"),n-=t=this._sessionM.get(1).getLastWsHelloTs(),e.setMessage("last wshello time:".concat(t," diff:").concat(n,"ms")).end()),!1)}}]),Da=[{cmd:jn.GET_GRP_PROFILE,interval:1,count:8},{cmd:jn.UPDATE_GRP_PROFILE,interval:1,count:8},{cmd:jn.GET_AV_MBR_LIST,interval:3,count:1},{cmd:jn.GET_GRP_PENDENCY,interval:1,count:15},{cmd:jn.GET_TOPIC_LIST,interval:1,count:10},{cmd:jn.SET_GRP_ATTR,interval:5,count:10},{cmd:jn.MODIFY_GRP_ATTR,interval:5,count:10},{cmd:jn.DEL_GRP_ATTR,interval:5,count:10},{cmd:jn.CLEAR_GRP_ATTR,interval:5,count:10},{cmd:jn.GET_GRP_ATTR,interval:5,count:20},{cmd:jn.UPDATE_GRP_COUNTER,interval:5,count:20},{cmd:jn.GET_GRP_COUNTER,interval:5,count:20},{cmd:jn.SET_ALL_MSG_READ,interval:1,count:1},{cmd:jn.GET_USER_STATUS,interval:5,count:20},{cmd:jn.SUB_USER_STATUS,interval:5,count:20},{cmd:jn.UNSUB_USER_STATUS,interval:5,count:20},{cmd:jn.CS,interval:5,count:20},{cmd:jn.GRP_CS,interval:5,count:20},{cmd:jn.MBR_CS,interval:5,count:20},{cmd:jn.USER_CS,interval:5,count:20},{cmd:jn.CHECK_FOLLOW_TYPE,interval:5,count:20},{cmd:jn.GET_GRP_ROAMING_MSG,interval:1,count:20},{cmd:jn.GET_C2C_ROAMING_MSG,interval:1,count:20}],ba=new Map,Aa=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],La=0,Ra=Aa.length;La<Ra;La++)ba.set(La,Aa[La]);function wa(e){return i(this,wa),(e=n(this,wa,[e]))._n="ChannelModule",e._socketHandler=new ya(e),e._probing=!1,e._isAppShowing=!0,e._previousState=k.NET_STATE_CONNECTED,e._timerForNotLoggedIn=-1,e._timerForNotLoggedIn=setInterval(e.onCheckTimer.bind(e),1e3),e._fatalErrorFlag=!1,e._disconnectedTS=0,e._lastDiagnoseTS=0,e}function Oa(e){for(var t,n,i=e,o="",a=0,s=(i=e.length%8!=0?"0".repeat(8-e.length%8)+e:i).length;a<s;a+=8)t=parseInt(i.slice(a,a+4),2),n=parseInt(i.slice(a+4,a+8),2),o+=ba.get(t)+ba.get(n);return o}function Na(e){var t;return e<0||53<e?NaN:(t=0|1073741824*Math.random(),30<e?t+1073741824*(0|Math.random()*(1<<e-30)):t>>>30-e)}function Pa(e,t){for(var n=e.toString(16),i=t-n.length,o="0";0<i;i>>>=1,o+=o)1&i&&(n=o+n);return n}l(Ds,Nn);var Ua=a(Ds,[{key:"_init",value:function(){this._updateCmdFreqLimitMap(Da)}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("cmd_frequency_limit");dt(e)||(e=JSON.parse(e),this._updateCmdFreqLimitMap(e))}},{key:"_updateCmdFreqLimitMap",value:function(e){var t=this;e.forEach((function(e){t._cmdFreqLimitMap.set(e.cmd,{interval:e.interval,count:e.count})}))}},{key:"updateProtocolConfig",value:function(){this._pHandler.update()}},{key:"req",value:function(e){Re.d("".concat(this._n,".req options:"),e);var t,n,i=e.P;return this._pHandler.has(i)?(t=(e=this.getProtocolData(e)).head.servcmd,this._isFreqOverLimit(t)?kn({code:n=Bn.OVER_FREQUENCY_LIMIT,message:this.getErrMsg(n,this._getCmd(t))}):this._isServerOverload(t)?kn({code:n=Bn.OPEN_SERVICE_OVERLOAD_ERROR,message:this.getErrMsg(n,this._getCmd(t))}):(n=this.get(21),ka.includes(i)?n.simplySend(e):n.send(e))):(Re.w("".concat(this._n,".req unknown P:").concat(i)),kn({code:Bn.NO_PROTOCOL}))}},{key:"getKeyMap",value:function(e){return this._pHandler.getKeyMap(e)}},{key:"genCommonHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:w,websdkversion:R,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:75689843,sdkability_ext:Oa(""),cappid:e.getApplicationID(),cs:0}}},{key:"genCosSpecifiedHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:w,websdkversion:R,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:75689843,sdkability_ext:Oa(""),cappid:e.getApplicationID(),cs:0}}},{key:"genSSOReportHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:w,websdkversion:R,sdkappid:e.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:e.getStatusInstanceID(),sdkability:75689843,sdkability_ext:Oa(""),cappid:e.getApplicationID(),cs:0}}},{key:"getProtocolData",value:function(e){return this._pHandler.getProtocolData(e)}},{key:"trans",value:function(e){var t=e.servcmd;return e=e.data,t={head:f(f({},this.genCommonHead()),{},{servcmd:t}),body:e},this.get(21).send(t)}},{key:"sendComboMessage",value:function(e){var t=e.servcmd;return e=e.data,t={head:f(f({},this.genCommonHead()),{},{servcmd:t}),body:e},this.get(21).send(t)}},{key:"onErrorCodeNotZero",value:function(e){var t,n=e.errorCode;n===Bn.HELLO_ANSWER_KICKED_OUT&&(t=e.kickType,e=void 0===(e=e.newInstanceInfo)?{}:e,1===t?this.onMultipleAccountKickedOut(e):2===t?this.onMultipleDeviceKickedOut(e):3===t&&this.onRestApiKickedOut(e)),n!==Bn.MSG_A2KEY_EXPIRED&&n!==Bn.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.get(21).reConnect())}},{key:"onMessage",value:function(e){var t=(n=e.body).needAck,n=n.sessionData;1===(void 0===t?0:t)&&this._sendACK(n),this._msgDispatcher.onMessage(e)}},{key:"onReconnected",value:function(e){this._incrementalPullContactFlag=e<=300,this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){Re.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){Re.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var e,t,n,i=this,o="".concat(this._n,"._reLogin");this.isLoggedIn()&&(e=0,(t=this.get(1).getPushModule())&&(e=t.getUniAppPlatform()),n=new ii("reLogin"),this.req({P:jn.LOGIN,data:{isWebUniapp:e,customInfo:this.get(12).getCustomLoginInfo()}}).then((function(e){var t=(e=e.data).instanceID,a=(e=e.customStatus,i.get(12)),s=Fi(e),r=(a.setStatusInstanceID(t),i.get(21)),c=r.getSocketID();c="socketID:".concat(c," instanceID:").concat(t," customStatus:").concat(s),n.setMessage(c).end(!0),Re.l("".concat(o," ok. ").concat(c)),a.getCustomStatus()!==s&&i.get(4).onUserStatusUpdated({dataList:[{to:i.getMyUserID(),statusType:k.USER_STATUS_ONLINE,customStatus:e}]}),r.diagnose(),i.get(11).syncConvList(i._incrementalPullContactFlag).then((function(){Re.l("".concat(o,", sync conv list ok.")),i.get(25).start()})),((t=i.get(7))&&t.updateLocalMainSequenceOnReconnected(),c=i.get(10)).resetGetTopicTime(),c.getTopicListOnReconnected(),(a=i.get(35))&&a.clearCacheOnReconnected(),(s=i.get(8))&&s.updateCacheOnReconnected()})))}},{key:"onMultipleAccountKickedOut",value:function(e){this.get(1).onMultipleAccountKickedOut(e)}},{key:"onMultipleDeviceKickedOut",value:function(e){this.get(1).onMultipleDeviceKickedOut(e)}},{key:"_onUserSigExpired",value:function(){this.get(1).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(e){this.get(1).onRestApiKickedOut(e)}},{key:"_sendACK",value:function(e){this.req({P:jn.MSG_PUSH_ACK,data:{sessionData:e}})}},{key:"_isFreqOverLimit",value:function(e){var t,n,i,o;return e=e.split(".")[1],!!this._cmdFreqLimitMap.has(e)&&(!this._cmdReqInfoMap.has(e)||(t=(n=this._cmdFreqLimitMap.get(e)).count,n=n.interval,i=(o=this._cmdReqInfoMap.get(e)).startTime,o=o.requestCount,Date.now()-i>1e3*n)?(this._cmdReqInfoMap.set(e,{startTime:Date.now(),requestCount:1}),!1):(this._cmdReqInfoMap.set(e,{startTime:i,requestCount:o+=1}),t<o))}},{key:"_isServerOverload",value:function(e){var t,n;return!!this._serverOverloadInfoMap.has(e)&&(t=(n=this._serverOverloadInfoMap.get(e)).overloadTime,n=n.waitingTime,Date.now()-t<=1e3*n||(this._serverOverloadInfoMap.delete(e),!1))}},{key:"_getCmd",value:function(e){var t="";if(e.includes(".")){var n,i=e.split(".")[1];for(n in jn)if(jn[n]===i){t=n;break}}return t}},{key:"onPushedServerOverload",value:function(e){var t=e.overloadCommand;e=e.waitingTime,this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:e}),Re.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(e,"s cmd:").concat(this._getCmd(t)))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._updateCmdFreqLimitMap(Da),this._cmdReqInfoMap.clear(),this._serverOverloadInfoMap.clear(),this._incrementalPullContactFlag=!0}}]),Ga=(l(Ss,Nn),a(Ss,[{key:"getCloudConfig",value:function(e){return dt(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:"getServerConfig",value:function(e){var t={code:0,data:""};return!dt(e)&&this._cloudConfig.has(e)&&(t.data=this._cloudConfig.get(e)),Promise.resolve(t)}},{key:"_canFetch",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var e,t=this,n="".concat(this._n,".fetchConfig"),i=this._canFetch();Re.l("".concat(n," canFetch:").concat(i)),i&&(e=new ii("fetchCloudCtrlConfig"),i=this.get(12).getSDKAppID(),this._isFetching=!0,this.req({P:jn.FETCH_CLOUD_CTRL_CONFIG,data:{SDKAppID:i,version:this._version}}).then((function(i){t._isFetching=!1;var o=(a=i.data).version,a=a.cloudControlConfig;e.setMessage("version:".concat(t._version," newVersion:").concat(o," config:").concat(a)).end(),Re.l("".concat(n," ok")),t._parse(i.data)})).catch((function(i){t._isFetching=!1,e.setError(i).end(),Re.l("".concat(n," failed. error:"),i),t._setExpiredTime(12e4)})))}},{key:"onPushedConfig",value:function(e){Re.l("".concat(this._n,".onPushedConfig config:"),e),new ii("pushedCloudCtrlConfig").setMessage("newVersion:".concat(e.version," config:").concat(e.cloudControlConfig)).end(),this._parse(e)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"_parse",value:function(e){var t=this,n="".concat(this._n,"._parse"),i=e.errorCode,o=e.errorMessage,a=e.cloudControlConfig,s=e.version,r=e.expiredTime;if(0===i){if(this._version!==s){var c=null;try{c=JSON.parse(a)}catch(u){this.isPrivateNetWork()||Re.e("".concat(n," failed. config:"),a)}c&&(this._cloudConfig.clear(),Object.keys(c).forEach((function(e){t._cloudConfig.set(e,c[e])})),this._version=s,this.emitIEvt(Oi.CLOUD_CONFIG),this.emitOEvt(T.SERVER_CONFIG_UPDATED,{config:c}))}this._setExpiredTime(1e3*r)}else dt(i)?(Re.l("".concat(n," failed. Invalid message format:"),e),this._setExpiredTime(36e5)):(Re.e("".concat(n," errorCode:").concat(i," errorMessage:").concat(o)),this._setExpiredTime(12e4))}},{key:"_setExpiredTime",value:function(e){this._expiredTime=Date.now()+e}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}])),xa=(l(ks,Nn),a(ks,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var e,t,n,i,o=this,a=this._getLocalConvList().filter((function(e){return e.type===k.CONV_GROUP&&e.groupProfile.type!==k.GRP_AVCHATROOM})),s=this.get(11),r=[];a.forEach((function(a){var c=a.conversationID;a=a.lastMessage,e=c.replace(k.CONV_GROUP,""),t=s.getLocalLastMessage(c),a&&0!==a.lastSequence&&t&&(n=a.lastSequence,t=t.sequence,i=n-t,0<t)&&1<=i&&i<300?o._recoverGroupMsg({groupID:e,localLastMessageSequence:t,remoteLastMessageSequence:n}):r.push(e)})),this._getGroupNotice(r)}},{key:"_recoverC2CChat",value:function(){var e,t,n,i=this,o=this._getLocalConvList().filter((function(e){return e.type===k.CONV_C2C})),a=this.get(11),s=[Promise.resolve()],r=[];o.forEach((function(o){var c=o.conversationID;o=o.lastMessage,e=a.getLocalLastMessage(c),o&&0!==o.lastTime&&e&&(t=o.lastTime,e=e.time,n=t-e,0<e)&&1<=n&&n<=600&&(s.push(i._recoverC2CMsg({conversationID:c,localLastMessageTime:e,remoteLastMessageTime:t})),r.push(c))})),Promise.all(s).then((function(){Re.l("".concat(i._n,"._recoverC2CChat all done, convIDList:"),r),i.get(19).syncOnReconnected()}))}},{key:"_getLocalConvList",value:function(){return this.get(11).getLocalConvList()}},{key:"_recoverGroupMsg",value:function(e){var t=this,n="".concat(this._n,".").concat("_recoverGroupMsg"),i=(Re.l("".concat(n," options:"),e),e.groupID),o=e.localLastMessageSequence,a=e.remoteLastMessageSequence,s=JSON.stringify(e),r=new ii("_recoverGroupMsg");r.setMessage(s),this._getGroupRoamingMsg({groupID:i,sequence:o}).then((function(e){var c=(e=e.data).complete,u=e.messageList;if(!dt(u)){e=u[0].sequence;var l=u.map((function(e){return e.sequence})),d=(l="".concat(s," complete:").concat(c," sequenceList:").concat(l),Re.l("".concat(n," ").concat(l)),e!==o&&e<a&&2!==c&&t._recoverGroupMsg({groupID:i,localLastMessageSequence:e,remoteLastMessageSequence:a}),r.setMessage(l).end(),t.get(7));1<u.length&&u.sort((function(e,t){return e.sequence-t.sequence}));for(var h=!1,p=0,g=u.length;p<g;p++)if(u[p].from===k.CONV_SYSTEM){h=!0;break}if(h)for(var f=0,m=u.length;f<m;f++){var _=u[f];_.from!==k.CONV_SYSTEM?d.onNewMessage({dataList:[_],isInstantMessage:!1,updateUnreadCount:!1}):d.onNewGroupTips({event:_.event,dataList:[_]})}else d.onNewMessage({dataList:u,isInstantMessage:!1,updateUnreadCount:!1})}})).catch((function(e){r.setError(e).end(),Re.w("".concat(n," failed. error:"),e)}))}},{key:"_getGroupNotice",value:function(e){var t=e.length;if(Re.l("".concat(this._n,"._getGroupNotice length:").concat(t)),0!==t){var n=this.get(7);if(t<=10)n.getNotice(e);else{var i=Math.floor(t/10);5<=i&&(i=5);for(var o=0;o<=i;o++)n.getNotice(e.slice(10*o,10*(o+1)))}}}},{key:"_getGroupRoamingMsg",value:function(e){var t=e.groupID;return e=e.sequence,this.req({P:jn.GET_GRP_ROAMING_MSG,data:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:e+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMsg",value:function(e){var t=this,n="".concat(this._n,".").concat("_recoverC2CMsg"),i=(Re.l("".concat(n," options:"),e),e.conversationID),o=e.localLastMessageTime,a=e.remoteLastMessageTime,s=JSON.stringify(e),r=new ii("_recoverC2CMsg");return r.setMessage(s),this._getC2CRoamingMsg({conversationID:i,time:o}).then((function(e){var o=(e=e.data).complete;if(e=e.messageList,!dt(e)){var c=e.length;if(t.get(6).onNewMessage({dataList:e,isInstantMessage:!0}),c=e[c-1].time,e=e.map((function(e){return e.random})),e="".concat(s," complete:").concat(o," randomList:").concat(e),Re.l("".concat(n," ").concat(e)),r.setMessage(e).end(),c<a&&1!==o)return t._recoverC2CMsg({conversationID:i,localLastMessageTime:c,remoteLastMessageTime:a})}})).catch((function(e){r.setError(e).end(),Re.w("".concat(n," failed. error:"),e)}))}},{key:"_getC2CRoamingMsg",value:function(e){var t=e.conversationID;return e=e.time,this.req({P:jn.GET_C2C_ROAMING_MSG,data:{peerAccount:t.replace(k.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:e,direction:1}})}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}])),Fa=a((function e(){i(this,e),this._n="AvgE2EDelay",this._e2eDelayArray=[]}),[{key:"addMessageDelay",value:function(e){0<=(e=Te()-e)&&this._e2eDelayArray.push(e)}},{key:"_calcAvg",value:function(e,t){var n;return 0===t?0:(n=0,e.forEach((function(e){n+=e})),Ut(n/t,1))}},{key:"_calcCountWithLimit",value:function(e){var t=e.e2eDelayArray,n=e.min,i=e.max;return t.filter((function(e){return n<=e&&e<i})).length}},{key:"_calcPercent",value:function(e,t){return 100<(e=Ut(e/t*100,2))?100:e}},{key:"_checkE2EDelayException",value:function(e,t){var n,i,o,a=e.filter((function(e){return t<e}));0<a.length&&(n=a.length,i=Math.min.apply(Math,y(a)),o=Math.max.apply(Math,y(a)),a=this._calcAvg(a,n),50<(e=Ut(n/e.length*100,2)))&&new ii("messageE2EDelayException").setMessage("count:".concat(n," min:").concat(i," max:").concat(o," avg:").concat(a," percent:").concat(e)).setLevel("warning").end()}},{key:"getStatResult",value:function(){var e,t,n,i,o,a,s=this._e2eDelayArray.length;return 0===s?null:(e=y(this._e2eDelayArray),t=this._calcCountWithLimit({e2eDelayArray:e,min:0,max:1}),n=this._calcCountWithLimit({e2eDelayArray:e,min:1,max:3}),i=this._calcPercent(t,s),o=this._calcPercent(n,s),a=this._calcAvg(e,s),this._checkE2EDelayException(e,3),e.length=0,this.reset(),{totalCount:s,countLessThan1Second:t,percentOfCountLessThan1Second:i,countLessThan3Second:n,percentOfCountLessThan3Second:o,avgDelay:a})}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),Ba=a((function e(){i(this,e),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}),[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(e){this._rttArray.push(e)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(e){return e.length}},{key:"_calcSuccessRateOfRequest",value:function(e,t){return 0===t?0:100<(e=Ut(e/t*100,2))?100:e}},{key:"_calcAvg",value:function(e,t){var n;return 0===t?0:(n=0,e.forEach((function(e){n+=e})),parseInt(n/t))}},{key:"_calcMax",value:function(){return Math.max.apply(Math,y(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,y(this._rttArray))}},{key:"getStatResult",value:function(){var e,t,n=this._calcTotalCount(),i=y(this._rttArray);return 0===n?null:(e=this._calcRTTCount(i),t=this._calcSuccessRateOfRequest(e,n),i=this._calcAvg(i,e),Re.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(i)),this.reset(),{totalCount:n,rttCount:e,successRateOfRequest:t,avgRTT:i})}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),Va=a((function e(){i(this,e),this._map=new Map}),[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}))}},{key:"addTotalCount",value:function(e){return!(dt(e)||!this._map.has(e)||(this._map.get(e).totalCount+=1,0))}},{key:"addSuccessCount",value:function(e){return!(dt(e)||!this._map.has(e)||(this._map.get(e).successCount+=1,0))}},{key:"addFailedCountOfUserSide",value:function(e){return!(dt(e)||!this._map.has(e)||(this._map.get(e).failedCountOfUserSide+=1,0))}},{key:"addCost",value:function(e,t){return!(dt(e)||!this._map.has(e)||(this._map.get(e).costArray.push(t),0))}},{key:"addFileSize",value:function(e,t){return!(dt(e)||!this._map.has(e)||(this._map.get(e).fileSizeArray.push(t),0))}},{key:"_calcSuccessRateOfBusiness",value:function(e){return dt(e)||!this._map.has(e)?-1:100<(e=Ut((e=this._map.get(e)).successCount/e.totalCount*100,2))?100:e}},{key:"_calcSuccessRateOfPlatform",value:function(e){var t;return dt(e)||!this._map.has(e)?-1:(t=this._map.get(e),100<(e=Ut(e=this._calcSuccessCountOfPlatform(e)/t.totalCount*100,2))?100:e)}},{key:"_calcTotalCount",value:function(e){return dt(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(e){return dt(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(e){return dt(e)||!this._map.has(e)?-1:(e=this._map.get(e)).successCount+e.failedCountOfUserSide}},{key:"_calcAvg",value:function(e){return dt(e)||!this._map.has(e)?-1:e===Wn?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:"_calcAvgCost",value:function(e){var t,n=this._map.get(e).costArray.length;return 0===n?0:(t=0,this._map.get(e).costArray.forEach((function(e){t+=e})),parseInt(t/n))}},{key:"_calcAvgSpeed",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach((function(e){t+=e})),this._map.get(e).fileSizeArray.forEach((function(e){n+=e})),parseInt(1e3*n/t)}},{key:"getStatResult",value:function(e){var t,n,i,o,a,s=this._calcTotalCount(e);return 0===s?null:(t=this._calcSuccessCountOfBusiness(e),n=this._calcSuccessRateOfBusiness(e),i=this._calcSuccessCountOfPlatform(e),o=this._calcSuccessRateOfPlatform(e),a=this._calcAvg(e),this.reset(e),{totalCount:s,successCountOfBusiness:t,successRateOfBusiness:n,successCountOfPlatform:i,successRateOfPlatform:o,avgValue:a})}},{key:"reset",value:function(e){dt(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),ja=a((function e(){i(this,e),this._lastMap=new Map,this._currentMap=new Map}),[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._lastMap.set(e,new Map),t._currentMap.set(e,new Map)}))}},{key:"addMessageSequence",value:function(e){var t,n,i,o=e.key,a=e.message;return!(dt(o)||!this._lastMap.has(o)||!this._currentMap.has(o)||(t=a.conversationID,a=a.sequence,t=t.replace(k.CONV_GROUP,""),0!==this._lastMap.get(o).size&&this._lastMap.get(o).has(t)&&(i=(n=this._lastMap.get(o).get(t)).length-1,a>n[0])&&a<n[i]?(n.push(a),n.sort(),this._lastMap.get(o).set(t,n)):this._addCurrentMap(e),0))}},{key:"_addCurrentMap",value:function(e){var t=e.key,n=(e=e.message).conversationID;e=e.sequence,n=n.replace(k.CONV_GROUP,""),this._currentMap.get(t).has(n)||this._currentMap.get(t).set(n,[]),this._currentMap.get(t).get(n).push(e)}},{key:"_copyData",value:function(e){if(!dt(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),i=s(this._currentMap.get(e));try{for(i.s();!(t=i.n()).done;){var o=v(t.value,2),a=o[0],r=o[1];n.set(a,r)}}catch(c){i.e(c)}finally{i.f()}n=null,this._currentMap.set(e,new Map)}}},{key:"getStatResult",value:function(e){var t,n,i;return dt(this._currentMap.get(e))||dt(this._lastMap.get(e))?null:0===this._lastMap.get(e).size?(this._copyData(e),null):(n=t=0,this._lastMap.get(e).forEach((function(e,i){var o=(e=y(e.values())).length;e=e[o-1]-e[0]+1,t+=e,n+=o})),0===t?null:(100<(i=Ut(n/t*100,2))&&(i=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:i}))}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),qa=(l(Ts,Nn),a(Ts,[{key:"_onLoginSuccess",value:function(){var e=this,t=(this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems),this.get(13)),n=t.getItem(this.TAG,!1);!je(n)&&Xe(n.forEach)&&(Re.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach((function(t){e._statInfoArr.push(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("q_rpt_interval"),t=this.getCloudConfig("q_rpt_sdkappid_bl"),n=this.getCloudConfig("q_rpt_tinyid_wl");dt(e)||(this.REPORT_INTERVAL=Number(e)),dt(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(",").map((function(e){return Number(e)}))),dt(n)||(this.REPORT_TINYID_WHITELIST=n.split(","))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(e){this._avgRTT.addRTT(e)}},{key:"addMessageDelay",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:"addTotalCount",value:function(e){this._rateMessageSent.addTotalCount(e)||Re.w("".concat(this._n,".addTotalCount invalid key:"),e)}},{key:"addSuccessCount",value:function(e){this._rateMessageSent.addSuccessCount(e)||Re.w("".concat(this._n,".addSuccessCount invalid key:"),e)}},{key:"addFailedCountOfUserSide",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||Re.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),e)}},{key:"addCost",value:function(e,t){this._rateMessageSent.addCost(e,t)||Re.w("".concat(this._n,".addCost invalid key or cost:"),e,t)}},{key:"addFileSize",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||Re.w("".concat(this._n,".addFileSize invalid key or size:"),e,t)}},{key:"addMessageSequence",value:function(e){this._rateMessageReceived.addMessageSequence(e)||Re.w("".concat(this._n,".addMessageSequence invalid key:"),e.key)}},{key:"_getQualityItem",value:function(e){var t={},n=ti[this.get(15).getNetworkType()];switch(dt(n)&&(n=8),n={qualityType:Qn[e],timestamp:De(),networkType:n,extension:""},e){case qn:t=this._avgRTT.getStatResult();break;case Hn:t=this._avgE2EDelay.getStatResult();break;case Kn:case zn:case Yn:case $n:case Wn:t=this._rateMessageSent.getStatResult(e);break;case Jn:case Xn:case Zn:t=this._rateMessageReceived.getStatResult(e)}return null===t?null:f(f({},n),t)}},{key:"_report",value:function(e){var t=this,n=[],i=null,o=(dt(e)?this._qualityItems.forEach((function(e){null!==(i=t._getQualityItem(e))&&(i.reportIndex=t.reportIndex,i.wholePeriod=t.wholePeriod,n.push(i))})):null!==(i=this._getQualityItem(e))&&(i.reportIndex=this.reportIndex,i.wholePeriod=this.wholePeriod,n.push(i)),Re.d("".concat(this._n,"._report"),n),0<this._statInfoArr.length&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]),e=this.get(12)).getSDKAppID();e=e.getTinyID(),0<(n=Gt(this.REPORT_SDKAPPID_BLACKLIST,o)&&!xt(this.REPORT_TINYID_WHITELIST,e)?[]:n).length&&this._doReport(n)}},{key:"_doReport",value:function(e){var t=this,n={header:Ao(this),quality:e};this.req({P:jn.SSO_STAT,data:f({},n)}).then((function(){t.reportIndex++,t.wholePeriod=!1})).catch((function(n){Re.w("".concat(t._n,"._doReport failed. error:"),n),t._statInfoArr=t._statInfoArr.concat(e),t._flushAtOnce()}))}},{key:"_flushAtOnce",value:function(){var e=this.get(13),t=e.getItem(this.TAG,!1),n=this._statInfoArr,i="".concat(this._n,"._flushAtOnce");je(t)?(Re.l("".concat(i," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)):(10<(n=n.concat(t)).length&&(n=n.slice(0,10)),Re.l("".concat(i," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)),this._statInfoArr=[]}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}])),Ha=a((function e(t){i(this,e),je(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.time=t.time||0,this.source=t.source||"",this.wording=t.wording||"",this.type=t.type||"")})),Ka=a((function e(t){i(this,e),this._snsM=t,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSeq=0,this._map=new Map,this._unreadCount=0}),[{key:"updateCacheOnReconnected",value:function(){this._startTime=0,this._currentSeq=0,this.getApplicationList()}},{key:"getLocalApplicationList",value:function(){return{friendApplicationList:y(this._map.values()),unreadCount:this._unreadCount}}},{key:"_onApplicationListUpdated",value:function(){this._snsM.emitOEvt(T.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:y(this._map.values()),unreadCount:this._unreadCount})}},{key:"onApplicationRead",value:function(){this._unreadCount=0,this._onApplicationListUpdated()}},{key:"onApplicationAdded",value:function(e,t){var n,i,o=this;je(e)||(n="",n=t===this._snsM.getMyUserID()?k.SNS_APPLICATION_SENT_BY_ME:k.SNS_APPLICATION_SENT_TO_ME,i=!1,e.forEach((function(e){var t="".concat(e.userID,"_").concat(n);n!==k.SNS_APPLICATION_SENT_TO_ME||o._map.has(t)||(o._unreadCount+=1),o._map.set(t,new Ha(f(f({},e),{},{type:n}))),i=!0})),i&&this._onApplicationListUpdated())}},{key:"onApplicationDeleted",value:function(e){je(e)||(this._startTime=0,this._currentSeq=0,this.getApplicationList())}},{key:"getApplicationList",value:function(){var e=this,t="".concat(this._n,".").concat("getApplicationList"),n=new ii("getApplicationList");return this._snsM.req({P:jn.GET_FD_APPLICATION_LIST,data:{applicationType:k.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsM.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSeq}}).then((function(i){var o=(i=i.data).resultList,a=i.unreadCount,s=i.startTime,r=(i=i.currentSequence,e._startTime=s,e._currentSeq=i,e._unreadCount=a,We(o)?o.length:0);r="applicationCount:".concat(r," unreadCount:").concat(a," startTime:").concat(s," currentSequence:").concat(i),n.setMessage(r).end(),Re.i("".concat(t," ok. ").concat(r)),e._map.clear(),We(o)&&o.forEach((function(t){var n=t.userID,i=t.type;t=new Ha(t),e._map.set("".concat(n,"_").concat(i),t)})),e._onApplicationListUpdated()})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"deleteApplication",value:function(e){var t,n="".concat(this._n,".").concat("deleteApplication"),i=e.userID,o=e.type;return o&&(o===k.SNS_APPLICATION_SENT_BY_ME||o===k.SNS_APPLICATION_SENT_TO_ME)||(o=k.SNS_APPLICATION_SENT_TO_ME),this._map.has("".concat(i,"_").concat(o))?((t=new ii("deleteApplication")).setMessage("userID:".concat(i," type:").concat(o)),this._snsM.req({P:jn.DEL_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),userIDList:[i],type:o}}).then((function(e){var a=(r=(e=e.data.resultList)[0]).to,s=r.resultCode,r=r.resultInfo;return t.setMoreMessage("resultList:".concat(JSON.stringify(e))).end(),Re.i("".concat(n," ok. userID:").concat(i," type:").concat(o)),0===s?En():kn({userID:a,code:s,message:r})})).catch((function(e){return t.setError(e).end(),Re.w("".concat(n," failed. error:"),e),kn(e)}))):kn({code:Bn.FRIEND_APPLICATION_NOT_EXIST})}},{key:"acceptApplication",value:function(e){var t="".concat(this._n,".").concat("acceptApplication"),n=e.userID,i=e.remark,o=e.tag,a=e.type,s=(a&&(a===k.SNS_APPLICATION_AGREE||a===k.SNS_APPLICATION_AGREE_AND_ADD)||(a=k.SNS_APPLICATION_AGREE_AND_ADD),new ii("acceptApplication"));return s.setMessage("userID:".concat(n," type:").concat(a)),this._snsM.req({P:jn.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:n,remark:i,tag:o,action:a}]}}).then((function(e){s.end();var i=(e=e.data.resultList[0]).resultCode;if(e=e.resultInfo,0!==i)return kn({code:i,message:e});Re.i("".concat(t," ok. userID:").concat(n," type:").concat(a))})).catch((function(e){return s.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"refuseApplication",value:function(e){var t="".concat(this._n,".").concat("refuseApplication"),n=e.userID,i=new ii("refuseApplication");return i.setMessage("userID:".concat(n)),this._snsM.req({P:jn.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:n,action:"Response_Action_Reject"}]}}).then((function(e){i.end();var o=(e=e.data.resultList[0]).resultCode;if(e=e.resultInfo,0!==o)return kn({code:o,message:e});Re.i("".concat(t," ok. userID:").concat(n))})).catch((function(e){return i.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"setApplicationRead",value:function(){var e=this,t="".concat(this._n,".").concat("setApplicationRead"),n=new ii("setApplicationRead");return this._snsM.req({P:jn.REPORT_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),latestTimeStamp:Ut(De()/1e3,0)}}).then((function(i){n.end(),Re.i("".concat(t," ok")),e._unreadCount=0})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"reset",value:function(){this._maxLimited=100,this._startTime=0,this._currentSeq=0,this._unreadCount=0,this._map.clear()}}]),za=a((function e(t,n){i(this,e),this.userID=t,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var o={},a=[];if(o.userID=t,!je(n))for(var s,r="",c=0,u=n.length;c<u;c++)if(r=n[c].tag,s=n[c].value,-1<r.indexOf("Tag_SNS_Custom"))this.friendCustomField.push({key:r,value:s});else if(-1<r.indexOf("Tag_Profile_Custom"))a.push({key:r,value:s});else switch(r){case Oe.NICK:o.nick=s;break;case Oe.GENDER:o.gender=s;break;case Oe.BIRTHDAY:o.birthday=s;break;case Oe.LOCATION:o.location=s;break;case Oe.SELFSIGNATURE:o.selfSignature=s;break;case Oe.ALLOWTYPE:o.allowType=s;break;case Oe.LANGUAGE:o.language=s;break;case Oe.AVATAR:o.avatar=s;break;case Oe.MESSAGESETTINGS:o.messageSettings=s;break;case Oe.ADMINFORBIDTYPE:o.adminForbidType=s;break;case Oe.LEVEL:o.level=s;break;case Oe.ROLE:o.role=s;break;case Ne.REMARK:this.remark=s;break;case Ne.ADDTIME:this.addTime=s;break;case Ne.GROUP:this.groupList=JSON.parse(JSON.stringify(s));break;case Ne.ADDSOURCE:this.source=s;break;case Ne.ADDWORDING:break;default:Re.l("snsProfileItem unknown tag->",n[c].tag)}this.profile=new ji(f(f({},o),{},{profileCustomField:a}))}),[{key:"validate",value:function(e){var t,n=!0,i="";if(je(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var o=e.profileCustomField.length,a=null,s=0;s<o;s++){if(a=e.profileCustomField[s],!lt(a.key)||-1===a.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!lt(a.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if("profileCustomField"===t)continue;if(je(e[t])&&!lt(e[t])&&!ze(e[t])){i="key:"+t+", invalid value:"+e[t],n=!1;continue}switch(t){case"nick":lt(e[t])||(n=!(i="nick must be a string")),500<it(e[t])&&(i="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(it(e[t])," bytes"),n=!1);break;case"gender":st(Pe,e.gender)||(i="key:gender, invalid value:"+e.gender,n=!1);break;case"birthday":ze(e.birthday)||(n=!(i="birthday must be a number"));break;case"location":lt(e.location)||(n=!(i="location must be a string"));break;case"selfSignature":lt(e.selfSignature)||(n=!(i="selfSignature must be a string"));break;case"allowType":st(Ge,e.allowType)||(i="key:allowType, invalid value:"+e.allowType,n=!1);break;case"language":ze(e.language)||(n=!(i="language must be a number"));break;case"avatar":lt(e.avatar)||(n=!(i="avatar must be a string"));break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n=!(i="messageSettings must be 0 or 1"));break;case"adminForbidType":st(Ue,e.adminForbidType)||(i="key:adminForbidType, invalid value:"+e.adminForbidType,n=!1);break;case"level":ze(e.level)||(n=!(i="level must be a number"));break;case"role":ze(e.role)||(n=!(i="role must be a number"));break;default:i="unknown key:"+t+"  "+e[t],n=!1}}return{valid:n,tips:i}}},{key:"update",value:function(e){var t=this,n="",i="",o=[];this.friendCustomField.forEach((function(e){o.push(e.key)}));for(var a=0,s=e.length;a<s;a++)!function(){if(n=e[a].tag,i=e[a].value,-1<n.indexOf("Tag_SNS_Custom"))-1<o.indexOf(n)?t.friendCustomField.forEach((function(e){e.key===n&&(e.value=i)})):t.friendCustomField.push({key:n,value:i});else if(-1<n.indexOf("Tag_Profile_Custom")){var s=!1;t.profile.profileCustomField.forEach((function(e){e.key===n&&(e.value=i,s=!0)})),s||t.profile.profileCustomField.push({key:n,value:i})}else switch(n){case Oe.NICK:t.profile.nick=i;break;case Oe.GENDER:t.profile.gender=i;break;case Oe.BIRTHDAY:t.profile.birthday=i;break;case Oe.LOCATION:t.profile.location=i;break;case Oe.SELFSIGNATURE:t.profile.selfSignature=i;break;case Oe.ALLOWTYPE:t.profile.allowType=i;break;case Oe.LANGUAGE:t.profile.language=i;break;case Oe.AVATAR:t.profile.avatar=i;break;case Oe.MESSAGESETTINGS:t.profile.messageSettings=i;break;case Oe.ADMINFORBIDTYPE:t.profile.adminForbidType=i;break;case Oe.LEVEL:t.profile.level=i;break;case Oe.ROLE:t.profile.role=i;break;case Ne.REMARK:t.remark=i;break;case Ne.ADDTIME:t.addTime=i;break;case Ne.GROUP:t.groupList=JSON.parse(JSON.stringify(i));break;case Ne.ADDSOURCE:t.source=i;break;case Ne.ADDWORDING:break;default:Re.d("snsProfileItem unkown tag->",e[a].tag)}}();this.timestamp=Date.now(),o.length=0}},{key:"updateProfile",value:function(e){this.profile=JSON.parse(JSON.stringify(e)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(e){-1===this.groupList.indexOf(e)&&(this.groupList.push(e),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(e){-1<(e=this.groupList.indexOf(e))&&(this.groupList.splice(e,1),this.count=this.groupList.length)}}]),Ya=a((function e(t){i(this,e),this._snsM=t,this._n="FriendHandler",this._map=new Map,this._startIdx=0,this._standardSeq=0,this._customSeq=0,this._expirationTime=18e4}),[{key:"updateCacheOnReconnected",value:function(){this._startIdx=0,this._standardSeq=0,this._customSeq=0,this.pagingGetFriendList()}},{key:"getLocalFriendList",value:function(){return y(this._map.values())}},{key:"getFriendRemark",value:function(e){return this._map.has(e)?this._map.get(e).remark:""}},{key:"onFriendProfileModified",value:function(e){var t,n=this;je(e=e.dataList)||(t=this._snsM.get(11),e.forEach((function(e){var i,o=e.userID;e=e.profileList,n.isMyFriend(o)&&(Re.l("".concat(n._n,".onFriendProfileModified. friend account:").concat(o,", profileList:").concat(JSON.stringify(e))),(i=n._map.get(o)).update(e),t.modifyMessageSentByPeer({conversationID:"".concat(k.CONV_C2C).concat(o),latestNick:i.profile.nick,latestAvatar:i.profile.avatar}))})),this._onFriendListUpdated())}},{key:"onFriendAdded",value:function(e){var t=this;0!==e.length&&(Re.l("".concat(this._n,".onFriendAdded userIDList:").concat(e)),e.forEach((function(e){t._map.set(e,new za(e))})),this.getFriendProfile({userIDList:e}).then((function(n){e.forEach((function(e){var n=t._map.get(e);0<n.groupList.length&&t._snsM.updateWhenFriendAdded({nameList:n.groupList,userID:e})})),t._onFriendListUpdated()})))}},{key:"onFriendDeleted",value:function(e){var t=this;0!==e.length&&(Re.l("".concat(this._n,".onFriendDeleted userIDList:").concat(e)),e.forEach((function(e){var n=t._map.get(e);0<n.groupList.length&&t._snsM.updateWhenFriendDeleted({nameList:n.groupList,userID:e}),t._map.delete(e)})),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsM.emitOEvt(T.FRIEND_LIST_UPDATED),this._snsM.get(11).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(e){var t,n=this,i="".concat(this._n,".").concat("getFriendProfile"),o=(e=e.userIDList,[]),a=[],s=[];return e.forEach((function(e){var t;n._map.has(e)?(t=n._map.get(e),Date.now()-t.timestamp<n._expirationTime?a.push(t):s.push(e)):o.push({userID:e,code:Bn.NOT_MY_FRIEND,message:n._snsM.getErrMsg(Bn.NOT_MY_FRIEND)})})),0===s.length?(Re.i("".concat(i," newUserIDList is empty")),Tn({friendList:a,failureUserIDList:o})):((t=new ii("getFriendProfile")).setMessage("userIDList:".concat(s)),Re.i("".concat(i," userIDList:").concat(s)),this._snsM.req({P:jn.GET_FD_PROFILE,data:{fromAccount:this._snsM.getMyUserID(),userIDList:s}}).then((function(e){return t.end(),Re.i("".concat(i," ok")),e.data.resultList.forEach((function(e){var t,i=e.to,s=e.resultCode,r=e.resultInfo;e=e.tagValueList,dt(s)||0===s?(n._map.has(i)?(t=n._map.get(i)).update(e):(t=new za(i,e),n._map.set(i,t)),a.push(t)):o.push({userID:i,code:s,message:r})})),En({friendList:a,failureUserIDList:o})})).catch((function(e){return t.setError(e).end(),Re.w("".concat(i," failed. error:"),e),kn(e)})))}},{key:"isMyFriend",value:function(e){return this._map.has(e)}},{key:"pagingGetFriendList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendList"),n=new ii("getFriendList"),i=Date.now();this._snsM.req({P:jn.GET_FD_LIST,data:{fromAccount:this._snsM.getMyUserID(),startIndex:this._startIdx,standardSequence:this._standardSeq,customSequence:this._customSeq}}).then((function(o){var a=(o=o.data).friendCount,s=o.resultList,r=o.nextStartIndex,c=o.standardSequence,u=o.customSequence;o=o.completeFlag,e._startIdx=r,e._standardSeq=c,e._customSeq=u,a="friendCount:".concat(a," nextStartIndex:").concat(r," standardSequence:").concat(c," ")+"customSequence:".concat(u," completeFlag:").concat(o," cost:").concat(Yt(i)),n.setMessage(a).end(),Re.i("".concat(t," ok."),a),je(s)||s.forEach((function(t){var n=t.to;t=t.tagValueList,e._map.set(n,new za(n,t))})),0===o?e.pagingGetFriendList():(e._snsM.emitOEvt(T.FRIEND_LIST_UPDATED),e._pagingGetFriendProfile())})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"_pagingGetFriendProfile",value:function(){var e=this,t=y(this._map.keys()),n=this._snsM.get(4),i=t.length,o=i<=100?1:Math.ceil(i/100);Re.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(i," pageCount:").concat(o));for(var a=0;a<o;a++)n.getUserProfile({userIDList:t.slice(100*a,100*(a+1))}).then((function(t){t.data.forEach((function(t){var n=e._map.get(t.userID);n&&n.updateProfile(t)})),e._onFriendListUpdated()}))}},{key:"addFriend",value:function(e){var t,n,i,o,a,s,r,c=this,u="".concat(this._n,".").concat("addFriend");return e.wording&&!1===this._snsM.filterProfanity("wording",e)?kn({code:Bn.PROFANITY_FOUND}):(t=e.to,n=e.source,i=e.type,o=e.wording,a=e.remark,e=e.groupName,(s=i)&&(s===k.SNS_ADD_TYPE_SINGLE||s===k.SNS_ADD_TYPE_BOTH)||(s=k.SNS_ADD_TYPE_BOTH),(r=new ii("addFriend")).setMessage("to:".concat(t," source:").concat(n," type:").concat(s)),this._snsM.req({P:jn.ADD_FD,data:{fromAccount:this._snsM.getMyUserID(),addFriendItem:[{to:t,source:n,wording:o,remark:a,groupName:e}],type:s}}).then((function(e){e=e.data.resultList;var t=(r.setMoreMessage("resultList:".concat(JSON.stringify(e))).end(),e=e[0]).to,n=e.resultCode;return e=e.resultInfo,Re.i("".concat(u," ok. to:").concat(t," type:").concat(s," code:").concat(n)),dt(n)||0===n?En({userID:t,code:0}):30539===n?En({userID:t,code:n,message:c._snsM.getErrMsg(n)}):kn({userID:t,code:n,message:c._snsM.getErrMsg(n)||e})})).catch((function(e){return r.setError(e).end(),Re.w("".concat(u," failed. error:"),e),kn(e)})))}},{key:"deleteFriend",value:function(e){var t,n=this,i="".concat(this._n,".").concat("deleteFriend"),o=e.userIDList,a=(e=e.type,1e3<o.length&&(Re.w("".concat(i," ").concat(Ht(1e3))),o.length=1e3),[]),s=[],r=[];return o.forEach((function(e){n._map.has(e)?r.push(e):a.push({userID:e,code:Bn.NOT_MY_FRIEND,message:n._snsM.getErrMsg(Bn.NOT_MY_FRIEND)})})),0===r.length?Tn({successUserIDList:s,failureUserIDList:a}):((o=e)&&(o===k.SNS_DELETE_TYPE_SINGLE||o===k.SNS_DELETE_TYPE_BOTH)||(o=k.SNS_DELETE_TYPE_BOTH),(t=new ii("deleteFriend")).setMessage("userIDList:".concat(r," type:").concat(o)),this._snsM.req({P:jn.DEL_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:r,type:o}}).then((function(e){return t.end(),Re.i("".concat(i," ok")),je(e=e.data.resultList)||e.forEach((function(e){var t=e.to,n=e.resultCode;e=e.resultInfo,dt(n)||0===n?s.push({userID:t}):a.push({userID:t,code:n,message:e})})),En({successUserIDList:s,failureUserIDList:a})})).catch((function(e){return t.setError(e).end(),Re.w("".concat(i," error:"),e),kn(e)})))}},{key:"updateFriend",value:function(e){var t,n,i,o=this,a=e.userID,s=e.remark,r=e.friendCustomField;return this._map.has(a)?(t="".concat(this._n,".").concat("updateFriend"),(n=new ii("updateFriend")).setMessage("userID:".concat(a," remark:").concat(s," friendCustomField:").concat(r)),i=[],dt(s)||i.push({tag:Ne.REMARK,value:s}),We(r)&&0<r.length&&r.forEach((function(e){i.push({tag:e.key,value:e.value})})),this._snsM.req({P:jn.UPDATE_FD,data:{fromAccount:this._snsM.getMyUserID(),updateItem:[{to:a,snsItem:i}]}}).then((function(e){n.end(),Re.i("".concat(t," ok"));var i=(e=e.data.resultList[0]).to,a=e.resultCode;return e=e.resultInfo,dt(a)||0===a?((i=o._map.get(i))&&(dt(s)||(i.remark=s),We(r)&&0<r.length&&vt(i.friendCustomField,r),o._onFriendListUpdated()),En(i)):kn({code:a,message:e})})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))):kn({code:Bn.NOT_MY_FRIEND})}},{key:"checkFriend",value:function(e){var t="".concat(this._n,".").concat("checkFriend"),n=e.userIDList,i=e.type,o=(i&&(i===k.SNS_CHECK_TYPE_SINGLE||i===k.SNS_CHECK_TYPE_BOTH)||(i=k.SNS_CHECK_TYPE_BOTH),new ii("checkFriend"));return o.setMessage("userIDList:".concat(n," type:").concat(i)),this._snsM.req({P:jn.CHECK_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:n,type:i}}).then((function(e){o.end(),Re.i("".concat(t," ok. userIDList:").concat(n," type:").concat(i));var a=[],s=[];return We(e=e.data.resultList)&&e.forEach((function(e){var t=e.to,n=e.relation,i=e.resultCode;e=e.resultInfo,dt(i)||0===i?a.push({userID:t,code:0,relation:n}):s.push({userID:t,code:i,message:e})})),En({successUserIDList:a,failureUserIDList:s})})).catch((function(e){return o.setError(e).end(),Re.w("".concat(t," failed. error:"),e),kn(e)}))}},{key:"onAddedToFriendGroup",value:function(e){var t=this,n=e.name;e=e.userIDList,Re.l("".concat(this._n,".onAddedToFriendGroup groupName:").concat(n," userIDList:").concat(e)),n&&!je(e)&&e.forEach((function(e){t._map.has(e)&&t._map.get(e).addToGroupList(n)}))}},{key:"onRemovedFromFriendGroup",value:function(e){var t=this,n=e.name;e=e.userIDList,Re.l("".concat(this._n,".onRemovedFromFriendGroup groupName:").concat(n," userIDList:").concat(e)),n&&!je(e)&&e.forEach((function(e){t._map.has(e)&&t._map.get(e).removeFromGroupList(n)}))}},{key:"reset",value:function(){this._map.clear(),this._startIdx=0,this._standardSeq=0,this._customSeq=0}}]),$a=a((function e(t){i(this,e),je(t)||(this.name=t.name||"",this.userIDList=t.userIDList||[],this.count=this.userIDList.length||0)}),[{key:"addToUserIDList",value:function(e){-1===this.userIDList.indexOf(e)&&(this.userIDList.push(e),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(e){-1<(e=this.userIDList.indexOf(e))&&(this.userIDList.splice(e,1),this.count=this.userIDList.length)}}]),Wa=a((function e(t){i(this,e),this._snsM=t,this._n="FriendGroupHandler",this._map=new Map}),[{key:"updateCacheOnReconnected",value:function(){this.getGroupList()}},{key:"getLocalGroupList",value:function(){return y(this._map.values())}},{key:"_onGroupListUpdated",value:function(){var e=y(this._map.values());this._snsM.emitOEvt(T.FRIEND_GROUP_LIST_UPDATED,e)}},{key:"getGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getGroupList"),n=new ii("getGroupList");return this._snsM.req({P:jn.GET_FD_GRP_LIST,data:{fromAccount:this._snsM.getMyUserID()}}).then((function(i){n.end(),je(i=i.data.resultList)?Re.i("".concat(t," ok. count:0")):(Re.i("".concat(t," ok. count:").concat(i.length)),e._map.clear(),i.forEach((function(t){var n=new $a(t);e._map.set(t.name,n)})),e._onGroupListUpdated())})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," error:"),e),kn(e)}))}},{key:"createGroup",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("createGroup"),a=e.name;return e=e.userIDList,this._map.has(a)?kn({code:Bn.FRIEND_GRP_EXISTED}):(t="name:".concat(a," userIDList:").concat(e),(n=new ii("createGroup")).setMessage(t),this._snsM.req({P:jn.CREATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),groupName:[a],userIDList:We(e)?e:void 0}}).then((function(e){n.end(),Re.l("".concat(o," ok. ").concat(t)),e=e.data.resultList;var s=[],r=[];return e&&e.forEach((function(e){var t=e.to,n=e.resultCode,i=e.resultInfo;dt(n)||0===n?s.push(t):(t={userID:e.to,code:n,message:i},r.push(t))})),e=new $a({name:a,userIDList:s}),i._map.set(a,e),i._snsM.onAddedToFriendGroup({name:a,userIDList:s}),i._onGroupListUpdated(),En({friendGroup:e,failureUserIDList:r})})).catch((function(e){return n.setError(e).end(),Re.w("".concat(o," failed. error:"),e),kn(e)})))}},{key:"deleteGroup",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("deleteGroup"),a=e.name;return this._map.has(a)?(t="name:".concat(a),(n=new ii("deleteGroup")).setMessage(t),this._snsM.req({P:jn.DEL_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),nameList:[a]}}).then((function(e){n.end(),Re.l("".concat(o," ok. ").concat(t));var s=i._map.get(a);return s&&(i._snsM.onRemovedFromFriendGroup({name:a,userIDList:s.userIDList}),i._map.delete(a),s.userIDList.length=0),i._onGroupListUpdated(),En(s)})).catch((function(e){return n.setError(e).end(),Re.w("".concat(o," failed. error:"),e),kn(e)}))):this._onGroupNotExist()}},{key:"renameGroup",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("renameGroup"),a=e.oldName,s=e.newName;return this._map.has(a)?(t="oldName:".concat(a," newName:").concat(s),(n=new ii("renameGroup")).setMessage(t),this._snsM.req({P:jn.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:a,newName:s}}).then((function(){var e;return n.end(),Re.l("".concat(o," ok. ").concat(t)),i._map.has(a)?((e=i._map.get(a)).name=s,i._map.delete(a),i._map.set(s,e),i._snsM.onRemovedFromFriendGroup({name:a,userIDList:e.userIDList}),i._snsM.onAddedToFriendGroup({name:s,userIDList:e.userIDList}),i._onGroupListUpdated(),En(e)):En()})).catch((function(e){return n.setError(e).end(),Re.w("".concat(o," failed. error:"),e),kn(e)}))):this._onGroupNotExist()}},{key:"addToGroup",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("addToGroup"),a=e.name;return e=e.userIDList,this._map.has(a)?(t="name:".concat(a," userIDList:").concat(e),(n=new ii("addToGroup")).setMessage(t),this._snsM.req({P:jn.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:a,updateGroupItem:e.filter((function(e){return i._snsM.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Add"}}))}}).then((function(e){return n.end(),Re.l("".concat(o," ok. ").concat(t)),i._onGroupUpdated(a,e)})).catch((function(e){return n.setError(e).end(),Re.w("".concat(o," failed. error:"),e),kn(e)}))):this._onGroupNotExist()}},{key:"removeFromGroup",value:function(e){var t,n,i=this,o="".concat(this._n,".").concat("removeFromGroup"),a=e.name;return e=e.userIDList,this._map.has(a)?(t="name:".concat(a," userIDList:").concat(e),(n=new ii("removeFromGroup")).setMessage(t),this._snsM.req({P:jn.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:a,updateGroupItem:e.filter((function(e){return i._snsM.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Delete"}}))}}).then((function(e){return n.end(),Re.l("".concat(o," ok. ").concat(t)),i._onGroupUpdated(a,e)})).catch((function(e){return n.setError(e).end(),Re.w("".concat(o," failed. error:"),e),kn(e)}))):this._onGroupNotExist()}},{key:"_onGroupUpdated",value:function(e,t){t=t.data.resultList;var n=this._map.get(e),i=[],o=[],a=[];return We(t)&&t.forEach((function(e){var t=e.to,s=e.resultCode,r=e.resultInfo,c=e.type;0===s?"Update_Type_Add"===c?n&&(n.addToUserIDList(t),o.push(t)):"Update_Type_Delete"===c&&n&&(n.removeFromUserIDList(t),a.push(t)):i.push({to:e.to,code:s,message:r})})),Re.l("".concat(this._n,"._onGroupUpdated name:").concat(e," userIDList:").concat(n.userIDList)),0<o.length&&this._snsM.onAddedToFriendGroup({name:e,userIDList:o}),0<a.length&&this._snsM.onRemovedFromFriendGroup({name:e,userIDList:a}),En({friendGroup:n,failureUserIDList:i})}},{key:"updateWhenFriendAdded",value:function(e){var t=this,n=e.nameList,i=e.userID;Re.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(i," nameList:").concat(n)),je(n)||n.forEach((function(e){t._map.has(e)&&t._map.get(e).addToUserIDList(i)}))}},{key:"updateWhenFriendDeleted",value:function(e){var t=this,n=e.nameList,i=e.userID;Re.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(i," nameList:").concat(n)),je(n)||n.forEach((function(e){t._map.has(e)&&t._map.get(e).removeFromUserIDList(i)}))}},{key:"_onGroupNotExist",value:function(e){return kn({code:Bn.FRIEND_GRP_NOT_EXIST})}},{key:"reset",value:function(){this._map.clear()}}]),Ja=(l(Es,Nn),a(Es,[{key:"onContextUpdated",value:function(e){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getGroupList(),this._friendApplicationHandler.getApplicationList()}},{key:"onRelationChainModified",value:function(e){var t,n,i,o,a,s,r=this;je(e=e.dataList)||(t=[],n=[],i=[],a=!(o=[]),s="",e.forEach((function(e){var c;3!==e.pushType&&4!==e.pushType||!e.from||(s=e.from),e.friendAddAccount&&(t.push.apply(t,y(e.friendAddAccount)),o.push.apply(o,y(e.friendAddAccount))),e.friendDelAccount&&n.push.apply(n,y(e.friendDelAccount)),e.friendApplicationAdded&&i.push.apply(i,y(e.friendApplicationAdded)),e.friendApplicationDeletedUserIDList&&o.push.apply(o,y(e.friendApplicationDeletedUserIDList)),e.reportTime&&7===e.pushType&&(a=!0),e.friendUpInfo&&(c={dataList:[]},e.friendUpInfo.forEach((function(e){c.dataList.push({userID:e.friendAccount,profileList:y(e.sns)})})),r.onFriendProfileModified(c))})),a&&this._friendApplicationHandler.onApplicationRead(),this._friendApplicationHandler.onApplicationAdded(i,s),this._friendApplicationHandler.onApplicationDeleted(o),this._friendHandler.onFriendAdded(t),this._friendHandler.onFriendDeleted(n))}},{key:"isMyFriend",value:function(e){return this._friendHandler.isMyFriend(e)}},{key:"filterProfanity",value:function(e,t){var n,i=this.get(29);return!i||(n=(i=i.filterText(t[e],"sns")).isAllowedToSend,i=i.modifiedText,!0===n&&(t[e]=i,!0))}},{key:"onFriendProfileModified",value:function(e){this._friendHandler.onFriendProfileModified(e)}},{key:"getLocalFriendList",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=this._friendHandler.getLocalFriendList();return e?Tn(t):t}},{key:"getFriendRemark",value:function(e){return this._friendHandler.getFriendRemark(e)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(e){return this._friendHandler.addFriend(e)}},{key:"deleteFriend",value:function(e){return this._friendHandler.deleteFriend(e)}},{key:"checkFriend",value:function(e){return this._friendHandler.checkFriend(e)}},{key:"getFriendProfile",value:function(e){return this._friendHandler.getFriendProfile(e)}},{key:"updateFriend",value:function(e){return this._friendHandler.updateFriend(e)}},{key:"onAddedToFriendGroup",value:function(e){this._friendHandler.onAddedToFriendGroup(e)}},{key:"onRemovedFromFriendGroup",value:function(e){this._friendHandler.onRemovedFromFriendGroup(e)}},{key:"getLocalFriendApplicationList",value:function(){return Tn(this._friendApplicationHandler.getLocalApplicationList())}},{key:"deleteFriendApplication",value:function(e){return this._friendApplicationHandler.deleteApplication(e)}},{key:"refuseFriendApplication",value:function(e){return this._friendApplicationHandler.refuseApplication(e)}},{key:"acceptFriendApplication",value:function(e){return this._friendApplicationHandler.acceptApplication(e)}},{key:"setFriendApplicationRead",value:function(e){return this._friendApplicationHandler.setApplicationRead(e)}},{key:"getLocalFriendGroupList",value:function(){return Tn(this._friendGroupHandler.getLocalGroupList())}},{key:"createFriendGroup",value:function(e){return this._friendGroupHandler.createGroup(e)}},{key:"deleteFriendGroup",value:function(e){return this._friendGroupHandler.deleteGroup(e)}},{key:"addToFriendGroup",value:function(e){return this._friendGroupHandler.addToGroup(e)}},{key:"removeFromFriendGroup",value:function(e){return this._friendGroupHandler.removeFromGroup(e)}},{key:"renameFriendGroup",value:function(e){return this._friendGroupHandler.renameGroup(e)}},{key:"updateWhenFriendAdded",value:function(e){this._friendGroupHandler.updateWhenFriendAdded(e)}},{key:"updateWhenFriendDeleted",value:function(e){this._friendGroupHandler.updateWhenFriendDeleted(e)}},{key:"updateCacheOnReconnected",value:function(){Re.l("".concat(this._n,".updateCacheOnReconnected")),this._friendHandler.updateCacheOnReconnected(),this._friendGroupHandler.updateCacheOnReconnected(),this._friendApplicationHandler.updateCacheOnReconnected()}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}])),Xa=(l(Cs,Nn),a(Cs,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&ge}},{key:"startWorkerTimer",value:function(){Re.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){Re.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){var e,t;ge&&(e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000);    postMessage(interval);  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"})),this._workerTimer=new Worker(e),(t=this)._workerTimer.onmessage=function(e){e.data?(t._timerID=e.data,Re.l("".concat(t._n,"._init seed:").concat(t._timerID))):t._m.onCheckTimer()})}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("enable_worker");Re.l("".concat(this._n,"._onCloudConfig enableWorker:").concat(e)),dt(e)||"1"===e?!this._isWorkerEnabled&&ge&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&ge&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){Re.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:"getTimerID",value:function(){return this._timerID}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}])),Za=a((function e(t){i(this,e),this._commercialConfigM=t,this._n="PurchasedFeatureHandler",this._isCSPluginReported=!1,this._featureMap=new Map}),[{key:"isValidPurchaseBits",value:function(e){return e&&"string"==typeof e&&1<=e.length&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:"parsePurchaseBits",value:function(e){if(this.isValidPurchaseBits(e)){this._featureMap.clear();for(var t,n=e.length-1,i=0;0<=n;n--,i++)t=(i<32?new b(0,Math.pow(2,i)):new b(Math.pow(2,i-32),0)).toString(),"1"===e[n]?this._featureMap.set(t,!0):this._featureMap.set(t,!1)}else Re.w("".concat(this._n,".parsePurchaseBits invalid purchasebits:").concat(e))}},{key:"hasPurchasedFeature",value:function(e){return!!this._featureMap.get(e)}},{key:"isFeatureEnabled",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,i=!0,o=t.length-1,a=0;0<=o;o--,a++)if("1"===t.charAt(o)&&(n=(a<32?new b(0,Math.pow(2,a)):new b(Math.pow(2,a-32),0)).toString(),!this._featureMap.get(n))){i=!1;break}return Re.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(e," key:").concat(n," ret:").concat(i)),Tn({enabled:i})}},{key:"isFeatureEnabledForStat",value:function(e){for(var t=parseInt(e).toString(2),n=t.length-1,i=0;0<=n;n--,i++)if("1"===t.charAt(n)){if(o=(i<32?new b(0,Math.pow(2,i)):new b(Math.pow(2,i-32),0)).toString(),!this._featureMap.get(o))break;var o,a="",s=0;o===P.PLUGIN_TRANSLATE?(a="plugin_translate",s=16):o===P.PLUGIN_VOICE_TO_TEXT?(a="plugin_voice_to_text",s=17):o===P.PLUGIN_CS?(a="plugin_cs",s=14):o===P.PLUGIN_PUSH?(a="plugin_push",s=13):o===P.PLUGIN_BOT?(a="plugin_bot",s=15):o===P.MSG_REACTION&&(a="plugin_emoji_reaction",s=18),""!==a&&(o=this._commercialConfigM.get(12).getUIPlatform(),new ii(a).setCode(s).setUIPlatform(o).end(),Re.l("".concat(this._n,".isFeatureEnabledForStat ").concat(a," code:").concat(s," uiPlatform:").concat(o)))}}},{key:"isCSPluginEnabled",value:function(){var e;this._isCSPluginReported||(e=this._commercialConfigM.get(12).getUIPlatform(),new ii("plugin_search").setCode(6).setUIPlatform(e).end(),this._isCSPluginReported=!0)}},{key:"clear",value:function(){this._featureMap.clear(),this._isCSPluginReported=!1}}]),Qa=a((function e(t){i(this,e),this._m=t,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new Za(this)}),[{key:"_canFetch",value:function(){return this.get(12).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var e,t,n=this,i=this._canFetch(),o="".concat(this._n,".fetchConfig");Re.l("".concat(o," canFetch:").concat(i)),i&&(e=new ii("fetchCommercialConfig"),i=this.get(12).getSDKAppID(),t=this.get(20),this._isFetching=!0,t.req({P:jn.FETCH_COMMERCIAL_CONFIG,data:{SDKAppID:i}}).then((function(t){e.setMessage("purchaseBits:".concat(t.data.purchaseBits)).end(),Re.l("".concat(o," ok.")),n._parseConfig(t.data),n._isFetching=!1})).catch((function(t){e.setError(t).end(),n._isFetching=!1})))}},{key:"onPushedConfig",value:function(e){var t="".concat(this._n,".onPushedConfig data:").concat(JSON.stringify(e));Re.l("".concat(t)),new ii("pushedCommercialConfig").setMessage("purchaseBits:".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:"_parseConfig",value:function(e){var t="".concat(this._n,"._parseConfig"),n=e.errorCode,i=e.errorMessage,o=e.purchaseBits,a=e.expiredTime;0===n?(this._purchasedFeatureHandler.parsePurchaseBits(o),this._expiredTime=Date.now()+1e3*a):dt(n)?(Re.l("".concat(t," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Re.e("".concat(t," errorCode:").concat(n," errorMessage:").concat(i)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"canIUse",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:"isFeatureEnabled",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:"isFeatureEnabledForStat",value:function(e){this._purchasedFeatureHandler.isFeatureEnabledForStat(e)}},{key:"isCSPluginEnabled",value:function(){this._purchasedFeatureHandler.isCSPluginEnabled()}},{key:"get",value:function(e){return this._m.get(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),es=(l(Ms,Nn),a(Ms,[{key:"registerPlugin",value:function(e){var t,n,i,o,a,s,r,c,u,l,d,h,p;J?(this._offlinePushPlugin=e["tim-offline-push-plugin"],t=(p=e.offlinePushConfig||{}).huaweiBusinessID,n=p.xiaomiBusinessID,i=p.xiaomiAppID,o=p.xiaomiAppKey,a=p.meizuBusinessID,s=p.meizuAppID,r=p.meizuAppKey,c=p.vivoBusinessID,u=p.oppoBusinessID,l=p.oppoAppKey,d=p.oppoAppSecret,h=p.honorBusinessID,p=p.iosBusinessID,this._androidPushConfig.huaweiPushBussinessId=t,this._androidPushConfig.xiaomiPushBussinessId=n,this._androidPushConfig.xiaomiPushAppId=i,this._androidPushConfig.xiaomiPushAppKey=o,this._androidPushConfig.meizuPushBussinessId=a,this._androidPushConfig.meizuPushAppId=s,this._androidPushConfig.meizuPushAppKey=r,this._androidPushConfig.vivoPushBussinessId=c,this._androidPushConfig.oppoPushBussinessId=u,this._androidPushConfig.oppoPushAppKey=l,this._androidPushConfig.oppoPushAppSecret=d,this._androidPushConfig.honorPushBussinessId=h,new ii("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!dt(this._offlinePushPlugin))).end(!0),Re.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=p,this._setAppShowListener()):this.warn("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var e,t=this,n="".concat(this._n,".").concat("_getDeviceToken");Xe(this._offlinePushPlugin.getDeviceToken)?(e="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID),Re.l("".concat(n," start. ").concat(e)),new ii("_getDeviceToken").setMessage("".concat(e)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,(function(i){var o,a,s,r,c=new ii("getDeviceTokenRes"),u=i.code,l=i.msg;0===u?(o=(r=i.data).deviceToken,a=r.deviceBrand,s=r.deviceType,r=r.bussinessId,t._deviceToken=o,t._businessID=r||t._iosBusinessID,e="deviceToken:".concat(o,", deviceBrand:").concat(a||s,", businessID:").concat(t._businessID),Re.l("".concat(n," ok. ").concat(e)),c.setMessage(e).end(!0),t._setToken()):(c.setMessage("code:".concat(u,", msg:").concat(l)).end(!0),Re.e("".concat(n," failed. error:"),i))}))):Re.e("".concat(n," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return J&&!dt(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");dt(this._offlinePushPlugin)?Re.e("".concat(t," offlinePushPlugin is undefined")):Xe(this._offlinePushPlugin.setAppShowListener)?(new ii("_setAppShowListener").end(!0),Re.l("".concat(t," start")),this._offlinePushPlugin.setAppShowListener((function(n){n=(n||{}).appShow,new ii("setAppShowListenerRes").setMessage("appShow:".concat(n)).end(!0),Re.l("".concat(t," ok. appShow:").concat(n)),e._m.isReady()&&(0===n?(e._getConvUnreadCount(),e._onBackground()):1===n&&e._onForeground())}))):Re.e("".concat(t," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){var e;if(!dt(this._offlinePushPlugin)&&Xe(this._offlinePushPlugin.getDeviceType))return e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType,Re.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}},{key:"_setToken",value:function(){var e="".concat(this._n,"._setToken"),t=this.get(12),n=1,i="",o="",a=(je(this._deviceToken)&&(n=0),this.getUniAppPlatform()),s=this.getDeviceBrand(),r=(a===L.IOS||a===L.IPAD||a===L.MAC?o=this._deviceToken:a===L.ANDROID&&(i=this._deviceToken),new ii("offlinePushSetToken"));return a="deviceToken:".concat(o||i,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(s,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(n,", platform:").concat(a),r.setMessage("".concat(a)),Re.l("".concat(e," ").concat(a)),this.req({P:jn.SET_TOKEN,data:{tokenID:i,pushMsg:n,sdkAppID:t.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:s,deviceToken:o,isWebUniapp:this._isWebUniapp}}).then((function(t){return r.end(),Re.l("".concat(e," ok")),t})).catch((function(t){return r.setError(t).end(),Re.e("".concat(e," failed. error:"),t),kn(t)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach((function(t){t.type===k.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===k.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new ii("_onBackground");this.req({P:jn.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(i){return n.setMessage("c2cUnreadCount: ".concat(e._c2cUnreadCount,", groupUnreadCount: ").concat(e._groupUnreadCount)).end(),Re.l("".concat(t," ok")),i})).catch((function(e){n.setError(e).end(),Re.e("".concat(t," failed. error:"),e)}))}},{key:"_onForeground",value:function(){var e="".concat(this._n,".").concat("_onForeground"),t=new ii("_onForeground");this.req({P:jn.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then((function(n){return t.end(),Re.l("".concat(e," ok")),n})).catch((function(n){t.setError(n).end(),Re.e("".concat(e," failed. error:"),n)}))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?L.IOS:"android"===e?L.ANDROID:1002===t?L.IPAD:1001===t?L.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Re.l("".concat(this._n,".reset"))}}])),ts=(l(Is,Nn),a(Is,[{key:"registerPlugin",value:function(e){var t,n,i;J?(t="".concat(this._n,".").concat("registerPlugin"),this._pushPlugin=e["tim-push"],this._getDeviceInfo(),n=(i=e.pushConfig||{}).androidConfig,i=i.iOSConfig,Ye(n)&&(this._androidPushConfig=n[this._deviceInfo.packageName]),n=(i||{}).iOSBusinessID,this._iOSBusinessID=n,i=!dt(this._pushPlugin),new ii("registerPlugin").setMessage(this._pluginName).setMoreMessage("isExisted:".concat(i)).end(!0),Re.l("".concat(t," ok. pushConfig:").concat(JSON.stringify(e.pushConfig))),i?(this._setAppShowListener(),this._setPushEventReportListener()):Re.e("".concat(t," ").concat(this._pluginName," is undefined"))):this.warn("TIMPushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._reportEventCacheList(),this._getDeviceToken(),this.get(27).isFeatureEnabledForStat(Math.pow(2,41))}},{key:"_reportEventCacheList",value:function(){var e=this,t="".concat(this._n,".").concat("_reportEventCacheList");Xe(this._pushPlugin.getPushEventCacheList)?(new ii("_reportEventCacheList").end(!0),this._pushPlugin.getPushEventCacheList((function(n){var i=n.code,o=n.data.eventList,a=new ii("getPushEventCacheListRes");if(a.setCode(i),0!==i)a.setMessage("res:".concat(JSON.stringify(n))).end(!0),Re.e("".concat(t," failed. error:").concat(JSON.stringify(n)));else{i=o.length<10?"eventList:".concat(JSON.stringify(o)):"eventList.length:".concat(o.length),Re.l("".concat(t," ok. ").concat(i)),a.setMessage(i).end(!0);for(var s=f(f({},n.data),{},{eventList:[]});0<o.length;)s.eventList=o.splice(0,40),e._pushReport(s)}}))):Re.e("".concat(this._pluginName,".getPushEventCacheList is not a function"))}},{key:"_getDeviceToken",value:function(){var e,t=this,n="".concat(this._n,".").concat("_getDeviceToken");Xe(this._pushPlugin.getDeviceToken)?(e="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig)," iOSBusinessID:").concat(this._iOSBusinessID),Re.l("".concat(n," start. ").concat(e)),new ii("_getDeviceToken").setMessage("".concat(e)).end(!0),this._pushPlugin.getDeviceToken(this._androidPushConfig,(function(i){var o,a,s,r=i.code,c=i.msg,u=new ii("getDeviceTokenRes");u.setCode(r),0===r?(o=(r=i.data).deviceToken,a=r.deviceBrand,s=r.deviceType,r=r.bussinessId,t._deviceToken=o,t._businessID=r||t._iOSBusinessID,e="deviceToken:".concat(o," deviceBrand:").concat(a||s," businessID:").concat(t._businessID),Re.l("".concat(n," ok. ").concat(e)),u.setMessage(e).end(!0),t._setToken()):(u.setMessage(c).end(!0),Re.e("".concat(n," failed. error:").concat(JSON.stringify(i))))}))):Re.e("".concat(this._pluginName,".getDeviceToken is not a function"))}},{key:"_getDeviceInfo",value:function(){var e,t,n,i,o="".concat(this._n,".").concat("_getDeviceInfo");Xe(this._pushPlugin.getDeviceInfo)?(i=(e=this._pushPlugin.getDeviceInfo()).code,t=e.data,(n=new ii("_getDeviceInfo")).setCode(i),0===i?(this._deviceInfo=f(f({},this._deviceInfo),t),this._deviceInfo.pushVersion||(this._deviceInfo.pushVersion="1.0.1"),i="deviceInfo:".concat(JSON.stringify(this._deviceInfo)),Re.l("".concat(o," ok. ").concat(i)),n.setMessage(i).end(!0)):(n.setMessage("deviceInfoRes:".concat(JSON.stringify(e))).end(!0),Re.e("".concat(o," failed. error:").concat(JSON.stringify(e))))):Re.e("".concat(this._pluginName,".getDeviceInfo is not a function"))}},{key:"canIUseTIMPush",value:function(){return J&&!dt(this._pushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");Xe(this._pushPlugin.setAppShowListener)?(new ii("_setAppShowListener").end(!0),Re.l("".concat(t," start")),this._pushPlugin.setAppShowListener((function(n){n=(n||{}).appShow,new ii("setAppShowListenerRes").setMessage("appShow:".concat(n)).end(!0),Re.l("".concat(t," ok. appShow:").concat(n)),e._m.isReady()&&(0===n?(e._getConvUnreadCount(),e._onBackground()):1===n&&e._onForeground())}))):Re.e("".concat(this._pluginName,".setAppShowListener is not a function"))}},{key:"_setPushEventReportListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setPushEventReportListener");Xe(this._pushPlugin.setPushEventReportListener)?(new ii("_setPushEventReportListener").end(!0),this._pushPlugin.setPushEventReportListener((function(n){var i=n.code,o=n.data,a=o.eventList,s=new ii("setPushEventReportListenerRes");s.setCode(i),0===i?(i="eventList:".concat(JSON.stringify(a)),Re.l("".concat(t," ok. ").concat(i)),s.setMessage(i).end(!0),e._m.isReady()&&We(a)&&0<a.length&&e._pushReport(o)):(s.setMessage("res:".concat(JSON.stringify(n))).end(!0),Re.e("".concat(t," failed. error:").concat(JSON.stringify(n))))}))):Re.e("".concat(this._pluginName,".setPushEventReportListener is not a function"))}},{key:"getDeviceBrand",value:function(){var e;if(!dt(this._pushPlugin)&&Xe(this._pushPlugin.getDeviceType))return e=(this._pushPlugin.getDeviceType()||{}).deviceType,Re.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}},{key:"_setToken",value:function(){var e="".concat(this._n,".").concat("_setToken"),t=this.get(12),n=1,i="",o="",a=(je(this._deviceToken)&&(n=0),this.getUniAppPlatform()),s=this.getDeviceBrand(),r=(a===L.IOS||a===L.IPAD||a===L.MAC?o=this._deviceToken:a===L.ANDROID&&(i=this._deviceToken),a=f({tokenID:i,pushMsg:n,sdkAppID:t.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:s,deviceToken:o,isWebUniapp:this._isWebUniapp},this._deviceInfo),new ii("_setToken"));i="data:".concat(JSON.stringify(a)),r.setMessage("".concat(i)),Re.l("".concat(e," ").concat(i)),this.req({P:jn.SET_TOKEN,data:a}).then((function(){r.end(),Re.w("".concat(e," ok"))})).catch((function(t){r.setError(t).end(),Re.e("".concat(e," failed. error:"),t),kn(t)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach((function(t){t.type===k.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===k.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new ii("_onBackground");this.req({P:jn.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(){n.setMessage("c2cUnreadCount:".concat(e._c2cUnreadCount," groupUnreadCount:").concat(e._groupUnreadCount)).end(),Re.l("".concat(t," ok"))})).catch((function(e){n.setError(e).end(),Re.e("".concat(t," failed. error:"),e)}))}},{key:"_onForeground",value:function(){var e="".concat(this._n,".").concat("_onForeground"),t=new ii("_onForeground");this.req({P:jn.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then((function(){t.end(),Re.l("".concat(e," ok"))})).catch((function(n){t.setError(n).end(),Re.e("".concat(e," failed. error:"),n)}))}},{key:"_pushReport",value:function(e){var t=this,n="".concat(this._n,".").concat("_pushReport"),i=new ii("_pushReport");this.req({P:jn.PUSH_REPORT,data:{eventList:e.eventList}}).then((function(){i.end(),t._notifyReportSuccess(e)})).catch((function(e){i.setError(e).end(),Re.e("".concat(n," failed. error:"),e)}))}},{key:"_notifyReportSuccess",value:function(e){!dt(this._pushPlugin)&&Xe(this._pushPlugin.notifyReportSuccess)&&(this._pushPlugin.notifyReportSuccess(e),Re.l("".concat(this._n,"._notifyReportSuccess ok")))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?L.IOS:"android"===e?L.ANDROID:1002===t?L.IPAD:1001===t?L.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Re.l("".concat(this._n,".reset"))}}])),ns=(l(ys,Nn),a(ys,[{key:"init",value:function(){var e=this.get(18).getPlugin("tim-profanity-filter-plugin");e&&(this._plugin=new e({logger:Re,isArray:We,isMap:qe,isDevMode:this.isDevMode()}),this._getLexicon())}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(e,t){var n=!0;if(this._plugin&&this._canIUseLexicon&&(!t||!t.messageControlInfo||!0!==t.messageControlInfo.excludedFromContentModeration)){t=e.type;var i=e.conversationType;if(t===k.MSG_TEXT||t===k.MSG_CUSTOM){var o,a="".concat(this._n,".filterMessage");if(Re.l("".concat(a)),t===k.MSG_TEXT){if(i===k.CONV_C2C?o="c2c_text_message":i===k.CONV_GROUP&&(o="group_text_message"),!this._isConfigOn(o))return n;var s=(r=this._plugin.filter(e.payload.text)).type,r=r.modifiedText;1===s?n=!1:2===s&&(e.payload.text=r)}else if(t===k.MSG_CUSTOM){if(i===k.CONV_C2C?o="c2c_custom_message":i===k.CONV_GROUP&&(o="group_custom_message"),!this._isConfigOn(o))return n;s=this._plugin.filter(e.payload.data),r=this._plugin.filter(e.payload.description),t=this._plugin.filter(e.payload.extension),1===s.type||1===r.type||1===t.type?n=!1:(2===s.type&&(e.payload.data=s.modifiedText),2===r.type&&(e.payload.description=r.modifiedText),2===t.type&&(e.payload.extension=t.modifiedText))}Re.l("".concat(a," done. isAllowedToSend:").concat(n))}}return n}},{key:"filterText",value:function(e,t){var n="".concat(this._n,".filterText"),i={isAllowedToSend:!0,modifiedText:e};return this._plugin&&this._canIUseLexicon&&this._isConfigOn(t)&&(Re.l("".concat(n)),e=(t=this._plugin.filter(e)).type,t=t.modifiedText,1===e?i.isAllowedToSend=!1:2===e&&(i.modifiedText=t),Re.l("".concat(n," done. ret:"),i)),i}},{key:"_getLexicon",value:function(){var e=this,t=new ii("profanityFilter"),n="".concat(this._n,"._getLexicon");this._isFetching=!0,this.req({P:jn.GET_PROFANITY_LIST,data:{startIndex:this._startIndex,version:this._version}}).then((function(i){var o=(i=i.data).errorInfo,a=i.filterConfig,s=i.lexicon,r=i.strToken,c=i.completeFlag,u=i.nextStartIndex,l=i.version,d=(i=i.expiredTime,o.errorCode),h=o.errorMessage;return 0!==d?(e._isFetching=!1,Re.w("".concat(n," failed. error:"),o),void t.setCode(d).setMessage(h).end()):(e._onFilterConfig(a),e._getToken(r),1===c?(Re.l("".concat(n," done. version:").concat(l," expiredTime:").concat(i)),e._version=l,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*i,void e._plugin.onLexiconCompleted(s)):(e._startIndex=u,e._plugin.onLexiconSliced(s),void e._getLexicon()))})).catch((function(i){t.setError(i).end(),e._isFetching=!1,Re.l("".concat(n," failed. error:"),i)}))}},{key:"_onFilterConfig",value:function(e){var t=this;je(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach((function(n){t._filterConfigMap.set(n,e[n])})),Re.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(e){return 1===this._filterConfigMap.get(e)}},{key:"_getToken",value:function(e){if(lt(e)){var t=e.length,n="";if(t%2==0)for(var i=0;i<=t-1;i+=2)n=(n+=e[i+1])+e[i];else{for(var o=0;o<t-1;o+=2)n=(n+=e[o+1])+e[o];n+=e[t-1]}this._plugin.onToken(n)}}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}])),is=a((function e(t){i(this,e),this._m=t,this._n="TransCmdModule",this._TRTCCommandList=["tui_room_svr.*","callkit_records_svr.*","room_engine_srv.*","room_engine_http_srv.*","room_engine_mic.*","live_engine_srv.*","live_engine_http_srv.*","live_engine_pk.*","trtc_ai_service.*","call_engine_srv.*"],this._TRTCCommandMap=new Map,this._setTRTCCommandMap(),this._m.getIEmitInst().on(Oi.CLOUD_CONFIG,this._onCloudConfig,this)}),[{key:"_onCloudConfig",value:function(){var e=this,t=this._m.get(23).getCloudConfig("rtc_cmd");dt(t)||((t=JSON.parse(t)).forEach((function(t){e._TRTCCommandList.includes(t)||e._TRTCCommandList.push(t)})),this._setTRTCCommandMap())}},{key:"_setTRTCCommandMap",value:function(){for(var e,t=0,n=this._TRTCCommandList.length;t<n;t++)e=this._TRTCCommandList[t].split(".")[0],this._TRTCCommandMap.set(e,1)}},{key:"onRoomCustomDataReceived",value:function(e){this._m.getOEmitInst().emit(T.ROOM_CUSTOM_DATA_RECEIVED,e)}},{key:"sendTRTCCustomData",value:function(e){var t=e.serviceCommand,n=(e=e.data,"".concat(N.NAME.TUIROOM_SVR,".*"));return dt(t)||(n=t),this._isValidServiceCommand(n)?this._trans({servcmd:n,data:e}):kn({code:Bn.INVALID_TRTC_CMD})}},{key:"_trans",value:function(e){Re.d("".concat(this._n,"._trans. options:").concat(JSON.stringify(e)));var t=e.servcmd;return e=e.data,this._m.get(20).trans({servcmd:t,data:lt(e)?JSON.parse(e):e})}},{key:"_isValidServiceCommand",value:function(e){return e.endsWith(".*")?this._TRTCCommandList.includes(e):(e=e.split(".")[0],this._TRTCCommandMap.has(e))}},{key:"isTRTCCommand",value:function(e){return e=e.split(".")[0],this._TRTCCommandMap.has(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),os=a((function e(t){i(this,e),this._m=t,this._n="ErrMsgModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this.CURRENT_DOMAIN=F,this._map=new Map,this._init()}),[{key:"_init",value:function(){var e,t=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(t){try{e=JSON.parse(t)}catch(n){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),Re.w("".concat(this._n,"._init error:"),n)}e&&(this._needToUpdate(e)?this._fetch():this._fillMap(e.message))}else this._fetch()}},{key:"_needToUpdate",value:function(e){var t=e.localSavedTime;return e=e.localSavedVersion,t=t&&(new Date).getTime()-t>=this.STORAGE_EXPIRES_TIME,e=!e||"3.5.5"!==e,Re.l("".concat(this._n,"._needToUpdate isTimeout:").concat(t," isDifferentVersion:").concat(e)),t||e}},{key:"_fetch",value:function(){this._m.get(12).isPrivateNetWork()||this._fetchWithRetry()}},{key:"_fetchWithRetry",value:function(){var e=this;this._fetchAdapter().catch((function(){e.CURRENT_DOMAIN!==V&&(e._generateCurrentDomain(),e._fetchWithRetry())}))}},{key:"_generateCurrentDomain",value:function(){this.CURRENT_DOMAIN===F?this.CURRENT_DOMAIN=B:this.CURRENT_DOMAIN===B&&(this.CURRENT_DOMAIN=V)}},{key:"_fetchAdapter",value:function(){var e="https://".concat(this.CURRENT_DOMAIN,"/im/download/error-message/v3/0.0.7/tim-error-message.txt"),t="application/x-www-form-urlencoded;charset=UTF-8",n="".concat(this._n,"._fetchAdapter ok in"),i=this;return new Promise((function(o,a){var s,r;Q?ie.request({url:e,method:"GET",timeout:3e3,header:{"content-type":t},dataType:"text",success:function(e){i._fillAndSave(e.data),Re.l("".concat(n," mini program.")),o()},fail:function(e){a(e)}}):(s=new XMLHttpRequest,r=setTimeout((function(){s.abort()}),3e3),s.onreadystatechange=function(){4===s.readyState&&(r&&clearTimeout(r),200===s.status||304===s.status?(Re.l("".concat(n," browser.")),i._fillAndSave(s.responseText),o()):a(s.status))},s.onerror=function(e){a(e)},s.open("GET",e,!0),s.setRequestHeader("Content-type",t),s.send())}))}},{key:"_fillAndSave",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:(new Date).getTime(),localSavedVersion:"3.5.5"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.get(13)}},{key:"_fillMap",value:function(e){this._map.clear();for(var t,n,i=e.split(";\n"),o=i.length,a=new RegExp(/'/g),s=0;s<o;s++)if(n=i[s].indexOf(":"),t=i[s].slice(0,n),n=i[s].slice(n+1,i[s].length),!t.startsWith("//")){if(dt(n))continue;this._map.set(t,n.replace(a,""))}}},{key:"get",value:function(e){var t=e.isIntl,n=e.key,i=e.replacement1;return e=e.replacement2,t="".concat(n,t?"_en":"_cn"),!this._map.has(t)&&this._map.has(n)&&(t=n),n="",this._map.has(t)&&(n=this._map.get(t),dt(i)||(n=n.replace("$replacement1",i)),dt(e)||(n=n.replace("$replacement2",e))),n}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),as=a((function e(t){i(this,e),this._n="RemoteSignalingHandler",this._sigM=t}),[{key:"onNewMessageList",value:function(e){var t=this;e.forEach((function(e){var n=t.getPayloadData(e);n&&t._handleActionType(n,e)}))}},{key:"onMessageModified",value:function(e){var t=this;e.forEach((function(e){var n=t.getPayloadData(e);n&&t._onInvitationModified(n,e)}))}},{key:"getPayloadData",value:function(e){var t="".concat(this._n,".getPayloadData");e=e.payload.data;try{return JSON.parse(e)}catch(n){return Re.e("".concat(t," JSON parse error. signalingData:").concat(e)),null}}},{key:"_handleActionType",value:function(e,t){switch(e.actionType){case S.ACTION_TYPE_INVITE:this._onNewInvitationReceived(e,t);break;case S.ACTION_TYPE_REJECT_INVITE:this._onInviteeRejected(e);break;case S.ACTION_TYPE_ACCEPT_INVITE:this._onInviteeAccepted(e);break;case S.ACTION_TYPE_CANCEL_INVITE:this._onInvitationCancelled(e);break;case S.ACTION_TYPE_INVITE_TIMEOUT:this._onInvitationTimeout(e)}}},{key:"_genBaseEmitData",value:function(e){return{inviteID:e.inviteID,inviter:e.inviter,groupID:e.groupID,data:e.data||""}}},{key:"_onNewInvitationReceived",value:function(e,t){var n="".concat(this._n,"._onNewInvitationReceived"),i=e.inviteID,o=e.inviteeList,a=e.groupID,s=e.inviter,r=this._sigM.getMyUserID(),c=o.includes(r),u=e.timeout,l=(Ce().getTime()-1e3*t.time)/1e3;0<u&&0<l&&l<u&&(u-=l),n="".concat(n," myselfIncluded:").concat(c," groupID:").concat(a," signalObj:").concat(JSON.stringify(e)),Re.l("".concat(n," timeout:").concat(u,"s delta:").concat(l,"s")),!(a&&c||!a)||(n=this._sigM.getInviteInfo(i))&&n===e||(n||this._sigM.setInviteInfo(i,f(f({},e),{},{message:t})),this._sigM.emitEvent(S.NEW_INVITATION_RECEIVED,f(f({},this._genBaseEmitData(e)),{},{inviteeList:o})),s!==r&&this._sigM.startTimer(f(f({},e),{},{timeout:u})))}},{key:"_onInviteeRejected",value:function(e){var t="".concat(this._n,"._onInviteeRejected"),n=e.inviteID,i=e.inviter,o=e.groupID,a=this._sigM.hasInviteInfo(n);Re.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(a," inviter:").concat(i," groupID:").concat(o)),a&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(S.INVITEE_REJECTED,f(f({},this._genBaseEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInviteeAccepted",value:function(e){var t="".concat(this._n,"._onInviteeAccepted"),n=e.inviteID,i=e.inviter,o=e.groupID,a=this._sigM.hasInviteInfo(n);Re.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(a," inviter:").concat(i," groupID:").concat(o)),a&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(S.INVITEE_ACCEPTED,f(f({},this._genBaseEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInvitationCancelled",value:function(e){var t="".concat(this._n,"._onInvitationCancelled"),n=e.inviteID,i=e.inviter,o=e.groupID,a=this._sigM.hasInviteInfo(n);Re.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(a," inviter:").concat(i," groupID:").concat(o)),a&&(this._sigM.deleteInviteInfo(n),this._sigM.emitEvent(S.INVITATION_CANCELLED,this._genBaseEmitData(e)))}},{key:"_onInvitationTimeout",value:function(e){var t="".concat(this._n,"._onInvitationTimeout"),n=e.inviteID,i=e.inviter,o=e.groupID,a=e.inviteeList,s=this._sigM.hasInviteInfo(n);Re.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(s," inviter:").concat(i," groupID:").concat(o,"  data:").concat(e.data)),s&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(S.INVITATION_TIMEOUT,f(f({},this._genBaseEmitData(e)),{},{inviteeList:a,isSelfTimeout:!1})))}},{key:"_onInvitationModified",value:function(e,t){var n="".concat(this._n,"._onInvitationModified"),i=e.inviteID,o=e.data,a=this._sigM.hasInviteInfo(i);Re.l("".concat(n," inviteID:").concat(i," hasInviteID:").concat(a," data:").concat(o)),a&&(this._sigM.setInviteInfo(i,f(f({},e),{},{message:t})),this._sigM.emitEvent(S.INVITATION_MODIFIED,{inviteID:i,data:o}))}}]),ss=a((function e(t){i(this,e),this._n="LocalSignalingHandler",this._sigM=t}),[{key:"generateInviteID",value:function(){var e,t=(t=Pa)((e=Na)(32),8)+"-"+t(e(16),4)+"-"+t(16384|e(12),4)+"-"+t(32768|e(14),4)+"-"+t(e(48),12);return Re.l("".concat(this._n,".generateInviteID inviteID:").concat(t)),t}},{key:"createInviteInfo",value:function(e){var t=this.generateInviteID(),n=(e=this.createInviteCustomData(f(f({},e),{},{inviteID:t}))).groupID,i=e.inviteeList;return n=n||i[0],{customData:e,message:this._sigM.createSignaling(e,n),inviteID:t}}},{key:"_genBaseCustomData",value:function(e){var t=e.data,n=e.inviteID;return{businessID:1,timeout:0,data:void 0===t?"":t,inviteID:void 0===n?"":n,groupID:void 0===(e=e.groupID)?"":e}}},{key:"createInviteCustomData",value:function(e){var t=e.userID,n=void 0===(n=e.timeout)?0:n,i=void 0===(i=e.groupID)?"":i,o=this._sigM.getMyUserID();return o=f(f({},this._genBaseCustomData(e)),{},{actionType:S.ACTION_TYPE_INVITE,inviter:o,inviteeList:i?e.inviteeList:[t],timeout:n}),Re.l("".concat(this._n,".createInviteCustomData customData:"),o),o}},{key:"createCancelCustomData",value:function(e){var t,n="".concat(this._n,".createCancelCustomData"),i=e.inviteID,o=this._sigM.getMyUserID(),a=(i=this._sigM.getInviteInfo(i)).inviteeList,s=i.groupID;return(i=i.inviter)===o?t=f(f({},this._genBaseCustomData(e)),{},{actionType:S.ACTION_TYPE_CANCEL_INVITE,groupID:s,inviter:o,inviteeList:a}):Re.e("".concat(n," unmatched inviter:").concat(i," and my userID:").concat(o)),Re.l("".concat(n," customData:"),t),t}},{key:"createAcceptCustomData",value:function(e){var t,n="".concat(this._n,".createAcceptCustomData"),i=e.inviteID,o=this._sigM.getMyUserID(),a=this._sigM.getInviteInfo(i),s=a.inviter,r=a.groupID;return a.inviteeList.includes(o)?t=f(f({},this._genBaseCustomData(e)),{},{actionType:S.ACTION_TYPE_ACCEPT_INVITE,groupID:r,inviter:s,inviteeList:[o]}):Re.e("".concat(n," userID:").concat(o," not in inviteeList. inviteID:").concat(i," groupID:").concat(r)),Re.l("".concat(n," customData:"),t),t}},{key:"createRejectCustomData",value:function(e){var t,n="".concat(this._n,".createRejectCustomData"),i=e.inviteID,o=this._sigM.getMyUserID(),a=this._sigM.getInviteInfo(i),s=a.inviter,r=a.groupID;return a.inviteeList.includes(o)?t=f(f({},this._genBaseCustomData(e)),{},{actionType:S.ACTION_TYPE_REJECT_INVITE,groupID:r,inviter:s,inviteeList:[o]}):Re.e("".concat(n," userID:").concat(o," not in inviteeList. inviteID:").concat(i," groupID:").concat(r)),Re.l("".concat(n," customData:"),t),t}},{key:"createTimeoutCustomData",value:function(e){var t="".concat(this._n,".createTimeoutCustomData"),n=e.inviteeList,i=e.inviter,o=void 0!==(o=e.isInviter)&&o,a=this._sigM.getMyUserID();return e=f(f({},this._genBaseCustomData(e)),{},{actionType:S.ACTION_TYPE_INVITE_TIMEOUT,inviter:i,inviteeList:o?n:[a]}),Re.l("".concat(t," customData:"),e),e}}]),rs=a((function e(t){i(this,e),this._n="HistorySignalingHandler",this._sigM=t,this.COUNT=20,this.EXPIRED_TIME=300,this._map=new Map,this._relatedToMeMap=new Map}),[{key:"setCloudConfig",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:20,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300;this.COUNT=e,this.EXPIRED_TIME=t,Re.l("".concat(this._n,".setCloudConfig count:").concat(e,", time:").concat(t))}},{key:"getHistorySignaling",value:function(){var e=this,t=this._sigM.get(11).getLocalConvList();je(t)||(this._getC2CSignalingList(),t=this._getValidGroupConvList(t),this._getGroupSignalingList(t).then((function(t){e._handleSignalingList(t)})))}},{key:"_getC2CSignalingList",value:function(){var e=this._sigM.get(6).getMessageListFromUnreadDB();e=this._sigM.filterMessageList(e),this._getRelatedToMeMap(e)}},{key:"_getGroupSignalingList",value:function(e){var t=this;return 0===(e=this._createPromiseList(e)).length?Promise.resolve(this._sortSignaling(this._relatedToMeMap)):this._concurrentGetMessageList(e).then((function(e){var n=new Map;return e.forEach((function(e){e=e.list,e=t._getRelatedToMeMap(e),n=new Map([].concat(y(n),y(e)))})),t._sortSignaling(n)}))}},{key:"_handleSignalingList",value:function(e){je(e)||this._sigM.onNewMessageList(e)}},{key:"_getValidGroupConvList",value:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var o=(s=e[n]).type,a=s.unreadCount,s=s.lastMessage;o=o===k.CONV_GROUP,s=this._isNotExpired(s),o&&a&&s&&t.push(e[n])}return t}},{key:"_isNotExpired",value:function(e){return!(!e||!e.lastTime)&&e.lastTime>Te()-this.EXPIRED_TIME}},{key:"_createPromiseList",value:function(e){for(var t=[],n=0;n<e.length;n++){var i=(o=e[n]).conversationID,o=(o=o.unreadCount)<this.COUNT?o:this.COUNT;this._map.set(i,{msgCount:o,list:[]}),o=this._sigM.get(11).getMessageList({conversationID:i}),t.push(o)}return t}},{key:"_concurrentGetMessageList",value:function(e){var t=this,n=[];return Promise.all(e).then((function(e){for(var i=0;i<e.length;i++){var o=(a=e[i]).code,a=a.data;0===o&&0!==a.messageList.length&&(t._handleMessageList(a.messageList),o=t._relayGetMessageList(a))&&n.push(o)}return 0<n.length?t._concurrentGetMessageList(n):t._map}))}},{key:"_relayGetMessageList",value:function(e){var t,n=e.messageList,i=e.nextReqMessageID;return e=e.isCompleted,0===n.length||(n=n[0].conversationID,0===(t=this._map.get(n).msgCount))||e?null:this._sigM.get(11).getMessageList({conversationID:n,nextReqMessageID:i,count:t})}},{key:"_handleMessageList",value:function(e){var t=e.length,n=e[0].conversationID,i=(o=this._map.get(n)).msgCount,o=o.list;this._map.set(n,{msgCount:0<i-t?i-t:0,list:o.concat(this._sigM.filterMessageList(e))})}},{key:"_getRelatedToMeMap",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this._saveRelatedToMe(n)}return this._relatedToMeMap}},{key:"_saveRelatedToMe",value:function(e){var t,n=(t=this._sigM.getPayloadData(e)||{}).actionType,i=void 0===(t=t.inviteID)?"":t;switch(void 0===n?"":n){case S.ACTION_TYPE_INVITE:this._setHistoryInvite(e);break;case S.ACTION_TYPE_REJECT_INVITE:case S.ACTION_TYPE_ACCEPT_INVITE:this._updateHistoryInvite(e);break;case S.ACTION_TYPE_CANCEL_INVITE:this._delHistoryInvite(i);break;case S.ACTION_TYPE_INVITE_TIMEOUT:this._updateHistoryInvite(e)}}},{key:"_setHistoryInvite",value:function(e){var t=this._sigM.getPayloadData(e)||{},n=void 0===(n=t.inviteID)?"":n,i=void 0===(i=t.inviteeList)?[]:i,o=void 0===(o=t.timeout)?0:o,a=this._sigM.getMyUserID();i.includes(a)&&(i=Te()-e.time,0<o&&o<i&&0!==o||this._relatedToMeMap.set(n,f(f({},t),{},{messageList:[e]})))}},{key:"_delHistoryInvite",value:function(e){this._relatedToMeMap.has(e)&&this._relatedToMeMap.delete(e)}},{key:"_updateHistoryInvite",value:function(e){var t=void 0===(t=(o=this._sigM.getPayloadData(e)||{}).inviteID)?"":t,n=void 0===(o=o.inviteeList)?[]:o;if(this._relatedToMeMap.has(t)){for(var i=(o=this._relatedToMeMap.get(t)).inviteeList,o=o.messageList,a=0;a<n.length;a++){var s=n[a];i.includes(s)&&i.splice(i.indexOf(s),1)}0===i.length?this._delHistoryInvite(t):o.push(e)}else this._delHistoryInvite(t)}},{key:"_sortSignaling",value:function(e){var t=[];return e.forEach((function(e){t=[].concat(y(t),y(e.messageList))})),t.sort((function(e,t){return e.time-t.time}))}},{key:"reset",value:function(){this._map.clear(),this._relatedToMeMap.clear()}}]),cs=a((function e(t,n){i(this,e),this.businessID=t.businessID||1,this.inviteID=t.inviteID,this.groupID=t.groupID||"",this.inviter=t.inviter||"",this.inviteeList=t.inviteeList||[],this.data=t.data||"",this.actionType=t.actionType||S.ACTION_TYPE_INVITE,this.timeout=t.timeout||0})),us=["message"],ls=["message"],ds=(l(vs,Nn),a(vs,[{key:"onC2CUnreadHandleCompleted",value:function(){this._isC2CUnreadHandleCompleted=!0,this._isCloudConfigCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onConvSyncCompleted",value:function(){this._isConvSyncCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isCloudConfigCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onCloudConfig",value:function(){this._isCloudConfigCompleted=!0;var e=this.getCloudConfig("history_s_count"),t=this.getCloudConfig("history_s_time");dt(e)||(e=Number(e)),dt(t)||(t=Number(t)),this._historySignalingHandler.setCloudConfig(e,t),this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"_isListenerExisted",value:function(){return-1<this._m.getOEmitInst().eventNames().indexOf(S.NEW_INVITATION_RECEIVED)}},{key:"onReady",value:function(){this._isSyncCompleted=!0;var e=this._isListenerExisted();Re.l("".concat(this._n,".onReady. isListenerExisted: ").concat(e)),e&&this._historySignalingHandler.getHistorySignaling()}},{key:"onNewMessageList",value:function(e){if(0<(e=this.filterMessageList(e)).length)return this._remoteSignalingHandler.onNewMessageList(e)}},{key:"onMessageModified",value:function(e){if(0<(e=this.filterMessageList(e)).length)return this._remoteSignalingHandler.onMessageModified(e)}},{key:"hasInviteInfo",value:function(e){return this._inviteInfoMap.has(e)}},{key:"getInviteInfo",value:function(e){return this._inviteInfoMap.get(e)}},{key:"setInviteInfo",value:function(e,t){var n=t.message;t=m(t,us),Re.l("".concat(this._n,".setInviteInfo inviteID:").concat(e," data:"),t),this._inviteInfoMap.set(e,f(f({},t),{},{message:n}))}},{key:"deleteInviteInfo",value:function(e){this.hasInviteInfo(e)&&(Re.l("".concat(this._n,".deleteInviteInfo inviteID:").concat(e,".")),this._inviteInfoMap.delete(e))}},{key:"updateInviteInfo",value:function(e){var t="".concat(this._n,".updateInviteInfo"),n=e.inviteID,i=e.inviter,o=e.inviteeList;e=e.groupID,Re.l("".concat(t," inviteID:").concat(n," inviter:").concat(i," groupID:").concat(e)),e&&this.hasInviteInfo(n)&&(i=o[0],(e=this.getInviteInfo(n).inviteeList).includes(i)&&(e.splice(e.indexOf(i),1),Re.l("".concat(t," remove ").concat(i,". localInviteeList.length:").concat(e.length))),0!==e.length)||this.deleteInviteInfo(n)}},{key:"canIUseSignaling",value:function(){return this._canIUseSignaling}},{key:"emitEvent",value:function(e,t){this.emitOEvt(e,t)}},{key:"addSignalingListener",value:function(e,t,n){this._canIUseSignaling||(this._canIUseSignaling=!0),this._m.getOEmitInst().on(e,t,n)}},{key:"removeSignalingListener",value:function(e,t,n){this._m.getOEmitInst().off(e,t,n),this._isListenerExisted()||(this._canIUseSignaling=!1)}},{key:"invite",value:function(e){var t=this,n="".concat(this._n,".").concat("invite"),i=this._localSignalingHandler.createInviteInfo(e),o=i.message,a=i.customData,s=i.inviteID;return Re.l("".concat(n," options:").concat(JSON.stringify(e)," inviteID:").concat(s)),this.sendSignaling(o,e).then((function(e){return e&&0===e.code?(t.setInviteInfo(s,f(f({},a),{},{message:o})),t.startTimer(f(f({},a),{},{inviteID:s})),f(f({},e),{},{inviteID:s})):e})).catch((function(e){return kn(e)}))}},{key:"inviteSync",value:function(e,t,n){var i=this,o="".concat(this._n,".").concat("inviteSync"),a=this._localSignalingHandler.createInviteInfo(e),s=a.message,r=a.customData,c=a.inviteID;return Re.l("".concat(o," options:").concat(JSON.stringify(e)," inviteID:").concat(c)),this.sendSignaling(s,e).then((function(e){if(e&&0===e.code)return i.setInviteInfo(c,f(f({},r),{},{message:s})),i.startTimer(f(f({},r),{},{inviteID:c})),t&&t({inviteID:c}),{inviteID:c};n&&n(0===e.code,e.message||"")})).catch((function(e){return n&&n(e.code,e.message),kn(e)})),c}},{key:"_handleImResponse",value:function(e,t,n){t&&0===t.code&&(this._isHandling=!1,n?this.deleteInviteInfo(e.inviteID):this.updateInviteInfo(e))}},{key:"cancel",value:function(e){var t=this,n="".concat(this._n,".").concat("cancel");if(Re.l("".concat(n," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return kn({code:Bn.INVALID_CANCEL_MESSAGE});this._isHandling=!0;var i,o=this._localSignalingHandler.createCancelCustomData(e);return o?(n=o.groupID,i=o.inviteeList,n=n||i[0],i=this.createSignaling(o,n),this.sendSignaling(i,e).then((function(n){return t._handleImResponse(o,n,!0),0===n.code?f(f({},n),{},{inviteID:e.inviteID}):n})).catch((function(e){return kn(e)}))):(this._isHandling=!1,kn({code:Bn.SIGNALING_NO_PERMISSION}))}},{key:"accept",value:function(e){var t=this,n="".concat(this._n,".").concat("accept");if(Re.l("".concat(n," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return kn({code:Bn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var i=this._localSignalingHandler.createAcceptCustomData(e);return i?(n=this.createSignaling(i),this.sendSignaling(n,e).then((function(n){return t._handleImResponse(i,n),0===n.code?f(f({},n),{},{inviteID:e.inviteID}):n})).catch((function(e){return kn(e)}))):(this._isHandling=!1,kn({code:Bn.SIGNALING_NO_PERMISSION}))}},{key:"reject",value:function(e){var t=this,n="".concat(this._n,".").concat("reject");if(Re.l("".concat(n," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return kn({code:Bn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var i=this._localSignalingHandler.createRejectCustomData(e);return i?(n=this.createSignaling(i),this.sendSignaling(n,e).then((function(n){return t._handleImResponse(i,n,!0),0===n.code?f(f({},n),{},{inviteID:e.inviteID}):n})).catch((function(e){return kn(e)}))):(this._isHandling=!1,kn({code:Bn.SIGNALING_NO_PERMISSION}))}},{key:"getSignalingInfo",value:function(e){var t="".concat(this._n,".getSignalingInfo"),n=e.ID,i=e.from,o=e.to,a=this._filterSignaling(e),s=null;return a&&(e=this.getPayloadData(e),s=new cs(e)),e=a?"actionType:".concat(s.actionType):"",Re.l("".concat(t," messageID:").concat(n," from:").concat(i," to:").concat(o," ")+"".concat(e," isSignaling:").concat(a)),s}},{key:"modifyInvitation",value:function(e){var t,n,i,o,a=this,s=e.inviteID;return e=e.data,this.hasInviteInfo(s)?(t=this.getInviteInfo(s),n=t.message,i=m(t,ls),o=n.payload.data,i.data=e,n.payload.data=JSON.stringify(i),this.get(2).modifyRemoteMessage(n).then((function(e){return a.hasInviteInfo(s)&&a.setInviteInfo(s,f(f({},i),{},{message:n})),e})).catch((function(e){return n.payload.data=o,kn(e)}))):kn({code:Bn.SIGNALING_INVALID_INVITE_ID})}},{key:"_genMsgCtrlInfo",value:function(){var e=void 0===(e=(o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data)?"":e,t=o.onlineUserOnly,n=void 0===(n=o.inviteID)?"":n,i=o.offlinePushInfo,o=o.actionType,a={_onlineOnlyFlag:!1};return n={onlineUserOnly:(a=n&&this.getInviteInfo(n)?this.getInviteInfo(n).message:a)._onlineOnlyFlag||t||!1,offlinePushInfo:i,messageControlInfo:{excludedFromContentModeration:!0,excludedFromUnreadCount:!1,excludedFromLastMessage:!1}},o===S.ACTION_TYPE_INVITE_TIMEOUT?(a=!!e.match(/excludeTimeoutSignalingFromHistoryMessage/),n.messageControlInfo.excludedFromUnreadCount=a,n.messageControlInfo.excludedFromLastMessage=a):(t=!!e.match(/excludeFromHistoryMessage/),i=!!e.match(/excludeOriginalSignalingFromHistoryMessage/),n.messageControlInfo.excludedFromUnreadCount=t||i,n.messageControlInfo.excludedFromLastMessage=t||i),n}},{key:"sendSignaling",value:function(e,t){var n=this;return this.get(2).sendMessageInstance(e,this._genMsgCtrlInfo(t)).catch((function(e){return n._isHandling=!1,kn(e)}))}},{key:"filterMessageList",value:function(e){var t=this;return e.filter((function(e){return t._filterSignaling(e)}))}},{key:"getPayloadData",value:function(e){return this._remoteSignalingHandler.getPayloadData(e)}},{key:"createSignaling",value:function(e,t){var n=e.groupID,i=e.inviter;return t={to:t||n||i,conversationType:n?k.CONV_GROUP:k.CONV_C2C,priority:k.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify(e)}},i=this.get(2).createCustomMessage(t),Re.l("".concat(this._n,".createSignaling. message:"),i),i}},{key:"_filterSignaling",value:function(e){var t,n,i=!1;return e.type&&e.type===k.MSG_CUSTOM&&(t=e.cloudCustomData,e=void 0===(e=e.payload.data)?"":e,t=(void 0===t?"":t).match(/"type":"tsignaling"/),n=e.match(/inviteID/),e=e.match(/actionType/),i=t||n&&e),!!i}},{key:"startTimer",value:function(e){var t,n,i,o=this,a="".concat(this._n,".startTimer"),s=e.timeout,r=e.inviteID,c=e.inviter,u=e.groupID,l=c===this.getMyUserID();Re.l("".concat(a," timeout:").concat(s," isInviter:").concat(l," groupID:").concat(u)),s<=0||(t=l?s+5:s,n=1,i=setInterval((function(){var s=o._hasLocalInviteInfo(e,l);n<t&&s?++n:(s&&o._sendTimeoutNotice(r,l),Re.l("".concat(a," end.")),clearInterval(i))}),1e3))}},{key:"_hasLocalInviteInfo",value:function(e,t){var n,i,o=e.inviteID;return e=e.groupID,!!this.hasInviteInfo(o)&&(n="".concat(this._n,"._hasLocalInviteInfo"),i=this.getInviteInfo(o).inviteeList,Re.l("".concat(n," inviteID:").concat(o," inviteeList:").concat(i," groupID:").concat(e)),!e||(t?0<i.length:0<i.length&&i.includes(this.getMyUserID())))}},{key:"_getReceiver",value:function(e,t){var n=t.groupID,i=t.inviteeList;return t=t.inviter,e?n||i[0]:n||t}},{key:"_sendTimeoutNotice",value:function(e,t){var n=this,i=this.getInviteInfo(e),o=this._getReceiver(t,i),a=(Re.l("".concat(this._n,"._sendTimeoutNotice inviteID:").concat(e," to:").concat(o," isInviter:").concat(t)),this._localSignalingHandler.createTimeoutCustomData(f(f({},i),{},{isInviter:t}))),s=this.createSignaling(a,o);return this.sendSignaling(s,a).then((function(i){var o,r,c;i&&0===i.code&&(i=a.data,o=a.groupID,r=a.inviteeList,c=a.inviter,n.emitEvent(S.INVITATION_TIMEOUT,{data:i,groupID:o,inviteID:e,inviteeList:r,inviter:c,isSelfTimeout:!0,message:s}),t?n.deleteInviteInfo(e):n.updateInviteInfo(a))}))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._inviteInfoMap.clear(),this._canIUseSignaling=!1,this._isHandling=!1,this._historySignalingHandler.reset(),this._isC2CUnreadHandleCompleted=!1,this._isConvSyncCompleted=!1,this._isSyncCompleted=!1,this._isCloudConfigCompleted=!1}}])),hs=["followDiffList"],ps=["from"],gs={NONE:0,FOLLOWERS:1,FOLLOWING:2,MUTUAL:3},fs=(l(_s,Nn),a(_s,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("follow_req_count");dt(e)||(e=Number(e),this.DEFAULT_COUNT=e>this.MAX_COUNT?this.MAX_COUNT:e,this._clearFollowList())}},{key:"clearCacheOnReconnected",value:function(){this._clearFollowList()}},{key:"onFollowNotify",value:function(e){var t=this;e=e.dataList||[],Re.l("".concat(this._n,".onFollowNotify followChangeList:").concat(e.length)),e.forEach((function(e){var n=void 0===(n=e.followDiffList)?[]:n,i=(e=m(e,hs)).from,o=m(e,ps);n.forEach((function(e){var n=e.isAdd,a=(e=void 0===(e=e.followType)?0:e,t._initFollowInfo());1===n?(o.userID=i,a[e].userInfoList.push(o),a[e].isAdd=!0):(a[e].userInfoList.push(i),a[e].isAdd=!1),t._emitEvent(a)}))}))}},{key:"_initFollowInfo",value:function(){var e={};return Object.values(gs).forEach((function(t){t!==gs.NONE&&(e[t]={userInfoList:[],isAdd:!1})})),e}},{key:"_emitEvent",value:function(e){var t=this;Object.keys(e).forEach((function(n){n=Number(n);var i=e[n];0<i.userInfoList.length&&(n===gs.FOLLOWERS&&(t._clearFollowList(gs.FOLLOWERS),t.emitOEvt(T.MY_FOLLOWERS_LIST_UPDATED,i)),n===gs.FOLLOWING&&(t._clearFollowList(gs.FOLLOWING),t.emitOEvt(T.MY_FOLLOWING_LIST_UPDATED,i)),n===gs.MUTUAL)&&(t._clearFollowList(gs.MUTUAL),t.emitOEvt(T.MUTUAL_FOLLOWERS_LIST_UPDATED,i))}))}},{key:"followUser",value:function(e){var t,n,i;return this.canIUse(P.FOLLOW)?(t="".concat(this._n,".").concat("followUser"),n="userIDList:".concat(e.length),(i=new ii("followUser")).setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.FOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:e.map((function(e){return{userID:e}}))}}).then((function(e){return i.end(),Re.l("".concat(t," ok.")),En(e.data.resultList)})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this.noUse("followUser")}},{key:"unfollowUser",value:function(e){var t,n,i;return this.canIUse(P.FOLLOW)?(t="".concat(this._n,".").concat("unfollowUser"),n="userIDList:".concat(e.length),(i=new ii("unfollowUser")).setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.UNFOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then((function(e){return i.end(),Re.l("".concat(t," ok.")),En(e.data.resultList)})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this.noUse("unfollowUser")}},{key:"getMyFollowersList",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n="getMyFollowersList";if(!this.canIUse(P.FOLLOW))return this.noUse(n);var i=t||this.FIRST_PAGE_INDEX;if(this._myFollowersList.has(i)){var o=(s=this._myFollowersList.get(i)).resultList,a=s.nextCursor,s=s.lastUpdateTime;if(Date.now()-s<this.MAX_CATCH_TIME&&0<o.length)return Re.l("".concat(this._n,".").concat(n," nextCursor:").concat(t," from local.")),Tn({resultList:o,nextCursor:a})}return this._getFollowList(t,gs.FOLLOWERS).then((function(o){return e._myFollowersList.set(i,f(f({},o),{},{lastUpdateTime:Date.now()})),Re.l("".concat(e._n,".").concat(n," nextCursor:").concat(t," from remote.")),En(o)}))}},{key:"getMyFollowingList",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n="getMyFollowingList";if(!this.canIUse(P.FOLLOW))return this.noUse(n);var i=t||this.FIRST_PAGE_INDEX;if(this._myFollowingList.has(i)){var o=(s=this._myFollowingList.get(i)).resultList,a=s.nextCursor,s=s.lastUpdateTime;if(Date.now()-s<this.MAX_CATCH_TIME&&0<o.length)return Re.l("".concat(this._n,".").concat(n," nextCursor:").concat(t," from local.")),Tn({resultList:o,nextCursor:a})}return this._getFollowList(t,gs.FOLLOWING).then((function(o){return e._myFollowingList.set(i,f(f({},o),{},{lastUpdateTime:Date.now()})),Re.l("".concat(e._n,".").concat(n," nextCursor:").concat(t," from remote.")),En(o)}))}},{key:"getMutualFollowersList",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n="getMutualFollowersList";if(!this.canIUse(P.FOLLOW))return this.noUse(n);var i=t||this.FIRST_PAGE_INDEX;if(this._myMutualFollowersList.has(i)){var o=(s=this._myMutualFollowersList.get(i)).resultList,a=s.nextCursor,s=s.lastUpdateTime;if(Date.now()-s<this.MAX_CATCH_TIME&&0<o.length)return Re.l("".concat(this._n,".").concat(n," nextCursor:").concat(t," from local.")),Tn({resultList:o,nextCursor:a})}return this._getFollowList(t,gs.MUTUAL).then((function(o){return e._myMutualFollowersList.set(i,f(f({},o),{},{lastUpdateTime:Date.now()})),Re.l("".concat(e._n,".").concat(n," nextCursor:").concat(t," from remote.")),En(o)}))}},{key:"_getFollowList",value:function(e,t){var n=this,i=new ii("_getFollowList");return i.setMessage("nextCursor:".concat(e," type:").concat(t)),this.req({P:jn.GET_FOLLOW,data:{fromAccount:this.getMyUserID(),count:this.DEFAULT_COUNT,nextCursor:e,type:t}}).then((function(e){i.end();var t=void 0===(t=(e=e.data).resultList)?[]:t,o=(e=void 0===(e=e.nextCursor)?"":e,[]);return t.forEach((function(e){var t=e.userID,i=e.followTime;e=e.profileList,o.push(f({userID:t,followTime:i},n._handleProfileItem(void 0===e?[]:e)))})),{resultList:o,nextCursor:e}})).catch((function(e){return i.setError(e).end(),Re.e("".concat(n._n,"._getFollowList failed. error:"),e),kn(e)}))}},{key:"_handleProfileItem",value:function(e){var t={};return e.forEach((function(e){switch(e.tag){case Oe.NICK:t.nick=e.value;break;case Oe.GENDER:t.gender=e.value;break;case Oe.BIRTHDAY:t.birthday=e.value;break;case Oe.LOCATION:t.location=e.value;break;case Oe.SELFSIGNATURE:t.selfSignature=e.value;break;case Oe.ALLOWTYPE:t.allowType=e.value;break;case Oe.LANGUAGE:t.language=e.value;break;case Oe.AVATAR:t.avatar=e.value;break;case Oe.MESSAGESETTINGS:t.messageSettings=e.value;break;case Oe.ADMINFORBIDTYPE:t.adminForbidType=e.value;break;case Oe.LEVEL:t.level=e.value;break;case Oe.ROLE:t.role=e.value;break;default:t[e.tag]=e.value}})),t}},{key:"getUserFollowInfo",value:function(e){var t,n,i;return this.canIUse(P.FOLLOW)?(n=!1,dt(e)&&(e=[this.getMyUserID()],n=!0),t="".concat(this._n,".").concat("getUserFollowInfo"),n="userIDList:".concat(e.length," isGetMyFollowInfo:").concat(n),(i=new ii("getUserFollowInfo")).setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.GET_FOLLOW_INFO,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then((function(e){i.end(),Re.l("".concat(t," ok.")),e=e.data.followInfoList;var n=[];return(void 0===e?[]:e).forEach((function(e){var t=e.followersCount,i=e.followingCount;e=e.mutualFollowersCount,n.push({followersCount:t,followingCount:i,mutualFollowersCount:e})})),En(n)})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))):this.noUse("getUserFollowInfo")}},{key:"checkFollowType",value:function(e){if(!this.canIUse(P.FOLLOW))return this.noUse("checkFollowType");100<e.length&&(e=e.slice(0,100),Re.w("".concat(t," ").concat(Ht(100))));var t="".concat(this._n,".").concat("checkFollowType"),n="userIDList length:".concat(e.length," "),i=new ii("checkFollowType");return i.setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.CHECK_FOLLOW_TYPE,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then((function(e){i.end(),Re.l("".concat(t," ok.")),e=e.data.resultList;var n=[];return(void 0===e?[]:e).forEach((function(e){var t=e.userID;e=e.followType,n.push({userID:t,followType:e})})),En(n)})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),kn(e)}))}},{key:"_clearFollowList",value:function(e){dt(e)?(this._myFollowersList.clear(),this._myFollowingList.clear(),this._myMutualFollowersList.clear()):e!==gs.FOLLOWERS?e!==gs.FOLLOWING?e===gs.MUTUAL&&this._myMutualFollowersList.clear():this._myFollowingList.clear():this._myFollowersList.clear()}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._clearFollowList()}}])),ms=Go((function(e,t){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t,n,i=Array.prototype.slice.call(arguments,1);i.length;){var o=i.shift();if(o){if("object"!==M(o))throw new TypeError(o+"must be non-object");for(var a in o)t=o,n=a,Object.prototype.hasOwnProperty.call(t,n)&&(e[a]=o[a])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,i,o){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),o);else for(var a=0;a<i;a++)e[o+a]=t[n+a]},flattenChunks:function(e){for(var t,n,i,o=0,a=0,s=e.length;a<s;a++)o+=e[a].length;for(i=new Uint8Array(o),a=t=0,s=e.length;a<s;a++)n=e[a],i.set(n,t),t+=n.length;return i}},o={arraySet:function(e,t,n,i,o){for(var a=0;a<i;a++)e[o+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)}));function _s(e){return i(this,_s),(e=n(this,_s,[e]))._n="FollowModule",e._myFollowersList=new Map,e._myFollowingList=new Map,e._myMutualFollowersList=new Map,e.MAX_CATCH_TIME=6e5,e.FIRST_PAGE_INDEX=at(),e.DEFAULT_COUNT=500,e.MAX_COUNT=1e3,e.getIEmitInst().on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function vs(e){i(this,vs),(e=n(this,vs,[e]))._n="SignalingModule",e._inviteInfoMap=new Map,e._canIUseSignaling=!1,e._isHandling=!1,e._remoteSignalingHandler=new as(e),e._localSignalingHandler=new ss(e),e._historySignalingHandler=new rs(e),e._isC2CUnreadHandleCompleted=!1,e._isConvSyncCompleted=!1,e._isSyncCompleted=!1,e._isCloudConfigCompleted=!1;var t=e.getIEmitInst();return t.on(Oi.C2C_UNREAD_HANDLE_COMPLETED,e.onC2CUnreadHandleCompleted,e),t.on(Oi.CONV_SYNC_COMPLETED,e.onConvSyncCompleted,e),t.on(Oi.CLOUD_CONFIG,e.onCloudConfig,e),e}function ys(e){return i(this,ys),(e=n(this,ys,[e]))._n="ProfanityFilterModule",e._plugin=null,e._filterConfigMap=new Map,e._startIndex=0,e._version=0,e._canIUseLexicon=!1,e._isFetching=!1,e._expiredTime=0,e}function Is(e){var t;return i(this,Is),(t=n(this,Is,[e]))._m=e,t._n="TIMPushModule",t._pluginName="TIMPush",t._pushPlugin=void 0,t._androidPushConfig={},t._deviceToken="",t._businessID=0,t._iOSBusinessID=0,t._c2cUnreadCount=0,t._groupUnreadCount=0,t._isWebUniapp=0,t._deviceInfo={notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:"1.0.1",packageName:""},t}function Ms(e){var t;return i(this,Ms),(t=n(this,Ms,[e]))._m=e,t._n="OfflinePushModule",t._offlinePushPlugin=void 0,t._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},t._deviceToken="",t._businessID=0,t._iosBusinessID=0,t._c2cUnreadCount=0,t._groupUnreadCount=0,t._isWebUniapp=0,t}function Cs(e){return i(this,Cs),(e=n(this,Cs,[e]))._n="WorkerTimerModule",e._isWorkerEnabled=!0,e._workerTimer=null,e._timerID=-1,e._init(),e.getIEmitInst().on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function Es(e){return i(this,Es),(e=n(this,Es,[e]))._n="SnsModule",e._friendHandler=new Ya(e),e._friendApplicationHandler=new Ka(e),e._friendGroupHandler=new Wa(e),e.getIEmitInst().on(Oi.A2KEY_AND_TINYID_UPDATED,e.onContextUpdated,e),e}function Ts(e){i(this,Ts),(e=n(this,Ts,[e]))._n="QualityStatModule",e.TAG="im-ssolog-quality-stat",e.reportIndex=0,e.wholePeriod=!1,e._qualityItems=[qn,Hn,Kn,zn,Yn,$n,Wn,Jn,Xn,Zn],e._messageSentItems=[Kn,zn,Yn,$n,Wn],e._messageReceivedItems=[Jn,Xn,Zn],e.REPORT_INTERVAL=120,e.REPORT_SDKAPPID_BLACKLIST=[],e.REPORT_TINYID_WHITELIST=[],e._statInfoArr=[],e._avgRTT=new Ba,e._avgE2EDelay=new Fa,e._rateMessageSent=new Va,e._rateMessageReceived=new ja;var t=e.getIEmitInst();return t.on(Oi.A2KEY_AND_TINYID_UPDATED,e._onLoginSuccess,e),t.on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function ks(e){return i(this,ks),(e=n(this,ks,[e]))._n="RecoverMsgModule",e.PULL_LIMIT_COUNT=15,e}function Ss(e){return i(this,Ss),(e=n(this,Ss,[e]))._n="CloudControlModule",e._cloudConfig=new Map,e._expiredTime=0,e._version=0,e._isFetching=!1,e}function Ds(e){return i(this,Ds),(e=n(this,Ds,[e]))._n="SessionModule",e._platform=e.getPlatform(),e._pHandler=new Ta(e),e._msgDispatcher=new Sa(e),e._cmdFreqLimitMap=new Map,e._cmdReqInfoMap=new Map,e._serverOverloadInfoMap=new Map,e._incrementalPullContactFlag=!0,e._init(),e.getIEmitInst().on(Oi.CLOUD_CONFIG,e._onCloudConfig,e),e}function bs(e,t,n,i){for(var o=65535&e,a=e>>>16&65535,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;a=a+(o=o+t[i++]|0)|0,--s;);o%=65521,a%=65521}return o|a<<16}function As(e,t,n,i){var o=Rs,a=i+n;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}function Ls(e,t,n,i,o,a,s,r){var c,u,l,d,h,p,g,f,m,_=r.bits,v=0,y=0,I=0,M=0,C=0,E=0,T=0,k=0,S=0,D=0,b=null,A=0,L=new ms.Buf16(16),R=new ms.Buf16(16),w=null,O=0;for(v=0;v<=15;v++)L[v]=0;for(y=0;y<i;y++)L[t[n+y]]++;for(C=_,M=15;1<=M&&0===L[M];M--);if(M<C&&(C=M),0===M)o[a++]=20971520,o[a++]=20971520,r.bits=1;else{for(I=1;I<M&&0===L[I];I++);for(C<I&&(C=I),v=k=1;v<=15;v++)if((k=(k<<1)-L[v])<0)return-1;if(0<k&&(0===e||1!==M))return-1;for(R[1]=0,v=1;v<15;v++)R[v+1]=R[v]+L[v];for(y=0;y<i;y++)0!==t[n+y]&&(s[R[t[n+y]]++]=y);if(p=0===e?(b=w=s,19):1===e?(b=ws,A-=257,w=Os,O-=257,256):(b=Ns,w=Ps,-1),v=I,h=a,T=y=D=0,l=-1,d=(S=1<<(E=C))-1,1===e&&852<S||2===e&&592<S)return 1;for(;;){for(m=s[y]<p?(f=0,s[y]):s[y]>p?(f=w[O+s[y]],b[A+s[y]]):(f=96,0),c=1<<(g=v-T),I=u=1<<E;o[h+(D>>T)+(u-=c)]=g<<24|f<<16|m,0!==u;);for(c=1<<v-1;D&c;)c>>=1;if(D=0!==c?(D&c-1)+c:0,y++,0==--L[v]){if(v===M)break;v=t[n+s[y]]}if(C<v&&(D&d)!==l){for(h+=I,k=1<<(E=v-(T=0===T?C:T));E+T<M&&!((k-=L[E+T])<=0);)E++,k<<=1;if(S+=1<<E,1===e&&852<S||2===e&&592<S)return 1;o[l=D&d]=C<<24|E<<16|h-a}}0!==D&&(o[h+D]=v-T<<24|64<<16),r.bits=C}return 0}ms.assign,ms.shrinkBuf,ms.setTyped,ms.Buf8,ms.Buf16,ms.Buf32;var Rs=function(){for(var e=[],t=0;t<256;t++){for(var n=t,i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}(),ws=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Os=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ns=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Ps=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function Us(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Gs(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ms.Buf16(320),this.work=new ms.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function xs(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new ms.Buf32(852),t.distcode=t.distdyn=new ms.Buf32(592),t.sane=1,t.back=-1,0):-2}function Fs(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,xs(e)):-2}function Bs(e,t){var n,i;return!e||!e.state||(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t))?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,Fs(e))}function Vs(e,t){var n;return e?(n=new Gs,(e.state=n).window=null,0!==(n=Bs(e,t))&&(e.state=null),n):-2}var js,qs,Hs=!0;function Ks(e,t,n,i){var o;return null===(e=e.state).window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new ms.Buf8(e.wsize)),i>=e.wsize?(ms.arraySet(e.window,t,n-e.wsize,e.wsize,0),e.wnext=0,e.whave=e.wsize):((o=e.wsize-e.wnext)>i&&(o=i),ms.arraySet(e.window,t,n-i,o,e.wnext),(i-=o)?(ms.arraySet(e.window,t,n-i,i,0),e.wnext=i,e.whave=e.wsize):(e.wnext+=o,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=o))),0}var zs={inflateReset:Fs,inflateReset2:Bs,inflateResetKeep:xs,inflateInit:function(e){return Vs(e,15)},inflateInit2:Vs,inflate:function(e,t){var n,i,o,a,s,r,c,u,l,d,h,p,g,f,m,_,v,y,I,M,C,E,T,k,S=0,D=new ms.Buf8(4),b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),s=e.next_out,o=e.output,c=e.avail_out,a=e.next_in,i=e.input,r=e.avail_in,u=n.hold,l=n.bits,d=r,h=c,E=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap)n.mode=13;else{for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(2&n.wrap&&35615===u)D[n.check=0]=255&u,D[1]=u>>>8&255,n.check=As(n.check,D,2,0),l=u=0,n.mode=2;else if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31)e.msg="incorrect header check",n.mode=30;else if(8!=(15&u))e.msg="unknown compression method",n.mode=30;else{if(l-=4,C=8+(15&(u>>>=4)),0===n.wbits)n.wbits=C;else if(C>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<C,e.adler=n.check=1,n.mode=512&u?10:12,l=u=0}}break;case 2:for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(n.flags=u,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(D[0]=255&u,D[1]=u>>>8&255,n.check=As(n.check,D,2,0)),l=u=0,n.mode=3;case 3:for(;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.head&&(n.head.time=u),512&n.flags&&(D[0]=255&u,D[1]=u>>>8&255,D[2]=u>>>16&255,D[3]=u>>>24&255,n.check=As(n.check,D,4,0)),l=u=0,n.mode=4;case 4:for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(D[0]=255&u,D[1]=u>>>8&255,n.check=As(n.check,D,2,0)),l=u=0,n.mode=5;case 5:if(1024&n.flags){for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(D[0]=255&u,D[1]=u>>>8&255,n.check=As(n.check,D,2,0)),l=u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((p=(p=n.length)>r?r:p)&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),ms.arraySet(n.head.extra,i,a,p,C)),512&n.flags&&(n.check=As(n.check,i,p,a)),r-=p,a+=p,n.length-=p),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===r)break e;for(p=0;C=i[a+p++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C)),C&&p<r;);if(512&n.flags&&(n.check=As(n.check,i,p,a)),r-=p,a+=p,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===r)break e;for(p=0;C=i[a+p++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C)),C&&p<r;);if(512&n.flags&&(n.check=As(n.check,i,p,a)),r-=p,a+=p,C)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;l<16;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}l=u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}e.adler=n.check=Us(u),l=u=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=c,e.next_in=a,e.avail_in=r,n.hold=u,n.bits=l,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last)u>>>=7&l,l-=7&l,n.mode=27;else{for(;l<3;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}switch(n.last=1&u,--l,3&(u>>>=1)){case 0:n.mode=14;break;case 1:A=L=void 0;var A,L=n;if(Hs){for(js=new ms.Buf32(512),qs=new ms.Buf32(32),A=0;A<144;)L.lens[A++]=8;for(;A<256;)L.lens[A++]=9;for(;A<280;)L.lens[A++]=7;for(;A<288;)L.lens[A++]=8;for(Ls(1,L.lens,0,288,js,0,L.work,{bits:9}),A=0;A<32;)L.lens[A++]=5;Ls(2,L.lens,0,32,qs,0,L.work,{bits:5}),Hs=!1}if(L.lencode=js,L.lenbits=9,L.distcode=qs,L.distbits=5,n.mode=20,6!==t)break;u>>>=2,l-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}u>>>=2,l-=2}break;case 14:for(u>>>=7&l,l-=7&l;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&u,l=u=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(p=n.length){if(0===(p=c<(p=r<p?r:p)?c:p))break e;ms.arraySet(o,i,a,p,s),r-=p,a+=p,c-=p,s+=p,n.length-=p}else n.mode=12;break;case 17:for(;l<14;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(n.nlen=257+(31&u),u>>>=5,l-=5,n.ndist=1+(31&u),u>>>=5,l-=5,n.ncode=4+(15&u),u>>>=4,l-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;l<3;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.lens[b[n.have++]]=7&u,u>>>=3,l-=3}for(;n.have<19;)n.lens[b[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},E=Ls(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(S=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,v=65535&S,!((m=S>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(v<16)u>>>=m,l-=m,n.lens[n.have++]=v;else{if(16===v){for(k=m+2;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(u>>>=m,l-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}C=n.lens[n.have-1],p=3+(3&u),u>>>=2,l-=2}else if(17===v){for(k=m+3;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}C=0,p=3+(7&(u>>>=m)),u>>>=3,l=l-m-3}else{for(k=m+7;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}C=0,p=11+(127&(u>>>=m)),u>>>=7,l=l-m-7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;p--;)n.lens[n.have++]=C}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},E=Ls(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},E=Ls(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,E){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=r&&258<=c){e.next_out=s,e.avail_out=c,e.next_in=a,e.avail_in=r,n.hold=u,n.bits=l,H=V=U=P=N=O=w=R=ie=ne=te=ee=Q=Z=X=J=W=$=Y=z=K=q=j=B=F=void 0;var R,w,O,N,P,U,G=e,x=h,F=G.state,B=G.next_in,V=G.input,j=B+(G.avail_in-5),q=G.next_out,H=G.output,K=q-(x-G.avail_out),z=q+(G.avail_out-257),Y=F.dmax,$=F.wsize,W=F.whave,J=F.wnext,X=F.window,Z=F.hold,Q=F.bits,ee=F.lencode,te=F.distcode,ne=(1<<F.lenbits)-1,ie=(1<<F.distbits)-1;t:do{for(Q<15&&(Z+=V[B++]<<Q,Q+=8,Z+=V[B++]<<Q,Q+=8),R=ee[Z&ne];;){if(Z>>>=w=R>>>24,Q-=w,0==(w=R>>>16&255))H[q++]=65535&R;else{if(!(16&w)){if(!(64&w)){R=ee[(65535&R)+(Z&(1<<w)-1)];continue}if(32&w){F.mode=12;break t}G.msg="invalid literal/length code",F.mode=30;break t}for(O=65535&R,(w&=15)&&(Q<w&&(Z+=V[B++]<<Q,Q+=8),O+=Z&(1<<w)-1,Z>>>=w,Q-=w),Q<15&&(Z+=V[B++]<<Q,Q+=8,Z+=V[B++]<<Q,Q+=8),R=te[Z&ie];;){if(Z>>>=w=R>>>24,Q-=w,!(16&(w=R>>>16&255))){if(!(64&w)){R=te[(65535&R)+(Z&(1<<w)-1)];continue}G.msg="invalid distance code",F.mode=30;break t}if(N=65535&R,Q<(w&=15)&&(Z+=V[B++]<<Q,(Q+=8)<w)&&(Z+=V[B++]<<Q,Q+=8),(N+=Z&(1<<w)-1)>Y){G.msg="invalid distance too far back",F.mode=30;break t}if(Z>>>=w,Q-=w,N>(w=q-K)){if((w=N-w)>W&&F.sane){G.msg="invalid distance too far back",F.mode=30;break t}if(U=X,(P=0)===J){if(P+=$-w,w<O){for(O-=w;H[q++]=X[P++],--w;);P=q-N,U=H}}else if(J<w){if(P+=$+J-w,(w-=J)<O){for(O-=w;H[q++]=X[P++],--w;);if(P=0,J<O){for(O-=w=J;H[q++]=X[P++],--w;);P=q-N,U=H}}}else if(P+=J-w,w<O){for(O-=w;H[q++]=X[P++],--w;);P=q-N,U=H}for(;2<O;)H[q++]=U[P++],H[q++]=U[P++],H[q++]=U[P++],O-=3;O&&(H[q++]=U[P++],1<O)&&(H[q++]=U[P++])}else{for(P=q-N;H[q++]=H[P++],H[q++]=H[P++],H[q++]=H[P++],2<(O-=3););O&&(H[q++]=H[P++],1<O)&&(H[q++]=H[P++])}break}}break}}while(B<j&&q<z);B-=O=Q>>3,Z&=(1<<(Q-=O<<3))-1,G.next_in=B,G.next_out=q,G.avail_in=B<j?j-B+5:5-(B-j),G.avail_out=q<z?z-q+257:257-(q-z),F.hold=Z,F.bits=Q,s=e.next_out,o=e.output,c=e.avail_out,a=e.next_in,i=e.input,r=e.avail_in,u=n.hold,l=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;_=(S=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,v=65535&S,!((m=S>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(_&&!(240&_)){for(y=m,I=_,M=v;_=(S=n.lencode[M+((u&(1<<y+I)-1)>>y)])>>>16&255,v=65535&S,!(y+(m=S>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}u>>>=y,l-=y,n.back+=y}if(u>>>=m,l-=m,n.back+=m,n.length=v,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(k=n.extra;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(S=n.distcode[u&(1<<n.distbits)-1])>>>16&255,v=65535&S,!((m=S>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(!(240&_)){for(y=m,I=_,M=v;_=(S=n.distcode[M+((u&(1<<y+I)-1)>>y)])>>>16&255,v=65535&S,!(y+(m=S>>>24)<=l);){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}u>>>=y,l-=y,n.back+=y}if(u>>>=m,l-=m,n.back+=m,64&_){e.msg="invalid distance code",n.mode=30;break}n.offset=v,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(k=n.extra;l<k;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===c)break e;if(n.offset>(p=h-c)){if((p=n.offset-p)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}g=p>n.wnext?(p-=n.wnext,n.wsize-p):n.wnext-p,p>n.length&&(p=n.length),f=n.window}else f=o,g=s-n.offset,p=n.length;for(c-=p=c<p?c:p,n.length-=p;o[s++]=f[g++],--p;);0===n.length&&(n.mode=21);break;case 26:if(0===c)break e;o[s++]=n.length,c--,n.mode=21;break;case 27:if(n.wrap){for(;l<32;){if(0===r)break e;r--,u|=i[a++]<<l,l+=8}if(h-=c,e.total_out+=h,n.total+=h,h&&(e.adler=n.check=(n.flags?As:bs)(n.check,o,h,s-h)),h=c,(n.flags?u:Us(u))!==n.check){e.msg="incorrect data check",n.mode=30;break}l=u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;l<32;){if(0===r)break e;r--,u+=i[a++]<<l,l+=8}if(u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}l=u=0}n.mode=29;case 29:E=1;break e;case 30:E=-3;break e;case 31:return-4;default:return-2}return e.next_out=s,e.avail_out=c,e.next_in=a,e.avail_in=r,n.hold=u,n.bits=l,(n.wsize||h!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&Ks(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,n.wrap&&h&&(e.adler=n.check=(n.flags?As:bs)(n.check,o,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==d&&0===h||4===t)&&0===E?-5:E},inflateEnd:function(e){var t;return e&&e.state?((t=e.state).window&&(t.window=null),e.state=null,0):-2},inflateGetHeader:function(e,t){return e&&e.state&&2&(e=e.state).wrap?((e.head=t).done=!1,0):-2},inflateSetDictionary:function(e,t){var n,i=t.length;return!e||!e.state||0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&bs(1,t,i,0)!==n.check?-3:Ks(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0)},inflateInfo:"pako inflate (from Nodeca project)"},Ys=!0,$s=!0;try{String.fromCharCode.apply(null,[0])}catch(Cr){Ys=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Cr){$s=!1}for(var Ws=new ms.Buf8(256),Js=0;Js<256;Js++)Ws[Js]=252<=Js?6:248<=Js?5:240<=Js?4:224<=Js?3:192<=Js?2:1;function Xs(e,t){for(var n,i,o=t||e.length,a=new Array(2*o),s=0,r=0;r<o;)if((n=e[r++])<128)a[s++]=n;else if(4<(i=Ws[n]))a[s++]=65533,r+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&r<o;)n=n<<6|63&e[r++],i--;1<i?a[s++]=65533:n<65536?a[s++]=n:(n-=65536,a[s++]=55296|n>>10&1023,a[s++]=56320|1023&n)}var c=a,u=s;if(u<65534&&(c.subarray&&$s||!c.subarray&&Ys))return String.fromCharCode.apply(null,ms.shrinkBuf(c,u));for(var l="",d=0;d<u;d++)l+=String.fromCharCode(c[d]);return l}function Zs(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function Qs(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}Ws[254]=Ws[254]=1;var er={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},tr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},nr=Object.prototype.toString;function ir(e){if(!(this instanceof ir))return new ir(e);this.options=ms.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits)&&(t.windowBits=-15),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zs,this.strm.avail_out=0,(e=zs.inflateInit2(this.strm,t.windowBits))!==er.Z_OK)throw new Error(tr[e]);if(this.header=new Qs,zs.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=function(e){for(var t,n,i,o,a=e.length,s=0,r=0;r<a;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new ms.Buf8(s),r=o=0;o<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(t.dictionary):"[object ArrayBuffer]"===nr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw)&&(e=zs.inflateSetDictionary(this.strm,t.dictionary))!==er.Z_OK)throw new Error(tr[e])}function or(e,t){if((t=new ir(t)).push(e,!0),t.err)throw t.msg||tr[t.err];return t.result}ir.prototype.push=function(e,t){var n,i,o,a,s,r=this.strm,c=this.options.chunkSize,u=this.options.dictionary,l=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?er.Z_FINISH:er.Z_NO_FLUSH,"string"==typeof e?r.input=function(e){for(var t=new ms.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t}(e):"[object ArrayBuffer]"===nr.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new ms.Buf8(c),r.next_out=0,r.avail_out=c),(n=(n=zs.inflate(r,er.Z_NO_FLUSH))===er.Z_NEED_DICT&&u?zs.inflateSetDictionary(this.strm,u):n)===er.Z_BUF_ERROR&&!0===l&&(n=er.Z_OK,l=!1),n!==er.Z_STREAM_END&&n!==er.Z_OK)return this.onEnd(n),!(this.ended=!0);!r.next_out||0!==r.avail_out&&n!==er.Z_STREAM_END&&(0!==r.avail_in||i!==er.Z_FINISH&&i!==er.Z_SYNC_FLUSH)||("string"===this.options.to?(o=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0||0===n)&&n+Ws[e[n]]>t?n:t}(r.output,r.next_out),a=r.next_out-o,s=Xs(r.output,o),r.next_out=a,r.avail_out=c-a,a&&ms.arraySet(r.output,r.output,o,a,0),this.onData(s)):this.onData(ms.shrinkBuf(r.output,r.next_out))),0===r.avail_in&&0===r.avail_out&&(l=!0)}while((0<r.avail_in||0===r.avail_out)&&n!==er.Z_STREAM_END);return(i=n===er.Z_STREAM_END?er.Z_FINISH:i)===er.Z_FINISH?(n=zs.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===er.Z_OK):i!==er.Z_SYNC_FLUSH||(this.onEnd(er.Z_OK),!(r.avail_out=0))},ir.prototype.onData=function(e){this.chunks.push(e)},ir.prototype.onEnd=function(e){e===er.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ms.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},On={};var ar=((0,ms.assign)(On,{Inflate:ir,inflate:or,inflateRaw:function(e,t){return(t=t||{}).raw=!0,or(e,t)},ungzip:or},er),On),sr=a((function e(t){i(this,e),this._m=t,this._n="InflateModule",this._bLogForInflateOK=!1,this._bLogForInflateError=!1}),[{key:"inflate",value:function(e){e=new Uint8Array(e).slice(4);var t,n=Date.now();try{t=ar.inflate(e,{to:"string"}),this._bLogForInflateOK||(this._bLogForInflateOK=!0,new ii("inflateOK").end())}catch(o){return this._bLogForInflateError?void 0:(this._bLogForInflateError=!0,void new ii("inflateError").setMessage(o).end())}e=e.length+4;var i=t.length;return Re.d("inflate ok. zipped:".concat(e," unzipped:").concat(i)+" compression ratio:".concat(Math.round(100*(i-e)/i),"% cost:").concat(Date.now()-n)),t}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._bLogForInflateOK=!1,this._bLogForInflateError=!1}}]),rr="Message",cr="User",ur="Group",lr="GroupMember",dr=["count"],hr=["conversationID","timePosition","timePeriod"],pr=["miniBirthday","maxBirthday"],gr=r(r(r(r({},rr,jn.CS),cr,jn.USER_CS),ur,jn.GRP_CS),lr,jn.MBR_CS),fr=(l(Ir,Nn),a(Ir,[{key:"searchCloudMessages",value:function(e){return this.search(rr,e)}},{key:"searchCloudUsers",value:function(e){return this.search(cr,e)}},{key:"searchCloudGroups",value:function(e){return this.search(ur,e)}},{key:"searchCloudGroupMembers",value:function(e){return this.search(lr,e)}},{key:"search",value:function(e,t){var n=this,i="searchCloud".concat(e,"s"),o="".concat(this._n,".").concat(i);if(!t)return kn({code:Bn.OPTIONS_IS_EMPTY,message:this.getErrMsg(Bn.OPTIONS_IS_EMPTY,i)});var a=t.keywordList,s=Je(a),r=t.count;if(t.count&&(r=parseInt(r)),e===rr&&!s&&!Je(t.senderUserIDList)&&!Je(t.messageTypeList)||e!==rr&&!s)throw Re.e("[".concat(i,'] Missing required params: "keywordList".')),new Error("Params validate failed.");var c=Date.now(),u=new ii(i),l="keywordList:".concat(a," keywordListMatchType:").concat(t.keywordListMatchType," cursor:").concat(t.cursor," count:").concat(r);return Re.l("".concat(o," ").concat(l)),this.req({P:gr[e],data:this._genParams(e,t)}).then((function(i){var a=(s=i.data).code,s=s.message;if(0!==a)return 60020===(r=a)?r="SearchUnable":e!==rr&&27003===a?r="SearchParamsError":e!==rr&&60018===a&&(r="SearchOverLimit"),r=n.getErrMsg(r)||s,s=new Fn({code:a,message:r}),u.setMessage(l).setError(s).end(),kn(s);n.get(27).isCSPluginEnabled(),s=void 0===(r=(a=i.data).cursor)?"":r;var r=a.totalCount;return a="totalCount:".concat(r," cost:").concat(Yt(c)),En({searchResultList:(Re.l("".concat(o," ok. cursor:").concat(s," ").concat(a)),u.setMessage("".concat(l," ").concat(a)).end(),a=n._genRes(e,t,i.data)),cursor:s,totalCount:r})})).catch((function(e){return u.setMessage(l).setError(e).end(),kn(e)}))}},{key:"_genParams",value:function(e,t){var n=t.count,i=m(t,dr);return n&&(i.count=parseInt(n)),e===rr?this._genMsgParams(i):(n=t.keywordList,t=t.keywordListMatchType,i.keywords=n,i.keywordMatchType="and"===t?1:0,e===cr?this._genUserParams(i):i)}},{key:"_genMsgParams",value:function(e){var t=e.conversationID,n=e.timePosition,i=e.timePeriod;return e=m(e,hr),dt(t)||(kt(t)&&(e.account=t.replace(k.CONV_C2C,"")),St(t)&&(e.groupID=t.replace(k.CONV_GROUP,""))),ze(i)&&0<i&&(ze(n)&&0<n?e.startTime=n-i:e.startTime=Te()-i),e.startTime&&e.startTime<0&&(e.startTime=void 0),ze(n)&&0<n&&(e.endTime=n),e}},{key:"_genUserParams",value:function(e){var t=e.miniBirthday,n=e.maxBirthday;return e=m(e,pr),ze(t)&&(e.miniBirthday=parseInt(t),ze(n)||(e.maxBirthday=4294967295)),ze(n)&&(e.maxBirthday=parseInt(n)),e}},{key:"_genRes",value:function(e,t,n){switch(e){case rr:return this._genMsgRes(n.searchResult,!t.conversationID);case cr:return this._genUserRes(n.userList);case ur:return this._genGrpRes(n.groupList);case lr:return this._genMemberRes(n.groupMemberList);default:return[]}}},{key:"_genMsgRes",value:function(e,t){var n=this.get(11);return We(e)&&0!==e.length?e.map((function(e){var i=e.groupID,o=e.userID,a=e.messageCount,s=(e=void 0===(e=e.messageList)?[]:e,{conversationID:o=i?"".concat(k.CONV_GROUP).concat(i):"".concat(k.CONV_C2C).concat(o),messageCount:a,messageList:[]});return t&&1<a||0<(a=e.filter((function(e){return!!e}))).length&&(e=n.onRoamingMessage(a,o,!1),i&&e.reverse(),s.messageList=e,s.messageCount=e.length),s})):[]}},{key:"_genUserRes",value:function(e){var t=this.get(4)._profileHandler;if(!We(e))return[];for(var n=[],i=0,o=e.length;i<o;i++){var a=(s=e[i]).userID,s=s.profileItems;"@TLS#NOT_FOUND"!==a&&""!==a&&(a=t._update(a,t._getLatestProfileFromResponse(a,s)).latestProfile,n.push(a))}return n}},{key:"_genGrpRes",value:function(e){if(!We(e))return[];for(var t=[],n=0,i=e.length;n<i;n++)e[n]&&e[n].groupID&&t.push(new Ki(e[n]));return t}},{key:"_genMemberRes",value:function(e){if(!We(e))return[];for(var t,n,i,o,a,s,r=new Map,c=0,u=e.length;c<u;c++)e[c]&&e[c].userID&&e[c].groupID&&(n=(t=e[c]).groupID,o=t.name,a=t.type,s=t.avatar,i=t.nick,o={groupID:n,name:o,type:a,avatar:s},a={userID:t.userID,nick:i,nameCard:t.nameCard},r.has(n)?((s=r.get(n)).memberList.push(a),r.set(n,s)):r.set(n,{groupInfo:o,memberList:[a]}));return y(r.values())}}])),mr=a((function e(t){var n=this;i(this,e);var o,a=new ii("sdkConstruct"),s=(this._n="ModuleManager",this._isReady=!1,this._reason=Bn.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._map=new Map,this._optionalModuleMap=new Map,this._codeMsgForTUIMap=new Map,this._iEmitter=null,this._oEmitter=null,this._checkCount=0,this._checkTimer=-1,this._map.set(12,new Io(this,t)),this._map.set(37,new sr(this)),this._map.set(15,new Po(this)),this._map.set(27,new Qa(this)),this._map.set(23,new Ga(this)),this._map.set(24,new Xa(this)),this._map.set(26,new qa(this)),this._map.set(21,new Ma(this)),this._map.set(20,new Ua(this)),this._map.set(1,new Co(this)),this._map.set(2,new $o(this)),this._map.set(3,new Wo(this)),this._map.set(34,new Jo(this)),this._map.set(31,new Xo(this)),this._map.set(4,new yo(this)),this._map.set(6,new wi(this)),this._map.set(11,new Ji(this)),this._map.set(7,new lo(this)),this._map.set(10,new go(this)),this._map.set(13,new Lo(this)),this._map.set(32,new os(this)),this._map.set(14,new wo(this)),this._map.set(17,new Vo(this)),this._map.set(18,new Zo(this)),this._map.set(19,new Qo(this)),this._map.set(25,new xa(this)),this._map.set(8,new Ja(this)),this._map.set(28,new es(this)),this._map.set(36,new ts(this)),this._map.set(29,new ns(this)),this._map.set(30,new is(this)),this._map.set(33,new ds(this)),this._map.set(35,new fs(this)),this._map.set(38,new fr(this)),this._eventThrottleMap=new Map,this._eventThrottling=t.eventThrottling,this._map.get(12).isPartialUpdatedConvs()&&(this._eventThrottling=!1),$e(t.modules)?(Object.keys(t.modules).forEach((function(e){o=t.modules[e],"group-module"===e?n._map.set(7,new o(n)):"relationship-module"===e?n._map.set(8,new o(n)):"signaling-module"===e?n._map.set(33,new o(n)):"follow-module"===e?n._map.set(35,new o(n)):"cloud-search-module"===e&&n._map.set(38,new o(n)),n._optionalModuleMap.set(e,1)})),this._map.get(12).setUsingChatCore(!0)):this._map.has(7)||this._map.get(12).setUsingChatCore(!0),t.instanceID),r=t.SDKAppID,c=this._map.get(12).isIntl(),u=this._map.get(12).isUsingChatCore();s="instanceID:".concat(s," SDKAppID:").concat(r," isIntl:").concat(c," isUsingChatCore:").concat(u," host:").concat(Rt())+" isIOSWebView:".concat(_e," platform:").concat(ae," canIUseInflate:").concat(this.canIUseInflate())+" workerAvailable:".concat(ge," eventThrottling:").concat(this._eventThrottling," UserAgent:").concat(oe),ii.bindEventStatModule(this._map.get(14)),ii.bindNetMonitorModule(this._map.get(15)),a.setMessage("".concat(s," ").concat(function(){var e="";if(Q)try{var t=ie.getSystemInfoSync(),n=t.model,i=t.version,o=t.system,a=t.platform,s=t.SDKVersion;e="model:".concat(n," version:").concat(i," system:").concat(o," platform:").concat(a," SDKVersion:").concat(s)}catch(r){e=""}return e}())).end(),Re.i("SDK ".concat(s)),Fn.prototype._getErrMsg=this.getErrMsg.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}),[{key:"_startTimer",value:function(){var e=this._map.get(24),t=e.isWorkerEnabled();Re.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),Re.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var e=this._map.get(24),t=e.isWorkerEnabled();Re.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){Re.l("".concat(this._n,"._stopMainThreadTimer")),0<this._checkTimer&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){Re.l("".concat(this._n,"._stopMainThreadSocket"));var e=this._map.get(21);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:"_startMainThreadSocket",value:function(){Re.l("".concat(this._n,"._startMainThreadSocket"));var e=this._map.get(21);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){Re.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){Re.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var e,t=s(this._map);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(i){t.e(i)}finally{t.f()}}},{key:"_initReadyList",value:function(){var e=this;this._readyList=[this._map.get(1)],this._readyList.forEach((function(t){t.ready((function(){return e._onModuleReady()}))}))}},{key:"_onModuleReady",value:function(){var e,t,n=!0;this._readyList.forEach((function(e){e.isReady()||(n=!1)})),n&&!this._isReady&&(this._isReady=!0,this._oEmitter.emit(T.SDK_READY),e=Date.now()-this._startLoginTs,Re.w("SDK is ready. cost ".concat(e," ms")),this._startLoginTs=Date.now(),t=this._ssoLogForReady.getStartTs()+Se,this._ssoLogForReady.setMessage(e).start(t).end())}},{key:"login",value:function(){0===this._startLoginTs&&(Ee(),this._startLoginTs=Date.now(),this._startTimer(),this._map.get(15).start(),this._ssoLogForReady=new ii("sdkReady"),this._reason=Bn.LOGGING_IN)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOEmitInst",value:function(){return null===this._oEmitter&&(this._oEmitter=new xo,e=this._oEmitter,Vn=e,this._oEmitter._emit=this._oEmitter.emit,this._oEmitter.emit=function(e,t){var n,i,o=this;this._canIUseSignaling()&&(e===T.MESSAGE_RECEIVED&&this.get(33).onNewMessageList(t),e===T.MESSAGE_MODIFIED)&&this.get(33).onMessageModified(t),e===T.CONVERSATION_LIST_UPDATED||e===T.FRIEND_LIST_UPDATED||e===T.GROUP_LIST_UPDATED||e===T.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?!1!==this._eventThrottling?this._eventThrottleMap.has(e)?(n=Date.now())-(i=this._eventThrottleMap.get(e)).last<=1e3?(-1<i.timeoutID&&clearTimeout(i.timeoutID),i.timeoutID=setTimeout((function(){i.last=Date.now(),o._oEmitter._emit.apply(o._oEmitter,[e,{name:e,data:o._getEventData(e)}])}),1e3)):(i.last=n,this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:this._getEventData(e)}])):(this._eventThrottleMap.set(e,{last:Date.now(),timeoutID:-1}),this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:this._getEventData(e)}])):this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:this._getEventData(e)}]):this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:t}])}.bind(this)),this._oEmitter;var e}},{key:"_canIUseSignaling",value:function(){var e=this.get(33);return!!e&&e.canIUseSignaling()}},{key:"_getEventData",value:function(e){return e===T.CONVERSATION_LIST_UPDATED?this._map.get(12).isPartialUpdatedConvs()?this._map.get(11).getPartialUpdatedConvs():this._map.get(11).getLocalConvList():e===T.FRIEND_LIST_UPDATED?this._map.get(8).getLocalFriendList(!1):e===T.GROUP_LIST_UPDATED?this._map.get(7).getLocalGroupList():e===T.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._map.get(11).getTotalUnreadCount():e===T.CONVERSATION_ID_LIST_UPDATED?this._map.get(11).getUpdatedConvIDList():void 0}},{key:"getIEmitInst",value:function(){return null===this._iEmitter&&(this._iEmitter=new xo,this._iEmitter._emit=this._iEmitter.emit,this._iEmitter.emit=function(e,t){e=$e(t)&&t.data?[e,{name:e,data:t.data}]:[e,{name:e,data:t}],this._iEmitter._emit.apply(this._iEmitter,e)}.bind(this)),this._iEmitter}},{key:"hasModule",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"canIUseModule",value:function(e){return!this._map.get(12).isUsingChatCore()||this._optionalModuleMap.has(e)}},{key:"canIUseInflate",value:function(){return!!this._map.get(37)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.get(12).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(e){this._reason=e}},{key:"getErrMsg",value:function(e,t,n){return this._map.get(32).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:"warn",value:function(e,t,n){(e=this.getErrMsg(e,t,n))&&Re.w(e)}},{key:"onError",value:function(e){var t="code:".concat(e.code," message:").concat(e.message);Re.w("Oops! ".concat(t)),new ii("error").setMessage(t).setLevel("error").end(),this.getOEmitInst().emit(T.ERROR,e)}},{key:"restartTimer",value:function(){Re.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer();var e=this.get(7);e&&e.restartPolling()}},{key:"getTimerID",value:function(){var e=this._map.get(24);return e.isWorkerEnabled()?e.getTimerID():this._checkTimer}},{key:"getPollingTimerID",value:function(e){return this._map.get(7).getPollingTimerID(e)}},{key:"statTUIKeyFeatures",value:function(e){var t=e.code,n=t+(e=void 0===(e=e.msg)?"":e);this._codeMsgForTUIMap.has(n)||(this._codeMsgForTUIMap.set(n,1),n=this.get(12).getUIPlatform(),new ii("tui_key_features").setCode(t).setMessage(e).setUIPlatform(n).end())}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),Ee();var e,t=s(this._map);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2)[1];n.reset&&n.reset()}}catch(r){t.e(r)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._oEmitter.emit(T.SDK_NOT_READY);var i,o=s(this._eventThrottleMap);try{for(o.s();!(i=o.n()).done;){var a=v(i.value,2)[1];-1<a.timeoutID&&clearTimeout(a.timeoutID)}}catch(r){o.e(r)}finally{o.f()}this._eventThrottleMap.clear(),this._codeMsgForTUIMap.clear()}}]),_r=a((function e(t){i(this,e),this._funcMap=new Map,this._m=t,this._n="SafetyCallback",this._reportCount=0}),[{key:"defense",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;if("string"!=typeof e)return null;if(0===e.length)return null;if("function"!=typeof t)return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var i=null;return this._funcMap.get(e).has(t)?i=this._funcMap.get(e).get(t):(i=this._pack(e,t,n),this._funcMap.get(e).set(t,i)),i}},{key:"defenseOnce",value:function(e,t){return"function"!=typeof t?null:this._pack(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0)}},{key:"find",value:function(e,t){return"string"!=typeof e||0===e.length||"function"!=typeof t?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.warn("ListenerFnNotFound",e),null)}},{key:"delete",value:function(e,t){return"function"==typeof t&&!!this._funcMap.has(e)&&!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),0===this._funcMap.get(e).size&&this._funcMap.delete(e),!0)}},{key:"_pack",value:function(e,t,n){var i=this;return function(){try{t.apply(n,Array.from(arguments))}catch(s){var o=Object.values(T).indexOf(e),a="CallbackError";-1!==o&&(o=Object.keys(T)[o],i._m.warn(a,o,s)),i._reportCount<5&&(new ii(a).setMessage("eventName:".concat(e)).setMoreMessage(s.message).end(),i._reportCount+=1)}}}},{key:"destroy",value:function(){this._funcMap.clear()}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._reportCount=0}}]),vr=a((function e(t){i(this,e),t={SDKAppID:t.SDKAppID,unlimitedAVChatRoom:t.unlimitedAVChatRoom||!1,scene:t.scene||"",oversea:t.oversea||!1,instanceID:Lt(),devMode:t.devMode||!1,testEnv:t.testEnv||!1,proxyServer:t.proxyServer||void 0,fileUploadProxy:t.fileUploadProxy||void 0,fileDownloadProxy:t.fileDownloadProxy||t.fileUploadProxy||void 0,eventThrottling:!1!==t.eventThrottling,partialUpdatedConversations:!0===t.partialUpdatedConversations,disableIndependentDomain:!0===t.disableIndependentDomain,modules:t.modules||void 0},this._m=new mr(t),this._safetyCallbackFactory=new _r(this._m)}),[{key:"onError",value:function(e){this._m.onError(e)}},{key:"login",value:function(e){return this._m.login(),this._get(1).login(e)}},{key:"logout",value:function(){var e=this;return this._get(1).logout().then((function(t){return e._safetyCallbackFactory.reset(),e._m.reset(),t}))}},{key:"getLoginUser",value:function(){return this._get(1).getLoginUser()}},{key:"getServerTime",value:function(){return De()}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrMsg",value:function(e,t,n){return this._m.getErrMsg(e,t,n)}},{key:"_get",value:function(e){return this._m.get(e)}},{key:"destroy",value:function(){var e=this,t=this._get(12),n=t.getSDKAppID();return Re.w("destroy ".concat(n," ").concat(t.getInstanceID())),this.logout().finally((function(){e._safetyCallbackFactory.destroy(),e._m.stopTimer(),e._get(24).terminate(),e._get(21).dealloc(),e._m.getOEmitInst().emit(T.SDK_DESTROY,{SDKAppID:n})}))}},{key:"on",value:function(e,t,n){Re.d("on","eventName:".concat(e)),this._m.getOEmitInst().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"once",value:function(e,t,n){Re.d("once","eventName:".concat(e)),this._m.getOEmitInst().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:"off",value:function(e,t,n,i){Re.d("off","eventName:".concat(e));var o=this._safetyCallbackFactory.find(e,t);null!==o&&(this._m.getOEmitInst().off(e,o,n,i),this._safetyCallbackFactory.delete(e,t))}},{key:"registerPlugin",value:function(e){(dt(e["tim-push"])?dt(e["tim-offline-push-plugin"])?this._get(18):this._get(28):this._get(36)).registerPlugin(e)}},{key:"setLogLevel",value:function(e){var t;e<=0&&((t=this.getErrMsg("TIM_ASCII_ART"))&&c("log","at node_modules/@tencentcloud/chat/index.js:1",t),(t=this.getErrMsg("API_REFER"))&&(qt()?c("log","at node_modules/@tencentcloud/chat/index.js:1","%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",t):c("log","at node_modules/@tencentcloud/chat/index.js:1","IM SDK API ->",t)),(t=this.getErrMsg("DOCS_GUIDE"))&&c("log","at node_modules/@tencentcloud/chat/index.js:1",t),t=this.getErrMsg("IOS_WEBVIEW_WARNING"),_e)&&t&&c("warn","at node_modules/@tencentcloud/chat/index.js:1",t),Re.setLevel(e)}},{key:"createTextMessage",value:function(e){return this._get(2).createTextMessage(e)}},{key:"createTextAtMessage",value:function(e){return this._get(2).createTextMessage(e)}},{key:"createImageMessage",value:function(e){return this._get(2).createImageMessage(e)}},{key:"createAudioMessage",value:function(e){return this._get(2).createAudioMessage(e)}},{key:"createVideoMessage",value:function(e){return this._get(2).createVideoMessage(e)}},{key:"createCustomMessage",value:function(e){return this._get(2).createCustomMessage(e)}},{key:"createFaceMessage",value:function(e){return this._get(2).createFaceMessage(e)}},{key:"createFileMessage",value:function(e){return this._get(2).createFileMessage(e)}},{key:"createLocationMessage",value:function(e){return this._get(2).createLocationMessage(e)}},{key:"createMergerMessage",value:function(e){return this._get(2).createMergerMessage(e)}},{key:"downloadMergerMessage",value:function(e){return e.type!==k.MSG_MERGER?kn({code:Bn.MSG_MERGER_TYPE_INVALID}):je(e.payload.downloadKey)?kn({code:Bn.MSG_MERGER_KEY_INVALID}):this._get(2).downloadMergerMessage(e).catch((function(e){return kn({code:Bn.MSG_MERGER_DOWNLOAD_FAIL})}))}},{key:"createForwardMessage",value:function(e){return this._get(2).createForwardMessage(e)}},{key:"sendMessage",value:function(e,t){return e instanceof ki?this._get(2).sendMessageInstance(e,t):kn({code:Bn.MSG_INSTANCE_REQUIRED})}},{key:"callExperimentalAPI",value:function(e,t){return"sendComboMessage"===e?this._get(31).sendMessage(t):"handleGroupInvitation"===e?this._get(7).handleGroupInvitation(t):"isCommercialAbilityEnabled"===e?this._get(27).isFeatureEnabled(t):"isFeatureEnabledForStat"===e?this._get(27).isFeatureEnabledForStat(t):"isIntl"===e?this.isIntl():"sendTRTCCustomData"===e||"sendRoomCustomData"===e?this._get(30).sendTRTCCustomData(t):"getTimerID"===e?this._m.getTimerID():"getPollingTimerID"===e?this._m.getPollingTimerID(t):"setApplicationID"===e?(this._get(12).setApplicationID(t),void this._get(20).updateProtocolConfig()):"getServerConfig"===e?this._get(23).getServerConfig(t):"canIUseModule"===e?this._m.canIUseModule(t):"startMessageLongPolling"===e?this._get(7).startMessageLongPolling(t):"stopMessageLongPolling"===e?this._get(7).stopMessageLongPolling(t):"disableMessagePullOnInvite"===e?this._get(11).disableMsgPullOnInvite(t):"clearLocalMessage"===e?this._get(11).clearMemMsg(t,!1):"setCustomLoginInfo"===e?this._get(12).setCustomLoginInfo(t):"statTUIKeyFeatures"===e?this._m.statTUIKeyFeatures(t):"getGroupReceiptsByUsers"===e?this._get(7).getGroupReceiptsByUsers(t):kn({code:Bn.INVALID_OPERATION})}},{key:"revokeMessage",value:function(e){return this._get(2).revokeMessage(e)}},{key:"resendMessage",value:function(e,t){return e instanceof ki?this._get(2).resendMessage(e,t):kn({code:Bn.MSG_INSTANCE_REQUIRED})}},{key:"deleteMessage",value:function(e){return this._get(2).deleteMessage(e)}},{key:"translateText",value:function(e){return this._get(2).translateText(e)}},{key:"convertVoiceToText",value:function(e){return this._get(2).convertVoiceToText(e)}},{key:"setMessageExtensions",value:function(e,t){return this._get(3).setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this._get(3).getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this._get(3).deleteMessageExtensions(e,t)}},{key:"addMessageReaction",value:function(e,t){return this._get(34).addMessageReaction(e,t)}},{key:"removeMessageReaction",value:function(e,t){return this._get(34).removeMessageReaction(e,t)}},{key:"getMessageReactions",value:function(e){return this._get(34).getMessageReactions(e)}},{key:"getAllUserListOfMessageReaction",value:function(e){return this._get(34).getAllUserListOfMessageReaction(e)}},{key:"modifyMessage",value:function(e){return this._get(2).modifyRemoteMessage(e)}},{key:"getMessageList",value:function(e){return this._get(11).getMessageList(e)}},{key:"getMessageListHopping",value:function(e){return this._get(11).getMessageListHopping(e)}},{key:"sendMessageReadReceipt",value:function(e){return this._get(11).sendReadReceipt(e)}},{key:"getMessageReadReceiptList",value:function(e){return this._get(11).getReadReceiptList(e)}},{key:"getGroupMessageReadMemberList",value:function(e){var t=this._get(7);return t?t.getReadReceiptDetail(e):kn({code:Bn.NO_MODULE})}},{key:"findMessage",value:function(e){return this._get(11).findMessage(e)}},{key:"setMessageRead",value:function(e){return this._get(11).setMessageRead(e)}},{key:"getConversationList",value:function(e){return this._get(11).getConvList(e)}},{key:"getConversationProfile",value:function(e){return this._get(11).getConversationProfile(e)}},{key:"deleteConversation",value:function(e){return this._get(11).deleteConversation(e)}},{key:"setConversationDraft",value:function(e){return this._get(11).setConvDraft(e)}},{key:"clearHistoryMessage",value:function(e){return this._get(11).clearHistoryMessage(e)}},{key:"pinConversation",value:function(e){return this._get(11).pinConversation(e)}},{key:"setAllMessageRead",value:function(e){return this._get(11).setAllMessageRead(e)}},{key:"setMessageRemindType",value:function(e){return this._get(11).setMessageRemindType(e)}},{key:"setAllReceiveMessageOpt",value:function(e){return this._get(11).setAllRcvMsgOpt(e)}},{key:"getAllReceiveMessageOpt",value:function(){return this._get(11).getAllRcvMsgOpt()}},{key:"getTotalUnreadMessageCount",value:function(){return this._get(11).getTotalUnreadCount()}},{key:"setConversationCustomData",value:function(e){return this._get(11).setConvCustomData(e)}},{key:"markConversation",value:function(e){return this._get(11).markConv(e)}},{key:"getConversationGroupList",value:function(){return this._get(11).getConvGroupList()}},{key:"createConversationGroup",value:function(e){return this._get(11).createConvGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._get(11).deleteConvGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._get(11).renameConvGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._get(11).addConvsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._get(11).deleteConvsFromGroup(e)}},{key:"searchCloudMessages",value:function(e){var t=this._get(38);return t?t.searchCloudMessages(e):kn({code:Bn.NO_MODULE})}},{key:"searchCloudUsers",value:function(e){var t=this._get(38);return t?t.searchCloudUsers(e):kn({code:Bn.NO_MODULE})}},{key:"searchCloudGroups",value:function(e){var t=this._get(38);return t?t.searchCloudGroups(e):kn({code:Bn.NO_MODULE})}},{key:"searchCloudGroupMembers",value:function(e){var t=this._get(38);return t?t.searchCloudGroupMembers(e):kn({code:Bn.NO_MODULE})}},{key:"getMyProfile",value:function(){return this._get(4).getMyProfile()}},{key:"getUserProfile",value:function(e){return this._get(4).getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._get(4).updateMyProfile(e)}},{key:"getBlacklist",value:function(){return this._get(4).getLocalBlacklist()}},{key:"addToBlacklist",value:function(e){return this._get(4).addBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this._get(4).deleteBlacklist(e)}},{key:"setSelfStatus",value:function(e){return this._get(4).setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._get(4).getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._get(4).subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._get(4).unsubscribeUserStatus(e)}},{key:"getFriendList",value:function(){var e=this._get(8);return e?e.getLocalFriendList():kn({code:Bn.NO_MODULE})}},{key:"addFriend",value:function(e){var t=this._get(8);return t?t.addFriend(e):kn({code:Bn.NO_MODULE})}},{key:"deleteFriend",value:function(e){var t=this._get(8);return t?t.deleteFriend(e):kn({code:Bn.NO_MODULE})}},{key:"checkFriend",value:function(e){var t=this._get(8);return t?t.checkFriend(e):kn({code:Bn.NO_MODULE})}},{key:"getFriendProfile",value:function(e){var t=this._get(8);return t?t.getFriendProfile(e):kn({code:Bn.NO_MODULE})}},{key:"updateFriend",value:function(e){var t=this._get(8);return t?t.updateFriend(e):kn({code:Bn.NO_MODULE})}},{key:"getFriendApplicationList",value:function(){var e=this._get(8);return e?e.getLocalFriendApplicationList():kn({code:Bn.NO_MODULE})}},{key:"acceptFriendApplication",value:function(e){var t=this._get(8);return t?t.acceptFriendApplication(e):kn({code:Bn.NO_MODULE})}},{key:"refuseFriendApplication",value:function(e){var t=this._get(8);return t?t.refuseFriendApplication(e):kn({code:Bn.NO_MODULE})}},{key:"deleteFriendApplication",value:function(e){var t=this._get(8);return t?t.deleteFriendApplication(e):kn({code:Bn.NO_MODULE})}},{key:"setFriendApplicationRead",value:function(){var e=this._get(8);return e?e.setFriendApplicationRead():kn({code:Bn.NO_MODULE})}},{key:"getFriendGroupList",value:function(){var e=this._get(8);return e?e.getLocalFriendGroupList():kn({code:Bn.NO_MODULE})}},{key:"createFriendGroup",value:function(e){var t=this._get(8);return t?t.createFriendGroup(e):kn({code:Bn.NO_MODULE})}},{key:"deleteFriendGroup",value:function(e){var t=this._get(8);return t?t.deleteFriendGroup(e):kn({code:Bn.NO_MODULE})}},{key:"addToFriendGroup",value:function(e){var t=this._get(8);return t?t.addToFriendGroup(e):kn({code:Bn.NO_MODULE})}},{key:"removeFromFriendGroup",value:function(e){var t=this._get(8);return t?t.removeFromFriendGroup(e):kn({code:Bn.NO_MODULE})}},{key:"renameFriendGroup",value:function(e){var t=this._get(8);return t?t.renameFriendGroup(e):kn({code:Bn.NO_MODULE})}},{key:"followUser",value:function(e){var t=this._get(35);return t?t.followUser(e):kn({code:Bn.NO_MODULE})}},{key:"unfollowUser",value:function(e){var t=this._get(35);return t?t.unfollowUser(e):kn({code:Bn.NO_MODULE})}},{key:"getMyFollowersList",value:function(e){var t=this._get(35);return t?t.getMyFollowersList(e):kn({code:Bn.NO_MODULE})}},{key:"getMyFollowingList",value:function(e){var t=this._get(35);return t?t.getMyFollowingList(e):kn({code:Bn.NO_MODULE})}},{key:"getMutualFollowersList",value:function(e){var t=this._get(35);return t?t.getMutualFollowersList(e):kn({code:Bn.NO_MODULE})}},{key:"getUserFollowInfo",value:function(e){var t=this._get(35);return t?t.getUserFollowInfo(e):kn({code:Bn.NO_MODULE})}},{key:"checkFollowType",value:function(e){var t=this._get(35);return t?t.checkFollowType(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupList",value:function(){var e=this._get(7);return e?e.getGroupList():kn({code:Bn.NO_MODULE})}},{key:"getGroupProfile",value:function(e){var t=this._get(7);return t?t.getGroupProfile(e):kn({code:Bn.NO_MODULE})}},{key:"createGroup",value:function(e){var t=this._get(7);return t?t.createGroup(e):kn({code:Bn.NO_MODULE})}},{key:"dismissGroup",value:function(e){var t=this._get(7);return t?t.dismissGroup(e):kn({code:Bn.NO_MODULE})}},{key:"updateGroupProfile",value:function(e){var t=this._get(7);return t?t.updateGroupProfile(e):kn({code:Bn.NO_MODULE})}},{key:"joinGroup",value:function(e){var t=this._get(7);return t?t.joinGroup(e):kn({code:Bn.NO_MODULE})}},{key:"quitGroup",value:function(e){var t=this._get(7);return t?t.quitGroup(e):kn({code:Bn.NO_MODULE})}},{key:"searchGroupByID",value:function(e){var t=this._get(7);return t?t.searchGroupByID(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._get(7);return t?t.getGroupOnlineMemberCount(e):kn({code:Bn.NO_MODULE})}},{key:"changeGroupOwner",value:function(e){var t=this._get(7);return t?t.changeGroupOwner(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupApplicationList",value:function(){var e=this._get(7);return e?e.getGroupApplicationList():kn({code:Bn.NO_MODULE})}},{key:"handleGroupApplication",value:function(e){var t=this._get(7);return t?t.handleGroupApplication(e):kn({code:Bn.NO_MODULE})}},{key:"initGroupAttributes",value:function(e){var t=this._get(7);return t?t.initGroupAttributes(e):kn({code:Bn.NO_MODULE})}},{key:"setGroupAttributes",value:function(e){var t=this._get(7);return t?t.setGroupAttributes(e):kn({code:Bn.NO_MODULE})}},{key:"deleteGroupAttributes",value:function(e){var t=this._get(7);return t?t.deleteGroupAttributes(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupAttributes",value:function(e){var t=this._get(7);return t?t.getGroupAttributes(e):kn({code:Bn.NO_MODULE})}},{key:"setGroupCounters",value:function(e){var t=this._get(7);return t?t.setGroupCounters(e):kn({code:Bn.NO_MODULE})}},{key:"increaseGroupCounter",value:function(e){var t=this._get(7);return t?t.increaseGroupCounter(e):kn({code:Bn.NO_MODULE})}},{key:"decreaseGroupCounter",value:function(e){var t=this._get(7);return t?t.decreaseGroupCounter(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupCounters",value:function(e){var t=this._get(7);return t?t.getGroupCounters(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupMemberList",value:function(e){var t=this._get(7);return t?t.getGroupMemberList(e):kn({code:Bn.NO_MODULE})}},{key:"getGroupMemberProfile",value:function(e){var t=this._get(7);return t?t.getGroupMemberProfile(e):kn({code:Bn.NO_MODULE})}},{key:"addGroupMember",value:function(e){var t=this._get(7);return t?t.addGroupMember(e):kn({code:Bn.NO_MODULE})}},{key:"deleteGroupMember",value:function(e){var t=this._get(7);return t?t.deleteGroupMember(e):kn({code:Bn.NO_MODULE})}},{key:"setGroupMemberMuteTime",value:function(e){var t=this._get(7);return t?t.setGroupMemberMuteTime(e):kn({code:Bn.NO_MODULE})}},{key:"setGroupMemberRole",value:function(e){var t=this._get(7);return t?t.setGroupMemberRole(e):kn({code:Bn.NO_MODULE})}},{key:"setGroupMemberNameCard",value:function(e){var t=this._get(7);return t?t.setGroupMemberNameCard(e):kn({code:Bn.NO_MODULE})}},{key:"setGroupMemberCustomField",value:function(e){var t=this._get(7);return t?t.setGroupMemberCustomField(e):kn({code:Bn.NO_MODULE})}},{key:"markGroupMemberList",value:function(e){var t=this._get(7);return t?t.markGroupMemberList(e):kn({code:Bn.NO_MODULE})}},{key:"getJoinedCommunityList",value:function(){return this._get(10).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(e){return this._get(10).createTopicInCommunity(e)}},{key:"deleteTopicFromCommunity",value:function(e){return this._get(10).deleteTopicFromCommunity(e)}},{key:"updateTopicProfile",value:function(e){return this._get(10).updateTopicProfile(e)}},{key:"getTopicList",value:function(e){return this._get(10).getTopicList(e)}},{key:"addSignalingListener",value:function(e,t,n){var i=this._get(33);i&&i.addSignalingListener(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"removeSignalingListener",value:function(e,t,n){var i,o=this._safetyCallbackFactory.find(e,t);null!==o&&(i=this._get(33))&&(i.removeSignalingListener(e,o,n),this._safetyCallbackFactory.delete(e,t))}},{key:"invite",value:function(e){var t=this._get(33);return t?t.invite(e):kn({code:Bn.NO_MODULE})}},{key:"inviteSync",value:function(e,t,n){var i=this._get(33);return i?i.inviteSync(e,t,n):""}},{key:"inviteInGroup",value:function(e){var t=this._get(33);return t?t.invite(e):kn({code:Bn.NO_MODULE})}},{key:"inviteInGroupSync",value:function(e,t,n){var i=this._get(33);return i?i.inviteSync(e,t,n):""}},{key:"cancel",value:function(e){var t=this._get(33);return t?t.cancel(e):kn({code:Bn.NO_MODULE})}},{key:"accept",value:function(e){var t=this._get(33);return t?t.accept(e):kn({code:Bn.NO_MODULE})}},{key:"reject",value:function(e){var t=this._get(33);return t?t.reject(e):kn({code:Bn.NO_MODULE})}},{key:"getSignalingInfo",value:function(e){var t=this._get(33);return t?t.getSignalingInfo(e):null}},{key:"modifyInvitation",value:function(e){var t=this._get(33);return t?t.modifyInvitation(e):kn({code:Bn.NO_MODULE})}}]),yr={login:1,logout:1,getLoginUser:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1,isReady:1,addSignalingListener:1,removeSignalingListener:1,callExperimentalAPI:1};function Ir(e){return i(this,Ir),(e=n(this,Ir,[e]))._n="CSModule",e}var Mr={};return(Pn={}).create=function(e){var t,n,i,o="TencentCloudChat.create",a=0;if(ze(i=e.SDKAppID))a=i;else if(a=parseInt(i),isNaN(i))return Re.e("".concat(o," failed. Failed to parse the SDKAppID, please check the arguments")),null;return a&&Mr[a]?Mr[a]:(Re.l("".concat(o)),(i=new vr(f(f({},e),{},{SDKAppID:a}))).on(T.SDK_DESTROY,(function(e){Mr[e.data.SDKAppID]=null,delete Mr[e.data.SDKAppID]})),t=i,n=Object.create(null),Object.keys(xn).forEach((function(e){var i;t[e]&&(i=new D,n[e]=function(){var n=Array.from(arguments);return i.use((function(n,i){s=e;var o,a,s=!(!(o=t).isReady()&&1!==yr[s])||(a={code:a=o.getNotReadyReason(),message:"".concat(o.getErrMsg(a)," | ").concat(s," | ").concat(o.getErrMsg(Bn.SDK_IS_NOT_READY))},o.onError(a),a);return!0===s?i():kn(s)})).use((function(t,n){if(!0===function(e,t,n){if(void 0===t)return!0;var i=!0;if($e(t))Object.keys(t).forEach((function(o){var a=1===e.length?e[0][o]:void 0;i=!!Wt(a,t[o],n,o)&&i}));else if(We(t))for(var o=0;o<t.length;o++)i=!!Wt(e[o],t[o],n,t[o].name)&&i;if(i)return i;throw new Error("Params validate failed.")}(t,Gn[e],e))return n()})).use((function(n,i){return t[e].apply(t,n)})),i.run(n)})})),e=n,Mr[a]=e,Gn.hookGetAPITips(i.getErrMsg.bind(i)),Re.l("".concat(o," ok")),e)},Pn.TYPES=k,Pn.EVENT=T,Pn.TSignaling=S,Pn.VERSION="3.5.5",Re.l("TencentCloudChat.VERSION:".concat(Pn.VERSION)),Pn}();const po=lo(ho.exports);var go={exports:{}};!function(e){e.exports=function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=void 0!==uo?uo:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},l="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),d="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),h="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),p="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),g="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),f="undefined"!=typeof uni&&"undefined"==typeof window&&!0,m=f&&"ios"===uni.getDeviceInfo().platform.toLocaleLowerCase(),_=(f&&uni.getDeviceInfo().platform.toLocaleLowerCase(),l||d||h||p||g||f),v=void 0!==u&&(void 0!==u.nativeModuleProxy||void 0!==u.ReactNative),y=d?qq:h?tt:p?swan:g?my:l?wx:f?uni:{},I=function(e){if("object"!==n(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var i=t;null!==Object.getPrototypeOf(i);)i=Object.getPrototypeOf(i);return t===i};function M(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(I(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}var C=function(){function e(){i(this,e),this._n="WebRequest"}return a(e,[{key:"request",value:function(e,n){var i=this,o="".concat(this._n,".request"),a=e.downloadUrl||"",s=(e.method||"PUT").toUpperCase(),r=e.url;if(c("log","at node_modules/tim-upload-plugin/index.js:1","%c tim-upload-plugin %c","background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent","".concat(o," URL:").concat(r)),e.qs){var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"=";return M(e)?"":I(e)?Object.keys(e).map((function(i){var o=encodeURIComponent(i)+n;return Array.isArray(e[i])?e[i].map((function(e){return o+encodeURIComponent(e)})).join(t):o+encodeURIComponent(e[i])})).filter(Boolean).join(t):void 0}(e.qs);u&&(r+="".concat(-1===r.indexOf("?")?"?":"&").concat(u))}var l=new XMLHttpRequest;l.open(s,r,!0),l.responseType=e.dataType||"text";var d=e.headers||{};if(e.uploadByIP&&(d=t(t({},d),{},{host:e.uploadIP})),!M(d))for(var h in d)d.hasOwnProperty(h)&&"content-length"!==h.toLowerCase()&&"user-agent"!==h.toLowerCase()&&"origin"!==h.toLowerCase()&&"host"!==h.toLowerCase()&&l.setRequestHeader(h,d[h]);return l.onload=function(){if(200===l.status)n(null,i._xhrRes(l,i._xhrBody(l,a,e.uploadByIP&&e.uploadIP),d));else{if(e.uploadIP&&-1===e.url.indexOf(e.uploadIP))return e.url=(o=e.url,s=e.uploadIP,o.replace(/^http(s)?:\/\/(.*?)\//,"https://".concat(s,"/"))),e.uploadByIP=!0,i.request(e,n);var t={code:l.status,message:JSON.stringify(l.responseText)};n(t,i._xhrRes(l,i._xhrBody(l,a,e.uploadByIP&&e.uploadIP),d))}var o,s},l.onerror=function(t){var o=i._xhrBody(l,a,e.uploadByIP&&e.uploadIP),s={code:l.status,message:JSON.stringify(l.responseText)};o||l.statusText||0!==l.status||(t.message="CORS blocked or network error"),n(s,i._xhrRes(l,o)),s=null},e.onProgress&&l.upload&&(l.upload.onprogress=function(t){var n=t.total,i=t.loaded,o=Math.floor(100*i/n);e.onProgress({total:n,loaded:i,percent:(o>=100?100:o)/100})}),l.send(e.resources),l}},{key:"_xhrRes",value:function(e,t){var n={};return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){if(e){var t=e.indexOf(":"),i=e.substr(0,t).trim().toLowerCase(),o=e.substr(t+1).trim();n[i]=o}})),{statusCode:e.status,statusMessage:e.statusText,headers:n,data:t}}},{key:"_xhrBody",value:function(e,t,n){return 200===e.status&&t?{location:t,uploadIP:n}:{response:e.responseText,uploadIP:n}}}]),e}(),E=["unknown","image","video","audio","log"],T=["name"],k=function(){function e(){i(this,e)}return a(e,[{key:"request",value:function(e,n){var i=this,o=e.resources,a=void 0===o?"":o,s=e.headers,c=void 0===s?{}:s,u=e.url,l=e.downloadUrl,d=void 0===l?"":l,h=u,p=null,f=d.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),_=decodeURIComponent(f[3]),v=_.indexOf("?")>-1?_.split("?")[0]:_,I={key:e.fileKey?e.fileKey:v,success_action_status:200,"Content-Type":""},M={};if(m){var C=u.split("?sign=");if(C.length>1){var k=C[1];h="".concat(C[0],"?sign=").concat(encodeURIComponent("".concat(k))),M.sign=decodeURIComponent(k),M.signature=decodeURIComponent(k)}}var S={url:h,header:c,name:"file",filePath:a,formData:t(t({},I),M),timeout:e.timeout||3e5};if(g){var D=S;D.name,S=t(t({},r(D,T)),{},{fileName:"file",fileType:E[e.fileType]})}return(p=y.uploadFile(t(t({},S),{},{success:function(e){i._handleResponse({response:e,downloadUrl:d,callback:n})},fail:function(e){i._handleResponse({response:e,downloadUrl:d,callback:n})}}))).onProgressUpdate&&p.onProgressUpdate((function(t){e.onProgress&&e.onProgress({total:t.totalBytesExpectedToSend,loaded:t.totalBytesSent,percent:Math.floor(t.progress)/100})})),p}},{key:"_handleResponse",value:function(e){var n=e.downloadUrl,i=e.response,o=e.callback,a=i.header,s={};if(a)for(var r in a)a.hasOwnProperty(r)&&(s[r.toLowerCase()]=a[r]);var c=+i.statusCode;200===c?o(null,{statusCode:c,headers:s,data:t(t({},i.data),{},{location:n})}):o({code:c,message:JSON.stringify(i.data)},{statusCode:c,headers:s,data:void 0})}}]),e}(),S=function(){function e(){i(this,e)}return a(e,[{key:"request",value:function(e,t){var n=this,i=e.resources,o=void 0===i?"":i,a=e.fileKey,s=void 0===a?"":a,r=e.url,c=e.downloadUrl,u=void 0===c?"":c,l=new FormData;l.append("key",s),l.append("success_action_status",200),l.append("file",{uri:o,type:"application/octet-stream",name:"uploaded_file"}),fetch(r,{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:l}).then((function(e){n._handleResponse({response:e,downloadUrl:u,callback:t})})).catch((function(e){n._handleResponse({response:e,downloadUrl:u,callback:t})}))}},{key:"_handleResponse",value:function(e){var t=e.downloadUrl,n=e.response,i=e.callback,o=n.headers,a=n.status,s=o&&o.map||{};200===a?i(null,{statusCode:200,headers:s,data:{location:t}}):i({code:a,message:JSON.stringify(n)},{statusCode:a,headers:s,data:void 0})}}]),e}();return function(){function e(){i(this,e),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=_?new k:v?new S:new C,c("log","at node_modules/tim-upload-plugin/index.js:1","TIMUploadPlugin.VERSION: ".concat("1.4.2"))}return a(e,[{key:"uploadFile",value:function(e,t){var n=this;return this.httpRequest.request(e,(function(i,o){i&&n.tryCount<n.retry&&n.allowRetry(i)?(n.tryCount++,n.uploadFile(e,t)):(n.tryCount=0,t(i,o))}))}},{key:"allowRetry",value:function(e){var t=!1,n=!1;if(e){var i=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var o=e.error&&e.error.Code,a=e.error&&e.error.Message;("RequestTimeTooSkewed"===o||"AccessDenied"===o&&"Request has expired"===a)&&(n=!0)}catch(c){}if(n&&i){var s=Date.now(),r=Date.parse(i);Math.abs(s+this.systemClockOffset-r)>=3e4&&(this.systemClockOffset=r-s,t=!0)}else 5===Math.floor(e.statusCode/100)&&(t=!0)}return t}}],[{key:"getVersion",value:function(){return"1.4.2"}}]),e}()}()}(go);const fo=lo(go.exports);var mo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,0,62,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,63,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];const _o={getRandomValues(e){if(!(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8ClampedArray))throw new Error("Expected an integer array");if(e.byteLength>65536)throw new Error("Can only request a maximum of 65536 bytes");return function(e,t){for(var n,i=e.length,o="="===e[i-2]?2:"="===e[i-1]?1:0,a=0,s=i-o&4294967292,r=0;r<s;r+=4)n=mo[e.charCodeAt(r)]<<18|mo[e.charCodeAt(r+1)]<<12|mo[e.charCodeAt(r+2)]<<6|mo[e.charCodeAt(r+3)],t[a++]=n>>16&255,t[a++]=n>>8&255,t[a++]=255&n;1===o&&(n=mo[e.charCodeAt(r)]<<10|mo[e.charCodeAt(r+1)]<<4|mo[e.charCodeAt(r+2)]>>2,t[a++]=n>>8&255,t[a++]=255&n),2===o&&(n=mo[e.charCodeAt(r)]<<2|mo[e.charCodeAt(r+1)]>>4,t[a++]=255&n)}(r("DCloud-Crypto").getRandomValues(e.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e}};var vo={exports:{}};!function(e){e.exports=function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=void 0,"symbol"==typeof(o=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i.key,"string"))?o:String(o)),i)}var o}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,a,s,r=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(l){u=!0,o=l}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return r}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,s=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw s}}}}var u,l,d=function(){for(var e=" \t\r\n~!@#$%^&*()_+-=【】、{}|;':\"，。、《》？αβγδεζηθικλμνξοπρστυφχψωΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ。，、；：？！…—·ˉ¨‘’“”々～‖∶＂＇｀｜〃〔〕〈〉《》「」『』．〖〗【】（）［］｛｝ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅪⅫ⒈⒉⒊⒋⒌⒍⒎⒏⒐⒑⒒⒓⒔⒕⒖⒗⒘⒙⒚⒛㈠㈡㈢㈣㈤㈥㈦㈧㈨㈩①②③④⑤⑥⑦⑧⑨⑩⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂⒃⒄⒅⒆⒇≈≡≠＝≤≥＜＞≮≯∷±＋－×÷／∫∮∝∞∧∨∑∏∪∩∈∵∴⊥∥∠⌒⊙≌∽√§№☆★○●◎◇◆□℃‰€■△▲※→←↑↓〓¤°＃＆＠＼︿＿￣―♂♀┌┍┎┐┑┒┓─┄┈├┝┞┟┠┡┢┣│┆┊┬┭┮┯┰┱┲┳┼┽┾┿╀╁╂╃└┕┖┗┘┙┚┛━┅┉┤┥┦┧┨┩┪┫┃┇┋┴┵┶┷┸┹┺┻╋╊╉╈╇╆╅╄",t=new Map,n=0,i=e.length;n<i;n++)t.set(e.charCodeAt(0),!0);return t}(),h=function(){function t(n){e(this,t);var i,a=n.input,s=n.isArray,r=n.isMap;this._trieTree={},s(a)?i=a:r(a)&&(i=o(a.keys()),this._map=a);for(var c=0,u=i.length;c<u;c++)if(i[c]){for(var l=this._trieTree,d=i[c],h=0,p=d.length;h<p;h++)l[d[h]]||(l[d[h]]={}),l=l[d[h]];l.isEnd=!0}}return n(t,[{key:"filter",value:function(e){var t=e.text,n=e.replacingEnabled;if(0===Object.keys(this._trieTree).length)return{isMatched:!1,modifiedText:t};for(var i=this._trieTree,o=t.toLowerCase(),a="",s=!1,r=o.length,c=0;c<r;c++)if(!0!==d.get(o.charCodeAt(c))){for(var u=0,l="",h=!1,p=c;p<r;p++){if(!i[o[p]]){i=this._trieTree;break}if(l+=o[p],i[o[p]].isEnd){h=!0,u=p-c,i=this._trieTree;break}i=i[o[p]]}if(u>1&&(c+=u),h){if(s=!0,!n)break;var g=this._map.get(l)||"*";a=t.replace(new RegExp(l,"gi"),g)}}return{isMatched:s,modifiedText:a}}},{key:"reset",value:function(){this._trieTree={},this._map=null}}]),t}(),p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==uo?uo:"undefined"!=typeof self?self:{},g={},f=(u=function(e,t){var n,i,o,a,s,r,c,u,l,d,h,f,m;e.exports=(r=r||function(e){var t;if("undefined"!=typeof window&&_o&&(t=_o),!t&&"undefined"!=typeof window&&window.msCrypto&&(t=window.msCrypto),!t&&void 0!==p&&p.crypto&&(t=p.crypto),!t)try{t=g}catch(m){}var n=function(){if(t){if("function"==typeof t.getRandomValues)try{return t.getRandomValues(new Uint32Array(1))[0]}catch(m){}if("function"==typeof t.randomBytes)try{return t.randomBytes(4).readInt32LE()}catch(m){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},a=o.lib={},s=a.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},r=a.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,o=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<o;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<o;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],i=0;i<e;i+=4)t.push(n());return new r.init(t,e)}}),c=o.enc={},u=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var a=t[o>>>2]>>>24-o%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new r.init(n,t/2)}},l=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var a=t[o>>>2]>>>24-o%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new r.init(n,t)}},d=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},h=a.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,i=this._data,o=i.words,a=i.sigBytes,s=this.blockSize,c=a/(4*s),u=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*s,l=e.min(4*u,a);if(u){for(var d=0;d<u;d+=s)this._doProcessBlock(o,d);n=o.splice(0,u),i.sigBytes-=l}return new r.init(n,l)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(a.Hasher=h.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),o.algo={});return o}(Math),s=(a=r).lib.WordArray,a.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var o=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,r=0;r<4&&a+.75*r<n;r++)o.push(i.charAt(s>>>6*(3-r)&63));var c=i.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var a=n.charAt(64);if(a){var r=e.indexOf(a);-1!==r&&(t=r)}return function(e,t,n){for(var i=[],o=0,a=0;a<t;a++)if(a%4){var r=n[e.charCodeAt(a-1)]<<a%4*2|n[e.charCodeAt(a)]>>>6-a%4*2;i[o>>>2]|=r<<24-o%4*8,o++}return s.create(i,o)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var a=this._hash.words,r=e[t+0],c=e[t+1],p=e[t+2],g=e[t+3],f=e[t+4],m=e[t+5],_=e[t+6],v=e[t+7],y=e[t+8],I=e[t+9],M=e[t+10],C=e[t+11],E=e[t+12],T=e[t+13],k=e[t+14],S=e[t+15],D=a[0],b=a[1],A=a[2],L=a[3];D=u(D,b,A,L,r,7,s[0]),L=u(L,D,b,A,c,12,s[1]),A=u(A,L,D,b,p,17,s[2]),b=u(b,A,L,D,g,22,s[3]),D=u(D,b,A,L,f,7,s[4]),L=u(L,D,b,A,m,12,s[5]),A=u(A,L,D,b,_,17,s[6]),b=u(b,A,L,D,v,22,s[7]),D=u(D,b,A,L,y,7,s[8]),L=u(L,D,b,A,I,12,s[9]),A=u(A,L,D,b,M,17,s[10]),b=u(b,A,L,D,C,22,s[11]),D=u(D,b,A,L,E,7,s[12]),L=u(L,D,b,A,T,12,s[13]),A=u(A,L,D,b,k,17,s[14]),D=l(D,b=u(b,A,L,D,S,22,s[15]),A,L,c,5,s[16]),L=l(L,D,b,A,_,9,s[17]),A=l(A,L,D,b,C,14,s[18]),b=l(b,A,L,D,r,20,s[19]),D=l(D,b,A,L,m,5,s[20]),L=l(L,D,b,A,M,9,s[21]),A=l(A,L,D,b,S,14,s[22]),b=l(b,A,L,D,f,20,s[23]),D=l(D,b,A,L,I,5,s[24]),L=l(L,D,b,A,k,9,s[25]),A=l(A,L,D,b,g,14,s[26]),b=l(b,A,L,D,y,20,s[27]),D=l(D,b,A,L,T,5,s[28]),L=l(L,D,b,A,p,9,s[29]),A=l(A,L,D,b,v,14,s[30]),D=d(D,b=l(b,A,L,D,E,20,s[31]),A,L,m,4,s[32]),L=d(L,D,b,A,y,11,s[33]),A=d(A,L,D,b,C,16,s[34]),b=d(b,A,L,D,k,23,s[35]),D=d(D,b,A,L,c,4,s[36]),L=d(L,D,b,A,f,11,s[37]),A=d(A,L,D,b,v,16,s[38]),b=d(b,A,L,D,M,23,s[39]),D=d(D,b,A,L,T,4,s[40]),L=d(L,D,b,A,r,11,s[41]),A=d(A,L,D,b,g,16,s[42]),b=d(b,A,L,D,_,23,s[43]),D=d(D,b,A,L,I,4,s[44]),L=d(L,D,b,A,E,11,s[45]),A=d(A,L,D,b,S,16,s[46]),D=h(D,b=d(b,A,L,D,p,23,s[47]),A,L,r,6,s[48]),L=h(L,D,b,A,v,10,s[49]),A=h(A,L,D,b,k,15,s[50]),b=h(b,A,L,D,m,21,s[51]),D=h(D,b,A,L,E,6,s[52]),L=h(L,D,b,A,g,10,s[53]),A=h(A,L,D,b,M,15,s[54]),b=h(b,A,L,D,c,21,s[55]),D=h(D,b,A,L,y,6,s[56]),L=h(L,D,b,A,S,10,s[57]),A=h(A,L,D,b,_,15,s[58]),b=h(b,A,L,D,T,21,s[59]),D=h(D,b,A,L,f,6,s[60]),L=h(L,D,b,A,C,10,s[61]),A=h(A,L,D,b,p,15,s[62]),b=h(b,A,L,D,I,21,s[63]),a[0]=a[0]+D|0,a[1]=a[1]+b|0,a[2]=a[2]+A|0,a[3]=a[3]+L|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var a=e.floor(i/4294967296),s=i;n[15+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),n[14+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process();for(var r=this._hash,c=r.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return r},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,i,o,a,s){var r=e+(t&n|~t&i)+o+s;return(r<<a|r>>>32-a)+t}function l(e,t,n,i,o,a,s){var r=e+(t&i|n&~i)+o+s;return(r<<a|r>>>32-a)+t}function d(e,t,n,i,o,a,s){var r=e+(t^n^i)+o+s;return(r<<a|r>>>32-a)+t}function h(e,t,n,i,o,a,s){var r=e+(n^(t|~i))+o+s;return(r<<a|r>>>32-a)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),u=(c=r).lib,l=u.WordArray,d=u.Hasher,h=c.algo,f=[],m=h.SHA1=d.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],a=n[2],s=n[3],r=n[4],c=0;c<80;c++){if(c<16)f[c]=0|e[t+c];else{var u=f[c-3]^f[c-8]^f[c-14]^f[c-16];f[c]=u<<1|u>>>31}var l=(i<<5|i>>>27)+r+f[c];l+=c<20?1518500249+(o&a|~o&s):c<40?1859775393+(o^a^s):c<60?(o&a|o&s|a&s)-1894007588:(o^a^s)-899497514,r=s,s=a,a=o<<30|o>>>2,o=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+r|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=d.clone.call(this);return e._hash=this._hash.clone(),e}}),c.SHA1=d._createHelper(m),c.HmacSHA1=d._createHmacHelper(m),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,o=0;o<64;)t(i)&&(o<8&&(s[o]=n(e.pow(i,.5))),c[o]=n(e.pow(i,1/3)),o++),i++}();var u=[],l=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],a=n[2],s=n[3],r=n[4],l=n[5],d=n[6],h=n[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var g=u[p-15],f=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,m=u[p-2],_=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;u[p]=f+u[p-7]+_+u[p-16]}var v=i&o^i&a^o&a,y=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),I=h+((r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25))+(r&l^~r&d)+c[p]+u[p];h=d,d=l,l=r,r=s+I|0,s=a,a=o,o=i,i=I+(y+v)|0}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+r|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(i/4294967296),n[15+(o+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),function(){var e=r,t=e.lib.WordArray,n=e.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o+=2){var a=t[o>>>2]>>>16-o%4*8&65535;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var n=e.length,i=[],o=0;o<n;o++)i[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(i,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a+=2){var s=i(t[a>>>2]>>>16-a%4*8&65535);o.push(String.fromCharCode(s))}return o.join("")},parse:function(e){for(var n=e.length,o=[],a=0;a<n;a++)o[a>>>1]|=i(e.charCodeAt(a)<<16-a%2*16);return t.create(o,2*n)}}}(),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,i=[],o=0;o<n;o++)i[o>>>2]|=e[o]<<24-o%4*8;t.call(this,i,n)}else t.apply(this,arguments)}).prototype=e}}(),
/** @preserve
              (c) 2012 by C��dric Mesnil. All rights reserved.
               Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
                   - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
                  - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
               THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
              */
function(){var e=r,t=e.lib,n=t.WordArray,i=t.Hasher,o=e.algo,a=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),l=n.create([0,1518500249,1859775393,2400959708,2840853838]),d=n.create([1352829926,1548603684,1836072691,2053994217,0]),h=o.RIPEMD160=i.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var r,h,y,I,M,C,E,T,k,S,D,b=this._hash.words,A=l.words,L=d.words,R=a.words,w=s.words,O=c.words,N=u.words;for(C=r=b[0],E=h=b[1],T=y=b[2],k=I=b[3],S=M=b[4],n=0;n<80;n+=1)D=r+e[t+R[n]]|0,D+=n<16?p(h,y,I)+A[0]:n<32?g(h,y,I)+A[1]:n<48?f(h,y,I)+A[2]:n<64?m(h,y,I)+A[3]:_(h,y,I)+A[4],D=(D=v(D|=0,O[n]))+M|0,r=M,M=I,I=v(y,10),y=h,h=D,D=C+e[t+w[n]]|0,D+=n<16?_(E,T,k)+L[0]:n<32?m(E,T,k)+L[1]:n<48?f(E,T,k)+L[2]:n<64?g(E,T,k)+L[3]:p(E,T,k)+L[4],D=(D=v(D|=0,N[n]))+S|0,C=S,S=k,k=v(T,10),T=E,E=D;D=b[1]+y+k|0,b[1]=b[2]+I+S|0,b[2]=b[3]+M+C|0,b[3]=b[4]+r+E|0,b[4]=b[0]+h+T|0,b[0]=D},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,a=o.words,s=0;s<5;s++){var r=a[s];a[s]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}return o},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function p(e,t,n){return e^t^n}function g(e,t,n){return e&t|~e&n}function f(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function _(e,t,n){return e^(t|~n)}function v(e,t){return e<<t|e>>>32-t}e.RIPEMD160=i._createHelper(h),e.HmacRIPEMD160=i._createHmacHelper(h)}(),function(){var e=r,t=e.lib.Base,n=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var i=e.blockSize,o=4*i;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),s=this._iKey=t.clone(),r=a.words,c=s.words,u=0;u<i;u++)r[u]^=1549556828,c[u]^=909522486;a.sigBytes=s.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}(),function(){var e=r,t=e.lib,n=t.Base,i=t.WordArray,o=e.algo,a=o.SHA1,s=o.HMAC,c=o.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=s.create(n.hasher,e),a=i.create(),r=i.create([1]),c=a.words,u=r.words,l=n.keySize,d=n.iterations;c.length<l;){var h=o.update(t).finalize(r);o.reset();for(var p=h.words,g=p.length,f=h,m=1;m<d;m++){f=o.finalize(f),o.reset();for(var _=f.words,v=0;v<g;v++)p[v]^=_[v]}a.concat(h),u[0]++}return a.sigBytes=4*l,a}});e.PBKDF2=function(e,t,n){return c.create(n).compute(e,t)}}(),function(){var e=r,t=e.lib,n=t.Base,i=t.WordArray,o=e.algo,a=o.MD5,s=o.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,o=this.cfg,a=o.hasher.create(),s=i.create(),r=s.words,c=o.keySize,u=o.iterations;r.length<c;){n&&a.update(n),n=a.update(e).finalize(t),a.reset();for(var l=1;l<u;l++)n=a.finalize(n),a.reset();s.concat(n)}return s.sigBytes=4*c,s}});e.EvpKDF=function(e,t,n){return s.create(n).compute(e,t)}}(),function(){var e=r,t=e.lib.WordArray,n=e.algo,i=n.SHA256,o=n.SHA224=i.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=i._createHelper(o),e.HmacSHA224=i._createHmacHelper(o)}(),function(){var e=r,t=e.lib,n=t.Base,i=t.WordArray,o=e.x64={};o.Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],o=0;o<t;o++){var a=e[o];n.push(a.high),n.push(a.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),i=t.length,o=0;o<i;o++)t[o]=t[o].clone();return e}})}(),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.x64.Word,s=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){c[e+5*t]=(n+1)*(n+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,s=0;s<24;s++){for(var r=0,d=0,h=0;h<7;h++){if(1&o){var p=(1<<h)-1;p<32?d^=1<<p:r^=1<<p-32}128&o?o=o<<1^113:o<<=1}l[s]=a.create(r,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var h=s.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,i=this.blockSize/2,o=0;o<i;o++){var a=e[t+2*o],s=e[t+2*o+1];a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(b=n[o]).high^=s,b.low^=a}for(var r=0;r<24;r++){for(var h=0;h<5;h++){for(var p=0,g=0,f=0;f<5;f++)p^=(b=n[h+5*f]).high,g^=b.low;var m=d[h];m.high=p,m.low=g}for(h=0;h<5;h++){var _=d[(h+4)%5],v=d[(h+1)%5],y=v.high,I=v.low;for(p=_.high^(y<<1|I>>>31),g=_.low^(I<<1|y>>>31),f=0;f<5;f++)(b=n[h+5*f]).high^=p,b.low^=g}for(var M=1;M<25;M++){var C=(b=n[M]).high,E=b.low,T=c[M];T<32?(p=C<<T|E>>>32-T,g=E<<T|C>>>32-T):(p=E<<T-32|C>>>64-T,g=C<<T-32|E>>>64-T);var k=d[u[M]];k.high=p,k.low=g}var S=d[0],D=n[0];for(S.high=D.high,S.low=D.low,h=0;h<5;h++)for(f=0;f<5;f++){var b=n[M=h+5*f],A=d[M],L=d[(h+1)%5+5*f],R=d[(h+2)%5+5*f];b.high=A.high^~L.high&R.high,b.low=A.low^~L.low&R.low}b=n[0];var w=l[r];b.high^=w.high,b.low^=w.low}},_doFinalize:function(){var t=this._data,n=t.words,o=(this._nDataBytes,8*t.sigBytes),a=32*this.blockSize;n[o>>>5]|=1<<24-o%32,n[(e.ceil((o+1)/a)*a>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var s=this._state,r=this.cfg.outputLength/8,c=r/8,u=[],l=0;l<c;l++){var d=s[l],h=d.high,p=d.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),u.push(p),u.push(h)}return new i.init(u,r)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=o._createHelper(h),t.HmacSHA3=o._createHmacHelper(h)}(Math),function(){var e=r,t=e.lib.Hasher,n=e.x64,i=n.Word,o=n.WordArray,a=e.algo;function s(){return i.create.apply(i,arguments)}var c=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=s()}();var l=a.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],a=n[2],s=n[3],r=n[4],l=n[5],d=n[6],h=n[7],p=i.high,g=i.low,f=o.high,m=o.low,_=a.high,v=a.low,y=s.high,I=s.low,M=r.high,C=r.low,E=l.high,T=l.low,k=d.high,S=d.low,D=h.high,b=h.low,A=p,L=g,R=f,w=m,O=_,N=v,P=y,U=I,G=M,x=C,F=E,B=T,V=k,j=S,q=D,H=b,K=0;K<80;K++){var z,Y,$=u[K];if(K<16)Y=$.high=0|e[t+2*K],z=$.low=0|e[t+2*K+1];else{var W=u[K-15],J=W.high,X=W.low,Z=(J>>>1|X<<31)^(J>>>8|X<<24)^J>>>7,Q=(X>>>1|J<<31)^(X>>>8|J<<24)^(X>>>7|J<<25),ee=u[K-2],te=ee.high,ne=ee.low,ie=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ae=u[K-7],se=ae.high,re=ae.low,ce=u[K-16],ue=ce.high,le=ce.low;Y=(Y=(Y=Z+se+((z=Q+re)>>>0<Q>>>0?1:0))+ie+((z+=oe)>>>0<oe>>>0?1:0))+ue+((z+=le)>>>0<le>>>0?1:0),$.high=Y,$.low=z}var de,he=G&F^~G&V,pe=x&B^~x&j,ge=A&R^A&O^R&O,fe=L&w^L&N^w&N,me=(A>>>28|L<<4)^(A<<30|L>>>2)^(A<<25|L>>>7),_e=(L>>>28|A<<4)^(L<<30|A>>>2)^(L<<25|A>>>7),ve=(G>>>14|x<<18)^(G>>>18|x<<14)^(G<<23|x>>>9),ye=(x>>>14|G<<18)^(x>>>18|G<<14)^(x<<23|G>>>9),Ie=c[K],Me=Ie.high,Ce=Ie.low,Ee=q+ve+((de=H+ye)>>>0<H>>>0?1:0),Te=_e+fe;q=V,H=j,V=F,j=B,F=G,B=x,G=P+(Ee=(Ee=(Ee=Ee+he+((de+=pe)>>>0<pe>>>0?1:0))+Me+((de+=Ce)>>>0<Ce>>>0?1:0))+Y+((de+=z)>>>0<z>>>0?1:0))+((x=U+de|0)>>>0<U>>>0?1:0)|0,P=O,U=N,O=R,N=w,R=A,w=L,A=Ee+(me+ge+(Te>>>0<_e>>>0?1:0))+((L=de+Te|0)>>>0<de>>>0?1:0)|0}g=i.low=g+L,i.high=p+A+(g>>>0<L>>>0?1:0),m=o.low=m+w,o.high=f+R+(m>>>0<w>>>0?1:0),v=a.low=v+N,a.high=_+O+(v>>>0<N>>>0?1:0),I=s.low=I+U,s.high=y+P+(I>>>0<U>>>0?1:0),C=r.low=C+x,r.high=M+G+(C>>>0<x>>>0?1:0),T=l.low=T+B,l.high=E+F+(T>>>0<B>>>0?1:0),S=d.low=S+j,d.high=k+V+(S>>>0<j>>>0?1:0),b=h.low=b+H,h.high=D+q+(b>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(i+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),function(){var e=r,t=e.x64,n=t.Word,i=t.WordArray,o=e.algo,a=o.SHA512,s=o.SHA384=a.extend({_doReset:function(){this._hash=new i.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=a._createHelper(s),e.HmacSHA384=a._createHmacHelper(s)}(),r.lib.Cipher||function(){var e=r,t=e.lib,n=t.Base,i=t.WordArray,o=t.BufferedBlockAlgorithm,a=e.enc,s=(a.Utf8,a.Base64),c=e.algo.EvpKDF,u=t.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:m}return function(t){return{encrypt:function(n,i,o){return e(i).encrypt(t,n,i,o)},decrypt:function(n,i,o){return e(i).decrypt(t,n,i,o)}}}}()}),l=(t.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),e.mode={}),d=t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=l.CBC=function(){var e=d.extend();function t(e,t,n){var i,o=this._iv;o?(i=o,this._iv=void 0):i=this._prevBlock;for(var a=0;a<n;a++)e[t+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize;t.call(this,e,n,o),i.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,a=e.slice(n,n+o);i.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=a}}),e}(),p=(e.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,o=n-e.sigBytes%n,a=o<<24|o<<16|o<<8|o,s=[],r=0;r<o;r+=4)s.push(a);var c=i.create(s,o);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(t.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:p}),reset:function(){var e;u.reset.call(this);var t=this.cfg,n=t.iv,i=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=i.createEncryptor:(e=i.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(i,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),f=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?i.create([1398893684,1701076831]).concat(n).concat(t):t).toString(s)},parse:function(e){var t,n=s.parse(e),o=n.words;return 1398893684==o[0]&&1701076831==o[1]&&(t=i.create(o.slice(2,4)),o.splice(0,4),n.sigBytes-=16),g.create({ciphertext:n,salt:t})}},m=t.SerializableCipher=n.extend({cfg:n.extend({format:f}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var o=e.createEncryptor(n,i),a=o.finalize(t),s=o.cfg;return g.create({ciphertext:a,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),_=(e.kdf={}).OpenSSL={execute:function(e,t,n,o){o||(o=i.random(8));var a=c.create({keySize:t+n}).compute(e,o),s=i.create(a.words.slice(t),4*n);return a.sigBytes=4*t,g.create({key:a,iv:s,salt:o})}},v=t.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:_}),encrypt:function(e,t,n,i){var o=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize);i.iv=o.iv;var a=m.encrypt.call(this,e,t,o.key,i);return a.mixIn(o),a},decrypt:function(e,t,n,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var o=i.kdf.execute(n,e.keySize,e.ivSize,t.salt);return i.iv=o.iv,m.decrypt.call(this,e,t,o.key,i)}})}(),r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,n,i){var o,a=this._iv;a?(o=a.slice(0),this._iv=void 0):o=this._prevBlock,i.encryptBlock(o,0);for(var s=0;s<n;s++)e[t+s]^=o[s]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize;t.call(this,e,n,o,i),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,a=e.slice(n,n+o);t.call(this,e,n,o,i),this._prevBlock=a}}),e}(),r.mode.ECB=((o=r.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),o.Decryptor=o.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),o),r.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,i=4*t,o=i-n%i,a=n+o-1;e.clamp(),e.words[a>>>2]|=o<<24-a%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126={pad:function(e,t){var n=4*t,i=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(i-1)).concat(r.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.mode.OFB=(i=(n=r.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,a=this._keystream;o&&(a=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(a,0);for(var s=0;s<i;s++)e[t+s]^=a[s]}}),n.Decryptor=i,n),r.pad.NoPadding={pad:function(){},unpad:function(){}},function(){var e=r,t=e.lib.CipherParams,n=e.enc.Hex;e.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var i=n.parse(e);return t.create({ciphertext:i})}}}(),function(){var e=r,t=e.lib.BlockCipher,n=e.algo,i=[],o=[],a=[],s=[],c=[],u=[],l=[],d=[],h=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var g=r^r<<1^r<<2^r<<3^r<<4;g=g>>>8^255&g^99,i[n]=g,o[g]=n;var f=e[n],m=e[f],_=e[m],v=257*e[g]^16843008*g;a[n]=v<<24|v>>>8,s[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,u[n]=v,v=16843009*_^65537*m^257*f^16843008*n,l[g]=v<<24|v>>>8,d[g]=v<<16|v>>>16,h[g]=v<<8|v>>>24,p[g]=v,n?(n=f^e[e[e[_^f]]],r^=e[e[r]]):n=r=1}}();var g=[0,1,2,4,8,16,32,64,128,27,54],f=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,o=4*((this._nRounds=n+6)+1),a=this._keySchedule=[],s=0;s<o;s++)s<n?a[s]=t[s]:(u=a[s-1],s%n?n>6&&s%n==4&&(u=i[u>>>24]<<24|i[u>>>16&255]<<16|i[u>>>8&255]<<8|i[255&u]):(u=i[(u=u<<8|u>>>24)>>>24]<<24|i[u>>>16&255]<<16|i[u>>>8&255]<<8|i[255&u],u^=g[s/n|0]<<24),a[s]=a[s-n]^u);for(var r=this._invKeySchedule=[],c=0;c<o;c++){if(s=o-c,c%4)var u=a[s];else u=a[s-4];r[c]=c<4||s<=4?u:l[i[u>>>24]]^d[i[u>>>16&255]]^h[i[u>>>8&255]]^p[i[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,c,u,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,h,p,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,o,a,s,r){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],p=4,g=1;g<c;g++){var f=i[u>>>24]^o[l>>>16&255]^a[d>>>8&255]^s[255&h]^n[p++],m=i[l>>>24]^o[d>>>16&255]^a[h>>>8&255]^s[255&u]^n[p++],_=i[d>>>24]^o[h>>>16&255]^a[u>>>8&255]^s[255&l]^n[p++],v=i[h>>>24]^o[u>>>16&255]^a[l>>>8&255]^s[255&d]^n[p++];u=f,l=m,d=_,h=v}f=(r[u>>>24]<<24|r[l>>>16&255]<<16|r[d>>>8&255]<<8|r[255&h])^n[p++],m=(r[l>>>24]<<24|r[d>>>16&255]<<16|r[h>>>8&255]<<8|r[255&u])^n[p++],_=(r[d>>>24]<<24|r[h>>>16&255]<<16|r[u>>>8&255]<<8|r[255&l])^n[p++],v=(r[h>>>24]<<24|r[u>>>16&255]<<16|r[l>>>8&255]<<8|r[255&d])^n[p++],e[t]=f,e[t+1]=m,e[t+2]=_,e[t+3]=v},keySize:8});e.AES=t._createHelper(f)}(),function(){var e=r,t=e.lib,n=t.WordArray,i=t.BlockCipher,o=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var i=a[n]-1;t[n]=e[i>>>5]>>>31-i%32&1}for(var o=this._subKeys=[],r=0;r<16;r++){var u=o[r]=[],l=c[r];for(n=0;n<24;n++)u[n/6|0]|=t[(s[n]-1+l)%28]<<31-n%6,u[4+(n/6|0)]|=t[28+(s[n+24]-1+l)%28]<<31-n%6;for(u[0]=u[0]<<1|u[0]>>>31,n=1;n<7;n++)u[n]=u[n]>>>4*(n-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),h.call(this,1,1431655765);for(var i=0;i<16;i++){for(var o=n[i],a=this._lBlock,s=this._rBlock,r=0,c=0;c<8;c++)r|=u[c][((s^o[c])&l[c])>>>0];this._lBlock=s,this._rBlock=a^r}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,h.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function p(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=i._createHelper(d);var g=o.TripleDES=i.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),i=e.length<4?e.slice(0,2):e.slice(2,4),o=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=d.createEncryptor(n.create(t)),this._des2=d.createEncryptor(n.create(i)),this._des3=d.createEncryptor(n.create(o))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=i._createHelper(g)}(),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,i=this._S=[],o=0;o<256;o++)i[o]=o;o=0;for(var a=0;o<256;o++){var s=o%n,r=t[s>>>2]>>>24-s%4*8&255;a=(a+i[o]+r)%256;var c=i[o];i[o]=i[a],i[a]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,i=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var a=e[t];e[t]=e[n],e[n]=a,i|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,i}e.RC4=t._createHelper(i);var a=n.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});e.RC4Drop=t._createHelper(a)}(),
/** @preserve
               * Counter block mode compatible with  Dr Brian Gladman fileenc.c
               * derived from CryptoJS.mode.CTR
               * Jan Hruby jhruby.web@gmail.com
               */
r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var i,o=this._cipher,a=o.blockSize,s=this._iv,r=this._counter;s&&(r=this._counter=s.slice(0),this._iv=void 0),0===((i=r)[0]=t(i[0]))&&(i[1]=t(i[1]));var c=r.slice(0);o.encryptBlock(c,0);for(var u=0;u<a;u++)e[n+u]^=c[u]}});return e.Decryptor=n,e}(),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=[],o=[],a=[],s=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)o[n]^=i[n+4&7];if(t){var a=t.words,s=a[0],r=a[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),d=u>>>16|4294901760&l,h=l<<16|65535&u;for(o[0]^=u,o[1]^=d,o[2]^=l,o[3]^=h,o[4]^=u,o[5]^=d,o[6]^=l,o[7]^=h,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)i[o]=16711935&(i[o]<<8|i[o]>>>24)|4278255360&(i[o]<<24|i[o]>>>8),e[t+o]^=i[o]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],s=65535&i,r=i>>>16,c=((s*s>>>17)+s*r>>>15)+r*r,u=((4294901760&i)*i|0)+((65535&i)*i|0);a[n]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),r.mode.CTR=function(){var e=r.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,a=this._counter;o&&(a=this._counter=o.slice(0),this._iv=void 0);var s=a.slice(0);n.encryptBlock(s,0),a[i-1]=a[i-1]+1|0;for(var r=0;r<i;r++)e[t+r]^=s[r]}});return e.Decryptor=t,e}(),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=[],o=[],a=[],s=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)c.call(this);for(o=0;o<8;o++)i[o]^=n[o+4&7];if(t){var a=t.words,s=a[0],r=a[1],u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),d=u>>>16|4294901760&l,h=l<<16|65535&u;for(i[0]^=u,i[1]^=d,i[2]^=l,i[3]^=h,i[4]^=u,i[5]^=d,i[6]^=l,i[7]^=h,o=0;o<4;o++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)i[o]=16711935&(i[o]<<8|i[o]>>>24)|4278255360&(i[o]<<24|i[o]>>>8),e[t+o]^=i[o]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],s=65535&i,r=i>>>16,c=((s*s>>>17)+s*r>>>15)+r*r,u=((4294901760&i)*i|0)+((65535&i)*i|0);a[n]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),r.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},r)},u(l={exports:{}},l.exports),l.exports);return function(){function t(n){e(this,t);var i=n.isArray,o=n.isMap,a=n.isDevMode;this._isArray=i,this._isMap=o,this._isDevMode=a,this._interceptProfanityList=[],this._interceptFilter=null,this._interceptRegExpList=[],this._replacingProfanityMap=new Map,this._replacingFilter=null,this._replacingRegExpMap=new Map,this._key="",this._iv="",this._decryptOptions=void 0,this._n="TIMProfanityFilterPlugin",!0===a&&c("log","at node_modules/tim-profanity-filter-plugin/index.js:15","".concat(this._n,".VERSION:").concat("1.1.0"))}return n(t,[{key:"onToken",value:function(e){this._key=f.enc.Utf8.parse(e.slice(0,32)),this._iv=this._key,this._decryptOptions={iv:this._iv,mode:f.mode.CBC,padding:f.pad.Pkcs7}}},{key:"onLexiconSliced",value:function(e){if(this._isArray(e)&&0!==e.length){var t,n,i,o=r(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.filterType,c=a.profanityType,u=a.profanity,l=a.replacement;t=this._getDecryptedString(u),n=this._getDecryptedString(l),1===s?1===c?this._interceptProfanityList.push(t):2===c&&this._interceptRegExpList.push(t):2===s&&(1===c?this._replacingProfanityMap.set(t,n):2===c&&this._replacingRegExpMap.set(t,n))}}catch(d){o.e(d)}finally{o.f()}}}},{key:"_getDecryptedString",value:function(e){var t=f.AES.decrypt(e,this._key,this._decryptOptions);return f.enc.Utf8.stringify(t).toLowerCase()}},{key:"onLexiconCompleted",value:function(e){this.onLexiconSliced(e),this._interceptFilter=new h({input:this._interceptProfanityList,isArray:this._isArray,isMap:this._isMap}),this._replacingFilter=new h({input:this._replacingProfanityMap,isArray:this._isArray,isMap:this._isMap}),!0===this._isDevMode&&(c("log","at node_modules/tim-profanity-filter-plugin/index.js:15","".concat(this._n," _interceptProfanityList ->"),this._interceptProfanityList),c("log","at node_modules/tim-profanity-filter-plugin/index.js:15","".concat(this._n," _interceptRegExpList ->"),this._interceptRegExpList),c("log","at node_modules/tim-profanity-filter-plugin/index.js:15","".concat(this._n," _replacingProfanityMap ->"),this._replacingProfanityMap),c("log","at node_modules/tim-profanity-filter-plugin/index.js:15","".concat(this._n," _replacingRegExpMap ->"),this._replacingRegExpMap))}},{key:"filter",value:function(e){var t={type:0,modifiedText:e};if("string"!=typeof e)return!0===this._isDevMode&&c("warn","at node_modules/tim-profanity-filter-plugin/index.js:15","".concat(this._n,".filter invalid params, string required!")),t;if(!0===this._interceptFilter.filter({text:e,replacingEnabled:!1}).isMatched)return t.type=1,t;for(var n=!1,o=0,a=this._interceptRegExpList.length;o<a;o++)if(new RegExp(this._interceptRegExpList[o],"gi").test(e.toLowerCase())){n=!0;break}if(n)return t.type=1,t;var s=this._replacingFilter.filter({text:e,replacingEnabled:!0});!0===s.isMatched&&(t.type=2,t.modifiedText=s.modifiedText);var u,l=t.modifiedText,d=null,h=r(this._replacingRegExpMap);try{for(h.s();!(u=h.n()).done;){var p=i(u.value,2),g=p[0],f=p[1];d=new RegExp(g,"gi"),l=l.replace(d,f)}}catch(m){h.e(m)}finally{h.f()}return l!==e&&(t.type=2,t.modifiedText=l),t}},{key:"reset",value:function(){this._isArray=null,this._isMap=null,this._interceptProfanityList.length=0,this._interceptRegExpList.length=0,this._replacingProfanityMap.clear(),this._replacingRegExpMap.clear(),this._key="",this._iv="",this._decryptOptions={},this._interceptFilter&&this._interceptFilter.reset(),this._replacingFilter&&this._replacingFilter.reset()}}]),t}()}()}(vo);const yo=lo(vo.exports);function Io(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function Mo(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{c(i.next(e))}catch(t){a(t)}}function r(e){try{c(i.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}c((i=i.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;let Co=class e{constructor(t){return e.instance||(e.instance=this,this.engine=t,this.events={},this.bindIMEvents()),e.instance}addEvent(e,t){this.events[e]||(this.events[e]=new Map),this.events[e].set(t,1)}removeEvents(){Object.keys(this.events).forEach((e=>{this.events[e].clear()})),this.events={}}dispatch(e,t){if(this.events[e])for(const n of this.events[e].keys())n.call(this,t)}bindIMEvents(){this.engine.chat.on(this.engine.EVENT.SDK_READY,this.onSDKReady,this),this.engine.chat.on(this.engine.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.engine.chat.on(this.engine.EVENT.KICKED_OUT,this.onKickedOut,this),this.engine.chat.on(this.engine.EVENT.NET_STATE_CHANGE,this.onNetStateChange,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageModified,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_REVOKED,this.onMessageRevoked,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_REACTIONS_UPDATED,this.onMessageReactionsUpdated,this),this.engine.chat.on(this.engine.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated,this),this.engine.chat.on(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalMessageCountUpdated,this),this.engine.chat.on(this.engine.EVENT.PROFILE_UPDATED,this.onProfileUpdated,this),this.engine.chat.on(this.engine.EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated,this),this.engine.chat.on(this.engine.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated,this),this.engine.chat.on(this.engine.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated,this),this.engine.chat.on(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated,this)}unbindIMEvents(){this.engine.chat.off(this.engine.EVENT.SDK_READY,this.onSDKReady,this),this.engine.chat.off(this.engine.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.engine.chat.off(this.engine.EVENT.KICKED_OUT,this.onKickedOut,this),this.engine.chat.off(this.engine.EVENT.NET_STATE_CHANGE,this.onNetStateChange,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageModified,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_REVOKED,this.onMessageRevoked,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_REACTIONS_UPDATED,this.onMessageReactionsUpdated,this),this.engine.chat.off(this.engine.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated,this),this.engine.chat.off(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalMessageCountUpdated,this),this.engine.chat.off(this.engine.EVENT.PROFILE_UPDATED,this.onProfileUpdated,this),this.engine.chat.off(this.engine.EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated,this),this.engine.chat.off(this.engine.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated,this),this.engine.chat.off(this.engine.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated,this),this.engine.chat.off(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated,this),e.instance=null}onSDKReady(e){this.dispatch(this.engine.EVENT.SDK_READY,e.data)}onSDKNotReady(e){this.dispatch(this.engine.EVENT.SDK_NOT_READY,e.data)}onKickedOut(e){this.dispatch(this.engine.EVENT.KICKED_OUT,e.data)}onNetStateChange(e){this.dispatch(this.engine.EVENT.NET_STATE_CHANGE,e.data)}onReceiveMessage(e){this.dispatch(this.engine.EVENT.MESSAGE_RECEIVED,e.data)}onMessageModified(e){this.dispatch(this.engine.EVENT.MESSAGE_MODIFIED,e.data)}onMessageRevoked(e){this.dispatch(this.engine.EVENT.MESSAGE_REVOKED,e.data)}onMessageReadByPeer(e){this.dispatch(this.engine.EVENT.MESSAGE_READ_BY_PEER,e.data)}onMessageReadReceiptReceived(e){this.dispatch(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,e.data)}onMessageReactionsUpdated(e){this.dispatch(this.engine.EVENT.MESSAGE_REACTIONS_UPDATED,e.data)}onConversationListUpdated(e){this.dispatch(this.engine.EVENT.CONVERSATION_LIST_UPDATED,e.data)}onTotalMessageCountUpdated(e){this.dispatch(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,e.data)}onProfileUpdated(e){this.dispatch(this.engine.EVENT.PROFILE_UPDATED,e.data)}onBlacklistUpdated(e){this.dispatch(this.engine.EVENT.BLACKLIST_UPDATED,e.data)}onUserStatusUpdated(e){this.dispatch(this.engine.EVENT.USER_STATUS_UPDATED,e.data)}onGroupListUpdated(e){this.dispatch(this.engine.EVENT.GROUP_LIST_UPDATED,e.data)}onGroupAttributesUpdated(e){this.dispatch(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,e.data)}onGroupCounterUpdated(e){this.dispatch(this.engine.EVENT.GROUP_COUNTER_UPDATED,e.data)}onFriendListUpdated(e){this.dispatch(this.engine.EVENT.FRIEND_LIST_UPDATED,e.data)}onFriendApplicationListUpdated(e){this.dispatch(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,e.data)}};var Eo,To,ko,So,Do,bo,Ao,Lo,Ro;!function(e){e.TUIStore="TUIStore",e.TUITranslate="TUITranslate",e.TUIConversation="TUIConversation",e.TUIChat="TUIChat",e.TUIGroup="TUIGroup",e.TUIUser="TUIUser",e.TUIFriend="TUIFriend",e.TUIReport="TUIReport"}(Eo||(Eo={})),function(e){e.APP="application",e.CONV="conversation",e.CHAT="chat",e.GRP="group",e.USER="user",e.FRIEND="friend",e.SEARCH="search",e.CUSTOM="custom"}(To||(To={})),function(e){e[e.UNSUB_USER=-1]="UNSUB_USER"}(ko||(ko={})),function(e){e.BUSINESS_ID="user_typing_status",e[e.STATUS_START=1]="STATUS_START",e[e.STATUS_END=0]="STATUS_END",e[e.VERSION=1]="VERSION",e[e.ACTION_START_ID=14]="ACTION_START_ID",e[e.ACTION_END_ID=0]="ACTION_END_ID",e.ACTION_START="EIMAMSG_InputStatus_Ing",e.ACTION_END="EIMAMSG_InputStatus_End",e[e.NEED_TYPING=1]="NEED_TYPING"}(So||(So={})),function(e){e.ADD="add",e.REMOVE="remove"}(Do||(Do={})),function(e){e[e.MSG_MODIFY_CONFLICT=2480]="MSG_MODIFY_CONFLICT",e[e.MSG_MODIFY_DISABLED_IN_AVCHATROOM=2481]="MSG_MODIFY_DISABLED_IN_AVCHATROOM",e[e.MODIFY_MESSAGE_NOT_EXIST=20026]="MODIFY_MESSAGE_NOT_EXIST"}(bo||(bo={})),function(e){e[e.NOT_INIT=-1e5]="NOT_INIT",e[e.INVALID_CONV_ID=-100001]="INVALID_CONV_ID",e[e.CONV_ID_SAME=-100002]="CONV_ID_SAME",e[e.CONV_NOT_EXIST=-100003]="CONV_NOT_EXIST",e[e.GET_MSG_LIST_ERROR=-100004]="GET_MSG_LIST_ERROR",e[e.MISMATCH_TYPE_AND_PAYLOAD=-100005]="MISMATCH_TYPE_AND_PAYLOAD"}(Ao||(Ao={})),function(e){e.MSG_MODIFY_CONFLICT="MODIFY_MESSAGE_ERROR,修改消息发生冲突, data.message 是最新的消息",e.MSG_MODIFY_DISABLED_IN_AVCHATROOM="MODIFY_MESSAGE_ERROR,不支持修改直播群消息.",e.MODIFY_MESSAGE_NOT_EXIST="MODIFY_MESSAGE_ERROR,消息不存在."}(Lo||(Lo={})),function(e){e.NOT_INIT="TUIChatEngine 初始化未完成，请确认 TUIChatEngine.login 接口调用是否正常。",e.INVALID_CONV_ID="会话 ID 无效",e.CONV_ID_SAME="您切换的是同一个会话 ID",e.CONV_NOT_EXIST="会话不存在",e.GET_MSG_LIST_ERROR="Chat SDK is not ready.",e.MISMATCH_TYPE_AND_PAYLOAD="type 与 payload 不匹配."}(Ro||(Ro={}));const wo={logout:1,destroy:1},Oo=function(e){return void 0===e},No=function(e){return e.startsWith("_")},Po=function(e){return/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)},Uo=function(e){return e&&function(e){if("string"==typeof e)try{return!!JSON.parse(e)}catch(t){return!1}return!1}(e)?JSON.parse(e):e},Go=function(e){let t="";return t=e>=1048576?`${(e/1048576).toFixed(2)} Mb`:e>=1024?`${(e/1024).toFixed(2)} Kb`:`${e.toFixed(2)}B`,t},xo={"[TUIEmoji_Expect]":"emoji_0@2x.png","[TUIEmoji_Blink]":"emoji_1@2x.png","[TUIEmoji_Guffaw]":"emoji_2@2x.png","[TUIEmoji_KindSmile]":"emoji_3@2x.png","[TUIEmoji_Haha]":"emoji_4@2x.png","[TUIEmoji_Cheerful]":"emoji_5@2x.png","[TUIEmoji_Smile]":"emoji_6@2x.png","[TUIEmoji_Sorrow]":"emoji_7@2x.png","[TUIEmoji_Speechless]":"emoji_8@2x.png","[TUIEmoji_Amazed]":"emoji_9@2x.png","[TUIEmoji_Complacent]":"emoji_10@2x.png","[TUIEmoji_Lustful]":"emoji_11@2x.png","[TUIEmoji_Stareyes]":"emoji_12@2x.png","[TUIEmoji_Giggle]":"emoji_13@2x.png","[TUIEmoji_Daemon]":"emoji_14@2x.png","[TUIEmoji_Rage]":"emoji_15@2x.png","[TUIEmoji_Yawn]":"emoji_16@2x.png","[TUIEmoji_TearsLaugh]":"emoji_17@2x.png","[TUIEmoji_Silly]":"emoji_18@2x.png","[TUIEmoji_Wail]":"emoji_19@2x.png","[TUIEmoji_Kiss]":"emoji_20@2x.png","[TUIEmoji_Trapped]":"emoji_21@2x.png","[TUIEmoji_Fear]":"emoji_22@2x.png","[TUIEmoji_BareTeeth]":"emoji_23@2x.png","[TUIEmoji_FlareUp]":"emoji_24@2x.png","[TUIEmoji_Tact]":"emoji_25@2x.png","[TUIEmoji_Shit]":"emoji_26@2x.png","[TUIEmoji_ShutUp]":"emoji_27@2x.png","[TUIEmoji_Sigh]":"emoji_28@2x.png","[TUIEmoji_Hehe]":"emoji_29@2x.png","[TUIEmoji_Silent]":"emoji_30@2x.png","[TUIEmoji_Skull]":"emoji_31@2x.png","[TUIEmoji_Mask]":"emoji_32@2x.png","[TUIEmoji_Beer]":"emoji_33@2x.png","[TUIEmoji_Cake]":"emoji_34@2x.png","[TUIEmoji_RedPacket]":"emoji_35@2x.png","[TUIEmoji_Bombs]":"emoji_36@2x.png","[TUIEmoji_Ai]":"emoji_37@2x.png","[TUIEmoji_Celebrate]":"emoji_38@2x.png","[TUIEmoji_Bless]":"emoji_39@2x.png","[TUIEmoji_Flower]":"emoji_40@2x.png","[TUIEmoji_Watermelon]":"emoji_41@2x.png","[TUIEmoji_Cow]":"emoji_42@2x.png","[TUIEmoji_Fool]":"emoji_43@2x.png","[TUIEmoji_Surprised]":"emoji_44@2x.png","[TUIEmoji_Askance]":"emoji_45@2x.png","[TUIEmoji_Monster]":"emoji_46@2x.png","[TUIEmoji_Pig]":"emoji_47@2x.png","[TUIEmoji_Coffee]":"emoji_48@2x.png","[TUIEmoji_Ok]":"emoji_49@2x.png","[TUIEmoji_Heart]":"emoji_50@2x.png","[TUIEmoji_Sun]":"emoji_51@2x.png","[TUIEmoji_Moon]":"emoji_52@2x.png","[TUIEmoji_Star]":"emoji_53@2x.png","[TUIEmoji_Rich]":"emoji_54@2x.png","[TUIEmoji_Fortune]":"emoji_55@2x.png","[TUIEmoji_857]":"emoji_56@2x.png","[TUIEmoji_666]":"emoji_57@2x.png","[TUIEmoji_Prohibit]":"emoji_58@2x.png","[TUIEmoji_Convinced]":"emoji_59@2x.png","[TUIEmoji_Knife]":"emoji_60@2x.png","[TUIEmoji_Like]":"emoji_61@2x.png"},Fo={"[TUIEmoji_Smile]":"[微笑]","[TUIEmoji_Expect]":"[期待]","[TUIEmoji_Blink]":"[眨眼]","[TUIEmoji_Guffaw]":"[大笑]","[TUIEmoji_KindSmile]":"[姨母笑]","[TUIEmoji_Haha]":"[哈哈哈]","[TUIEmoji_Cheerful]":"[愉快]","[TUIEmoji_Speechless]":"[无语]","[TUIEmoji_Amazed]":"[惊讶]","[TUIEmoji_Sorrow]":"[悲伤]","[TUIEmoji_Complacent]":"[得意]","[TUIEmoji_Silly]":"[傻了]","[TUIEmoji_Lustful]":"[色]","[TUIEmoji_Giggle]":"[憨笑]","[TUIEmoji_Kiss]":"[亲亲]","[TUIEmoji_Wail]":"[大哭]","[TUIEmoji_TearsLaugh]":"[哭笑]","[TUIEmoji_Trapped]":"[困]","[TUIEmoji_Mask]":"[口罩]","[TUIEmoji_Fear]":"[恐惧]","[TUIEmoji_BareTeeth]":"[龇牙]","[TUIEmoji_FlareUp]":"[发怒]","[TUIEmoji_Yawn]":"[打哈欠]","[TUIEmoji_Tact]":"[机智]","[TUIEmoji_Stareyes]":"[星星眼]","[TUIEmoji_ShutUp]":"[闭嘴]","[TUIEmoji_Sigh]":"[叹气]","[TUIEmoji_Hehe]":"[呵呵]","[TUIEmoji_Silent]":"[收声]","[TUIEmoji_Surprised]":"[惊喜]","[TUIEmoji_Askance]":"[白眼]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[便便]","[TUIEmoji_Monster]":"[怪兽]","[TUIEmoji_Daemon]":"[恶魔]","[TUIEmoji_Rage]":"[恶魔怒]","[TUIEmoji_Fool]":"[衰]","[TUIEmoji_Pig]":"[猪]","[TUIEmoji_Cow]":"[牛]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[骷髅]","[TUIEmoji_Bombs]":"[炸弹]","[TUIEmoji_Coffee]":"[咖啡]","[TUIEmoji_Cake]":"[蛋糕]","[TUIEmoji_Beer]":"[啤酒]","[TUIEmoji_Flower]":"[花]","[TUIEmoji_Watermelon]":"[瓜]","[TUIEmoji_Rich]":"[壕]","[TUIEmoji_Heart]":"[爱心]","[TUIEmoji_Moon]":"[月亮]","[TUIEmoji_Sun]":"[太阳]","[TUIEmoji_Star]":"[星星]","[TUIEmoji_RedPacket]":"[红包]","[TUIEmoji_Celebrate]":"[庆祝]","[TUIEmoji_Bless]":"[福]","[TUIEmoji_Fortune]":"[发]","[TUIEmoji_Convinced]":"[服]","[TUIEmoji_Prohibit]":"[禁]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[刀]","[TUIEmoji_Like]":"[赞]"},Bo={enabledMessageReadReceipt:Math.pow(2,5),enabledEmojiPlugin:Math.pow(2,48),enabledOnlineStatus:Math.pow(2,7),enabledCustomerServicePlugin:Math.pow(2,40),enabledTranslationPlugin:Math.pow(2,38),enabledVoiceToText:Math.pow(2,39)},Vo=["messageList","conversationList","newMessageList"],jo=["translateTextInfo","voiceToTextInfo"],qo="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Ho="undefined"!=typeof uni&&"undefined"==typeof window,Ko=qo||Ho,zo="undefined"!=typeof uni,Yo=("undefined"!=typeof uni||"undefined"!=typeof window)&&!Ko,$o=qo?wx:zo?uni:window,Wo=Yo&&window&&window.navigator&&window.navigator.userAgent||"",Jo=/Android/i.test(Wo),Xo=/(?:Windows Phone)/.test(Wo),Zo=/(?:SymbianOS)/.test(Wo),Qo=/iPad/i.test(Wo)||/iPhone/i.test(Wo)||/iPod/i.test(Wo),ea=Jo||Xo||Zo||Qo,ta=Yo&&!ea;class na{constructor(){this.global=$o,this.isOfficial=!1}static getInstance(){return na.instance||(na.instance=new na),na.instance}initOfficial(e){this.isOfficial=e}getPlatform(){let e="";return ta?e="pc":ea?e="h5":qo?e="wechat":Ho&&!qo&&(e="app"),e}}class ia{constructor(){this.EVENT=po.EVENT,this.TYPES=po.TYPES,this.loginStatusPromise=new Map,this.userID="",this.isInited=!1}static getInstance(){return ia.instance||(ia.instance=new ia),ia.instance}mount(e,t){this[e]=t}login(e){const{chat:t,SDKAppID:n,userID:i}=e,o=1400187352===n||1400188366===n;return this.createChat(e),this.userID=i,na.getInstance().initOfficial(o),this.TUIStore.update(To.APP,"isOfficial",o),this.TUIStore.update(To.APP,"SDKVersion",po.VERSION),this.eventCenter=new Co(this),this.eventCenter.removeEvents(),this.resetStore(),this.initService(),t&&t.isReady()?(c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUIChatEngine.login ok, from TUICore."),this.TUIUser.getUserProfile(),this.checkCommercialAbility(),Promise.resolve({})):(this.registerPlugin(e),this.eventCenter.addEvent(this.EVENT.SDK_READY,(()=>{this.onSDKReady()})),this.eventCenter.addEvent(this.EVENT.SDK_NOT_READY,(()=>{this.onSDKNotReady()})),this.loginChat(e))}logout(){return this.userID="",this.isInited=!1,this.resetStore(),this.chat.logout()}isReady(){var e;return(null===(e=this.chat)||void 0===e?void 0:e.isReady())||!1}setLogLevel(e){this.chat?this.chat.setLogLevel(e):c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUIChatEngine 初始化未完成，请确认 TUIChatEngine.login 接口调用是否正常。")}destroy(){return this.eventCenter.unbindIMEvents(),this.isInited=!1,this.resetStore(),this.chat.destroy()}getMyUserID(){return this.userID}resetStore(){this.TUIStore.reset(To.CHAT),this.TUIStore.reset(To.CONV),this.TUIStore.reset(To.GRP),this.TUIStore.reset(To.USER),this.TUIStore.reset(To.SEARCH),this.TUIStore.reset(To.FRIEND),this.TUIStore.reset(To.CUSTOM),c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUIChatEngine.resetStore ok.")}initService(){this.TUIChat.init(),this.TUIConversation.init(),this.TUIUser.init(),this.initOptionalServices(),this.isInited=!0,c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUIChatEngine.initService ok.")}initOptionalServices(){const e=po.VERSION.split(".");e[0]>3||3===e[0]&&e[1]>=3&&e[2]>0?(!0===this.chat.callExperimentalAPI("canIUseModule",["group-module"])&&this.TUIGroup.init(),!0===this.chat.callExperimentalAPI("canIUseModule",["relationship-module"])&&this.TUIFriend.init()):(this.TUIGroup.init(),this.TUIFriend.init())}createChat(e){const{chat:t}=e,n=Io(e,["chat"]);Oo(t)?this.chat=po.create(Object.assign(Object.assign({},n),{scene:"chat-uikit-engine"})):this.chat=t}loginChat(e){const{userID:t,userSig:n}=e;return new Promise(((e,i)=>{this.chat.login({userID:t,userSig:n}).then((t=>{c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUIChatEngine.loginChat ok."),this.checkCommercialAbility(),t.data.repeatLogin&&this.chat.isReady()&&e(t),this.loginStatusPromise.set("login",{resolve:e,reject:i,imResponse:t})})).catch((e=>{i(e)}))}))}registerPlugin(e){const{useUploadPlugin:t=!1,useProfanityFilterPlugin:n=!1,TIMPush:i,pushConfig:o,TUIOfflinePush:a,offlinePushConfig:s}=e;!0===t&&this.chat.registerPlugin({"tim-upload-plugin":fo}),!0===n&&this.chat.registerPlugin({"tim-profanity-filter-plugin":yo}),!Ho||qo||Oo(i)||Oo(o)||this.chat.registerPlugin({"tim-push":i,pushConfig:o}),!Ho||qo||Oo(a)||Oo(s)||this.chat.registerPlugin({"tim-offline-push-plugin":a,offlinePushConfig:s})}onSDKReady(){if(this.loginStatusPromise.has("login")){const e=this.loginStatusPromise.get("login");e.resolve(e.imResponse),this.TUIUser.getUserProfile()}this.loginStatusPromise.delete("login")}onSDKNotReady(){this.loginStatusPromise.has("login")&&this.loginStatusPromise.get("login").reject(new Error("sdk not ready")),this.loginStatusPromise.delete("login"),this.resetStore()}checkCommercialAbility(){Object.keys(Bo).forEach((e=>{const t=Bo[e];this.chat.callExperimentalAPI("isCommercialAbilityEnabled",t).then((t=>{const{enabled:n=!1}=t.data;this.TUIStore.update(To.APP,e,n)}))}))}}class oa{constructor(){this.defaultStore={enabledMessageReadReceipt:!1,enabledEmojiPlugin:!1,enabledOnlineStatus:!1,enabledCustomerServicePlugin:!1,enabledTranslationPlugin:!1,enabledVoiceToText:!1,enableTyping:!0,enableConversationDraft:!0,isOfficial:!1,SDKVersion:"3.0.0",tasks:{sendMessage:!1,revokeMessage:!1,modifyNickName:!1,groupChat:!1,muteGroup:!1,dismissGroup:!1,call:!1,searchCloudMessage:!1,customerService:!1,translateTextMessage:!1}},this.store={enabledEmojiPlugin:!1,enabledMessageReadReceipt:!1,enabledOnlineStatus:!1,enabledCustomerServicePlugin:!1,enabledTranslationPlugin:!1,enabledVoiceToText:!1,enableTyping:!0,enableConversationDraft:!0,isOfficial:!1,SDKVersion:"3.0.0",tasks:{sendMessage:!1,revokeMessage:!1,modifyNickName:!1,groupChat:!1,muteGroup:!1,dismissGroup:!1,call:!1,searchCloudMessage:!1,customerService:!1,translateTextMessage:!1}}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}}class aa{constructor(){this.defaultStore={userProfile:{},displayOnlineStatus:!1,displayMessageReadReceipt:!0,userStatusList:new Map,kickedOut:"",netStateChange:"",userBlacklist:[],targetLanguage:"zh"},this.store={userProfile:{},displayOnlineStatus:!1,displayMessageReadReceipt:!0,userStatusList:new Map,kickedOut:"",netStateChange:"",userBlacklist:[],targetLanguage:"zh"}}update(e,t){"userStatusList"===e?this.updateUserStatusList(t):this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateUserStatusList(e){0!==e.length?e.forEach((e=>{const{userID:t,statusType:n=0,customStatus:i=""}=e;n===ko.UNSUB_USER?this.store.userStatusList.delete(t):this.store.userStatusList.set(t,{statusType:n,customStatus:i})})):this.store.userStatusList.clear()}}class sa{getEngine(){return ia.getInstance()}}const ra=function(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(function(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;let n=t;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}(e)){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1},ca=["[图片]","[语音]","[视频]","[文件]","[位置]","[地理位置]","[动画表情]","[自定义消息]","[群提示消息]","[聊天记录]"];class ua extends sa{constructor(e){super(),this.initProxy(e),this.isMuted=this.messageRemindType===this.getEngine().TYPES.MSG_REMIND_ACPT_NOT_NOTE||this.messageRemindType===this.getEngine().TYPES.MSG_REMIND_DISCARD,this.operationType=0,this._conversation=e}initProxy(e){Object.keys(e).forEach((t=>{No(t)||(this[t]=e[t])}))}updateProperties(e){Object.keys(e).forEach((t=>{No(t)||(this[t]=e[t])}))}updateOperationType(e){this.operationType=e}getConversation(){return this._conversation}deleteConversation(){return this.getEngine().TUIConversation.deleteConversation(this.conversationID)}pinConversation(){return this.getEngine().TUIConversation.pinConversation({conversationID:this.conversationID,isPinned:!this.isPinned})}muteConversation(){const e=this.getEngine(),t={messageRemindType:!0===this.isMuted?e.TYPES.MSG_REMIND_ACPT_AND_NOTE:e.TYPES.MSG_REMIND_ACPT_NOT_NOTE};if(this.type===e.TYPES.CONV_C2C){const n=this.conversationID.replace(e.TYPES.CONV_C2C,"");t.userIDList=[n]}else if(this.type===e.TYPES.CONV_GROUP){const n=this.conversationID.replace(e.TYPES.CONV_GROUP,"");t.groupID=n}return e.TUIConversation.muteConversation(t)}getAvatar(){var e,t,n,i,o,a;const s=this.getEngine();let r="";switch(this.type){case s.TYPES.CONV_C2C:r=Po(null===(e=this.userProfile)||void 0===e?void 0:e.avatar)?null===(t=this.userProfile)||void 0===t?void 0:t.avatar:"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_16.png";break;case s.TYPES.CONV_GROUP:r=Po(null===(n=this.groupProfile)||void 0===n?void 0:n.avatar)?null===(i=this.groupProfile)||void 0===i?void 0:i.avatar:"https://web.sdk.qcloud.com/im/demo/TUIkit/web/img/constomer.png";break;case s.TYPES.CONV_SYSTEM:r=Po(null===(o=this.groupProfile)||void 0===o?void 0:o.avatar)?null===(a=this.groupProfile)||void 0===a?void 0:a.avatar:"https://web.sdk.qcloud.com/component/TUIKit/assets/group_avatar.png"}return r}getShowName(){var e,t,n,i;const o=this.getEngine();let a="";switch(this.type){case o.TYPES.CONV_C2C:a=this.remark||(null===(e=this.userProfile)||void 0===e?void 0:e.nick)||(null===(t=this.userProfile)||void 0===t?void 0:t.userID)||"";break;case o.TYPES.CONV_GROUP:a=(null===(n=this.groupProfile)||void 0===n?void 0:n.name)||(null===(i=this.groupProfile)||void 0===i?void 0:i.groupID)||"";break;case o.TYPES.CONV_SYSTEM:a=o.TUITranslate.t("系统通知")}return a}getGroupAtInfo(){const e=this.getEngine(),t=e.TUITranslate.t.bind(e.TUITranslate),n=[`[${t("TUIConversation.有人@我")}]`,`[${t("TUIConversation.@所有人")}]`,`[${t("TUIConversation.@所有人")}][${t("TUIConversation.有人@我")}]`];let i="";for(let o=0;o<this.groupAtInfoList.length;o++)this.groupAtInfoList[o].atTypeArray[0]&&this.unreadCount>0&&(i=n[this.groupAtInfoList[o].atTypeArray[0]-1]);return i}getLastMessage(e){return"time"===e?this.getLastMessageTime():"text"===e?this.getLastMessageText():(c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`ConversationModel.getLastMessage key:${e} is invalid.`),null)}getLastMessageTime(){var e;const t=this.getEngine();let n="";return(null===(e=this.lastMessage)||void 0===e?void 0:e.lastTime)>0&&(n=function(e,t){const n=36e5,i=24*n,o=7*i,a=(new Date).getTime()-e;let s="";if(a<0)return s;const r=a/6e4,c=a/n,u=a/i,l=a/o;if(l>=1&&l<=4)s=` ${parseInt(`${l}`,10)} ${t("time.周")}${t("time.前")}`;else if(u>=1&&u<=6)s=` ${parseInt(`${u}`,10)} ${t("time.天")}${t("time.前")}`;else if(c>=1&&c<=23)s=` ${parseInt(`${c}`,10)} ${t("time.小时")}${t("time.前")}`;else if(r>=1&&r<=59)s=` ${parseInt(`${r}`,10)} ${t("time.分钟")}${t("time.前")}`;else if(a>=0&&a<=6e4)s=`${t("time.刚刚")}`;else{const t=new Date;t.setTime(e),s=`${t.getFullYear()}-${t.getMonth()+1<10?`0${t.getMonth()+1}`:t.getMonth()+1}-${t.getDate()<10?`0${t.getDate()}`:t.getDate()}`}return s}(1e3*this.lastMessage.lastTime,t.TUITranslate.t.bind(t.TUITranslate))),n}getLastMessageText(){var e;if(this.draftText)return Uo(this.draftText).abstract;const t=this.getEngine(),n=t.TUITranslate.t.bind(t.TUITranslate);if(4===this.operationType)return n("TUIConversation.您已被群管理员移出群聊");if(5===this.operationType)return n("TUIConversation.该群聊已被解散");if(8===this.operationType)return n("TUIConversation.您已退出该群聊");const i=this._conversation,{lastMessage:o}=this;let a="",s="";const r=i.unreadCount>0&&i.messageRemindType===t.TYPES.MSG_REMIND_ACPT_NOT_NOTE?`[${i.unreadCount>99?"99+":i.unreadCount}${n("TUIConversation.条")}]`:"";if(i.type===t.TYPES.CONV_GROUP)if(o.fromAccount===t.getMyUserID())a=n("TUIConversation.我");else{const e=o.fromAccount;a=t.TUIFriend.getFriendRemark([e])[e]||o.nameCard||o.nick||e}if(o.type===t.TYPES.MSG_TEXT)s=this.decodeTextMessage(o.payload.text);else if(o.type===t.TYPES.MSG_CUSTOM){const i=Uo(null===(e=null==o?void 0:o.payload)||void 0===e?void 0:e.data);if(1===(null==i?void 0:i.businessID))return s=t.TUIChat.messageHandler.handleCallKitSignaling(o),s;s=ca.includes(o.messageForShow)?n(`TUIChat.${o.messageForShow}`):o.messageForShow}else s=ca.includes(o.messageForShow)?n(`TUIChat.${o.messageForShow}`):o.messageForShow;return o.isRevoked&&(s=n("TUIChat.撤回了一条消息")),i.type===t.TYPES.CONV_GROUP&&o.type===t.TYPES.MSG_GRP_TIP?s:`${r}${a?`${a}:`:""}${s}`}decodeTextMessage(e){if(ra(e))return e;const t=/(\[.+?\])/g;let n=e;if(t.test(e)){const i=this.getEngine(),o=i.TUITranslate.t.bind(i.TUITranslate);n=e.replace(t,(e=>{const t=o(`Emoji.${e}`);return qo||!t||t.startsWith("Emoji.")?Fo[e]||e:t}))}return n}}class la{constructor(){this.defaultStore={currentConversationID:"",totalUnreadCount:0,conversationList:[],currentConversation:null,operationTypeMap:new Map},this.store={currentConversationID:"",totalUnreadCount:0,conversationList:[],currentConversation:null,operationTypeMap:new Map}}update(e,t){switch(e){case"conversationList":this.updateConversationList(t);break;case"operationTypeMap":this.updateOperationTypeMap(t);break;default:this.store[e]=t}}getData(e){return this.store[e]}getModel(e){return this.store.conversationList.find((t=>t.conversationID===e))}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateConversationList(e){const t=[];e.forEach((e=>{let n=e;e instanceof ua?n.updateProperties(e):n=new ua(e);const i=this.getOperationType(e);n.updateOperationType(i),t.push(n)})),this.store.conversationList=t}updateOperationTypeMap(e){const{conversationID:t,operationType:n=0}=e;this.store.operationTypeMap.set(t,n)}getOperationType(e){const{conversationID:t}=e;return this.store.operationTypeMap.get(t)||0}}class da extends sa{constructor(e){super(),this.messageHandlers={[this.getEngine().TYPES.MSG_TEXT]:e=>this.getEngine().TUIChat.messageHandler.handleTextMessage(e),[this.getEngine().TYPES.MSG_FACE]:e=>this.getEngine().TUIChat.messageHandler.handleFaceMessage(e),[this.getEngine().TYPES.MSG_LOCATION]:e=>this.getEngine().TUIChat.messageHandler.handleLocationMessage(e),[this.getEngine().TYPES.MSG_IMAGE]:e=>this.getEngine().TUIChat.messageHandler.handleImageMessage(e),[this.getEngine().TYPES.MSG_AUDIO]:e=>this.getEngine().TUIChat.messageHandler.handleAudioMessage(e),[this.getEngine().TYPES.MSG_VIDEO]:e=>this.getEngine().TUIChat.messageHandler.handleVideoMessage(e),[this.getEngine().TYPES.MSG_FILE]:e=>this.getEngine().TUIChat.messageHandler.handleFileMessage(e),[this.getEngine().TYPES.MSG_CUSTOM]:e=>this.getEngine().TUIChat.messageHandler.handleCustomMessage(e),[this.getEngine().TYPES.MSG_MERGER]:e=>this.getEngine().TUIChat.messageHandler.handleMergeMessage(e),[this.getEngine().TYPES.MSG_GRP_TIP]:e=>this.getEngine().TUIChat.messageHandler.handleGroupTipsMessage(e)},this._message=e,this._signalingInfo=void 0,this.progress=0,this.reactionList=[],this.initProperties(e)}initProperties(e){Object.keys(e).forEach((t=>{No(t)||(this[t]=e[t])}))}updateProperties(e){this._message=e,Object.keys(e).forEach((t=>{No(t)||(this[t]=e[t])}))}getMessage(){return this._message}modifyMessage(e){return e.type&&this._message.type!==e.type&&!e.payload?Promise.reject({code:Ao.MISMATCH_TYPE_AND_PAYLOAD,message:Ro.MISMATCH_TYPE_AND_PAYLOAD}):(this._message.type=e.type||this._message.type,this._message.payload=e.payload||this._message.payload,this._message.cloudCustomData=e.cloudCustomData||this._message.cloudCustomData,this.getEngine().TUIChat.modifyMessage(this._message))}revokeMessage(){return this.getEngine().TUIChat.revokeMessage(this._message)}resendMessage(){return this.getEngine().TUIChat.resendMessage(this._message)}deleteMessage(){return this.getEngine().TUIChat.deleteMessage([this._message])}quoteMessage(){return this.getEngine().TUIChat.quoteMessage(this._message)}replyMessage(){return this.getEngine().TUIChat.replyMessage(this._message)}setMessageExtensions(e){return this.getEngine().TUIChat.setMessageExtensions(this._message,e)}getMessageExtensions(){return this.getEngine().TUIChat.getMessageExtensions(this._message)}deleteMessageExtensions(e){return this.getEngine().TUIChat.deleteMessageExtensions(this._message,e)}getSignalingInfo(){return this.type!==this.getEngine().TYPES.MSG_CUSTOM?null:Oo(this._signalingInfo)?(this._signalingInfo=this.getEngine().chat.getSignalingInfo(this._message),this._signalingInfo):this._signalingInfo}getMessageContent(){const e=this.messageHandlers[this.type];if(Oo(e))return{};if(this.type===this.getEngine().TYPES.MSG_GRP_TIP)return e(this._message);const t=this.getEngine().TUIFriend.getFriendRemark([this.from]);return Object.assign(Object.assign({},e(this._message)),{showName:t[this.from]||this.nameCard||this.nick||this.from})}sendForwardMessage(e){return this.getEngine().TUIChat.sendForwardMessage(e,[this._message])}}class ha{constructor(){this.defaultStore={messageList:[],isCompleted:!1,nextReqMessageID:"",quoteMessage:{},newMessageList:[],typingStatus:!1,messageSource:void 0,translateTextInfo:void 0,voiceToTextInfo:void 0,userInfo:{}},this.store={messageList:[],isCompleted:!1,nextReqMessageID:"",quoteMessage:{},newMessageList:[],typingStatus:!1,messageSource:void 0,translateTextInfo:void 0,voiceToTextInfo:void 0,userInfo:{}}}update(e,t){switch(e){case"messageList":this.updateMessageList(t);break;case"translateTextInfo":this.updateTranslateTextInfo(t);break;case"voiceToTextInfo":this.updateVoiceToTextInfo(t);break;default:this.store[e]=t}}getData(e){return this.store[e]}getModel(e){return this.store.messageList.find((t=>t.ID===e))}reset(e=[]){const t=e.filter((e=>!jo.includes(e)));this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),null==t?void 0:t.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateMessageList(e){const t=[];e.forEach((e=>{let n=e;e instanceof da||(n=this.getModel(e.ID),n?n.updateProperties(e):n=new da(e)),t.push(n)})),this.store.messageList=t}updateTranslateTextInfo(e){this.updateBykey("translateTextInfo",e)}updateVoiceToTextInfo(e){this.updateBykey("voiceToTextInfo",e)}updateBykey(e,t){const{conversationID:n,messageID:i,visible:o=!1}=t;this.store[e]||(this.store[e]=new Map),this.store[e].has(n)||this.store[e].set(n,[]);const a=this.store[e].get(n)||[];let s=!0;for(let r=0;r<a.length;r++)if(a[r].messageID===i){a[r].visible=o,s=!1;break}s&&a.push({messageID:i,visible:o}),this.store[e].set(n,a)}}class pa{constructor(e){this.groupAttributes={},this.groupCounters={},this.initProxy(e)}initProxy(e){Object.keys(e).forEach((t=>{No(t)||(this[t]=e[t])}))}}class ga{constructor(){this.defaultStore={currentGroupID:"",currentGroup:{},currentGroupAttributes:{},currentGroupCounters:{},currentGroupMemberList:[],groupList:[],groupSystemNoticeList:[],isCompleted:!1,offset:0},this.store={currentGroupID:"",currentGroup:void 0,currentGroupAttributes:{},currentGroupCounters:{},currentGroupMemberList:[],groupList:[],groupSystemNoticeList:[],isCompleted:!1,offset:0}}update(e,t){switch(e){case"groupList":this.updateGroupList(t);break;case"currentGroup":this.store.currentGroup=t instanceof pa?t:new pa(t);break;default:this.store[e]=t}}getData(e){if("groupSystemNoticeList"===e){const e=[...this.store.groupSystemNoticeList];return this.store.groupSystemNoticeList.length=0,e}return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateGroupList(e){this.store.groupList=e.map((e=>e instanceof pa?e:new pa(e)))}}class fa{constructor(){this.store={}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){0===e.length&&(this.store={}),this.store=Object.assign(Object.assign({},this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:void 0})),{}))}}class ma{constructor(){this.defaultStore={friendList:[],friendApplicationList:[],friendApplicationUnreadCount:0},this.store={friendList:[],friendApplicationList:[],friendApplicationUnreadCount:0}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}}class _a{constructor(){this.defaultStore={currentSearchInputValue:{value:"",searchType:"global"},currentSearchMessageType:{value:{key:"",label:"",value:""},searchType:"global"},currentSearchMessageTime:{value:{key:"",label:"",value:{timePosition:0,timePeriod:0}},searchType:"global"},currentSearchingStatus:{isSearching:!1,searchType:"global"},isShowInConversationSearch:!1},this.store={currentSearchInputValue:{value:"",searchType:"global"},currentSearchMessageType:{value:{key:"",label:"",value:""},searchType:"global"},currentSearchMessageTime:{value:{key:"",label:"",value:{timePosition:0,timePeriod:0}},searchType:"global"},currentSearchingStatus:{isSearching:!1,searchType:"global"},isShowInConversationSearch:!1}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),null==e?void 0:e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}}class va{constructor(){this.storeMap={[To.APP]:new oa,[To.USER]:new aa,[To.CONV]:new la,[To.CHAT]:new ha,[To.GRP]:new ga,[To.FRIEND]:new ma,[To.SEARCH]:new _a},this.task={}}static getInstance(){return va.instance||(va.instance=new va),va.instance}watch(e,t){this.task[e]||(this.task[e]={});const n=this.task[e];Object.keys(t).forEach((i=>{const o=t[i];n[i]||(n[i]=new Map),n[i].set(o,1),this.notifyOnWatch(e,i,o)}))}unwatch(e,t){if(!this.task[e])return;const n=this.task[e];Object.keys(t).forEach((e=>{var i;null===(i=n[e])||void 0===i||i.delete(t[e])}))}update(e,t,n){var i;e!==To.CUSTOM||this.storeMap[e]||(this.storeMap[e]=new fa),null===(i=this.storeMap[e])||void 0===i||i.update(t,n),this.notify(e,t)}getData(e,t){var n;return e!==To.CUSTOM||this.storeMap[e]||(this.storeMap[e]=new fa),null===(n=this.storeMap[e])||void 0===n?void 0:n.getData(t)}getConversationModel(e){var t;return null===(t=this.storeMap[To.CONV])||void 0===t?void 0:t.getModel(e)}getMessageModel(e){var t;return null===(t=this.storeMap[To.CHAT])||void 0===t?void 0:t.getModel(e)}reset(e,t=[],n=!1){if(e in this.storeMap){const i=this.storeMap[e];0===t.length&&(t=Object.keys(null==i?void 0:i.store)),i.reset(t),n&&t.forEach((t=>{this.notify(e,t)}))}}notifyOnWatch(e,t,n){const i=this.getData(e,t);Vo.indexOf(t)>-1&&0===i.length||n&&n.call(this,i)}notify(e,t){if(!this.task[e])return;const n=this.task[e];if(n[t]){const i=n[t],o=this.getData(e,t);for(const[e]of i.entries())e.call(this,o)}}}function ya(e){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ia(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ma(e){var t=function(e){if("object"!=ya(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ya(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ya(t)?t:t+""}function Ca(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ma(i.key),i)}}function Ea(e,t,n){return t&&Ca(e.prototype,t),n&&Ca(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ka(e,t){return(ka=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Sa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ka(e,t)}function Da(e,t){if(t&&("object"==ya(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ta(e)}function ba(e){return(ba=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Aa(e,t,n){return(t=Ma(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function La(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function wa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oa={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},Na=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ia(this,e),this.init(t,n)}return Ea(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||Oa,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,i){return i&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,wa(wa({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}()),Pa=function(){function e(){Ia(this,e),this.observers={}}return Ea(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.observers[e]&&[].concat(this.observers[e]).forEach((function(e){e.apply(void 0,n)})),this.observers["*"]&&[].concat(this.observers["*"]).forEach((function(t){t.apply(t,[e].concat(n))}))}}]),e}();function Ua(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function Ga(e){return null==e?"":""+e}function xa(e,t,n){function i(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function o(){return!e||"string"==typeof e}for(var a="string"!=typeof t?[].concat(t):t.split(".");a.length>1;){if(o())return{};var s=i(a.shift());!e[s]&&n&&(e[s]=new n),e=Object.prototype.hasOwnProperty.call(e,s)?e[s]:{}}return o()?{}:{obj:e,k:i(a.shift())}}function Fa(e,t,n){var i=xa(e,t,Object);i.obj[i.k]=n}function Ba(e,t){var n=xa(e,t),i=n.obj,o=n.k;if(i)return i[o]}function Va(e,t,n){for(var i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?"string"==typeof e[i]||e[i]instanceof String||"string"==typeof t[i]||t[i]instanceof String?n&&(e[i]=t[i]):Va(e[i],t[i],n):e[i]=t[i]);return e}function ja(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var qa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Ha(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return qa[e]})):e}var Ka="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,za=[" ",",","?","!",";"];function Ya(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var i=t.split(n),o=e,a=0;a<i.length;++a){if(!o)return;if("string"==typeof o[i[a]]&&a+1<i.length)return;if(void 0===o[i[a]]){for(var s=2,r=i.slice(a,a+s).join(n),c=o[r];void 0===c&&i.length>a+s;)s++,c=o[r=i.slice(a,a+s).join(n)];if(void 0===c)return;if(null===c)return null;if(t.endsWith(r)){if("string"==typeof c)return c;if(r&&"string"==typeof c[r])return c[r]}var u=i.slice(a+s).join(n);return u?Ya(c,u,n):void 0}o=o[i[a]]}return o}}function $a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Wa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$a(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ja=function(){Sa(t,Pa);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ba(e);if(t){var o=ba(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Da(this,n)}}(t);function t(n){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return Ia(this,t),i=e.call(this),Ka&&Pa.call(Ta(i)),i.data=n||{},i.options=o,void 0===i.options.keySeparator&&(i.options.keySeparator="."),void 0===i.options.ignoreJSONStructure&&(i.options.ignoreJSONStructure=!0),i}return Ea(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,a=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure,s=[e,t];n&&"string"!=typeof n&&(s=s.concat(n)),n&&"string"==typeof n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(s=e.split("."));var r=Ba(this.data,s);return r||!a||"string"!=typeof n?r:Ya(this.data&&this.data[e]&&this.data[e][t],n,o)}},{key:"addResource",value:function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},a=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator,s=[e,t];n&&(s=s.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(i=t,t=(s=e.split("."))[1]),this.addNamespaces(t),Fa(this.data,s,i),o.silent||this.emit("added",e,t,n,i)}},{key:"addResources",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(e,t,o,n[o],{silent:!0});i.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[e,t];e.indexOf(".")>-1&&(i=n,n=t,t=(s=e.split("."))[1]),this.addNamespaces(t);var r=Ba(this.data,s)||{};i?Va(r,n,o):r=Wa(Wa({},r),n),Fa(this.data,s,r),a.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?Wa(Wa({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),t}(),Xa={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,i,o){var a=this;return e.forEach((function(e){a.processors[e]&&(t=a.processors[e].process(t,n,i,o))})),t}};function Za(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Qa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Za(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var es={},ts=function(){Sa(t,Pa);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ba(e);if(t){var o=ba(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Da(this,n)}}(t);function t(n){var i,o,a,s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ia(this,t),i=e.call(this),Ka&&Pa.call(Ta(i)),o=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],a=n,s=Ta(i),o.forEach((function(e){a[e]&&(s[e]=a[e])})),i.options=r,void 0===i.options.keySeparator&&(i.options.keySeparator="."),i.logger=Na.create("translator"),i}return Ea(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,o=t.ns||this.options.defaultNS||[],a=n&&e.indexOf(n)>-1,s=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var i=za.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===i.length)return!0;var o=new RegExp("(".concat(i.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),a=!o.test(e);if(!a){var s=e.indexOf(n);s>0&&!o.test(e.substring(0,s))&&(a=!0)}return a}(e,n,i));if(a&&!s){var r=e.match(this.interpolator.nestingRegexp);if(r&&r.length>0)return{key:e,namespaces:o};var c=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(i)}return"string"==typeof o&&(o=[o]),{key:e,namespaces:o}}},{key:"translate",value:function(e,n,i){var o=this;if("object"!==ya(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),"object"===ya(n)&&(n=Qa({},n)),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var a=void 0!==n.returnDetails?n.returnDetails:this.options.returnDetails,s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,r=this.extractFromKey(e[e.length-1],n),c=r.key,u=r.namespaces,l=u[u.length-1],d=n.lng||this.language,h=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(h){var p=n.nsSeparator||this.options.nsSeparator;return a?{res:"".concat(l).concat(p).concat(c),usedKey:c,exactUsedKey:c,usedLng:d,usedNS:l}:"".concat(l).concat(p).concat(c)}return a?{res:c,usedKey:c,exactUsedKey:c,usedLng:d,usedNS:l}:c}var g=this.resolve(e,n),f=g&&g.res,m=g&&g.usedKey||c,_=g&&g.exactUsedKey||c,v=Object.prototype.toString.apply(f),y=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,I=!this.i18nFormat||this.i18nFormat.handleAsObject;if(I&&f&&"string"!=typeof f&&"boolean"!=typeof f&&"number"!=typeof f&&["[object Number]","[object Function]","[object RegExp]"].indexOf(v)<0&&("string"!=typeof y||"[object Array]"!==v)){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var M=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,f,Qa(Qa({},n),{},{ns:u})):"key '".concat(c," (").concat(this.language,")' returned an object instead of string.");return a?(g.res=M,g):M}if(s){var C="[object Array]"===v,E=C?[]:{},T=C?_:m;for(var k in f)if(Object.prototype.hasOwnProperty.call(f,k)){var S="".concat(T).concat(s).concat(k);E[k]=this.translate(S,Qa(Qa({},n),{joinArrays:!1,ns:u})),E[k]===S&&(E[k]=f[k])}f=E}}else if(I&&"string"==typeof y&&"[object Array]"===v)(f=f.join(y))&&(f=this.extendTranslation(f,e,n,i));else{var D=!1,b=!1,A=void 0!==n.count&&"string"!=typeof n.count,L=t.hasDefaultValue(n),R=A?this.pluralResolver.getSuffix(d,n.count,n):"",w=n["defaultValue".concat(R)]||n.defaultValue;!this.isValidLookup(f)&&L&&(D=!0,f=w),this.isValidLookup(f)||(b=!0,f=c);var O=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&b?void 0:f,N=L&&w!==f&&this.options.updateMissing;if(b||D||N){if(this.logger.log(N?"updateKey":"missingKey",d,l,c,N?w:f),s){var P=this.resolve(c,Qa(Qa({},n),{},{keySeparator:!1}));P&&P.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var U=[],G=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&G&&G[0])for(var x=0;x<G.length;x++)U.push(G[x]);else"all"===this.options.saveMissingTo?U=this.languageUtils.toResolveHierarchy(n.lng||this.language):U.push(n.lng||this.language);var F=function(e,t,i){var a=L&&i!==f?i:O;o.options.missingKeyHandler?o.options.missingKeyHandler(e,l,t,a,N,n):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(e,l,t,a,N,n),o.emit("missingKey",e,l,t,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&A?U.forEach((function(e){o.pluralResolver.getSuffixes(e,n).forEach((function(t){F([e],c+t,n["defaultValue".concat(t)]||w)}))})):F(U,c,w))}f=this.extendTranslation(f,e,n,g,i),b&&f===c&&this.options.appendNamespaceToMissingKey&&(f="".concat(l,":").concat(c)),(b||D)&&this.options.parseMissingKeyHandler&&(f="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(l,":").concat(c):c,D?f:void 0):this.options.parseMissingKeyHandler(f))}return a?(g.res=f,g):f}},{key:"extendTranslation",value:function(e,t,n,i,o){var a=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,Qa(Qa({},this.options.interpolation.defaultVariables),n),i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(Qa(Qa({},n),{interpolation:Qa(Qa({},this.options.interpolation),n.interpolation)}));var s,r="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(r){var c=e.match(this.interpolator.nestingRegexp);s=c&&c.length}var u=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(u=Qa(Qa({},this.options.interpolation.defaultVariables),u)),e=this.interpolator.interpolate(e,u,n.lng||this.language,n),r){var l=e.match(this.interpolator.nestingRegexp);s<(l&&l.length)&&(n.nest=!1)}!n.lng&&"v1"!==this.options.compatibilityAPI&&i&&i.res&&(n.lng=i.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return o&&o[0]===i[0]&&!n.context?(a.logger.warn("It seems you are nesting recursively key: ".concat(i[0]," in key: ").concat(t[0])),null):a.translate.apply(a,i.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,h="string"==typeof d?[d]:d;return null!=e&&h&&h.length&&!1!==n.applyPostProcessor&&(e=Xa.handle(h,e,t,this.options&&this.options.postProcessPassResolved?Qa({i18nResolved:i},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,i,o,a,s=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!s.isValidLookup(t)){var c=s.extractFromKey(e,r),u=c.key;n=u;var l=c.namespaces;s.options.fallbackNS&&(l=l.concat(s.options.fallbackNS));var d=void 0!==r.count&&"string"!=typeof r.count,h=d&&!r.ordinal&&0===r.count&&s.pluralResolver.shouldUseIntlApi(),p=void 0!==r.context&&("string"==typeof r.context||"number"==typeof r.context)&&""!==r.context,g=r.lngs?r.lngs:s.languageUtils.toResolveHierarchy(r.lng||s.language,r.fallbackLng);l.forEach((function(e){s.isValidLookup(t)||(a=e,!es["".concat(g[0],"-").concat(e)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(a)&&(es["".concat(g[0],"-").concat(e)]=!0,s.logger.warn('key "'.concat(n,'" for languages "').concat(g.join(", "),'" won\'t get resolved as namespace "').concat(a,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach((function(n){if(!s.isValidLookup(t)){o=n;var a,c=[u];if(s.i18nFormat&&s.i18nFormat.addLookupKeys)s.i18nFormat.addLookupKeys(c,u,n,e,r);else{var l;d&&(l=s.pluralResolver.getSuffix(n,r.count,r));var g="".concat(s.options.pluralSeparator,"zero");if(d&&(c.push(u+l),h&&c.push(u+g)),p){var f="".concat(u).concat(s.options.contextSeparator).concat(r.context);c.push(f),d&&(c.push(f+l),h&&c.push(f+g))}}for(;a=c.pop();)s.isValidLookup(t)||(i=a,t=s.getResource(n,e,a,r))}})))}))}})),{res:t,usedKey:n,exactUsedKey:i,usedLng:o,usedNS:a}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}}],[{key:"hasDefaultValue",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}]),t}();function ns(e){return e.charAt(0).toUpperCase()+e.slice(1)}var is=function(){function e(t){Ia(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Na.create("languageUtils")}return Ea(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=ns(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=ns(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=ns(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var i=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(i)||(t=i)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var i=n.getLanguagePartFromCode(e);if(n.isSupportedCode(i))return t=i;t=n.options.supportedLngs.find((function(e){return e===i?e:e.indexOf("-")<0&&i.indexOf("-")<0?void 0:0===e.indexOf(i)?e:void 0}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,i=this.getFallbackCodes(t||this.options.fallbackLng||[],e),o=[],a=function(e){e&&(n.isSupportedCode(e)?o.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&a(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&a(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&a(this.getLanguagePartFromCode(e))):"string"==typeof e&&a(this.formatLanguageCode(e)),i.forEach((function(e){o.indexOf(e)<0&&a(n.formatLanguageCode(e))})),o}}]),e}(),os=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],as={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},ss=["v1","v2","v3"],rs={zero:0,one:1,two:2,few:3,many:4,other:5},cs=function(){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ia(this,e),this.languageUtils=t,this.options=i,this.logger=Na.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(n={},os.forEach((function(e){e.lngs.forEach((function(t){n[t]={numbers:e.nr,plurals:as[e.fc]}}))})),n)}return Ea(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(n){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getRule(e,n);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((function(e,t){return rs[e]-rs[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):i.numbers.map((function(i){return t.getSuffix(e,i,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getRule(e,n);return i?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(i.select(t)):this.getSuffixRetroCompatible(i,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,i=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),o=e.numbers[i];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var a=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):a():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?a():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}},{key:"shouldUseIntlApi",value:function(){return!ss.includes(this.options.compatibilityJSON)}}]),e}();function us(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ls(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?us(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):us(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ds(e,t,n){var i,o,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],c=(i=t,void 0!==(a=Ba(e,o=n))?a:Ba(i,o));return!c&&r&&"string"==typeof n&&void 0===(c=Ya(e,n,s))&&(c=Ya(t,n,s)),c}var hs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ia(this,e),this.logger=Na.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return Ea(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:Ha,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?ja(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?ja(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?ja(t.nestingPrefix):t.nestingPrefixEscaped||ja("$t("),this.nestingSuffix=t.nestingSuffix?ja(t.nestingSuffix):t.nestingSuffixEscaped||ja(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,i){var o,a,s,r=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function u(e){return e.replace(/\$/g,"$$$$")}var l=function(e){if(e.indexOf(r.formatSeparator)<0){var o=ds(t,c,e,r.options.keySeparator,r.options.ignoreJSONStructure);return r.alwaysFormat?r.format(o,void 0,n,ls(ls(ls({},i),t),{},{interpolationkey:e})):o}var a=e.split(r.formatSeparator),s=a.shift().trim(),u=a.join(r.formatSeparator).trim();return r.format(ds(t,c,s,r.options.keySeparator,r.options.ignoreJSONStructure),u,n,ls(ls(ls({},i),t),{},{interpolationkey:s}))};this.resetRegExp();var d=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,h=i&&i.interpolation&&void 0!==i.interpolation.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return u(e)}},{regex:this.regexp,safeValue:function(e){return r.escapeValue?u(r.escape(e)):u(e)}}].forEach((function(t){for(s=0;o=t.regex.exec(e);){var n=o[1].trim();if(void 0===(a=l(n)))if("function"==typeof d){var c=d(e,o,i);a="string"==typeof c?c:""}else if(i&&Object.prototype.hasOwnProperty.call(i,n))a="";else{if(h){a=o[0];continue}r.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),a=""}else"string"==typeof a||r.useRawValueToEscape||(a=Ga(a));var u=t.safeValue(a);if(e=e.replace(o[0],u),h?(t.regex.lastIndex+=a.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,++s>=r.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,i,o,a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function r(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var i=e.split(new RegExp("".concat(n,"[ ]*{"))),a="{".concat(i[1]);e=i[0];var s=(a=this.interpolate(a,o)).match(/'/g),r=a.match(/"/g);(s&&s.length%2==0&&!r||r.length%2!=0)&&(a=a.replace(/'/g,'"'));try{o=JSON.parse(a),t&&(o=ls(ls({},t),o))}catch(c){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),c),"".concat(e).concat(n).concat(a)}return delete o.defaultValue,e}for(;n=this.nestingRegexp.exec(e);){var c=[];(o=(o=ls({},s)).replace&&"string"!=typeof o.replace?o.replace:o).applyPostProcessor=!1,delete o.defaultValue;var u=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var l=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=l.shift(),c=l,u=!0}if((i=t(r.call(this,n[1].trim(),o),o))&&n[0]===e&&"string"!=typeof i)return i;"string"!=typeof i&&(i=Ga(i)),i||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),i=""),u&&(i=c.reduce((function(e,t){return a.format(e,t,s.lng,ls(ls({},s),{},{interpolationkey:n[1].trim()}))}),i.trim())),e=e.replace(n[0],i),this.regexp.lastIndex=0}return e}}]),e}();function ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function gs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ps(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ps(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fs(e){var t={};return function(n,i,o){var a=i+JSON.stringify(o),s=t[a];return s||(s=e(i,o),t[a]=s),s(n)}}var ms=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ia(this,e),this.logger=Na.create("formatter"),this.options=t,this.formats={number:fs((function(e,t){var n=new Intl.NumberFormat(e,gs({},t));return function(e){return n.format(e)}})),currency:fs((function(e,t){var n=new Intl.NumberFormat(e,gs(gs({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:fs((function(e,t){var n=new Intl.DateTimeFormat(e,gs({},t));return function(e){return n.format(e)}})),relativetime:fs((function(e,t){var n=new Intl.RelativeTimeFormat(e,gs({},t));return function(e){return n.format(e,t.range||"day")}})),list:fs((function(e,t){var n=new Intl.ListFormat(e,gs({},t));return function(e){return n.format(e)}}))},this.init(t)}return Ea(e,[{key:"init",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=fs(t)}},{key:"format",value:function(e,t,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t.split(this.formatSeparator).reduce((function(e,t){var a=function(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var i=e.split("(");t=i[0].toLowerCase().trim();var o=i[1].substring(0,i[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach((function(e){if(e){var t=function(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return La(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?La(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split(":")),i=t[0],o=t.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[i.trim()]||(n[i.trim()]=o),"false"===o&&(n[i.trim()]=!1),"true"===o&&(n[i.trim()]=!0),isNaN(o)||(n[i.trim()]=parseInt(o,10))}}))}return{formatName:t,formatOptions:n}}(t),s=a.formatName,r=a.formatOptions;if(i.formats[s]){var c=e;try{var u=o&&o.formatParams&&o.formatParams[o.interpolationkey]||{},l=u.locale||u.lng||o.locale||o.lng||n;c=i.formats[s](e,l,gs(gs(gs({},r),o),u))}catch(d){i.logger.warn(d)}return c}return i.logger.warn("there was no format function for ".concat(s)),e}),e)}}]),e}();function _s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function vs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ys=function(){Sa(t,Pa);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ba(e);if(t){var o=ba(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Da(this,n)}}(t);function t(n,i,o){var a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ia(this,t),a=e.call(this),Ka&&Pa.call(Ta(a)),a.backend=n,a.store=i,a.services=o,a.languageUtils=o.languageUtils,a.options=s,a.logger=Na.create("backendConnector"),a.waitingReads=[],a.maxParallelReads=s.maxParallelReads||10,a.readingCalls=0,a.maxRetries=s.maxRetries>=0?s.maxRetries:5,a.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,a.state={},a.queue=[],a.backend&&a.backend.init&&a.backend.init(o,s.backend,s),a}return Ea(t,[{key:"queueLoad",value:function(e,t,n,i){var o=this,a={},s={},r={},c={};return e.forEach((function(e){var i=!0;t.forEach((function(t){var r="".concat(e,"|").concat(t);!n.reload&&o.store.hasResourceBundle(e,t)?o.state[r]=2:o.state[r]<0||(1===o.state[r]?void 0===s[r]&&(s[r]=!0):(o.state[r]=1,i=!1,void 0===s[r]&&(s[r]=!0),void 0===a[r]&&(a[r]=!0),void 0===c[t]&&(c[t]=!0)))})),i||(r[e]=!0)})),(Object.keys(a).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(a),pending:Object.keys(s),toLoadLanguages:Object.keys(r),toLoadNamespaces:Object.keys(c)}}},{key:"loaded",value:function(e,t,n){var i=e.split("|"),o=i[0],a=i[1];t&&this.emit("failedLoading",o,a,t),n&&this.store.addResourceBundle(o,a,n),this.state[e]=t?-1:2;var s={};this.queue.forEach((function(n){var i,r,c,u,l,d,h;i=n.loaded,r=a,(u=(c=xa(i,[o],Object)).obj)[l=c.k]=u[l]||[],u[l].push(r),h=e,void 0!==(d=n).pending[h]&&(delete d.pending[h],d.pendingCount--),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){s[e]||(s[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===s[e][t]&&(s[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)this.waitingReads.push({lng:e,ns:t,fcName:n,tried:o,wait:a,callback:s});else{this.readingCalls++;var r=function(r,c){if(i.readingCalls--,i.waitingReads.length>0){var u=i.waitingReads.shift();i.read(u.lng,u.ns,u.fcName,u.tried,u.wait,u.callback)}r&&c&&o<i.maxRetries?setTimeout((function(){i.read.call(i,e,t,n,o+1,2*a,s)}),a):s(r,c)},c=this.backend[n].bind(this.backend);if(2!==c.length)return c(e,t,r);try{var u=c(e,t);u&&"function"==typeof u.then?u.then((function(e){return r(null,e)})).catch(r):r(null,u)}catch(l){r(l)}}}},{key:"prepareLoading",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var a=this.queueLoad(e,t,i,o);if(!a.toLoad.length)return a.pending.length||o(),null;a.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.split("|"),o=i[0],a=i[1];this.read(o,a,"read",void 0,void 0,(function(i,s){i&&t.logger.warn("".concat(n,"loading namespace ").concat(a," for language ").concat(o," failed"),i),!i&&s&&t.logger.log("".concat(n,"loaded namespace ").concat(a," for language ").concat(o),s),t.loaded(e,i,s)}))}},{key:"saveMissing",value:function(e,t,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=n&&""!==n){if(this.backend&&this.backend.create){var r=vs(vs({},a),{},{isUpdate:o}),c=this.backend.create.bind(this.backend);if(c.length<6)try{var u;(u=5===c.length?c(e,t,n,i,r):c(e,t,n,i))&&"function"==typeof u.then?u.then((function(e){return s(null,e)})).catch(s):s(null,u)}catch(l){s(l)}else c(e,t,n,i,s,r)}e&&e[0]&&this.store.addResource(e[0],t,n,i)}}}]),t}();function Is(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===ya(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===ya(e[2])||"object"===ya(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,i){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Ms(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Cs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Es(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cs(Object(n),!0).forEach((function(t){Aa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ts(){}var ks=function(){Sa(t,Pa);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ba(e);if(t){var o=ba(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Da(this,n)}}(t);function t(){var n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if(Ia(this,t),n=e.call(this),Ka&&Pa.call(Ta(n)),n.options=Ms(o),n.services={},n.logger=Na,n.modules={external:[]},i=Ta(n),Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach((function(e){"function"==typeof i[e]&&(i[e]=i[e].bind(i))})),a&&!n.isInitialized&&!o.isClone){if(!n.options.initImmediate)return n.init(o,a),Da(n,Ta(n));setTimeout((function(){n.init(o,a)}),0)}return n}return Ea(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var i=Is();function o(e){return e?"function"==typeof e?new e:e:null}if(this.options=Es(Es(Es({},i),this.options),Ms(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=Es(Es({},i.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var a;this.modules.logger?Na.init(o(this.modules.logger),this.options):Na.init(null,this.options),this.modules.formatter?a=this.modules.formatter:"undefined"!=typeof Intl&&(a=ms);var s=new is(this.options);this.store=new Ja(this.options.resources,this.options);var r=this.services;r.logger=Na,r.resourceStore=this.store,r.languageUtils=s,r.pluralResolver=new cs(s,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!a||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(r.formatter=o(a),r.formatter.init(r,this.options),this.options.interpolation.format=r.formatter.format.bind(r.formatter)),r.interpolator=new hs(this.options),r.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},r.backendConnector=new ys(o(this.modules.backend),r.resourceStore,r,this.options),r.backendConnector.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];e.emit.apply(e,[t].concat(i))})),this.modules.languageDetector&&(r.languageDetector=o(this.modules.languageDetector),r.languageDetector.init&&r.languageDetector.init(r,this.options.detection,this.options)),this.modules.i18nFormat&&(r.i18nFormat=o(this.modules.i18nFormat),r.i18nFormat.init&&r.i18nFormat.init(this)),this.translator=new ts(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];e.emit.apply(e,[t].concat(i))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=Ts),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&"dev"!==c[0]&&(this.options.lng=c[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var u=Ua(),l=function(){var t=function(t,i){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),u.resolve(i),n(t,i)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),u}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ts,i="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase())return n();var o=[],a=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){o.indexOf(e)<0&&o.push(e)}))};i?a(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((function(e){return a(e)})),this.options.preload&&this.options.preload.forEach((function(e){return a(e)})),this.services.backendConnector.load(o,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),n(e)}))}else n(null)}},{key:"reloadResources",value:function(e,t,n){var i=Ua();return e||(e=this.languages),t||(t=this.options.ns),n||(n=Ts),this.services.backendConnector.reload(e,t,(function(e){i.resolve(),n(e)})),i}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&Xa.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var i=Ua();this.emit("languageChanging",e);var o=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},a=function(a){e||a||!n.services.languageDetector||(a=[]);var s="string"==typeof a?a:n.services.languageUtils.getBestMatchFromCodes(a);s&&(n.language||o(s),n.translator.language||n.translator.changeLanguage(s),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage&&n.services.languageDetector.cacheUserLanguage(s)),n.loadResources(s,(function(e){var a,r;a=e,(r=s)?(o(r),n.translator.changeLanguage(r),n.isLanguageChangingTo=void 0,n.emit("languageChanged",r),n.logger.log("languageChanged",r)):n.isLanguageChangingTo=void 0,i.resolve((function(){return n.t.apply(n,arguments)})),t&&t(a,(function(){return n.t.apply(n,arguments)}))}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),i}},{key:"getFixedT",value:function(e,t,n){var i=this,o=function e(t,o){var a;if("object"!==ya(o)){for(var s=arguments.length,r=new Array(s>2?s-2:0),c=2;c<s;c++)r[c-2]=arguments[c];a=i.options.overloadTranslationOptionHandler([t,o].concat(r))}else a=Es({},o);a.lng=a.lng||e.lng,a.lngs=a.lngs||e.lngs,a.ns=a.ns||e.ns,a.keyPrefix=a.keyPrefix||n||e.keyPrefix;var u,l=i.options.keySeparator||".";return u=a.keyPrefix&&Array.isArray(t)?t.map((function(e){return"".concat(a.keyPrefix).concat(l).concat(e)})):a.keyPrefix?"".concat(a.keyPrefix).concat(l).concat(t):t,i.t(u,a)};return"string"==typeof e?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=n,o}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var i=n.lng||this.resolvedLanguage||this.languages[0],o=!!this.options&&this.options.fallbackLng,a=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;var s=function(e,n){var i=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===i||2===i};if(n.precheck){var r=n.precheck(this,s);if(void 0!==r)return r}return!(!this.hasResourceBundle(i,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(i,e)||o&&!s(a,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,i=Ua();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){i.resolve(),t&&t(e)})),i):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=Ua();"string"==typeof e&&(e=[e]);var i=this.options.preload||[],o=e.filter((function(e){return i.indexOf(e)<0}));return o.length?(this.options.preload=i.concat(o),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";var t=this.services&&this.services.languageUtils||new is(Is());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ts,o=Es(Es(Es({},this.options),n),{isClone:!0}),a=new t(o);return void 0===n.debug&&void 0===n.prefix||(a.logger=a.logger.clone(n)),["store","services","language"].forEach((function(t){a[t]=e[t]})),a.services=Es({},this.services),a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a.translator=new ts(a.services,a.options),a.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];a.emit.apply(a,[e].concat(n))})),a.init(o,i),a.translator.options=a.options,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),t}();Aa(ks,"createInstance",(function(){return new ks(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}));var Ss=ks.createInstance();Ss.createInstance=ks.createInstance,Ss.createInstance,Ss.dir,Ss.init,Ss.loadResources,Ss.reloadResources,Ss.use,Ss.changeLanguage,Ss.getFixedT,Ss.t,Ss.exists,Ss.setDefaultNamespace,Ss.hasLoadedNamespace,Ss.loadNamespaces,Ss.loadLanguages;class Ds extends sa{constructor(){super(),this.languages=null,this.keyMap={}}static getInstance(){return Ds.instance||(Ds.instance=new Ds),Ds.instance}provideLanguages(e){var t;qo||(this.languages=e,(null===(t=e["zh-CN"])||void 0===t?void 0:t.Chat)&&this.setKeyMap(e["zh-CN"]),c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUITranslateService.provideLanguages ok."))}useI18n(e){var t;if(qo)return;if(!this.languages)return void c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUITranslateService.useI18next not have messages.");const n={};for(const[o,a]of Object.entries(this.languages))n["zh_cn"===o?"zh":o]={translation:a};Ss.init({compatibilityJSON:"v3",lng:e||"zh",fallbackLng:"zh",detection:{order:["querystring","navigator"],caches:["localStorage","cookie"]},resources:n});let i=this.normalizeLanguageKey(e||"zh");null===(t=this.getEngine().TUIReport)||void 0===t||t.reportFeature(201,i)}changeLanguage(e){let t=this.normalizeLanguageKey(e);return this.getEngine().TUIReport.reportFeature(201,t),Ss.changeLanguage(e)}normalizeLanguageKey(e){return e.includes("en")?"en-us":e.includes("tw")?"zh-tw":e.includes("zh")||e.includes("cn")?"zh-cn":e.includes("ko")||e.includes("kr")?"ko-kr":e.includes("ja")||e.includes("jp")?"ja-jp":"other-"+e}t(e){if(!this.languages){let t=e;return!Oo(e)&&e.indexOf(".")>-1&&(t=e.split(".").pop()||""),t}const t=this.keyMap[e];return t?Ss.t(t):Ss.t(e)}setKeyMap(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=t?`${t}.${n}`:n;if(e[n]&&"object"==typeof e[n]&&!Array.isArray(e[n])&&null!==e[n])this.setKeyMap(e[n],i);else{let i=t?`${t}.${e[n]}`:e[n];i=this.replaceKey(i),this.keyMap[i]=`${t}.${n}`}}}replaceKey(e){return e.startsWith("Chat")?e.replace("Chat","TUIChat"):e.startsWith("Conversation")?e.replace("Conversation","TUIConversation"):e.startsWith("Message")?e.replace("Message","message.tip"):e.startsWith("Call")?e.replace("Call","message.custom"):e}}class bs extends sa{constructor(){super(),this.serv="TUIConversationService"}static getInstance(){return bs.instance||(bs.instance=new bs),bs.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalUnreadCountUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),this.getConversationInitData()}onConversationListUpdated(e){const t=this.filterSystemConversation(e);this.getEngine().TUIStore.update(To.CONV,"conversationList",t),this.updateCurrentConversation()}onTotalUnreadCountUpdated(e){this.getEngine().TUIStore.update(To.CONV,"totalUnreadCount",e)}onMessageReceived(e){const t=this.getEngine(),n=this.getEngine().TUIStore.getData(To.CONV,"conversationList");let i=!1;for(let o=0;o<e.length;o++){if(e[o].type!==t.TYPES.MSG_GRP_SYS_NOTICE)continue;const{operationType:a}=e[o].payload,s=`GROUP${e[o].to}`,r=4===a||5===a||8===a,c=2===a||6===a||7===a;if(r||c)for(let e=0;e<n.length;e++)if(n[e].type!==t.TYPES.CONV_C2C&&n[e].conversationID===s){if(r){this.getEngine().TUIStore.update(To.CONV,"operationTypeMap",{conversationID:s,operationType:a}),i=!0;break}if(c&&n[e].operationType>0){this.getEngine().TUIStore.update(To.CONV,"operationTypeMap",{conversationID:s,operationType:0}),i=!0;break}}}if(i){this.getEngine().TUIStore.update(To.CONV,"conversationList",n);const e=this.getEngine().TUIStore.getData(To.CONV,"currentConversationID")||"",t=this.findConversation(e);t&&this.getEngine().TUIStore.update(To.CONV,"currentConversation",t)}}getConversationInitData(){const e=this.getEngine();e.chat.isReady()&&e.chat.getConversationList().then((t=>{const{conversationList:n,isSyncCompleted:i}=t.data;if(c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${this.serv}.init, getConversationList count:${n.length} isSyncCompleted:${i}`),n.length>0){this.onConversationListUpdated(n);const t=e.chat.getTotalUnreadMessageCount();this.onTotalUnreadCountUpdated(t)}}))}switchConversation(e){return Mo(this,void 0,void 0,(function*(){const t=`${this.serv}.switchConversation`,n=this.getEngine();if(!e)return n.TUIStore.reset(To.CHAT,["messageList","isCompleted","nextReqMessageID"]),n.TUIStore.update(To.CONV,"currentConversationID",""),n.TUIStore.update(To.CONV,"currentConversation",null),c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${t} conversationID is empty, conversationID:${e}`),Promise.resolve({});if(!e.startsWith(n.TYPES.CONV_C2C)&&!e.startsWith(n.TYPES.CONV_GROUP))return c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${t} conversationID is invalid, conversationID:${e}`),Promise.reject({code:Ao.INVALID_CONV_ID,message:Ro.INVALID_CONV_ID});const i=n.TUIStore.getData(To.CONV,"currentConversationID");if(i&&i===e)return this.setMessageRead(i),c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${t} please check conversationID, conversationID:${e}`),Promise.resolve({code:Ao.CONV_ID_SAME,message:Ro.CONV_ID_SAME});const o=yield this.getConversationModel(e);return Oo(o)?(c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${t} target conversation is not exist, conversationID:${e}`),Promise.reject({code:Ao.CONV_NOT_EXIST,message:Ro.CONV_NOT_EXIST})):(i&&this.setMessageRead(i),e&&this.setMessageRead(e),n.TUIStore.reset(To.CHAT,["messageList","isCompleted","nextReqMessageID"]),n.TUIStore.update(To.CONV,"currentConversationID",e),n.TUIStore.update(To.CONV,"currentConversation",o),Promise.resolve(o))}))}getConversationModel(e){return Mo(this,void 0,void 0,(function*(){let t=this.findConversation(e);if(Oo(t))try{const n=yield this.getConversationProfile(e);n.data&&n.data.conversation&&(t=new ua(n.data.conversation))}catch(n){t=void 0}return t}))}findConversation(e){let t;const n=this.getEngine().TUIStore.getData(To.CONV,"conversationList");for(let i=0;i<n.length;i++)if(n[i].conversationID===e){t=n[i];break}return t}updateCurrentConversation(){const e=this.getEngine(),t=e.TUIStore.getData(To.CONV,"currentConversationID"),n=this.findConversation(t);n&&e.TUIStore.update(To.CONV,"currentConversation",n)}getConversationList(){return this.getEngine().chat.getConversationList()}getConversationProfile(e){return this.getEngine().chat.getConversationProfile(e)}deleteConversation(e){return this.getEngine().chat.deleteConversation(e).then((t=>{const n=this.getEngine().TUIStore.getData(To.CONV,"currentConversationID");return c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${this.serv}.deleteConversation conversationID:${e} currentConversationID:${n}`),e===n&&(this.getEngine().TUIStore.update(To.CONV,"currentConversationID",""),this.getEngine().TUIStore.update(To.CONV,"currentConversation",null)),t}))}pinConversation(e){return this.getEngine().chat.pinConversation(e)}muteConversation(e){return this.getEngine().chat.setMessageRemindType(e)}clearHistoryMessage(e){return this.getEngine().chat.clearHistoryMessage(e).then((e=>(this.getEngine().TUIStore.update(To.CHAT,"messageList",[]),this.getEngine().TUIStore.update(To.CHAT,"nextReqMessageID",""),this.getEngine().TUIStore.update(To.CHAT,"isCompleted",!0),e)))}setMessageRead(e){return this.getEngine().chat.setMessageRead({conversationID:e})}setConversationDraft(e){const{conversationID:t,draftInfo:n}=e;let i="";return n&&(i=JSON.stringify(n)),this.getEngine().chat.setConversationDraft({conversationID:t,draftText:i}).then((e=>{const{conversation:t}=e.data;this.updateConversation(t)}))}updateConversation(e){let t=!1;const n=this.getEngine().TUIStore.getData(To.CONV,"conversationList");for(let i=0;i<n.length;i++)if(n[i].conversationID===e.conversationID){n[i]=e,t=!0;break}t&&this.getEngine().TUIStore.update(To.CONV,"conversationList",n)}filterSystemConversation(e){return e.filter((e=>e.type!==this.getEngine().TYPES.CONV_SYSTEM))}}class As{constructor(e){this.TUIUserService=e}getEngine(){return this.TUIUserService.getEngine()}init(){this.getEngine().eventCenter.addEvent(this.getEngine().EVENT.PROFILE_UPDATED,this.onProfileUpdated.bind(this)),this.getEngine().eventCenter.addEvent(this.getEngine().EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated.bind(this)),this.getUserProfileInitData()}onProfileUpdated(e){const t=this.getEngine(),n=t.TUIStore.getData(To.USER,"userProfile");e.forEach((e=>{e.userID===n.userID&&t.TUIStore.update(To.USER,"userProfile",e)}))}onBlacklistUpdated(e){const t=this.getEngine();this.getBlacklistProfile(e).then((e=>{t.TUIStore.update(To.USER,"userBlacklist",e)}))}getUserProfileInitData(){const e=this.getEngine();e.chat.isReady()&&e.chat.getBlacklist().then((e=>{const t=e.data||[];c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`TUIUserProfileHandler.init, getBlacklist count:${t.length}`),t.length>0&&this.onBlacklistUpdated(t)}))}getBlacklistProfile(e){const t=[];let n=0;for(;n<e.length;)t.push(e.slice(n,n+=100));const i=[];t.forEach((e=>{i.push(this.TUIUserService.getUserProfile({userIDList:e}))}));const o=[];return Promise.all(i).then((e=>(e.forEach((e=>{const t=e.data.map((e=>{const{userID:t,nick:n,avatar:i}=e;return{userID:t,nick:n,avatar:i}}));o.push(...t)})),o)))}getUserProfile(e){const t=this.getEngine();return Oo(e)?t.chat.getMyProfile().then((e=>(t.TUIStore.update(To.USER,"userProfile",e.data),e))).catch((e=>Promise.reject(e))):t.chat.getUserProfile(e)}updateMyProfile(e){return this.getEngine().chat.updateMyProfile(e)}addToBlacklist(e){return this.getEngine().chat.addToBlacklist(e)}removeFromBlacklist(e){return this.getEngine().chat.removeFromBlacklist(e)}}function Ls(e,t,n=!0){var i,o;i=n?ws(e):e,o=t,Ko?$o.setStorageSync(i,o):Os()&&localStorage.setItem(i,JSON.stringify(o))}function Rs(e,t=!0){try{return function(e){if(Ko)return $o.getStorageSync(e);if(Os()){const t=localStorage.getItem(e);if("undefined"!==t)return JSON.parse(t)}}(t?ws(e):e)}catch(n){return void c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","Storage.getStorageItem error:",n)}}function ws(e){return`chat_engine_${e}`}function Os(){return navigator&&navigator.cookieEnabled&&localStorage}class Ns{constructor(e){this.TUIUserService=e}getEngine(){return this.TUIUserService.getEngine()}init(){const e=this.getEngine(),t=Rs("displayOnlineStatus")||!1;e.TUIStore.update(To.USER,"displayOnlineStatus",t),e.eventCenter.addEvent(e.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated.bind(this)),this.onConversationListUpdated()}onConversationListUpdated(){const e=this.getEngine();e.TUIStore.watch(To.CONV,{conversationList:()=>{const t=e.TUIStore.getData(To.APP,"enabledOnlineStatus"),n=e.TUIStore.getData(To.USER,"displayOnlineStatus");t&&n&&this.startToSubscribe()}})}onUserStatusUpdated(e){this.getEngine().TUIStore.update(To.USER,"userStatusList",e)}switchUserStatus(e){const t=this.getEngine(),{displayOnlineStatus:n=!1}=e;t.TUIStore.update(To.USER,"displayOnlineStatus",n),Ls("displayOnlineStatus",n);const i=t.TUIStore.getData(To.APP,"enabledOnlineStatus");i?!0===n?this.startToSubscribe():this.unsubscribeUserStatus():c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`UserStatusHandler.switchUserStatus enabledOnlineStatus:${i} displayOnlineStatus:${n}`)}getUserStatus(e){const t=this.getEngine();return t.chat.getUserStatus(e).then((e=>{const{successUserList:n}=e.data;return n.length>0&&t.TUIStore.update(To.USER,"userStatusList",n),e})).catch((e=>Promise.reject(e)))}subscribeUserStatus(e){var t;const n=(null===(t=null==e?void 0:e.userIDList)||void 0===t?void 0:t.length)||0;return 0===n?(c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`UserStatusHandler.subscribeUserStatus userID count:${n}`),Promise.resolve()):this.getEngine().chat.subscribeUserStatus(e)}unsubscribeUserStatus(e){const t=this.getEngine(),{userIDList:n=[]}=e||{};return t.chat.unsubscribeUserStatus({userIDList:n}).then((e=>{const{failureUserList:i}=e.data,o=[];return n.forEach((e=>{i.includes(e)||o.push({userID:e,statusType:ko.UNSUB_USER})})),t.TUIStore.update(To.USER,"userStatusList",o),e})).catch((e=>Promise.reject(e)))}startToSubscribe(){const e=this.getEngine(),t=e.TUIStore.getData(To.CONV,"conversationList"),n=e.TUIStore.getData(To.USER,"userStatusList"),i=[];t.forEach((t=>{if(t.type===e.TYPES.CONV_C2C){const o=t.conversationID.replace(e.TYPES.CONV_C2C,"");n.has(o)||i.push(o)}})),0!==i.length&&e.chat.isReady()&&(this.subscribeUserStatus({userIDList:i}),this.getUserStatus({userIDList:i}))}}class Ps extends sa{constructor(){super(),this.userProfileHandler=new As(this),this.userStatusHandler=new Ns(this)}static getInstance(){return Ps.instance||(Ps.instance=new Ps),Ps.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.KICKED_OUT,this.onKickedOut.bind(this)),e.eventCenter.addEvent(e.EVENT.NET_STATE_CHANGE,this.onNetStateChange.bind(this)),this.userProfileHandler.init(),this.userStatusHandler.init(),this.initMessageReadReceipt()}onKickedOut(e){this.getEngine().TUIStore.update(To.USER,"kickedOut",e.type)}onNetStateChange(e){this.getEngine().TUIStore.update(To.USER,"netStateChange",e.state)}initMessageReadReceipt(){const e=Rs("displayMessageReadReceipt")||!0;this.getEngine().TUIStore.update(To.USER,"displayMessageReadReceipt",e)}switchUserStatus(e){return this.userStatusHandler.switchUserStatus(e)}switchMessageReadStatus(e){this.getEngine().TUIStore.update(To.USER,"displayMessageReadReceipt",e),Ls("displayMessageReadReceipt",e)}getUserProfile(e){return this.userProfileHandler.getUserProfile(e)}updateMyProfile(e){return this.userProfileHandler.updateMyProfile(e)}addToBlacklist(e){return this.userProfileHandler.addToBlacklist(e)}removeFromBlacklist(e){return this.userProfileHandler.removeFromBlacklist(e)}getUserStatus(e){return this.userStatusHandler.getUserStatus(e)}subscribeUserStatus(e){return this.userStatusHandler.subscribeUserStatus(e)}unsubscribeUserStatus(e){return this.userStatusHandler.unsubscribeUserStatus(e)}}class Us{constructor(e){this.TUIChatService=e,this.userShowNameMap=new Map,this.requestedUserMap=new Map}getEngine(){return this.TUIChatService.getEngine()}t(e){return this.getEngine().TUITranslate.t(e)}handleTextMessage(e){return{text:this.decodeText(e.payload)}}handleFaceMessage(e){const t={name:"",url:"",type:""};return e.payload.data.indexOf("@custom")>-1?(t.name=e.payload.data,t.type="custom",t):(t.name=e.payload.data.indexOf("@2x")<0?`${e.payload.data}@2x`:e.payload.data,t.url=`https://web.sdk.qcloud.com/im/assets/face-elem/${t.name}.png`,t)}handleLocationMessage(e){const t={lon:"",lat:"",href:"",url:"",description:""};return t.lon=e.payload.longitude.toFixed(6),t.lat=e.payload.latitude.toFixed(6),t.href=`https://map.qq.com/?type=marker&isopeninfowin=1&markertype=1&pointx=${t.lon}&pointy=${t.lat}&name=${e.payload.description}`,t.url=`https://apis.map.qq.com/ws/staticmap/v2/?center=${t.lat},${t.lon}&zoom=10&size=300*150&maptype=roadmap&markers=size:large|color:0xFFCCFF|label:k|${t.lat},${t.lon}&key=UBNBZ-PTP3P-TE7DB-LHRTI-Y4YLE-VWBBD`,t.description=e.payload.description,t}handleImageMessage(e){return{url:e.payload.imageInfoArray[0].url,width:e.payload.imageInfoArray[0].width,height:e.payload.imageInfoArray[0].height}}handleAudioMessage(e){return{url:e.payload.url,second:e.payload.second}}handleVideoMessage(e){return{url:e.payload.videoUrl,snapshotUrl:e.payload.snapshotUrl,snapshotWidth:e.payload.snapshotWidth,snapshotHeight:e.payload.snapshotHeight}}handleFileMessage(e){return{url:e.payload.fileUrl,name:e.payload.fileName,size:Go(e.payload.fileSize)}}handleCustomMessage(e){var t;const n=this.handleCreateGroupCustomMessage(e);return{custom:this.handleCallKitSignaling(e)||n||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.extension)||`${this.t("TUIChat.[自定义消息]")}`,businessID:n?"group_create":""}}handleMergeMessage(e){return Object.assign({},e.payload)}handleGroupTipsMessage(e){var t,n,i,o,a,s;const r=this.getEngine(),c={text:""};let u=(null==e?void 0:e.nick)||(null===(n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.userIDList)||void 0===n?void 0:n.join(","));switch((null===(o=null===(i=null==e?void 0:e.payload)||void 0===i?void 0:i.memberList)||void 0===o?void 0:o.length)>0&&(u="",null===(s=null===(a=null==e?void 0:e.payload)||void 0===a?void 0:a.memberList)||void 0===s||s.map((e=>{const t=(null==e?void 0:e.nick)||(null==e?void 0:e.userID);return u+=`${this.substringByLength(t)},`,e})),u=null==u?void 0:u.slice(0,-1)),e.payload.operationType){case r.TYPES.GRP_TIP_MBR_JOIN:c.text=`${u} ${this.t("message.tip.加入群组")}`;break;case r.TYPES.GRP_TIP_MBR_QUIT:c.text=`${this.t("message.tip.群成员")}：${u} ${this.t("message.tip.退出群组")}`;break;case r.TYPES.GRP_TIP_MBR_KICKED_OUT:c.text=`${this.t("message.tip.群成员")}：${u} ${this.t("message.tip.被")}${this.t("message.tip.踢出群组")}`;break;case r.TYPES.GRP_TIP_MBR_SET_ADMIN:c.text=`${this.t("message.tip.群成员")}：${u} ${this.t("message.tip.成为管理员")}`;break;case r.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:c.text=`${this.t("message.tip.群成员")}：${u} ${this.t("message.tip.被撤销管理员")}`;break;case r.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:c.text=this.handleGroupProfileUpdated(e);break;case r.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:for(const t of e.payload.memberList)t.muteTime>0?c.text=`${this.t("message.tip.群成员")}：${u} ${this.t("message.tip.被禁言")}`:c.text=`${this.t("message.tip.群成员")}：${u} ${this.t("message.tip.被取消禁言")}`;break;default:c.text=`[${this.t("message.tip.群提示消息")}]`}return c}handleGroupSystemMessage(e){const t=e.payload.groupProfile.name||e.payload.groupProfile.groupID,n={text:""};switch(e.payload.operationType){case 1:n.text=`${e.payload.operatorID} ${this.t("message.tip.申请加入群组")}：${t}`;break;case 2:n.text=`${this.t("message.tip.成功加入群组")}：${t}`;break;case 3:n.text=`${this.t("message.tip.申请加入群组")}：${t} ${this.t("message.tip.被拒绝")}`;break;case 4:n.text=`${this.t("message.tip.你被管理员")}${e.payload.operatorID} ${this.t("message.tip.踢出群组")}：${t}`;break;case 5:n.text=`${this.t("message.tip.群")}：${t} ${this.t("message.tip.被")} ${e.payload.operatorID} ${this.t("message.tip.解散")}`;break;case 6:n.text=`${e.payload.operatorID} ${this.t("message.tip.创建群")}：${t}`;break;case 7:case 12:n.text=`${e.payload.operatorID} ${this.t("message.tip.邀请你加群")}：${t}`;break;case 8:n.text=`${this.t("message.tip.你退出群组")}：${t}`;break;case 9:n.text=`${this.t("message.tip.你被")}${e.payload.operatorID} ${this.t("message.tip.设置为群")}：${t} ${this.t("message.tip.的管理员")}`;break;case 10:n.text=`${this.t("message.tip.你被")}${e.payload.operatorID} ${this.t("message.tip.撤销群")}：${t} ${this.t("message.tip.的管理员身份")}`;break;case 13:n.text=`${e.payload.operatorID} ${this.t("message.tip.同意加群")}：${t}`;break;case 14:n.text=`${e.payload.operatorID} ${this.t("message.tip.拒接加群")}：${t}`;break;case 255:n.text=`${this.t("message.tip.自定义群系统通知")}: ${e.payload.userDefinedField}`;break;default:n.text="未解析的群系统通知"}return n}handleCallKitSignaling(e){var t,n,i,o,a,s,r,c,u,l;const d=Uo(e.payload.data);if(1!==(null==d?void 0:d.businessID))return"";const h=Uo(null==d?void 0:d.data),p=e.fromAccount||e.from,g=this.getEngine().TUIFriend.getFriendRemark([p]),f=this.getEngine().getMyUserID();let m=g[p]||e.nameCard||e.nick||p;switch(m=this.substringByLength(m),null==d?void 0:d.actionType){case 1:return"audioCall"!==(null===(t=null==h?void 0:h.data)||void 0===t?void 0:t.cmd)&&"videoCall"!==(null===(n=null==h?void 0:h.data)||void 0===n?void 0:n.cmd)||!(null==d?void 0:d.groupID)?"hangup"===(null===(i=null==h?void 0:h.data)||void 0===i?void 0:i.cmd)?(null==d?void 0:d.groupID)?`${this.t("message.custom.通话结束")}`:`${this.t("message.custom.通话时长")}：${function(e){const t=e;let n,i,o,a="";return t>=3600?(n=parseInt(""+t/3600,10)<10?`0${parseInt(""+t/3600,10)}`:parseInt(""+t/3600,10),i=parseInt(""+t%60/60,10)<10?`0${parseInt(""+t%60/60,10)}`:parseInt(""+t%60/60,10),o=t%3600<10?"0"+t%3600:t%3600,o>60&&(i=parseInt(""+o/60,10)<10?`0${parseInt(""+o/60,10)}`:parseInt(""+o/60,10),o=o%60<10?"0"+o%60:o%60),a=`${n}:${i}:${o}`):t>=60&&t<3600?(i=parseInt(""+t/60,10)<10?`0${parseInt(""+t/60,10)}`:parseInt(""+t/60,10),o=t%60<10?"0"+t%60:t%60,a=`00:${i}:${o}`):t<60&&(o=t<10?`0${t}`:t,a=`00:00:${o}`),a}(null==h?void 0:h.call_end)}`:"switchToAudio"===(null===(o=null==h?void 0:h.data)||void 0===o?void 0:o.cmd)?`${this.t("message.custom.切换语音通话")}`:"switchToVideo"===(null===(a=null==h?void 0:h.data)||void 0===a?void 0:a.cmd)?`${this.t("message.custom.切换视频通话")}`:`${this.t("message.custom.发起通话")}`:`${m} ${this.t("message.custom.发起通话")}`;case 2:return(null==d?void 0:d.groupID)?`${m} ${this.t("message.custom.取消通话")}`:this.isOldUIKit("message.custom.已取消")?this.t("message.custom.取消通话"):(null==d?void 0:d.inviter)===f?this.t("message.custom.已取消"):this.t("message.custom.对方已取消");case 3:return"switchToAudio"===(null===(s=null==h?void 0:h.data)||void 0===s?void 0:s.cmd)?`${this.t("message.custom.切换语音通话")}`:"switchToVideo"===(null===(r=null==h?void 0:h.data)||void 0===r?void 0:r.cmd)?`${this.t("message.custom.切换视频通话")}`:(null==d?void 0:d.groupID)?`${m} ${this.t("message.custom.已接听")}`:this.t("message.custom.已接听");case 4:return(null==d?void 0:d.groupID)?`${m} ${this.t("message.custom.拒绝通话")}`:this.isOldUIKit("message.custom.已拒绝")?this.t("message.custom.拒绝通话"):"line_busy"===(null==h?void 0:h.line_busy)||"lineBusy"===(null==h?void 0:h.data.message)?(null==d?void 0:d.inviter)===f?this.t("message.custom.对方忙线中"):this.t("message.custom.忙线未接听"):(null==d?void 0:d.inviter)===f?this.t("message.custom.对方已拒绝"):this.t("message.custom.已拒绝");case 5:if("switchToAudio"===(null===(c=null==h?void 0:h.data)||void 0===c?void 0:c.cmd))return`${this.t("message.custom.切换语音通话")}`;if("switchToVideo"===(null===(u=null==h?void 0:h.data)||void 0===u?void 0:u.cmd))return`${this.t("message.custom.切换视频通话")}`;if(null==d?void 0:d.groupID){if(p===(null==d?void 0:d.inviter)){this.handleCallkitTimeoutSignaling(d.inviteeList);let e="";return null===(l=d.inviteeList)||void 0===l||l.forEach((t=>{const n=this.userShowNameMap.get(t)||t;e+=`${this.substringByLength(n)}、`})),e=e.substring(0,e.lastIndexOf("、")),`${e} ${this.t("message.custom.无应答")}`}return`${m} ${this.t("message.custom.无应答")}`}return this.isOldUIKit("message.custom.对方无应答")?this.t("message.custom.无应答"):(null==d?void 0:d.inviter)===f?this.t("message.custom.对方无应答"):this.t("message.custom.超时无应答");default:return""}}handleCreateGroupCustomMessage(e){let t;const n=Uo(e.payload.data);return"group_create"===(null==n?void 0:n.businessID)&&(t=`${n.opUser} ${n.content}`),t}decodeText(e){const t=[];let n=e.text,i=-1,o=-1;for(;""!==n;)switch(i=n.indexOf("["),o=n.indexOf("]"),i){case 0:if(-1===o)t.push({name:"text",text:n}),n="";else{const e=n.slice(0,o+1);e.indexOf("@custom")>-1?(t.push({name:"img",src:"",type:"custom",emojiKey:e}),n=n.substring(o+1)):xo[e]?(t.push({name:"img",src:"https://web.sdk.qcloud.com/im/assets/emoji-plugin/"+xo[e],emojiKey:e}),n=n.substring(o+1)):(t.push({name:"text",text:"["}),n=n.slice(1))}break;case-1:t.push({name:"text",text:n}),n="";break;default:t.push({name:"text",text:n.slice(0,i)}),n=n.substring(i)}return t}handleGroupProfileUpdated(e){const{nick:t,payload:n}=e,{newGroupProfile:i,memberList:o,operatorID:a}=n;let s="";const r=t||a,c=Object.keys(i)[0];switch(c){case"muteAllMembers":s=i[c]?`${this.t("message.tip.管理员")} ${r} ${this.t("message.tip.开启全员禁言")}`:`${this.t("message.tip.管理员")} ${r} ${this.t("message.tip.取消全员禁言")}`;break;case"ownerID":s=`${o[0].nick||o[0].userID} ${this.t("message.tip.成为新的群主")}`;break;case"groupName":s=`${r} ${this.t("message.tip.修改群名为")} ${i[c]}`;break;case"notification":s=this.isOldUIKit("message.tip.把群公告修改为")?`${r} ${this.t("message.tip.发布新公告")}`:`${r} ${this.t("message.tip.把群公告修改为")} "${i[c]}"`}return s}handleCallkitTimeoutSignaling(e=[]){if(0===e.length)return;const t=this.getEngine().TUIFriend.getFriendRemark(e),n=[];e.forEach((e=>{const i=t[e];i?this.userShowNameMap.set(e,i):this.requestedUserMap.has(e)||(n.push(e),this.requestedUserMap.set(e,1))})),n.length>0&&this.getEngine().TUIUser.getUserProfile({userIDList:n}).then((e=>{(e.data||[]).forEach((e=>{const{userID:t,nick:n}=e,i=n||t;this.userShowNameMap.set(t,i)}))})).catch((()=>{}))}substringByLength(e,t=12){return e.length>t?`${e.slice(0,t)}...`:e}isOldUIKit(e){var t;const n=e.lastIndexOf("."),i=e.slice(0,n+1);return null===(t=this.t(e))||void 0===t?void 0:t.startsWith(i)}}class Gs{constructor(e){this.TUIChatService=e,this.typingTo="",this.timer=null}getEngine(){return this.TUIChatService.getEngine()}clearTypingStatus(){this.getEngine().TUIStore.getData(To.CHAT,"typingStatus")&&this.getEngine().TUIStore.update(To.CHAT,"typingStatus",!1),this.timer&&clearTimeout(this.timer),this.timer=null}handleLastMessage(e){const t=this.getEngine(),n=t.TUIStore.getData(To.CHAT,"typingStatus");if(e.type===this.getEngine().TYPES.MSG_CUSTOM&&"in"===e.flow){const i=Uo(e.payload.data);if(i.businessID===So.BUSINESS_ID){const{typingStatus:e,userAction:o}=i;if(e===So.STATUS_START||o===So.ACTION_START_ID)return n?(this.timer&&clearTimeout(this.timer),this.timer=null):t.TUIStore.update(To.CHAT,"typingStatus",!0),this.timer=setTimeout((()=>{this.clearTypingStatus()}),3e4),t.TUIStore.getData(To.CHAT,"typingStatus");e!==So.STATUS_END&&o!==So.ACTION_END_ID||this.clearTypingStatus()}}}filterTypingMessage(e=[]){return 0===e.length?[]:(this.getEngine().TUIStore.getData(To.APP,"enableTyping")&&this.handleLastMessage(e[e.length-1]),e.filter((e=>e.type!==this.getEngine().TYPES.MSG_CUSTOM||Uo(e.payload.data).businessID!==So.BUSINESS_ID)))}createTypingMessage(e=So.STATUS_END,t=""){const{BUSINESS_ID:n,STATUS_START:i,VERSION:o,ACTION_START_ID:a,ACTION_END_ID:s,ACTION_START:r,ACTION_END:c,NEED_TYPING:u}=So;return{to:t,conversationType:this.getEngine().TYPES.CONV_C2C,payload:{data:JSON.stringify({businessID:n,typingStatus:e,version:o,userAction:e===i?a:s,actionParam:e===i?r:c}),description:"",extension:""},cloudCustomData:JSON.stringify({messageFeature:{needTyping:u,version:o}})}}sendTyping(e=!1,t=""){if(e){this.typingTo=t;const e=this.createTypingMessage(So.STATUS_START,t);this.getEngine().TUIChat.sendCustomMessage(e,{onlineUserOnly:!0})}else this.sendTypingEnd()}sendTypingEnd(){if(this.typingTo){const e=this.createTypingMessage(So.STATUS_END,this.typingTo);this.getEngine().TUIChat.sendCustomMessage(e,{onlineUserOnly:!0})}this.typingTo=""}}class xs{constructor(e){this.TUIChatService=e}getEngine(){return this.TUIChatService.getEngine()}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived.bind(this))}onMessageReadReceiptReceived(e){const t=this.getEngine(),n=t.TUIStore.getData(To.CONV,"currentConversationID"),i=[];e.forEach((e=>{const{messageID:o}=e,a=t.chat.findMessage(o);a&&n===a.conversationID&&i.push(a)})),i.length>0&&t.TUIChat.updateMessageList(i,"edit")}sendMessageReadReceipt(e){const t=[];return e.forEach((e=>{const n=e.getMessage();t.push(n)})),this.getEngine().chat.sendMessageReadReceipt(t)}getGroupMessageReadMemberList(e){const t=e.message.getMessage(),n=Object.assign(Object.assign({},e),{message:t});return this.getEngine().chat.getGroupMessageReadMemberList(n)}getMessageReadReceiptList(e){const t=this.getEngine(),n=t.TUIStore.getData(To.APP,"enabledMessageReadReceipt"),i=t.TUIStore.getData(To.USER,"displayMessageReadReceipt");!n||!i||0===e.length||e[0].conversationType!==t.TYPES.CONV_GROUP||t.chat.getMessageReadReceiptList(e).then((e=>{const{messageList:t}=e.data;this.TUIChatService.updateMessageList(t,"edit")})).catch((e=>{c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`ReadReceiptHandler.getMessageReadReceiptList error:${e.message}`)}))}}class Fs extends sa{constructor(){super(),this.serv="TUIChatService",this.messageHandler=new Us(this),this.typingHandler=new Gs(this),this.readReceiptHandler=new xs(this),this.isSwitching=!0,this.delayGetHoppingFunction=void 0,this.hoppingConfigMap=new Map}static getInstance(){return Fs.instance||(Fs.instance=new Fs),Fs.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_MODIFIED,this.onMessageModified.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_REVOKED,this.onMessageRevoked.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_REACTIONS_UPDATED,this.onMessageReactionsUpdated.bind(this)),this.onCurrentConversationIDUpdated(),this.onMessageSource(),this.readReceiptHandler.init()}onMessageReceived(e){this.updateMessageList(e,"received"),this.getEngine().TUIStore.update(To.CHAT,"newMessageList",e)}onMessageModified(e){this.updateMessageList(e,"edit")}onMessageRevoked(e){this.updateMessageList(e,"edit")}onMessageReadByPeer(e){this.updateMessageList(e,"edit")}onMessageReactionsUpdated(e){this.updateMessageReactionList([e])}onCurrentConversationIDUpdated(){const e=this.getEngine();e.TUIStore.watch(To.CONV,{currentConversationID:t=>{this.isSwitching=!0,this.delayGetHoppingFunction=void 0,this.hoppingConfigMap.clear(),e.TUIStore.reset(To.CHAT),this.typingHandler.clearTypingStatus(),this.typingHandler.sendTypingEnd(),ra(t)||this.getMessageList().finally((()=>{this.isSwitching=!1,this.delayGetHoppingFunction&&this.delayGetHoppingFunction()}))}})}onMessageSource(){const e=this.getEngine();e.TUIStore.watch(To.CHAT,{messageSource:t=>{const n=this.getStoreData(To.CONV,"currentConversationID");if(!n||t&&t.conversationID!==n)return;if(Oo(t))return this.hoppingConfigMap.clear(),e.TUIStore.update(To.CHAT,"messageList",[]),e.TUIStore.update(To.CHAT,"nextReqMessageID",""),e.TUIStore.update(To.CHAT,"isCompleted",!1),void this.getMessageList();const i=this.getStoreData(To.CHAT,"messageList");i&&i.find((e=>t&&e.ID===t.ID))||(this.isSwitching?this.delayGetHoppingFunction=this.getMessageListHoppingForDown:this.getMessageListHoppingForDown())}})}getMessageListHoppingForDown(){const e=this.getStoreData(To.CHAT,"messageList"),{conversationID:t,sequence:n,time:i,ID:o}=this.getStoreData(To.CHAT,"messageSource");if(e&&e.find((e=>o&&e.ID===o)))return;const a=this.getEngine();a.TUIStore.update(To.CHAT,"messageList",[]),a.TUIStore.update(To.CHAT,"nextReqMessageID",""),a.TUIStore.update(To.CHAT,"isCompleted",!1),this.getMessageListHopping({conversationID:t,sequence:n,time:i,direction:1})}getStoreData(e,t){return this.getEngine().TUIStore.getData(e,t)}sendMessage(e,t){this.updateMessageList([e],"send");const n=this.getEngine().chat.sendMessage(e,t);return this.getResponse(n)}getResponse(e,t=!0,n=!0){return e.then((e=>{const n=e.data.messageList?e.data.messageList:[e.data.message];return t&&this.updateMessageList(n,"edit"),e})).catch((e=>{var t;return n&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.message)&&this.updateMessageList([e.data.message],"edit"),Promise.reject(e)}))}updateMessageList(e,t=""){if(this.getStoreData(To.CHAT,"messageSource")&&"unshift"!==t&&"edit"!==t)return;const n=this.getStoreData(To.CHAT,"messageList"),i=this.updateTargetMessageList(e,n,t);this.getEngine().TUIStore.update(To.CHAT,"messageList",i)}updateTargetMessageList(e,t,n=""){const i=this.getStoreData(To.CONV,"currentConversationID");let o=e.filter((e=>e.conversationID===i));if(o=this.handleC2CCallSignaling(o),!n||0===o.length)return t;const a=t||[];let s=[];if("send"===n||"push"===n){const e=this.getStoreData(To.CHAT,"userInfo");Object.keys(e).length>0&&this.updateLocalMessage(o,e)}switch(n){case"edit":for(const e of t){const t=o.find((t=>t.ID===e.ID));s.push(t||e)}break;case"resend":s=a.filter((e=>e.ID!==o[0].ID)).concat(o);break;case"send":s=a.concat(this.typingHandler.filterTypingMessage(o));break;case"push":s=a.concat(this.typingHandler.filterTypingMessage(o)),this.getEngine().chat.setMessageRead({conversationID:i});break;case"received":s=a.concat(this.typingHandler.filterTypingMessage(o)),s=this.sortMessageList(s),this.getEngine().chat.setMessageRead({conversationID:i});break;case"unshift":s=o.filter((e=>0===a.length||!a.find((t=>t.ID===e.ID)))),s.push(...a),s=this.sortMessageList(s)}return s}enterTypingState(){this.getStoreData(To.APP,"enableTyping")&&this.sendTyping(!0)}leaveTypingState(){this.getStoreData(To.APP,"enableTyping")&&this.sendTyping(!1)}sendTyping(e){const t=this.getEngine(),n=this.getStoreData(To.CONV,"currentConversationID");if(!n.startsWith(t.TYPES.CONV_C2C))return;const i=n.replace(t.TYPES.CONV_C2C,"");if(e){const e=this.getStoreData(To.CHAT,"messageList").filter((e=>"in"===e.flow));if(0===e.length)return;const t=1e3*e[e.length-1].time;if((new Date).getTime()-t>3e4)return}this.typingHandler.sendTyping(e,i)}quoteMessage(e){var t;return this.getEngine().TUIStore.update(To.CHAT,"quoteMessage",{message:e,type:"quote"}),null===(t=this.getEngine().TUIReport)||void 0===t||t.reportFeature(205),e}replyMessage(e){return this.getEngine().TUIStore.update(To.CHAT,"quoteMessage",{message:e,type:"reply"}),e}getCurrentConvInfo(){const{conversationID:e="",type:t}=this.getStoreData(To.CONV,"currentConversation")||{};return{to:e.replace(t,""),conversationType:t}}t(e){return this.getEngine().TUITranslate.t(e)||e}getMessageAbstractAndType(e){var t,n;const i=this.getEngine(),o={abstract:"",type:0};switch(e.type){case i.TYPES.MSG_TEXT:o.abstract=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.text,o.type=1;break;case i.TYPES.MSG_CUSTOM:o.abstract="[自定义消息]",o.type=2;break;case i.TYPES.MSG_IMAGE:o.abstract="[图片]",o.type=3;break;case i.TYPES.MSG_AUDIO:o.abstract="[语音]",o.type=4;break;case i.TYPES.MSG_VIDEO:o.abstract="[视频]",o.type=5;break;case i.TYPES.MSG_FILE:o.abstract="[文件]",o.type=6;break;case i.TYPES.MSG_LOCATION:o.type=7;break;case i.TYPES.MSG_FACE:o.abstract="[表情]",o.type=8;break;case i.TYPES.MSG_GRP_TIP:o.type=9;break;case i.TYPES.MSG_MERGER:o.abstract=null===(n=null==e?void 0:e.payload)||void 0===n?void 0:n.title,o.type=10}return o}genMessageReply(e,t){if("reply"!==t&&"quote"!==t)return{};const{abstract:n,type:i}=this.getMessageAbstractAndType(e),o={messageAbstract:n,messageSender:e.nick||e.from,messageID:e.ID},a=Object.assign(Object.assign({},o),{messageType:i,messageTime:null==e?void 0:e.time,messageSequence:null==e?void 0:e.sequence,version:1});if("reply"===t&&(a.messageRootID=e.ID,e.cloudCustomData)){const t=Uo(e.cloudCustomData);t.messageReply&&t.messageReply.messageRootID&&(a.messageRootID=t.messageReply.messageRootID)}return{messageReply:a,messageReplyRoot:o}}getMessageInfo(e,t,n){const{messageReply:i,messageReplyRoot:o}=this.genMessageReply(t,n),a=e.cloudCustomData?Uo(e.cloudCustomData):{};let s;if(a.messageReply?a.messageReply=Object.assign(Object.assign({},i),a.messageReply):a.messageReply=i,"reply"===n){const{messageRootID:e}=i;s=this.getEngine().chat.findMessage(e);const t=(null==s?void 0:s.cloudCustomData)?Uo(s.cloudCustomData):{};t.messageReplies||(t.messageReplies={}),r=t.messageReplies.replies,("function"==typeof Array.isArray?Array.isArray(r):"array"===Object.prototype.toString.call(r).match(/^\[object (.*)\]$/)[1].toLowerCase())||(t.messageReplies.replies=[]),t.messageReplies.replies.push(o),s.cloudCustomData=JSON.stringify(t)}var r;return{cloudCustomData:JSON.stringify(a),rootMessage:s}}sendTextMessage(e,t){const n=this.getEngine(),{message:i,type:o}=this.getStoreData(To.CHAT,"quoteMessage");let a={cloudCustomData:e.cloudCustomData||"",rootMessage:void 0};i&&(a=this.getMessageInfo(e,i,o));const s=n.chat.createTextMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{cloudCustomData:a.cloudCustomData}));return this.sendMessage(s,t).then((e=>(a.rootMessage&&this.modifyMessage(a.rootMessage),n.TUIStore.reset(To.CHAT,["quoteMessage"],!0),e)))}sendTextAtMessage(e,t){const n=this.getEngine(),{message:i,type:o}=this.getStoreData(To.CHAT,"quoteMessage");let a={cloudCustomData:e.cloudCustomData||"",rootMessage:void 0};i&&(a=this.getMessageInfo(e,i,o));const s=n.chat.createTextAtMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{cloudCustomData:a.cloudCustomData}));return this.sendMessage(s,t).then((e=>(a.rootMessage&&this.modifyMessage(a.rootMessage),n.TUIStore.reset(To.CHAT,["quoteMessage"],!0),e)))}sendImageMessage(e,t){const n=this.getEngine().chat.createImageMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendAudioMessage(e,t){const n=this.getEngine().chat.createAudioMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendVideoMessage(e,t){const n=this.getEngine().chat.createVideoMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendCustomMessage(e,t){const n=this.getEngine().chat.createCustomMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}sendFaceMessage(e,t){const n=this.getEngine().chat.createFaceMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}sendFileMessage(e,t){const n=this.getEngine().chat.createFileMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendLocationMessage(e,t){const n=this.getEngine().chat.createLocationMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}onProgress(e,t){const n=this.getEngine().TUIStore.getMessageModel(e);n&&(t-n.progress>=.1||1===t)&&(n.progress=t,this.updateMessageList([n],"edit"))}setAbstractList(e){const t=this.getEngine(),n=e.nick||e.from;let i="";switch(e.type){case t.TYPES.MSG_TEXT:i=e.payload.text||"",i.length>20&&(i=i.slice(0,20));break;case t.TYPES.MSG_MERGER:i=`${this.t("TUIChat.[聊天记录]")}`;break;case t.TYPES.MSG_IMAGE:i=`${this.t("TUIChat.[图片]")}`;break;case t.TYPES.MSG_AUDIO:i=`${this.t("TUIChat.[音频]")}`;break;case t.TYPES.MSG_VIDEO:i=`${this.t("TUIChat.[视频]")}`;break;case t.TYPES.MSG_CUSTOM:i=`${this.t("TUIChat.[自定义消息]")}`;break;case t.TYPES.MSG_FILE:i=`${this.t("TUIChat.[文件]")}`;break;case t.TYPES.MSG_FACE:i=`${this.t("TUIChat.[动画表情]")}`}return`${n}: ${i}`}genMergerForwardPayload(e,t){const{abstractList:n=[],compatibleText:i="",title:o}=t;return 0===n.length&&e.forEach((e=>{n.push(this.setAbstractList(e))})),{messageList:e,title:o,abstractList:n,compatibleText:i||this.t("TUIChat.请升级IMSDK到v2.10.1或更高版本查看此消息")}}genSendMergerForwardMessage(e){const{conversationList:t,messageList:n,params:i,mergeInfo:o,sendMessageOptions:a}=e,s=[];for(let r=0;r<t.length;r++){const{conversationID:e,type:c}=t[r],u=Object.assign({to:e.replace(`${c}`,""),conversationType:c,payload:this.genMergerForwardPayload(n,o)},i),l=this.getEngine().chat.createMergerMessage(u);s.push(this.sendMessage(l,a))}return s}genTitle(e,t){const{nick:n,from:i,to:o}=e;return`${n||i} ${this.t("TUIChat.和")} ${t||o} ${this.t("TUIChat.的聊天记录")}`}genMergeInfo(e){var t;return Mo(this,void 0,void 0,(function*(){const{messageList:n,mergeInfo:i}=e;if(i.title)return i;if(n[0].conversationType===this.getEngine().TYPES.CONV_GROUP)return i.title=this.t("TUIChat.群聊的聊天记录"),i;try{const{data:e=[]}=yield this.getEngine().TUIUser.getUserProfile({userIDList:[n[0].to]});i.title=this.genTitle(n[0],null===(t=e[0])||void 0===t?void 0:t.nick)}catch(o){i.title=this.genTitle(n[0])}return i}))}sendMergerForwardMessage(e){return Mo(this,void 0,void 0,(function*(){return e.mergeInfo=yield this.genMergeInfo(e),Promise.all(this.genSendMergerForwardMessage(e))}))}getOriginMessageList(e){return e.map((e=>e instanceof da?e.getMessage():e))}sendForwardMessage(e,t,n){t=this.getOriginMessageList(t);const i=n||{},{needMerge:o=!1,params:a={},mergeInfo:s={}}=i,r=Io(i,["needMerge","params","mergeInfo"]);if(o)return this.sendMergerForwardMessage({conversationList:e,messageList:t,params:a,mergeInfo:s,sendMessageOptions:r});const c=[];for(let u=0;u<e.length;u++){const{conversationID:n,type:i}=e[u],o=Object.assign({to:n.replace(`${i}`,""),conversationType:i},a),s=r[n]||r;for(let e=0;e<t.length;e++){Reflect.set(o,"payload",t[e]);const n=this.getEngine().chat.createForwardMessage(o);c.push(this.sendMessage(n,s))}}return Promise.all(c)}revokeMessage(e){const t=this.getEngine().chat.revokeMessage(e);return this.getResponse(t,!0,!1)}resendMessage(e){e.status="unSend",this.updateMessageList([e],"resend");const t=this.getEngine().chat.resendMessage(e);return this.getResponse(t,!0,!0)}deleteMessage(e){const t=this.getEngine().chat.deleteMessage(e);return this.getResponse(t,!0,!1)}setMessageExtensions(e,t){return this.getEngine().chat.setMessageExtensions(e,t)}getMessageExtensions(e){return this.getEngine().chat.getMessageExtensions(e)}deleteMessageExtensions(e,t){return this.getEngine().chat.deleteMessageExtensions(e,t)}modifyMessage(e){const t=this.getEngine().chat.modifyMessage(e);return this.getResponse(t,!0,!1).catch((e=>{const{code:t=0,data:n={}}=e.code;throw t===bo.MSG_MODIFY_CONFLICT?c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${Lo.MSG_MODIFY_CONFLICT} data.message: ${null==n?void 0:n.message}`):t===bo.MSG_MODIFY_DISABLED_IN_AVCHATROOM?c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",Lo.MSG_MODIFY_DISABLED_IN_AVCHATROOM):t===bo.MODIFY_MESSAGE_NOT_EXIST&&c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",Lo.MODIFY_MESSAGE_NOT_EXIST),e}))}getMessageList(e={conversationID:this.getStoreData(To.CONV,"currentConversationID"),nextReqMessageID:this.getStoreData(To.CHAT,"nextReqMessageID")}){const t=this.getEngine();if(!t.chat.isReady())return Promise.reject({code:Ao.GET_MSG_LIST_ERROR,message:Ro.GET_MSG_LIST_ERROR});if(this.getStoreData(To.CHAT,"isCompleted"))return Promise.resolve({data:{messageList:[],nextReqMessageID:"",isCompleted:!0}});const n=this.getStoreData(To.CHAT,"messageSource"),i=this.hoppingConfigMap.get("nextMessageSeq"),o=this.hoppingConfigMap.get("nextMessageTime"),a=i||o;return n&&n.conversationID===(null==e?void 0:e.conversationID)&&a?this.getMessageListHopping():t.chat.getMessageList(e).then((e=>{var n;const{messageList:i,nextReqMessageID:o,isCompleted:a}=e.data,s=this.getStoreData(To.CHAT,"userInfo");Object.keys(s).length>0&&this.updateLocalMessage(i,s),this.updateMessageList(i,"unshift"),t.TUIStore.update(To.CHAT,"nextReqMessageID",o),t.TUIStore.update(To.CHAT,"isCompleted",a);const r=null===(n=i[0])||void 0===n?void 0:n.conversationID,{operationType:c=0}=this.getEngine().TUIStore.getConversationModel(r)||{};return 0===c&&(this.getMessageReactions({messageList:i}),this.readReceiptHandler.getMessageReadReceiptList(i)),e})).catch((e=>Promise.reject(e)))}getMessageListHopping(e){var t;void 0===e&&(e={conversationID:null===(t=this.getStoreData(To.CHAT,"messageSource"))||void 0===t?void 0:t.conversationID,sequence:this.hoppingConfigMap.get("nextMessageSeq"),time:this.hoppingConfigMap.get("nextMessageTime")});const n=this.getEngine();return n.chat.getMessageListHopping(e).then((t=>{const{messageList:i,nextMessageSeq:o,nextMessageTime:a,isCompleted:s}=t.data,r=1===e.direction?e.sequence:o,c=1===e.direction?e.time:a;return this.updateMessageList(i,"unshift"),this.delayGetHoppingFunction=void 0,this.hoppingConfigMap.set("nextMessageSeq",r),this.hoppingConfigMap.set("nextMessageTime",c),n.TUIStore.update(To.CHAT,"isCompleted",s),t})).catch((e=>Promise.reject(e)))}sendMessageReadReceipt(e){return this.readReceiptHandler.sendMessageReadReceipt(e)}getGroupMessageReadMemberList(e){return this.readReceiptHandler.getGroupMessageReadMemberList(e).then((e=>{const{isCompleted:t,cursor:n,messageID:i,unreadUserIDList:o,readUserIDList:a}=e.data,s={code:0,data:{cursor:n,isCompleted:t,messageID:i,unreadUserInfoList:[],readUserInfoList:[]}},r=[...o,...a];return 0===r.length?s:this.getEngine().TUIUser.getUserProfile({userIDList:r}).then((e=>(o.length>0?e.data.forEach((e=>{const{userID:t,nick:n="",avatar:i=""}=e;s.data.unreadUserInfoList.push({userID:t,nick:n,avatar:i})})):e.data.forEach((e=>{const{userID:t,nick:n="",avatar:i=""}=e;s.data.readUserInfoList.push({userID:t,nick:n,avatar:i})})),s)))}))}downloadMergedMessages(e){return this.getEngine().chat.downloadMergerMessage(e)}setTranslationLanguage(e){this.getEngine().TUIStore.update(To.USER,"targetLanguage",e)}translateText(e){const t=this.getStoreData(To.USER,"targetLanguage"),n=Object.assign({targetLanguage:t,sourceLanguage:"auto"},e);return this.getEngine().chat.translateText(n)}searchCloudMessages(e){const t=this.getStoreData(To.CONV,"conversationList");return this.getEngine().chat.searchCloudMessages(e).then((e=>{const{searchResultList:n}=e.data;return e.data.searchResultList=n.map((e=>{const{messageList:n,conversationID:i}=e,o=Io(e,["messageList","conversationID"]),a=n.map((e=>new da(e))),s=t.find((e=>e.conversationID===i));return Object.assign(Object.assign({},o),{messageList:a.sort(((e,t)=>t.time-e.time)),conversation:s})})),e}))}addMessageReaction(e,t){return this.getEngine().chat.addMessageReaction(e.getMessage(),t)}removeMessageReaction(e,t){return this.getEngine().chat.removeMessageReaction(e.getMessage(),t)}getMessageReactions(e){const{messageList:t=[]}=e,n=this.getStoreData(To.APP,"enabledEmojiPlugin");c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`TUIChatService.getMessageReactions enabledEmojiPlugin:${n} messageList length:${t.length}`),n&&t.length>0&&this.getEngine().chat.getMessageReactions(e).then((e=>{const t=e.data.resultList||e.data;this.updateMessageReactionList(t)})).catch((()=>{}))}getAllUserListOfMessageReaction(e){var t;return this.getEngine().chat.getAllUserListOfMessageReaction(Object.assign(Object.assign({},e),{message:null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.getMessage()}))}updateMessageReactionList(e){const t=[];e.forEach((e=>{const{messageID:n,reactionList:i}=e,o=this.getEngine().TUIStore.getMessageModel(n);if(o){const e=[];for(let t=0;t<i.length;t++){let n=!0;for(let e=0;e<o.reactionList.length;e++)if(i[t].reactionID===o.reactionList[e].reactionID){o.reactionList[e]=i[t],n=!1;break}n&&e.push(i[t])}o.reactionList.push(...e),e.length=0,t.push(o)}})),t.length>0&&this.updateMessageList(t,"edit")}convertVoiceToText(e){const{message:t,language:n="zh"}=e,i=t.getMessage();return this.getEngine().chat.convertVoiceToText({message:i,language:n})}clearHistoryMessage(e){const t=this.getEngine();return t.chat.clearHistoryMessage(e).then((e=>(t.TUIStore.update(To.CHAT,"messageList",[]),t.TUIStore.update(To.CHAT,"nextReqMessageID",""),t.TUIStore.update(To.CHAT,"isCompleted",!1),e)))}updateMessageInfo(e){const t=this.getStoreData(To.CHAT,"userInfo");this.getEngine().TUIStore.update(To.CHAT,"userInfo",Object.assign(t,e));const n=this.getStoreData(To.CHAT,"messageList");n.length>0&&this.updateLocalMessage(n,e)&&this.getEngine().TUIStore.update(To.CHAT,"messageList",n)}updateLocalMessage(e,t){let n=!1;return e.forEach((e=>{if(t[e.from]){const{nick:i,nameCard:o,avatar:a}=t[e.from];i&&(e.nick=i,n=!0),o&&(e.nameCard=o,n=!0),a&&(e.avatar=a,n=!0)}})),n}handleC2CCallSignaling(e){const t=this.getEngine(),n=t.getMyUserID();return e.filter((e=>{var i,o,a,s,r;const{conversationType:u,type:l,payload:d}=e;let h=!0;if(u===t.TYPES.CONV_C2C&&l===t.TYPES.MSG_CUSTOM&&t.chat.getSignalingInfo(e)){const t=Uo(d.data);if(1===(null==t?void 0:t.businessID)){const u=Uo(t.data);if(h=!(e._isExcludedFromUnreadCount&&e._isExcludedFromLastMessage),h&&!0!==(null===(i=null==u?void 0:u.data)||void 0===i?void 0:i.consumed)){let i=null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.inviter;"line_busy"!==(null==u?void 0:u.line_busy)&&"lineBusy"!==(null===(a=null==u?void 0:u.data)||void 0===a?void 0:a.message)||(i=t.inviter);const{from:l,to:d}=e;if(i!==n&&e.from===n){const t=this.getStoreData(To.CONV,"currentConversation");e.from=d,e.to=l,e.flow="in",e.avatar=(null===(s=null==t?void 0:t.userProfile)||void 0===s?void 0:s.avatar)||""}if(i===n&&e.from!==n){const t=this.getStoreData(To.USER,"userProfile");e.from=d,e.to=l,e.flow="out",e.avatar=null==t?void 0:t.avatar}c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`${this.serv}.handleC2CCallSignaling myUserID:${n} callSignaling.inviter:${t.inviter} customData.data.inviter:${null===(r=null==u?void 0:u.data)||void 0===r?void 0:r.inviter}`)}}}return h}))}sortMessageList(e){const{conversationType:t}=e[0];if(t===this.getEngine().TYPES.CONV_C2C)return e.sort(((e,t)=>e.time-t.time));const n=e.filter((e=>"success"===e.status)).sort(((e,t)=>e.sequence-t.sequence));for(let i=0;i<e.length;i++)"success"!==e[i].status&&n.splice(i,0,e[i]);return n}}class Bs extends sa{constructor(){super(),this.groupMap=new Map}static getInstance(){return Bs.instance||(Bs.instance=new Bs),Bs.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),this.getGroupInitData()}onGroupListUpdated(e){const t=this.getEngine();t.TUIStore.update(To.GRP,"groupList",e);const n=t.TUIStore.getData(To.GRP,"currentGroupID");e.forEach((e=>{e.groupID===n&&t.TUIStore.update(To.GRP,"currentGroup",e)}))}onGroupAttributesUpdated(e){const t=this.getEngine(),n=t.TUIStore.getData(To.GRP,"currentGroupID");let i=t.TUIStore.getData(To.GRP,"groupList");const{groupID:o,groupAttributes:a}=e;n===o&&t.TUIStore.update(To.GRP,"currentGroupAttributes",a),i=i.map((e=>(e.groupID===o&&(e.groupAttributes=a),e))),t.TUIStore.update(To.GRP,"groupList",i)}onGroupCounterUpdated(e){const t=this.getEngine(),n=t.TUIStore.getData(To.GRP,"currentGroupID"),i=t.TUIStore.getData(To.GRP,"currentGroupCounters")||{};let o=t.TUIStore.getData(To.GRP,"groupList");const{groupID:a,key:s,value:r}=e;n===a&&(i[s]=r,t.TUIStore.update(To.GRP,"currentGroupCounters",i)),o=o.map((e=>(e.groupID===a&&(e.groupCounters=Object.assign(Object.assign({},e.groupCounters),{[s]:r})),e))),t.TUIStore.update(To.GRP,"groupList",o)}onMessageReceived(e){const t=this.getEngine(),n=[];e.forEach((e=>{if(e.type===t.TYPES.MSG_GRP_TIP){const{payload:n}=e,{operationType:i,userIDList:o}=n;switch(i){case t.TYPES.GRP_TIP_MBR_JOIN:this.addMemberList(o);break;case t.TYPES.GRP_TIP_MBR_QUIT:case t.TYPES.GRP_TIP_MBR_KICKED_OUT:this.removeMemberList(o);break;case t.TYPES.GRP_TIP_MBR_SET_ADMIN:case t.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:this.updateGroupMember(o);break;case t.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:break;case t.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:case t.TYPES.GRP_TIP_BAN_AVCHATROOM_MEMBER:case t.TYPES.GRP_TIP_UNBAN_AVCHATROOM_MEMBER:this.updateGroupMember(o)}}e.type===t.TYPES.MSG_GRP_SYS_NOTICE&&n.push(e)})),n.length>0&&t.TUIStore.update(To.GRP,"groupSystemNoticeList",n)}getGroupInitData(){const e=this.getEngine();e.chat.isReady()&&e.chat.getGroupList().then((e=>{const{groupList:t=[]}=e.data;c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`TUIGroupService.init, getGroupList count:${t.length}`),t.length>0&&this.onGroupListUpdated(t)}))}updateGroupMember(e){return Mo(this,void 0,void 0,(function*(){const t=this.getEngine().TUIStore.getData(To.GRP,"currentGroupID");if(t){const n=yield this.getGroupMemberProfile({groupID:t,userIDList:e}),{memberList:i}=n.data;this.updateMemberList(i)}}))}resetCurrentStore(){this.getEngine().TUIStore.reset(To.GRP,["currentGroupID","currentGroup","currentGroupAttributes","currentGroupCounters","currentGroupMemberList"],!0)}switchGroup(e){return Mo(this,void 0,void 0,(function*(){const t=this.getEngine();t.TUIStore.update(To.GRP,"offset",0),t.TUIStore.update(To.GRP,"isCompleted",!1);const n=t.TUIStore.getConversationModel(`GROUP${e}`);if((null==n?void 0:n.operationType)>0){const e=t.TUIStore.getData(To.GRP,"currentGroup");return Promise.resolve(e)}const i=t.TUIStore.getData(To.GRP,"currentGroupID");if(!e)return this.resetCurrentStore(),Promise.resolve({});if(i===e){const e=t.TUIStore.getData(To.GRP,"currentGroup");return Promise.resolve(e)}this.resetCurrentStore(),t.TUIStore.update(To.GRP,"currentGroupID",e);try{yield this.getGroupInfo(e)}catch(s){Promise.reject(s)}const o=setTimeout((()=>{this.groupMap.delete(e),clearTimeout(o)}),5e3),a=t.TUIStore.getData(To.GRP,"currentGroup");return Promise.resolve(a)}))}getGroupInfo(e){return Mo(this,void 0,void 0,(function*(){const t=this.getEngine(),n=this.groupMap.get(e);if(n)return this.updateMemberList((null==n?void 0:n.memberList)||[]),t.TUIStore.update(To.GRP,"currentGroup",n.group),t.TUIStore.update(To.GRP,"currentGroupAttributes",n.groupAttributes||{}),void t.TUIStore.update(To.GRP,"currentGroupCounters",n.counters||{});const i={group:{},memberList:[],groupAttributes:void 0,counters:void 0},{data:{group:o}}=yield this.getGroupProfile({groupID:e});i.group=o;const{data:{memberList:a}}=yield this.getGroupMemberList({groupID:e});i.memberList=a;const s=yield this.getGroupAttributes({groupID:e,keyList:[]}),{groupAttributes:r}=s.data;i.groupAttributes=r,t.TUIStore.update(To.GRP,"currentGroupAttributes",r);try{const n=yield this.getGroupCounters({groupID:e,keyList:[]}),{counters:o}=n.data;i.counters=o,t.TUIStore.update(To.GRP,"currentGroupCounters",o)}catch(u){c("warn","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",null==u?void 0:u.message)}this.groupMap.set(e,i)}))}getGroupProfile(e){const t=this.getEngine();return t.chat.getGroupProfile(e).then((n=>Mo(this,void 0,void 0,(function*(){if(t.TUIStore.getData(To.GRP,"currentGroupID")===e.groupID){const{group:e}=n.data;t.TUIStore.update(To.GRP,"currentGroup",e)}return n}))))}updateGroupProfile(e){return this.getEngine().chat.updateGroupProfile(e)}createGroup(e){return this.getEngine().chat.createGroup(e)}dismissGroup(e){return this.getEngine().chat.dismissGroup(e)}searchGroupByID(e){const t=this.getEngine();return t.chat.searchGroupByID(e).then((e=>{const{group:n}=e.data,i=t.TUIStore.getData(To.GRP,"groupList");return e.data.group.isJoinedGroup=i.some((e=>e.groupID===n.groupID)),e}))}joinGroup(e){return this.getEngine().chat.joinGroup(e)}quitGroup(e){return this.getEngine().chat.quitGroup(e)}getGroupApplicationList(){return this.getEngine().chat.getGroupApplicationList()}handleGroupApplication(e){return this.getEngine().chat.handleGroupApplication(e)}getGroupOnlineMemberCount(e){return this.getEngine().chat.getGroupOnlineMemberCount(e)}changeGroupOwner(e){return this.getEngine().chat.changeGroupOwner(e)}initGroupAttributes(e){return this.getEngine().chat.initGroupAttributes(e)}setGroupAttributes(e){return this.getEngine().chat.setGroupAttributes(e)}deleteGroupAttributes(e){return this.getEngine().chat.deleteGroupAttributes(e)}getGroupAttributes(e){return this.getEngine().chat.getGroupAttributes(e)}setGroupCounters(e){return this.getEngine().chat.setGroupCounters(e)}increaseGroupCounter(e){return this.getEngine().chat.increaseGroupCounter(e)}decreaseGroupCounter(e){return this.getEngine().chat.decreaseGroupCounter(e)}getGroupCounters(e){return this.getEngine().chat.getGroupCounters(e)}updateMemberList(e){const t=this.getEngine(),n=[...(t.TUIStore.getData(To.GRP,"currentGroupMemberList")||[]).filter((t=>!e.find((e=>e.userID===t.userID)))),...e];t.TUIStore.update(To.GRP,"currentGroupMemberList",n)}addMemberList(e){return Mo(this,void 0,void 0,(function*(){const t=this.getEngine().TUIStore.getData(To.GRP,"currentGroupID");if(t)try{const n=yield this.getGroupMemberProfile({groupID:t,userIDList:e}),{memberList:i}=n.data;this.updateMemberList(i)}catch(n){const t=e.map((e=>({userID:e,avatar:"",nick:"",role:"",joinTime:0,nameCard:"",muteUntil:0,memberCustomField:[]})));this.updateMemberList(t)}}))}removeMemberList(e){const t=this.getEngine(),n=t.TUIStore.getData(To.GRP,"currentGroupMemberList").filter((t=>-1===e.indexOf(t.userID)));t.TUIStore.update(To.GRP,"currentGroupMemberList",n)}getGroupMemberList(e){const t=this.getEngine();if(Oo(e.offset)){const n=t.TUIStore.getData(To.GRP,"offset");e.offset=n}return t.chat.getGroupMemberList(e).then((n=>{if(t.TUIStore.getData(To.GRP,"currentGroupID")===e.groupID){const{memberList:e,offset:i=0}=n.data;this.updateMemberList(e),t.TUIStore.update(To.GRP,"offset",i),0===i&&t.TUIStore.update(To.GRP,"isCompleted",!0)}return n}))}getGroupMemberProfile(e){return this.getEngine().chat.getGroupMemberProfile(e)}addGroupMember(e){const t=this.getEngine();return t.chat.addGroupMember(e).then((n=>Mo(this,void 0,void 0,(function*(){if(t.TUIStore.getData(To.GRP,"currentGroupID")===e.groupID){const{successUserIDList:e,group:i}=n.data;t.TUIStore.update(To.GRP,"currentGroup",i),this.addMemberList(e)}return n}))))}deleteGroupMember(e){const t=this.getEngine();return t.chat.deleteGroupMember(e).then((n=>{if(t.TUIStore.getData(To.GRP,"currentGroupID")===e.groupID){const{userIDList:e,group:i}=n.data;this.removeMemberList(e),t.TUIStore.update(To.GRP,"currentGroup",i)}return n}))}setGroupMemberMuteTime(e){return this.getEngine().chat.setGroupMemberMuteTime(e)}setGroupMemberRole(e){return this.getEngine().chat.setGroupMemberRole(e)}setGroupMemberNameCard(e){return this.getEngine().chat.setGroupMemberNameCard(e)}setGroupMemberCustomField(e){return this.getEngine().chat.setGroupMemberCustomField(e)}markGroupMemberList(e){return this.getEngine().chat.markGroupMemberList(e)}}class Vs extends sa{constructor(){super()}static getInstance(){return Vs.instance||(Vs.instance=new Vs),Vs.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated.bind(this)),this.getFriendInitData()}onFriendListUpdated(e){this.getEngine().TUIStore.update(To.FRIEND,"friendList",e)}onFriendApplicationListUpdated(e){const{friendApplicationList:t,unreadCount:n=0}=e,i=this.getEngine();i.TUIStore.update(To.FRIEND,"friendApplicationList",t),i.TUIStore.update(To.FRIEND,"friendApplicationUnreadCount",n)}getFriendInitData(){const e=this.getEngine();e.chat.isReady()&&(e.chat.getFriendList().then((e=>{const t=e.data||[];c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1",`TUIFriendService.init, getFriendList count:${t.length}`),t.length>0&&this.onFriendListUpdated(t)})),e.chat.getFriendApplicationList().then((e=>{this.onFriendApplicationListUpdated(e.data)})))}getFriendList(){return this.getEngine().chat.getFriendList()}getFriendRemark(e){const t=this.getEngine().TUIStore.getData(To.FRIEND,"friendList"),n={};return e.forEach((e=>{for(let i=0;i<t.length;i++)t[i].userID!==e||(n[e]=t[i].remark)})),n}addFriend(e){return this.getEngine().chat.addFriend(e)}deleteFriend(e){return this.getEngine().chat.deleteFriend(e)}checkFriend(e){return this.getEngine().chat.checkFriend(e)}getFriendProfile(e){return this.getEngine().chat.getFriendProfile(e)}updateFriend(e){return this.getEngine().chat.updateFriend(e)}acceptFriendApplication(e){return this.getEngine().chat.acceptFriendApplication(e)}refuseFriendApplication(e){return this.getEngine().chat.refuseFriendApplication({userID:e})}deleteFriendApplication(e){return this.getEngine().chat.deleteFriendApplication(e)}setFriendApplicationRead(){return this.getEngine().chat.setFriendApplicationRead()}}class js extends sa{static getInstance(){return js.instance||(js.instance=new js),js.instance}reportFeature(e,t){var n;return null===(n=this.getEngine().chat)||void 0===n?void 0:n.callExperimentalAPI("statTUIKeyFeatures",{code:e,msg:t?`${e}-${t}`:""})}}class qs{constructor(){this.cache=[],this.middlewares=[],this.options=null}use(e){return"function"!=typeof e&&c("error","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","middleware must be a function"),this.cache.push(e),this}next(){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}run(e){return this.middlewares=this.cache.map((e=>e)),this.options=e,this.next()}}function Hs(e,t,n){const i=Object.create(null);Object.keys(n).forEach((n=>{if(!t[n])return;i[n]=t[n];const o=new qs;t[n]=function(){const a=Array.from(arguments);return o.use(((t,i)=>e.isInited?i():Promise.reject({code:Ao.NOT_INIT,message:`${n} | ${Ro.NOT_INIT}`}))).use((e=>i[n].apply(t,e))),o.run(a)}}))}c("log","at node_modules/@tencentcloud/chat-uikit-engine/index.js:1","TUIChatEngine.VERSION:2.4.4");const Ks=ia.getInstance();na.getInstance();const zs=va.getInstance(),Ys=Ds.getInstance(),$s=bs.getInstance(),Ws=Ps.getInstance(),Js=Fs.getInstance(),Xs=Bs.getInstance(),Zs=Vs.getInstance(),Qs=js.getInstance();Ks.mount(Eo.TUIStore,zs),Ks.mount(Eo.TUITranslate,Ys),Ks.mount(Eo.TUIConversation,$s),Ks.mount(Eo.TUIUser,Ws),Ks.mount(Eo.TUIChat,Js),Ks.mount(Eo.TUIGroup,Xs),Ks.mount(Eo.TUIFriend,Zs),Ks.mount(Eo.TUIReport,Qs),Hs(Ks,Ks,wo),Hs(Ks,$s,{deleteConversation:1,pinConversation:1,muteConversation:1,switchConversation:1,getConversationProfile:1,clearHistoryMessage:1}),Hs(Ks,Js,{modifyMessage:1,revokeMessage:1,resendMessage:1,deleteMessage:1,quoteMessage:1,replyMessage:1,setMessageExtensions:1,deleteMessageExtensions:1,getMessageExtensions:1,sendTextMessage:1,sendTextAtMessage:1,sendImageMessage:1,sendAudioMessage:1,sendVideoMessage:1,sendFileMessage:1,sendCustomMessage:1,sendFaceMessage:1,sendLocationMessage:1,sendForwardMessage:1,enterTypingState:1,leaveTypingState:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageList:1,downloadMergedMessages:1,setTranslationLanguage:1,translateText:1,searchCloudMessages:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1}),Hs(Ks,Xs,{switchGroup:1,getGroupProfile:1,updateGroupProfile:1,createGroup:1,dismissGroup:1,searchGroupByID:1,joinGroup:1,quitGroup:1,getGroupApplicationList:1,handleGroupApplication:1,getGroupOnlineMemberCount:1,changeGroupOwner:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getGroupMemberList:1,getGroupMemberProfile:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberNameCard:1,setGroupMemberCustomField:1,markGroupMemberList:1}),Hs(Ks,Ws,{switchUserStatus:1,switchMessageReadStatus:1,getUserProfile:1,updateMyProfile:1,addToBlacklist:1,removeFromBlacklist:1}),Hs(Ks,Zs,{getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,getFriendProfile:1,updateFriend:1,acceptFriendApplication:1,refuseFriendApplication:1,deleteFriendApplication:1,setFriendApplicationRead:1}),Hs(Ks,Qs,wo);let er=class{constructor(){this.serviceMap=new Map}registerService(e,t){this.serviceMap.has(e)||(c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIServiceManager.registerService serviceName:${e}`),this.serviceMap.set(e,t))}unregisterService(e){this.serviceMap.has(e)&&(c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIServiceManager.unregisterService serviceName:${e}`),this.serviceMap.delete(e))}getService(e){return this.serviceMap.get(e)}callService(e){const{serviceName:t,method:n,params:i,callback:o}=e,a=this.getService(t);if(c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIServiceManager.callService serviceName:${t}, service:`,a),a)return a.onCall(n,i,o)}},tr=class{constructor(){this.extensionMap=new Map}registerExtension(e,t){if(c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIExtensionManager.registerExtension extensionID:${e}`),!this.extensionMap.has(e)){const t=[];this.extensionMap.set(e,t)}const n=this.extensionMap.get(e);-1===n.indexOf(t)&&n.push(t)}unregisterExtension(e,t){if(c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIExtensionManager.unregisterExtension extensionID:${e}`),this.extensionMap.has(e)){const n=this.extensionMap.get(e),i=n.indexOf(t);i>-1&&n.splice(i,1)}}getExtensionList(e,t){c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIExtensionManager.getExtensionList extensionID:${e} ${t?`params:${JSON.stringify(t)}`:""}`);let n=[],i=[];if(this.extensionMap.has(e)){n=this.extensionMap.get(e);for(let o=0;o<n.length;o++){const a=n[o].onGetExtension(e,t);i=i.concat(a)}}return i}};const nr=["vue2","vue3","rn"],ir={EVENT:{LOGIN_STATE_CHANGED:"loginStateChanged"},EVENT_SUB_KEY:{USER_LOGIN_SUCCESS:"userLoginSuccess",USER_LOGOUT_SUCCESS:"userLogoutSuccess",USER_KICKED_OFFLINE:"userKickedOffline",USER_SIG_EXPIRED:"userSigExpired"}},or={SERVICE:{NAME:"TUIContactService",METHOD:{SELECT_FRIEND:"selectFriend"}},EXTENSION:{CONTACT_LIST:{EXT_ID:"contactList"}}},ar={SERVICE:{NAME:"TUIEmojiPluginService",METHOD:{CLOSE_EMOJI_DETAIL:"closeEmojiDetail"}}},sr={SERVICE:{NAME:"TUITranslatePluginService"}},rr={SERVICE:{NAME:"TUIVoiceToTextPluginService"}},cr={SERVICE:{NAME:"TUICustomerServicePlugin",METHOD:{ACTIVE_CONVERSATION:"activeConversation",FILTER_MESSAGE:"filterMessage"}},EXTENSION:{}},ur={SERVICE:{NAME:"TUIPushPluginService"}},lr={SERVICE:{NAME:"TUIChatbotPluginService"}},dr="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),hr="undefined"!=typeof uni&&"undefined"==typeof window,pr="undefined"!=typeof uni,gr=("undefined"!=typeof uni||"undefined"!=typeof window)&&!(dr||hr);dr?wx:pr?uni:window;const fr=gr&&window&&window.navigator&&window.navigator.userAgent||"",mr=/Android/i.test(fr),_r=/(?:Windows Phone)/.test(fr),vr=/(?:SymbianOS)/.test(fr),yr=/iPad/i.test(fr)||/iPhone/i.test(fr)||/iPod/i.test(fr),Ir=mr||_r||vr||yr,Mr=gr&&!Ir,Cr=hr&&!dr,Er={[sr.SERVICE.NAME]:Math.pow(2,38),[rr.SERVICE.NAME]:Math.pow(2,39),[cr.SERVICE.NAME]:Math.pow(2,40),[ur.SERVICE.NAME]:Math.pow(2,41),[lr.SERVICE.NAME]:Math.pow(2,42),[ar.SERVICE.NAME]:Math.pow(2,48)};class Tr{constructor(e){this.loginStatusPromise=new Map,this.SDKAppID=0,this.userID="",this.userSig="",this.TUICore=e,this.isOnChatEvent=!1}static getInstance(e){return!Tr.instance&&e&&(Tr.instance=new Tr(e)),Tr.instance}login(e){const{SDKAppID:t,userID:n,userSig:i,framework:o}=e;return this.chat=po.create(Object.assign(Object.assign({},e),{scene:this.getStatScene(o)})),this.EVENT=po.EVENT,this.TYPES=po.TYPES,this.SDKAppID=t,this.userID=n,this.userSig=i,this.offChatEvent(),this.onChatEvent(),this.registerPlugin(e),this.loginChat(e)}logout(){return this.chat.logout().then((e=>(this.userID="",this.userSig="",this.TUICore.notifyEvent(ir.EVENT.LOGIN_STATE_CHANGED,ir.EVENT_SUB_KEY.USER_LOGOUT_SUCCESS),Promise.resolve(e))))}destroy(){return this.chat.destroy().then((e=>(this.userID="",this.userSig="",this.TUICore.notifyEvent(ir.EVENT.LOGIN_STATE_CHANGED,ir.EVENT_SUB_KEY.USER_LOGOUT_SUCCESS),Promise.resolve(e))))}setLogLevel(e){return this.chat.setLogLevel(e)}getContext(){return{chat:this.chat,SDKAppID:this.SDKAppID,userID:this.userID,userSig:this.userSig}}reportPlugin(){var e;for(const t in Er)this.TUICore.getService(t)&&(null===(e=this.chat.callExperimentalAPI("isFeatureEnabledForStat",Er[t]))||void 0===e||e.catch((e=>{})))}loginChat(e){const{userID:t,userSig:n}=e;return new Promise(((e,i)=>{this.chat.login({userID:t,userSig:n}).then((t=>{t.data.repeatLogin&&this.chat.isReady()&&e(t),this.reportPlugin(),this.loginStatusPromise.set("login",{resolve:e,reject:i,imResponse:t})})).catch((e=>{i(e)}))}))}onChatEvent(){this.chat.on(this.EVENT.SDK_READY,this.onSDKReady,this),this.chat.on(this.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.chat.on(this.EVENT.KICKED_OUT,this.onUserKicked,this),this.isOnChatEvent=!0}offChatEvent(){this.isOnChatEvent&&(this.chat.off(this.EVENT.SDK_READY,this.onSDKReady,this),this.chat.off(this.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.chat.off(this.EVENT.KICKED_OUT,this.onUserKicked,this),this.isOnChatEvent=!1)}onSDKReady(){if(this.loginStatusPromise.has("login")){this.TUICore.notifyEvent(ir.EVENT.LOGIN_STATE_CHANGED,ir.EVENT_SUB_KEY.USER_LOGIN_SUCCESS);const e=setTimeout((()=>{const t=this.loginStatusPromise.get("login");t.resolve(t.imResponse),clearTimeout(e),this.loginStatusPromise.delete("login")}),500)}}onSDKNotReady(){this.loginStatusPromise.has("login")&&this.loginStatusPromise.get("login").reject(new Error("sdk not ready")),this.loginStatusPromise.delete("login")}onUserKicked(e){e.data.type!==this.TYPES.KICKED_OUT_USERSIG_EXPIRED?this.TUICore.notifyEvent(ir.EVENT.LOGIN_STATE_CHANGED,ir.EVENT_SUB_KEY.USER_KICKED_OFFLINE):this.TUICore.notifyEvent(ir.EVENT.LOGIN_STATE_CHANGED,ir.EVENT_SUB_KEY.USER_SIG_EXPIRED)}registerPlugin(e){const{useUploadPlugin:t=!1,useProfanityFilterPlugin:n=!1,TUIOfflinePush:i,offlinePushConfig:o,TIMPush:a,pushConfig:s}=e;!0===t&&this.chat.registerPlugin({"tim-upload-plugin":fo}),!0===n&&this.chat.registerPlugin({"tim-profanity-filter-plugin":yo}),Cr&&a&&s&&this.chat.registerPlugin({"tim-push":a,pushConfig:s}),Cr&&i&&o&&this.chat.registerPlugin({"tim-offline-push-plugin":i,offlinePushConfig:o})}getStatScene(e){let t;return e&&nr.indexOf(e)>-1&&(t=this.genStatScene(e)),t}genStatScene(e){if("rn"===e)return"k-rn";let t="";return pr?(Mr&&(t=`k-${e}-pc-uni`),Ir&&(t=`k-${e}-h5-uni`),Cr&&(t=`k-${e}-app-uni`),dr&&(t=`k-${e}-mp-uni`),t):(Mr&&(t=`k-${e}-pc`),Ir&&(t=`k-${e}-h5`),t)}}let kr=class{constructor(){this.eventMap=new Map}registerEvent(e,t,n){const i=this.getKey(e,t);if(c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIEventManager.registerEvent eventName:${e} subKey:${t}`),!this.eventMap.has(i)){const e=[];this.eventMap.set(i,e)}const o=this.eventMap.get(i);-1===o.indexOf(n)&&(o.push(n),this.renotify(e,t,n))}unregisterEvent(e,t,n){c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIEventManager.unregisterEvent eventName:${e} subKey:${t}`);const i=this.getKey(e,t);if(this.eventMap.has(i)){const e=this.eventMap.get(i),t=e.indexOf(n);t>-1&&e.splice(t,1)}}notifyEvent(e,t,n){const i=this.getKey(e,t),o=n?`params:${JSON.stringify(n)}`:"";c("log","at node_modules/@tencentcloud/tui-core/index.js:1",`TUIEventManager.notifyEvent eventName:${e} subKey:${t} ${o}`),this.eventMap.has(i)&&this.eventMap.get(i).forEach((i=>{i.onNotifyEvent(e,t,n)}))}getKey(e,t){let n=e;return t&&(n=`${e}-${n}`),n}renotify(e,t,n){if(e===ir.EVENT.LOGIN_STATE_CHANGED&&t===ir.EVENT_SUB_KEY.USER_LOGIN_SUCCESS){const{chat:e}=Tr.getInstance().getContext();e&&e.isReady()&&(n.onNotifyEvent(ir.EVENT.LOGIN_STATE_CHANGED,ir.EVENT_SUB_KEY.USER_LOGIN_SUCCESS),c("log","at node_modules/@tencentcloud/tui-core/index.js:1","TUIEventManager.renotify success."))}}};c("log","at node_modules/@tencentcloud/tui-core/index.js:1","TUICore.VERSION:2.4.0");const Sr=class e{constructor(){this.serviceManager=new er,this.extensionManager=new tr,this.eventManager=new kr}static getInstance(){return e.instance||(c("log","at node_modules/@tencentcloud/tui-core/index.js:1","TUICore.getInstance ok."),e.instance=new e),e.instance}registerService(e,t){return this.serviceManager.registerService(e,t)}unregisterService(e){return this.serviceManager.unregisterService(e)}getService(e){return this.serviceManager.getService(e)}callService(e){return this.serviceManager.callService(e)}registerExtension(e,t){return this.extensionManager.registerExtension(e,t)}unregisterExtension(e,t){return this.extensionManager.unregisterExtension(e,t)}getExtensionList(e,t){return this.extensionManager.getExtensionList(e,t)}registerEvent(e,t,n){return this.eventManager.registerEvent(e,t,n)}unregisterEvent(e,t,n){return this.eventManager.unregisterEvent(e,t,n)}notifyEvent(e,t,n){return this.eventManager.notifyEvent(e,t,n)}}.getInstance();Tr.getInstance(Sr);var Dr={exports:{}};
/**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   */!function(e,t){(function(){var n,i="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",s=16,r=32,c=64,u=128,l=256,d=1/0,h=9007199254740991,p=NaN,g=4294967295,f=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",r],["partialRight",c],["rearg",l]],m="[object Arguments]",_="[object Array]",v="[object Boolean]",y="[object Date]",I="[object Error]",M="[object Function]",C="[object GeneratorFunction]",E="[object Map]",T="[object Number]",k="[object Object]",S="[object Promise]",D="[object RegExp]",b="[object Set]",A="[object String]",L="[object Symbol]",R="[object WeakMap]",w="[object ArrayBuffer]",O="[object DataView]",N="[object Float32Array]",P="[object Float64Array]",U="[object Int8Array]",G="[object Int16Array]",x="[object Int32Array]",F="[object Uint8Array]",B="[object Uint8ClampedArray]",V="[object Uint16Array]",j="[object Uint32Array]",q=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,z=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,$=RegExp(z.source),W=RegExp(Y.source),J=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(ne.source),oe=/^\s+/,ae=/\s/,se=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,re=/\{\n\/\* \[wrapped with (.+)\] \*/,ce=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,le=/[()=,{}\[\]\/\s]/,de=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pe=/\w*$/,ge=/^[-+]0x[0-9a-f]+$/i,fe=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,_e=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ie=/($^)/,Me=/['\n\r\u2028\u2029\\]/g,Ce="\\ud800-\\udfff",Ee="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Te="\\u2700-\\u27bf",ke="a-z\\xdf-\\xf6\\xf8-\\xff",Se="A-Z\\xc0-\\xd6\\xd8-\\xde",De="\\ufe0e\\ufe0f",be="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ae="['’]",Le="["+Ce+"]",Re="["+be+"]",we="["+Ee+"]",Oe="\\d+",Ne="["+Te+"]",Pe="["+ke+"]",Ue="[^"+Ce+be+Oe+Te+ke+Se+"]",Ge="\\ud83c[\\udffb-\\udfff]",xe="[^"+Ce+"]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Be="[\\ud800-\\udbff][\\udc00-\\udfff]",Ve="["+Se+"]",je="\\u200d",qe="(?:"+Pe+"|"+Ue+")",He="(?:"+Ve+"|"+Ue+")",Ke="(?:['’](?:d|ll|m|re|s|t|ve))?",ze="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ye="(?:"+we+"|"+Ge+")"+"?",$e="["+De+"]?",We=$e+Ye+("(?:"+je+"(?:"+[xe,Fe,Be].join("|")+")"+$e+Ye+")*"),Je="(?:"+[Ne,Fe,Be].join("|")+")"+We,Xe="(?:"+[xe+we+"?",we,Fe,Be,Le].join("|")+")",Ze=RegExp(Ae,"g"),Qe=RegExp(we,"g"),et=RegExp(Ge+"(?="+Ge+")|"+Xe+We,"g"),tt=RegExp([Ve+"?"+Pe+"+"+Ke+"(?="+[Re,Ve,"$"].join("|")+")",He+"+"+ze+"(?="+[Re,Ve+qe,"$"].join("|")+")",Ve+"?"+qe+"+"+Ke,Ve+"+"+ze,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Oe,Je].join("|"),"g"),nt=RegExp("["+je+Ce+Ee+De+"]"),it=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ot=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,st={};st[N]=st[P]=st[U]=st[G]=st[x]=st[F]=st[B]=st[V]=st[j]=!0,st[m]=st[_]=st[w]=st[v]=st[O]=st[y]=st[I]=st[M]=st[E]=st[T]=st[k]=st[D]=st[b]=st[A]=st[R]=!1;var rt={};rt[m]=rt[_]=rt[w]=rt[O]=rt[v]=rt[y]=rt[N]=rt[P]=rt[U]=rt[G]=rt[x]=rt[E]=rt[T]=rt[k]=rt[D]=rt[b]=rt[A]=rt[L]=rt[F]=rt[B]=rt[V]=rt[j]=!0,rt[I]=rt[M]=rt[R]=!1;var ct={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ut=parseFloat,lt=parseInt,dt="object"==typeof uo&&uo&&uo.Object===Object&&uo,ht="object"==typeof self&&self&&self.Object===Object&&self,pt=dt||ht||Function("return this")(),gt=t&&!t.nodeType&&t,ft=gt&&e&&!e.nodeType&&e,mt=ft&&ft.exports===gt,_t=mt&&dt.process,vt=function(){try{var e=ft&&ft.require&&ft.require("util").types;return e||_t&&_t.binding&&_t.binding("util")}catch(Ct){}}(),yt=vt&&vt.isArrayBuffer,It=vt&&vt.isDate,Mt=vt&&vt.isMap,Et=vt&&vt.isRegExp,Tt=vt&&vt.isSet,kt=vt&&vt.isTypedArray;function St(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Dt(e,t,n,i){for(var o=-1,a=null==e?0:e.length;++o<a;){var s=e[o];t(i,s,n(s),e)}return i}function bt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function At(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Lt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Rt(e,t){for(var n=-1,i=null==e?0:e.length,o=0,a=[];++n<i;){var s=e[n];t(s,n,e)&&(a[o++]=s)}return a}function wt(e,t){return!!(null==e?0:e.length)&&jt(e,t,0)>-1}function Ot(e,t,n){for(var i=-1,o=null==e?0:e.length;++i<o;)if(n(t,e[i]))return!0;return!1}function Nt(e,t){for(var n=-1,i=null==e?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}function Pt(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}function Ut(e,t,n,i){var o=-1,a=null==e?0:e.length;for(i&&a&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e);return n}function Gt(e,t,n,i){var o=null==e?0:e.length;for(i&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function xt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Ft=zt("length");function Bt(e,t,n){var i;return n(e,(function(e,n,o){if(t(e,n,o))return i=n,!1})),i}function Vt(e,t,n,i){for(var o=e.length,a=n+(i?1:-1);i?a--:++a<o;)if(t(e[a],a,e))return a;return-1}function jt(e,t,n){return t==t?function(e,t,n){var i=n-1,o=e.length;for(;++i<o;)if(e[i]===t)return i;return-1}(e,t,n):Vt(e,Ht,n)}function qt(e,t,n,i){for(var o=n-1,a=e.length;++o<a;)if(i(e[o],t))return o;return-1}function Ht(e){return e!=e}function Kt(e,t){var n=null==e?0:e.length;return n?Wt(e,t)/n:p}function zt(e){return function(t){return null==t?n:t[e]}}function Yt(e){return function(t){return null==e?n:e[t]}}function $t(e,t,n,i,o){return o(e,(function(e,o,a){n=i?(i=!1,e):t(n,e,o,a)})),n}function Wt(e,t){for(var i,o=-1,a=e.length;++o<a;){var s=t(e[o]);s!==n&&(i=i===n?s:i+s)}return i}function Jt(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function Xt(e){return e?e.slice(0,gn(e)+1).replace(oe,""):e}function Zt(e){return function(t){return e(t)}}function Qt(e,t){return Nt(t,(function(t){return e[t]}))}function en(e,t){return e.has(t)}function tn(e,t){for(var n=-1,i=e.length;++n<i&&jt(t,e[n],0)>-1;);return n}function nn(e,t){for(var n=e.length;n--&&jt(t,e[n],0)>-1;);return n}var on=Yt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),an=Yt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(e){return"\\"+ct[e]}function rn(e){return nt.test(e)}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function un(e,t){return function(n){return e(t(n))}}function ln(e,t){for(var n=-1,i=e.length,o=0,s=[];++n<i;){var r=e[n];r!==t&&r!==a||(e[n]=a,s[o++]=n)}return s}function dn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function hn(e){return rn(e)?function(e){var t=et.lastIndex=0;for(;et.test(e);)++t;return t}(e):Ft(e)}function pn(e){return rn(e)?function(e){return e.match(et)||[]}(e):function(e){return e.split("")}(e)}function gn(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var fn=Yt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var mn=function e(t){var ae,Ce=(t=null==t?pt:mn.defaults(pt.Object(),t,mn.pick(pt,ot))).Array,Ee=t.Date,Te=t.Error,ke=t.Function,Se=t.Math,De=t.Object,be=t.RegExp,Ae=t.String,Le=t.TypeError,Re=Ce.prototype,we=ke.prototype,Oe=De.prototype,Ne=t["__core-js_shared__"],Pe=we.toString,Ue=Oe.hasOwnProperty,Ge=0,xe=(ae=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||""))?"Symbol(src)_1."+ae:"",Fe=Oe.toString,Be=Pe.call(De),Ve=pt._,je=be("^"+Pe.call(Ue).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=mt?t.Buffer:n,He=t.Symbol,Ke=t.Uint8Array,ze=qe?qe.allocUnsafe:n,Ye=un(De.getPrototypeOf,De),$e=De.create,We=Oe.propertyIsEnumerable,Je=Re.splice,Xe=He?He.isConcatSpreadable:n,et=He?He.iterator:n,nt=He?He.toStringTag:n,ct=function(){try{var e=pa(De,"defineProperty");return e({},"",{}),e}catch(Ct){}}(),dt=t.clearTimeout!==pt.clearTimeout&&t.clearTimeout,ht=Ee&&Ee.now!==pt.Date.now&&Ee.now,gt=t.setTimeout!==pt.setTimeout&&t.setTimeout,ft=Se.ceil,_t=Se.floor,vt=De.getOwnPropertySymbols,Ft=qe?qe.isBuffer:n,Yt=t.isFinite,_n=Re.join,vn=un(De.keys,De),yn=Se.max,In=Se.min,Mn=Ee.now,Cn=t.parseInt,En=Se.random,Tn=Re.reverse,kn=pa(t,"DataView"),Sn=pa(t,"Map"),Dn=pa(t,"Promise"),bn=pa(t,"Set"),An=pa(t,"WeakMap"),Ln=pa(De,"create"),Rn=An&&new An,wn={},On=ja(kn),Nn=ja(Sn),Pn=ja(Dn),Un=ja(bn),Gn=ja(An),xn=He?He.prototype:n,Fn=xn?xn.valueOf:n,Bn=xn?xn.toString:n;function Vn(e){if(ar(e)&&!$s(e)&&!(e instanceof Kn)){if(e instanceof Hn)return e;if(Ue.call(e,"__wrapped__"))return qa(e)}return new Hn(e)}var jn=function(){function e(){}return function(t){if(!or(t))return{};if($e)return $e(t);e.prototype=t;var i=new e;return e.prototype=n,i}}();function qn(){}function Hn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}function Kn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=g,this.__views__=[]}function zn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function $n(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new $n;++t<n;)this.add(e[t])}function Jn(e){var t=this.__data__=new Yn(e);this.size=t.size}function Xn(e,t){var n=$s(e),i=!n&&Ys(e),o=!n&&!i&&Zs(e),a=!n&&!i&&!o&&pr(e),s=n||i||o||a,r=s?Jt(e.length,Ae):[],c=r.length;for(var u in e)!t&&!Ue.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ia(u,c))||r.push(u);return r}function Zn(e){var t=e.length;return t?e[Wi(0,t-1)]:n}function Qn(e,t){return Ua(Ro(e),ci(t,0,e.length))}function ei(e){return Ua(Ro(e))}function ti(e,t,i){(i!==n&&!Hs(e[t],i)||i===n&&!(t in e))&&si(e,t,i)}function ni(e,t,i){var o=e[t];Ue.call(e,t)&&Hs(o,i)&&(i!==n||t in e)||si(e,t,i)}function ii(e,t){for(var n=e.length;n--;)if(Hs(e[n][0],t))return n;return-1}function oi(e,t,n,i){return pi(e,(function(e,o,a){t(i,e,n(e),a)})),i}function ai(e,t){return e&&wo(t,Pr(t),e)}function si(e,t,n){"__proto__"==t&&ct?ct(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ri(e,t){for(var i=-1,o=t.length,a=Ce(o),s=null==e;++i<o;)a[i]=s?n:Lr(e,t[i]);return a}function ci(e,t,i){return e==e&&(i!==n&&(e=e<=i?e:i),t!==n&&(e=e>=t?e:t)),e}function ui(e,t,i,o,a,s){var r,c=1&t,u=2&t,l=4&t;if(i&&(r=a?i(e,o,a,s):i(e)),r!==n)return r;if(!or(e))return e;var d=$s(e);if(d){if(r=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Ue.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return Ro(e,r)}else{var h=ma(e),p=h==M||h==C;if(Zs(e))return ko(e,c);if(h==k||h==m||p&&!a){if(r=u||p?{}:va(e),!c)return u?function(e,t){return wo(e,fa(e),t)}(e,function(e,t){return e&&wo(t,Ur(t),e)}(r,e)):function(e,t){return wo(e,ga(e),t)}(e,ai(r,e))}else{if(!rt[h])return a?e:{};r=function(e,t,n){var i=e.constructor;switch(t){case w:return So(e);case v:case y:return new i(+e);case O:return function(e,t){var n=t?So(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case N:case P:case U:case G:case x:case F:case B:case V:case j:return Do(e,n);case E:return new i;case T:case A:return new i(e);case D:return function(e){var t=new e.constructor(e.source,pe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case b:return new i;case L:return o=e,Fn?De(Fn.call(o)):{}}var o}(e,h,c)}}s||(s=new Jn);var g=s.get(e);if(g)return g;s.set(e,r),lr(e)?e.forEach((function(n){r.add(ui(n,t,i,n,e,s))})):sr(e)&&e.forEach((function(n,o){r.set(o,ui(n,t,i,o,e,s))}));var f=d?n:(l?u?sa:aa:u?Ur:Pr)(e);return bt(f||e,(function(n,o){f&&(n=e[o=n]),ni(r,o,ui(n,t,i,o,e,s))})),r}function li(e,t,i){var o=i.length;if(null==e)return!o;for(e=De(e);o--;){var a=i[o],s=t[a],r=e[a];if(r===n&&!(a in e)||!s(r))return!1}return!0}function di(e,t,o){if("function"!=typeof e)throw new Le(i);return wa((function(){e.apply(n,o)}),t)}function hi(e,t,n,i){var o=-1,a=wt,s=!0,r=e.length,c=[],u=t.length;if(!r)return c;n&&(t=Nt(t,Zt(n))),i?(a=Ot,s=!1):t.length>=200&&(a=en,s=!1,t=new Wn(t));e:for(;++o<r;){var l=e[o],d=null==n?l:n(l);if(l=i||0!==l?l:0,s&&d==d){for(var h=u;h--;)if(t[h]===d)continue e;c.push(l)}else a(t,d,i)||c.push(l)}return c}Vn.templateSettings={escape:J,evaluate:X,interpolate:Z,variable:"",imports:{_:Vn}},Vn.prototype=qn.prototype,Vn.prototype.constructor=Vn,Hn.prototype=jn(qn.prototype),Hn.prototype.constructor=Hn,Kn.prototype=jn(qn.prototype),Kn.prototype.constructor=Kn,zn.prototype.clear=function(){this.__data__=Ln?Ln(null):{},this.size=0},zn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zn.prototype.get=function(e){var t=this.__data__;if(Ln){var i=t[e];return i===o?n:i}return Ue.call(t,e)?t[e]:n},zn.prototype.has=function(e){var t=this.__data__;return Ln?t[e]!==n:Ue.call(t,e)},zn.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Ln&&t===n?o:t,this},Yn.prototype.clear=function(){this.__data__=[],this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=ii(t,e);return!(n<0)&&(n==t.length-1?t.pop():Je.call(t,n,1),--this.size,!0)},Yn.prototype.get=function(e){var t=this.__data__,i=ii(t,e);return i<0?n:t[i][1]},Yn.prototype.has=function(e){return ii(this.__data__,e)>-1},Yn.prototype.set=function(e,t){var n=this.__data__,i=ii(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new zn,map:new(Sn||Yn),string:new zn}},$n.prototype.delete=function(e){var t=da(this,e).delete(e);return this.size-=t?1:0,t},$n.prototype.get=function(e){return da(this,e).get(e)},$n.prototype.has=function(e){return da(this,e).has(e)},$n.prototype.set=function(e,t){var n=da(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},Wn.prototype.add=Wn.prototype.push=function(e){return this.__data__.set(e,o),this},Wn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.clear=function(){this.__data__=new Yn,this.size=0},Jn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Jn.prototype.get=function(e){return this.__data__.get(e)},Jn.prototype.has=function(e){return this.__data__.has(e)},Jn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Yn){var i=n.__data__;if(!Sn||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new $n(i)}return n.set(e,t),this.size=n.size,this};var pi=Po(Mi),gi=Po(Ci,!0);function fi(e,t){var n=!0;return pi(e,(function(e,i,o){return n=!!t(e,i,o)})),n}function mi(e,t,i){for(var o=-1,a=e.length;++o<a;){var s=e[o],r=t(s);if(null!=r&&(c===n?r==r&&!hr(r):i(r,c)))var c=r,u=s}return u}function _i(e,t){var n=[];return pi(e,(function(e,i,o){t(e,i,o)&&n.push(e)})),n}function vi(e,t,n,i,o){var a=-1,s=e.length;for(n||(n=ya),o||(o=[]);++a<s;){var r=e[a];t>0&&n(r)?t>1?vi(r,t-1,n,i,o):Pt(o,r):i||(o[o.length]=r)}return o}var yi=Uo(),Ii=Uo(!0);function Mi(e,t){return e&&yi(e,t,Pr)}function Ci(e,t){return e&&Ii(e,t,Pr)}function Ei(e,t){return Rt(t,(function(t){return tr(e[t])}))}function Ti(e,t){for(var i=0,o=(t=Mo(t,e)).length;null!=e&&i<o;)e=e[Va(t[i++])];return i&&i==o?e:n}function ki(e,t,n){var i=t(e);return $s(e)?i:Pt(i,n(e))}function Si(e){return null==e?e===n?"[object Undefined]":"[object Null]":nt&&nt in De(e)?function(e){var t=Ue.call(e,nt),i=e[nt];try{e[nt]=n;var o=!0}catch(Ct){}var a=Fe.call(e);o&&(t?e[nt]=i:delete e[nt]);return a}(e):function(e){return Fe.call(e)}(e)}function Di(e,t){return e>t}function bi(e,t){return null!=e&&Ue.call(e,t)}function Ai(e,t){return null!=e&&t in De(e)}function Li(e,t,i){for(var o=i?Ot:wt,a=e[0].length,s=e.length,r=s,c=Ce(s),u=1/0,l=[];r--;){var d=e[r];r&&t&&(d=Nt(d,Zt(t))),u=In(d.length,u),c[r]=!i&&(t||a>=120&&d.length>=120)?new Wn(r&&d):n}d=e[0];var h=-1,p=c[0];e:for(;++h<a&&l.length<u;){var g=d[h],f=t?t(g):g;if(g=i||0!==g?g:0,!(p?en(p,f):o(l,f,i))){for(r=s;--r;){var m=c[r];if(!(m?en(m,f):o(e[r],f,i)))continue e}p&&p.push(f),l.push(g)}}return l}function Ri(e,t,i){var o=null==(e=Aa(e,t=Mo(t,e)))?e:e[Va(es(t))];return null==o?n:St(o,e,i)}function wi(e){return ar(e)&&Si(e)==m}function Oi(e,t,i,o,a){return e===t||(null==e||null==t||!ar(e)&&!ar(t)?e!=e&&t!=t:function(e,t,i,o,a,s){var r=$s(e),c=$s(t),u=r?_:ma(e),l=c?_:ma(t),d=(u=u==m?k:u)==k,h=(l=l==m?k:l)==k,p=u==l;if(p&&Zs(e)){if(!Zs(t))return!1;r=!0,d=!1}if(p&&!d)return s||(s=new Jn),r||pr(e)?ia(e,t,i,o,a,s):function(e,t,n,i,o,a,s){switch(n){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!a(new Ke(e),new Ke(t)));case v:case y:case T:return Hs(+e,+t);case I:return e.name==t.name&&e.message==t.message;case D:case A:return e==t+"";case E:var r=cn;case b:var c=1&i;if(r||(r=dn),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;i|=2,s.set(e,t);var l=ia(r(e),r(t),i,o,a,s);return s.delete(e),l;case L:if(Fn)return Fn.call(e)==Fn.call(t)}return!1}(e,t,u,i,o,a,s);if(!(1&i)){var g=d&&Ue.call(e,"__wrapped__"),f=h&&Ue.call(t,"__wrapped__");if(g||f){var M=g?e.value():e,C=f?t.value():t;return s||(s=new Jn),a(M,C,i,o,s)}}if(!p)return!1;return s||(s=new Jn),function(e,t,i,o,a,s){var r=1&i,c=aa(e),u=c.length,l=aa(t),d=l.length;if(u!=d&&!r)return!1;var h=u;for(;h--;){var p=c[h];if(!(r?p in t:Ue.call(t,p)))return!1}var g=s.get(e),f=s.get(t);if(g&&f)return g==t&&f==e;var m=!0;s.set(e,t),s.set(t,e);var _=r;for(;++h<u;){var v=e[p=c[h]],y=t[p];if(o)var I=r?o(y,v,p,t,e,s):o(v,y,p,e,t,s);if(!(I===n?v===y||a(v,y,i,o,s):I)){m=!1;break}_||(_="constructor"==p)}if(m&&!_){var M=e.constructor,C=t.constructor;M==C||!("constructor"in e)||!("constructor"in t)||"function"==typeof M&&M instanceof M&&"function"==typeof C&&C instanceof C||(m=!1)}return s.delete(e),s.delete(t),m}(e,t,i,o,a,s)}(e,t,i,o,Oi,a))}function Ni(e,t,i,o){var a=i.length,s=a,r=!o;if(null==e)return!s;for(e=De(e);a--;){var c=i[a];if(r&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){var u=(c=i[a])[0],l=e[u],d=c[1];if(r&&c[2]){if(l===n&&!(u in e))return!1}else{var h=new Jn;if(o)var p=o(l,d,u,e,t,h);if(!(p===n?Oi(d,l,3,o,h):p))return!1}}return!0}function Pi(e){return!(!or(e)||(t=e,xe&&xe in t))&&(tr(e)?je:me).test(ja(e));var t}function Ui(e){return"function"==typeof e?e:null==e?rc:"object"==typeof e?$s(e)?ji(e[0],e[1]):Vi(e):mc(e)}function Gi(e){if(!ka(e))return vn(e);var t=[];for(var n in De(e))Ue.call(e,n)&&"constructor"!=n&&t.push(n);return t}function xi(e){if(!or(e))return function(e){var t=[];if(null!=e)for(var n in De(e))t.push(n);return t}(e);var t=ka(e),n=[];for(var i in e)("constructor"!=i||!t&&Ue.call(e,i))&&n.push(i);return n}function Fi(e,t){return e<t}function Bi(e,t){var n=-1,i=Js(e)?Ce(e.length):[];return pi(e,(function(e,o,a){i[++n]=t(e,o,a)})),i}function Vi(e){var t=ha(e);return 1==t.length&&t[0][2]?Da(t[0][0],t[0][1]):function(n){return n===e||Ni(n,e,t)}}function ji(e,t){return Ca(e)&&Sa(t)?Da(Va(e),t):function(i){var o=Lr(i,e);return o===n&&o===t?Rr(i,e):Oi(t,o,3)}}function qi(e,t,i,o,a){e!==t&&yi(t,(function(s,r){if(a||(a=new Jn),or(s))!function(e,t,i,o,a,s,r){var c=La(e,i),u=La(t,i),l=r.get(u);if(l)return void ti(e,i,l);var d=s?s(c,u,i+"",e,t,r):n,h=d===n;if(h){var p=$s(u),g=!p&&Zs(u),f=!p&&!g&&pr(u);d=u,p||g||f?$s(c)?d=c:Xs(c)?d=Ro(c):g?(h=!1,d=ko(u,!0)):f?(h=!1,d=Do(u,!0)):d=[]:cr(u)||Ys(u)?(d=c,Ys(c)?d=Mr(c):or(c)&&!tr(c)||(d=va(u))):h=!1}h&&(r.set(u,d),a(d,u,o,s,r),r.delete(u));ti(e,i,d)}(e,t,r,i,qi,o,a);else{var c=o?o(La(e,r),s,r+"",e,t,a):n;c===n&&(c=s),ti(e,r,c)}}),Ur)}function Hi(e,t){var i=e.length;if(i)return Ia(t+=t<0?i:0,i)?e[t]:n}function Ki(e,t,n){t=t.length?Nt(t,(function(e){return $s(e)?function(t){return Ti(t,1===e.length?e[0]:e)}:e})):[rc];var i=-1;return t=Nt(t,Zt(la())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Bi(e,(function(e,n,o){return{criteria:Nt(t,(function(t){return t(e)})),index:++i,value:e}})),(function(e,t){return function(e,t,n){var i=-1,o=e.criteria,a=t.criteria,s=o.length,r=n.length;for(;++i<s;){var c=bo(o[i],a[i]);if(c)return i>=r?c:c*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function zi(e,t,n){for(var i=-1,o=t.length,a={};++i<o;){var s=t[i],r=Ti(e,s);n(r,s)&&eo(a,Mo(s,e),r)}return a}function Yi(e,t,n,i){var o=i?qt:jt,a=-1,s=t.length,r=e;for(e===t&&(t=Ro(t)),n&&(r=Nt(e,Zt(n)));++a<s;)for(var c=0,u=t[a],l=n?n(u):u;(c=o(r,l,c,i))>-1;)r!==e&&Je.call(r,c,1),Je.call(e,c,1);return e}function $i(e,t){for(var n=e?t.length:0,i=n-1;n--;){var o=t[n];if(n==i||o!==a){var a=o;Ia(o)?Je.call(e,o,1):po(e,o)}}return e}function Wi(e,t){return e+_t(En()*(t-e+1))}function Ji(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=_t(t/2))&&(e+=e)}while(t);return n}function Xi(e,t){return Oa(ba(e,t,rc),e+"")}function Zi(e){return Zn(Hr(e))}function Qi(e,t){var n=Hr(e);return Ua(n,ci(t,0,n.length))}function eo(e,t,i,o){if(!or(e))return e;for(var a=-1,s=(t=Mo(t,e)).length,r=s-1,c=e;null!=c&&++a<s;){var u=Va(t[a]),l=i;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(a!=r){var d=c[u];(l=o?o(d,u,c):n)===n&&(l=or(d)?d:Ia(t[a+1])?[]:{})}ni(c,u,l),c=c[u]}return e}var to=Rn?function(e,t){return Rn.set(e,t),e}:rc,no=ct?function(e,t){return ct(e,"toString",{configurable:!0,enumerable:!1,value:oc(t),writable:!0})}:rc;function io(e){return Ua(Hr(e))}function oo(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=Ce(o);++i<o;)a[i]=e[i+t];return a}function ao(e,t){var n;return pi(e,(function(e,i,o){return!(n=t(e,i,o))})),!!n}function so(e,t,n){var i=0,o=null==e?i:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;i<o;){var a=i+o>>>1,s=e[a];null!==s&&!hr(s)&&(n?s<=t:s<t)?i=a+1:o=a}return o}return ro(e,t,rc,n)}function ro(e,t,i,o){var a=0,s=null==e?0:e.length;if(0===s)return 0;for(var r=(t=i(t))!=t,c=null===t,u=hr(t),l=t===n;a<s;){var d=_t((a+s)/2),h=i(e[d]),p=h!==n,g=null===h,f=h==h,m=hr(h);if(r)var _=o||f;else _=l?f&&(o||p):c?f&&p&&(o||!g):u?f&&p&&!g&&(o||!m):!g&&!m&&(o?h<=t:h<t);_?a=d+1:s=d}return In(s,4294967294)}function co(e,t){for(var n=-1,i=e.length,o=0,a=[];++n<i;){var s=e[n],r=t?t(s):s;if(!n||!Hs(r,c)){var c=r;a[o++]=0===s?0:s}}return a}function uo(e){return"number"==typeof e?e:hr(e)?p:+e}function lo(e){if("string"==typeof e)return e;if($s(e))return Nt(e,lo)+"";if(hr(e))return Bn?Bn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ho(e,t,n){var i=-1,o=wt,a=e.length,s=!0,r=[],c=r;if(n)s=!1,o=Ot;else if(a>=200){var u=t?null:Xo(e);if(u)return dn(u);s=!1,o=en,c=new Wn}else c=t?[]:r;e:for(;++i<a;){var l=e[i],d=t?t(l):l;if(l=n||0!==l?l:0,s&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),r.push(l)}else o(c,d,n)||(c!==r&&c.push(d),r.push(l))}return r}function po(e,t){return null==(e=Aa(e,t=Mo(t,e)))||delete e[Va(es(t))]}function go(e,t,n,i){return eo(e,t,n(Ti(e,t)),i)}function fo(e,t,n,i){for(var o=e.length,a=i?o:-1;(i?a--:++a<o)&&t(e[a],a,e););return n?oo(e,i?0:a,i?a+1:o):oo(e,i?a+1:0,i?o:a)}function mo(e,t){var n=e;return n instanceof Kn&&(n=n.value()),Ut(t,(function(e,t){return t.func.apply(t.thisArg,Pt([e],t.args))}),n)}function _o(e,t,n){var i=e.length;if(i<2)return i?ho(e[0]):[];for(var o=-1,a=Ce(i);++o<i;)for(var s=e[o],r=-1;++r<i;)r!=o&&(a[o]=hi(a[o]||s,e[r],t,n));return ho(vi(a,1),t,n)}function vo(e,t,i){for(var o=-1,a=e.length,s=t.length,r={};++o<a;){var c=o<s?t[o]:n;i(r,e[o],c)}return r}function yo(e){return Xs(e)?e:[]}function Io(e){return"function"==typeof e?e:rc}function Mo(e,t){return $s(e)?e:Ca(e,t)?[e]:Ba(Cr(e))}var Co=Xi;function Eo(e,t,i){var o=e.length;return i=i===n?o:i,!t&&i>=o?e:oo(e,t,i)}var To=dt||function(e){return pt.clearTimeout(e)};function ko(e,t){if(t)return e.slice();var n=e.length,i=ze?ze(n):new e.constructor(n);return e.copy(i),i}function So(e){var t=new e.constructor(e.byteLength);return new Ke(t).set(new Ke(e)),t}function Do(e,t){var n=t?So(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function bo(e,t){if(e!==t){var i=e!==n,o=null===e,a=e==e,s=hr(e),r=t!==n,c=null===t,u=t==t,l=hr(t);if(!c&&!l&&!s&&e>t||s&&r&&u&&!c&&!l||o&&r&&u||!i&&u||!a)return 1;if(!o&&!s&&!l&&e<t||l&&i&&a&&!o&&!s||c&&i&&a||!r&&a||!u)return-1}return 0}function Ao(e,t,n,i){for(var o=-1,a=e.length,s=n.length,r=-1,c=t.length,u=yn(a-s,0),l=Ce(c+u),d=!i;++r<c;)l[r]=t[r];for(;++o<s;)(d||o<a)&&(l[n[o]]=e[o]);for(;u--;)l[r++]=e[o++];return l}function Lo(e,t,n,i){for(var o=-1,a=e.length,s=-1,r=n.length,c=-1,u=t.length,l=yn(a-r,0),d=Ce(l+u),h=!i;++o<l;)d[o]=e[o];for(var p=o;++c<u;)d[p+c]=t[c];for(;++s<r;)(h||o<a)&&(d[p+n[s]]=e[o++]);return d}function Ro(e,t){var n=-1,i=e.length;for(t||(t=Ce(i));++n<i;)t[n]=e[n];return t}function wo(e,t,i,o){var a=!i;i||(i={});for(var s=-1,r=t.length;++s<r;){var c=t[s],u=o?o(i[c],e[c],c,i,e):n;u===n&&(u=e[c]),a?si(i,c,u):ni(i,c,u)}return i}function Oo(e,t){return function(n,i){var o=$s(n)?Dt:oi,a=t?t():{};return o(n,e,la(i,2),a)}}function No(e){return Xi((function(t,i){var o=-1,a=i.length,s=a>1?i[a-1]:n,r=a>2?i[2]:n;for(s=e.length>3&&"function"==typeof s?(a--,s):n,r&&Ma(i[0],i[1],r)&&(s=a<3?n:s,a=1),t=De(t);++o<a;){var c=i[o];c&&e(t,c,o,s)}return t}))}function Po(e,t){return function(n,i){if(null==n)return n;if(!Js(n))return e(n,i);for(var o=n.length,a=t?o:-1,s=De(n);(t?a--:++a<o)&&!1!==i(s[a],a,s););return n}}function Uo(e){return function(t,n,i){for(var o=-1,a=De(t),s=i(t),r=s.length;r--;){var c=s[e?r:++o];if(!1===n(a[c],c,a))break}return t}}function Go(e){return function(t){var i=rn(t=Cr(t))?pn(t):n,o=i?i[0]:t.charAt(0),a=i?Eo(i,1).join(""):t.slice(1);return o[e]()+a}}function xo(e){return function(t){return Ut(tc(Yr(t).replace(Ze,"")),e,"")}}function Fo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=jn(e.prototype),i=e.apply(n,t);return or(i)?i:n}}function Bo(e){return function(t,i,o){var a=De(t);if(!Js(t)){var s=la(i,3);t=Pr(t),i=function(e){return s(a[e],e,a)}}var r=e(t,i,o);return r>-1?a[s?t[r]:r]:n}}function Vo(e){return oa((function(t){var o=t.length,a=o,s=Hn.prototype.thru;for(e&&t.reverse();a--;){var r=t[a];if("function"!=typeof r)throw new Le(i);if(s&&!c&&"wrapper"==ca(r))var c=new Hn([],!0)}for(a=c?a:o;++a<o;){var u=ca(r=t[a]),l="wrapper"==u?ra(r):n;c=l&&Ea(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[ca(l[0])].apply(c,l[3]):1==r.length&&Ea(r)?c[u]():c.thru(r)}return function(){var e=arguments,n=e[0];if(c&&1==e.length&&$s(n))return c.plant(n).value();for(var i=0,a=o?t[i].apply(this,e):n;++i<o;)a=t[i].call(this,a);return a}}))}function jo(e,t,i,o,a,s,r,c,l,d){var h=t&u,p=1&t,g=2&t,f=24&t,m=512&t,_=g?n:Fo(e);return function u(){for(var v=arguments.length,y=Ce(v),I=v;I--;)y[I]=arguments[I];if(f)var M=ua(u),C=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(y,M);if(o&&(y=Ao(y,o,a,f)),s&&(y=Lo(y,s,r,f)),v-=C,f&&v<d){var E=ln(y,M);return Wo(e,t,jo,u.placeholder,i,y,E,c,l,d-v)}var T=p?i:this,k=g?T[e]:e;return v=y.length,c?y=function(e,t){var i=e.length,o=In(t.length,i),a=Ro(e);for(;o--;){var s=t[o];e[o]=Ia(s,i)?a[s]:n}return e}(y,c):m&&v>1&&y.reverse(),h&&l<v&&(y.length=l),this&&this!==pt&&this instanceof u&&(k=_||Fo(k)),k.apply(T,y)}}function qo(e,t){return function(n,i){return function(e,t,n,i){return Mi(e,(function(e,o,a){t(i,n(e),o,a)})),i}(n,e,t(i),{})}}function Ho(e,t){return function(i,o){var a;if(i===n&&o===n)return t;if(i!==n&&(a=i),o!==n){if(a===n)return o;"string"==typeof i||"string"==typeof o?(i=lo(i),o=lo(o)):(i=uo(i),o=uo(o)),a=e(i,o)}return a}}function Ko(e){return oa((function(t){return t=Nt(t,Zt(la())),Xi((function(n){var i=this;return e(t,(function(e){return St(e,i,n)}))}))}))}function zo(e,t){var i=(t=t===n?" ":lo(t)).length;if(i<2)return i?Ji(t,e):t;var o=Ji(t,ft(e/hn(t)));return rn(t)?Eo(pn(o),0,e).join(""):o.slice(0,e)}function Yo(e){return function(t,i,o){return o&&"number"!=typeof o&&Ma(t,i,o)&&(i=o=n),t=_r(t),i===n?(i=t,t=0):i=_r(i),function(e,t,n,i){for(var o=-1,a=yn(ft((t-e)/(n||1)),0),s=Ce(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,i,o=o===n?t<i?1:-1:_r(o),e)}}function $o(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Ir(t),n=Ir(n)),e(t,n)}}function Wo(e,t,i,o,a,s,u,l,d,h){var p=8&t;t|=p?r:c,4&(t&=~(p?c:r))||(t&=-4);var g=[e,t,a,p?s:n,p?u:n,p?n:s,p?n:u,l,d,h],f=i.apply(n,g);return Ea(e)&&Ra(f,g),f.placeholder=o,Na(f,e,t)}function Jo(e){var t=Se[e];return function(e,n){if(e=Ir(e),(n=null==n?0:In(vr(n),292))&&Yt(e)){var i=(Cr(e)+"e").split("e");return+((i=(Cr(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var Xo=bn&&1/dn(new bn([,-0]))[1]==d?function(e){return new bn(e)}:hc;function Zo(e){return function(t){var n=ma(t);return n==E?cn(t):n==b?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return Nt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Qo(e,t,o,d,h,p,g,f){var m=2&t;if(!m&&"function"!=typeof e)throw new Le(i);var _=d?d.length:0;if(_||(t&=-97,d=h=n),g=g===n?g:yn(vr(g),0),f=f===n?f:vr(f),_-=h?h.length:0,t&c){var v=d,y=h;d=h=n}var I=m?n:ra(e),M=[e,t,o,d,h,v,y,p,g,f];if(I&&function(e,t){var n=e[1],i=t[1],o=n|i,s=o<131,r=i==u&&8==n||i==u&&n==l&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!s&&!r)return e;1&i&&(e[2]=t[2],o|=1&n?0:4);var c=t[3];if(c){var d=e[3];e[3]=d?Ao(d,c,t[4]):c,e[4]=d?ln(e[3],a):t[4]}(c=t[5])&&(d=e[5],e[5]=d?Lo(d,c,t[6]):c,e[6]=d?ln(e[5],a):t[6]);(c=t[7])&&(e[7]=c);i&u&&(e[8]=null==e[8]?t[8]:In(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=o}(M,I),e=M[0],t=M[1],o=M[2],d=M[3],h=M[4],!(f=M[9]=M[9]===n?m?0:e.length:yn(M[9]-_,0))&&24&t&&(t&=-25),t&&1!=t)C=8==t||t==s?function(e,t,i){var o=Fo(e);return function a(){for(var s=arguments.length,r=Ce(s),c=s,u=ua(a);c--;)r[c]=arguments[c];var l=s<3&&r[0]!==u&&r[s-1]!==u?[]:ln(r,u);return(s-=l.length)<i?Wo(e,t,jo,a.placeholder,n,r,l,n,n,i-s):St(this&&this!==pt&&this instanceof a?o:e,this,r)}}(e,t,f):t!=r&&33!=t||h.length?jo.apply(n,M):function(e,t,n,i){var o=1&t,a=Fo(e);return function t(){for(var s=-1,r=arguments.length,c=-1,u=i.length,l=Ce(u+r),d=this&&this!==pt&&this instanceof t?a:e;++c<u;)l[c]=i[c];for(;r--;)l[c++]=arguments[++s];return St(d,o?n:this,l)}}(e,t,o,d);else var C=function(e,t,n){var i=1&t,o=Fo(e);return function t(){return(this&&this!==pt&&this instanceof t?o:e).apply(i?n:this,arguments)}}(e,t,o);return Na((I?to:Ra)(C,M),e,t)}function ea(e,t,i,o){return e===n||Hs(e,Oe[i])&&!Ue.call(o,i)?t:e}function ta(e,t,i,o,a,s){return or(e)&&or(t)&&(s.set(t,e),qi(e,t,n,ta,s),s.delete(t)),e}function na(e){return cr(e)?n:e}function ia(e,t,i,o,a,s){var r=1&i,c=e.length,u=t.length;if(c!=u&&!(r&&u>c))return!1;var l=s.get(e),d=s.get(t);if(l&&d)return l==t&&d==e;var h=-1,p=!0,g=2&i?new Wn:n;for(s.set(e,t),s.set(t,e);++h<c;){var f=e[h],m=t[h];if(o)var _=r?o(m,f,h,t,e,s):o(f,m,h,e,t,s);if(_!==n){if(_)continue;p=!1;break}if(g){if(!xt(t,(function(e,t){if(!en(g,t)&&(f===e||a(f,e,i,o,s)))return g.push(t)}))){p=!1;break}}else if(f!==m&&!a(f,m,i,o,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function oa(e){return Oa(ba(e,n,Wa),e+"")}function aa(e){return ki(e,Pr,ga)}function sa(e){return ki(e,Ur,fa)}var ra=Rn?function(e){return Rn.get(e)}:hc;function ca(e){for(var t=e.name+"",n=wn[t],i=Ue.call(wn,t)?n.length:0;i--;){var o=n[i],a=o.func;if(null==a||a==e)return o.name}return t}function ua(e){return(Ue.call(Vn,"placeholder")?Vn:e).placeholder}function la(){var e=Vn.iteratee||cc;return e=e===cc?Ui:e,arguments.length?e(arguments[0],arguments[1]):e}function da(e,t){var n,i,o=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function ha(e){for(var t=Pr(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,Sa(o)]}return t}function pa(e,t){var i=function(e,t){return null==e?n:e[t]}(e,t);return Pi(i)?i:n}var ga=vt?function(e){return null==e?[]:(e=De(e),Rt(vt(e),(function(t){return We.call(e,t)})))}:yc,fa=vt?function(e){for(var t=[];e;)Pt(t,ga(e)),e=Ye(e);return t}:yc,ma=Si;function _a(e,t,n){for(var i=-1,o=(t=Mo(t,e)).length,a=!1;++i<o;){var s=Va(t[i]);if(!(a=null!=e&&n(e,s)))break;e=e[s]}return a||++i!=o?a:!!(o=null==e?0:e.length)&&ir(o)&&Ia(s,o)&&($s(e)||Ys(e))}function va(e){return"function"!=typeof e.constructor||ka(e)?{}:jn(Ye(e))}function ya(e){return $s(e)||Ys(e)||!!(Xe&&e&&e[Xe])}function Ia(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ve.test(e))&&e>-1&&e%1==0&&e<t}function Ma(e,t,n){if(!or(n))return!1;var i=typeof t;return!!("number"==i?Js(n)&&Ia(t,n.length):"string"==i&&t in n)&&Hs(n[t],e)}function Ca(e,t){if($s(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!hr(e))||(ee.test(e)||!Q.test(e)||null!=t&&e in De(t))}function Ea(e){var t=ca(e),n=Vn[t];if("function"!=typeof n||!(t in Kn.prototype))return!1;if(e===n)return!0;var i=ra(n);return!!i&&e===i[0]}(kn&&ma(new kn(new ArrayBuffer(1)))!=O||Sn&&ma(new Sn)!=E||Dn&&ma(Dn.resolve())!=S||bn&&ma(new bn)!=b||An&&ma(new An)!=R)&&(ma=function(e){var t=Si(e),i=t==k?e.constructor:n,o=i?ja(i):"";if(o)switch(o){case On:return O;case Nn:return E;case Pn:return S;case Un:return b;case Gn:return R}return t});var Ta=Ne?tr:Ic;function ka(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Oe)}function Sa(e){return e==e&&!or(e)}function Da(e,t){return function(i){return null!=i&&(i[e]===t&&(t!==n||e in De(i)))}}function ba(e,t,i){return t=yn(t===n?e.length-1:t,0),function(){for(var n=arguments,o=-1,a=yn(n.length-t,0),s=Ce(a);++o<a;)s[o]=n[t+o];o=-1;for(var r=Ce(t+1);++o<t;)r[o]=n[o];return r[t]=i(s),St(e,this,r)}}function Aa(e,t){return t.length<2?e:Ti(e,oo(t,0,-1))}function La(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Ra=Pa(to),wa=gt||function(e,t){return pt.setTimeout(e,t)},Oa=Pa(no);function Na(e,t,n){var i=t+"";return Oa(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(se,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return bt(f,(function(n){var i="_."+n[0];t&n[1]&&!wt(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(re);return t?t[1].split(ce):[]}(i),n)))}function Pa(e){var t=0,i=0;return function(){var o=Mn(),a=16-(o-i);if(i=o,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(n,arguments)}}function Ua(e,t){var i=-1,o=e.length,a=o-1;for(t=t===n?o:t;++i<t;){var s=Wi(i,a),r=e[s];e[s]=e[i],e[i]=r}return e.length=t,e}var Ga,xa,Fa,Ba=(Ga=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,i,o){t.push(i?o.replace(de,"$1"):n||e)})),t},xa=xs(Ga,(function(e){return 500===Fa.size&&Fa.clear(),e})),Fa=xa.cache,xa);function Va(e){if("string"==typeof e||hr(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ja(e){if(null!=e){try{return Pe.call(e)}catch(Ct){}try{return e+""}catch(Ct){}}return""}function qa(e){if(e instanceof Kn)return e.clone();var t=new Hn(e.__wrapped__,e.__chain__);return t.__actions__=Ro(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ha=Xi((function(e,t){return Xs(e)?hi(e,vi(t,1,Xs,!0)):[]})),Ka=Xi((function(e,t){var i=es(t);return Xs(i)&&(i=n),Xs(e)?hi(e,vi(t,1,Xs,!0),la(i,2)):[]})),za=Xi((function(e,t){var i=es(t);return Xs(i)&&(i=n),Xs(e)?hi(e,vi(t,1,Xs,!0),n,i):[]}));function Ya(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=null==n?0:vr(n);return o<0&&(o=yn(i+o,0)),Vt(e,la(t,3),o)}function $a(e,t,i){var o=null==e?0:e.length;if(!o)return-1;var a=o-1;return i!==n&&(a=vr(i),a=i<0?yn(o+a,0):In(a,o-1)),Vt(e,la(t,3),a,!0)}function Wa(e){return(null==e?0:e.length)?vi(e,1):[]}function Ja(e){return e&&e.length?e[0]:n}var Xa=Xi((function(e){var t=Nt(e,yo);return t.length&&t[0]===e[0]?Li(t):[]})),Za=Xi((function(e){var t=es(e),i=Nt(e,yo);return t===es(i)?t=n:i.pop(),i.length&&i[0]===e[0]?Li(i,la(t,2)):[]})),Qa=Xi((function(e){var t=es(e),i=Nt(e,yo);return(t="function"==typeof t?t:n)&&i.pop(),i.length&&i[0]===e[0]?Li(i,n,t):[]}));function es(e){var t=null==e?0:e.length;return t?e[t-1]:n}var ts=Xi(ns);function ns(e,t){return e&&e.length&&t&&t.length?Yi(e,t):e}var is=oa((function(e,t){var n=null==e?0:e.length,i=ri(e,t);return $i(e,Nt(t,(function(e){return Ia(e,n)?+e:e})).sort(bo)),i}));function os(e){return null==e?e:Tn.call(e)}var as=Xi((function(e){return ho(vi(e,1,Xs,!0))})),ss=Xi((function(e){var t=es(e);return Xs(t)&&(t=n),ho(vi(e,1,Xs,!0),la(t,2))})),rs=Xi((function(e){var t=es(e);return t="function"==typeof t?t:n,ho(vi(e,1,Xs,!0),n,t)}));function cs(e){if(!e||!e.length)return[];var t=0;return e=Rt(e,(function(e){if(Xs(e))return t=yn(e.length,t),!0})),Jt(t,(function(t){return Nt(e,zt(t))}))}function us(e,t){if(!e||!e.length)return[];var i=cs(e);return null==t?i:Nt(i,(function(e){return St(t,n,e)}))}var ls=Xi((function(e,t){return Xs(e)?hi(e,t):[]})),ds=Xi((function(e){return _o(Rt(e,Xs))})),hs=Xi((function(e){var t=es(e);return Xs(t)&&(t=n),_o(Rt(e,Xs),la(t,2))})),ps=Xi((function(e){var t=es(e);return t="function"==typeof t?t:n,_o(Rt(e,Xs),n,t)})),gs=Xi(cs);var fs=Xi((function(e){var t=e.length,i=t>1?e[t-1]:n;return i="function"==typeof i?(e.pop(),i):n,us(e,i)}));function ms(e){var t=Vn(e);return t.__chain__=!0,t}function _s(e,t){return t(e)}var vs=oa((function(e){var t=e.length,i=t?e[0]:0,o=this.__wrapped__,a=function(t){return ri(t,e)};return!(t>1||this.__actions__.length)&&o instanceof Kn&&Ia(i)?((o=o.slice(i,+i+(t?1:0))).__actions__.push({func:_s,args:[a],thisArg:n}),new Hn(o,this.__chain__).thru((function(e){return t&&!e.length&&e.push(n),e}))):this.thru(a)}));var ys=Oo((function(e,t,n){Ue.call(e,n)?++e[n]:si(e,n,1)}));var Is=Bo(Ya),Ms=Bo($a);function Cs(e,t){return($s(e)?bt:pi)(e,la(t,3))}function Es(e,t){return($s(e)?At:gi)(e,la(t,3))}var Ts=Oo((function(e,t,n){Ue.call(e,n)?e[n].push(t):si(e,n,[t])}));var ks=Xi((function(e,t,n){var i=-1,o="function"==typeof t,a=Js(e)?Ce(e.length):[];return pi(e,(function(e){a[++i]=o?St(t,e,n):Ri(e,t,n)})),a})),Ss=Oo((function(e,t,n){si(e,n,t)}));function Ds(e,t){return($s(e)?Nt:Bi)(e,la(t,3))}var bs=Oo((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var As=Xi((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Ma(e,t[0],t[1])?t=[]:n>2&&Ma(t[0],t[1],t[2])&&(t=[t[0]]),Ki(e,vi(t,1),[])})),Ls=ht||function(){return pt.Date.now()};function Rs(e,t,i){return t=i?n:t,t=e&&null==t?e.length:t,Qo(e,u,n,n,n,n,t)}function ws(e,t){var o;if("function"!=typeof t)throw new Le(i);return e=vr(e),function(){return--e>0&&(o=t.apply(this,arguments)),e<=1&&(t=n),o}}var Os=Xi((function(e,t,n){var i=1;if(n.length){var o=ln(n,ua(Os));i|=r}return Qo(e,i,t,n,o)})),Ns=Xi((function(e,t,n){var i=3;if(n.length){var o=ln(n,ua(Ns));i|=r}return Qo(t,i,e,n,o)}));function Ps(e,t,o){var a,s,r,c,u,l,d=0,h=!1,p=!1,g=!0;if("function"!=typeof e)throw new Le(i);function f(t){var i=a,o=s;return a=s=n,d=t,c=e.apply(o,i)}function m(e){var i=e-l;return l===n||i>=t||i<0||p&&e-d>=r}function _(){var e=Ls();if(m(e))return v(e);u=wa(_,function(e){var n=t-(e-l);return p?In(n,r-(e-d)):n}(e))}function v(e){return u=n,g&&a?f(e):(a=s=n,c)}function y(){var e=Ls(),i=m(e);if(a=arguments,s=this,l=e,i){if(u===n)return function(e){return d=e,u=wa(_,t),h?f(e):c}(l);if(p)return To(u),u=wa(_,t),f(l)}return u===n&&(u=wa(_,t)),c}return t=Ir(t)||0,or(o)&&(h=!!o.leading,r=(p="maxWait"in o)?yn(Ir(o.maxWait)||0,t):r,g="trailing"in o?!!o.trailing:g),y.cancel=function(){u!==n&&To(u),d=0,a=l=s=u=n},y.flush=function(){return u===n?c:v(Ls())},y}var Us=Xi((function(e,t){return di(e,1,t)})),Gs=Xi((function(e,t,n){return di(e,Ir(t)||0,n)}));function xs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Le(i);var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],a=n.cache;if(a.has(o))return a.get(o);var s=e.apply(this,i);return n.cache=a.set(o,s)||a,s};return n.cache=new(xs.Cache||$n),n}function Fs(e){if("function"!=typeof e)throw new Le(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}xs.Cache=$n;var Bs=Co((function(e,t){var n=(t=1==t.length&&$s(t[0])?Nt(t[0],Zt(la())):Nt(vi(t,1),Zt(la()))).length;return Xi((function(i){for(var o=-1,a=In(i.length,n);++o<a;)i[o]=t[o].call(this,i[o]);return St(e,this,i)}))})),Vs=Xi((function(e,t){var i=ln(t,ua(Vs));return Qo(e,r,n,t,i)})),js=Xi((function(e,t){var i=ln(t,ua(js));return Qo(e,c,n,t,i)})),qs=oa((function(e,t){return Qo(e,l,n,n,n,t)}));function Hs(e,t){return e===t||e!=e&&t!=t}var Ks=$o(Di),zs=$o((function(e,t){return e>=t})),Ys=wi(function(){return arguments}())?wi:function(e){return ar(e)&&Ue.call(e,"callee")&&!We.call(e,"callee")},$s=Ce.isArray,Ws=yt?Zt(yt):function(e){return ar(e)&&Si(e)==w};function Js(e){return null!=e&&ir(e.length)&&!tr(e)}function Xs(e){return ar(e)&&Js(e)}var Zs=Ft||Ic,Qs=It?Zt(It):function(e){return ar(e)&&Si(e)==y};function er(e){if(!ar(e))return!1;var t=Si(e);return t==I||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!cr(e)}function tr(e){if(!or(e))return!1;var t=Si(e);return t==M||t==C||"[object AsyncFunction]"==t||"[object Proxy]"==t}function nr(e){return"number"==typeof e&&e==vr(e)}function ir(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function or(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ar(e){return null!=e&&"object"==typeof e}var sr=Mt?Zt(Mt):function(e){return ar(e)&&ma(e)==E};function rr(e){return"number"==typeof e||ar(e)&&Si(e)==T}function cr(e){if(!ar(e)||Si(e)!=k)return!1;var t=Ye(e);if(null===t)return!0;var n=Ue.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Pe.call(n)==Be}var ur=Et?Zt(Et):function(e){return ar(e)&&Si(e)==D};var lr=Tt?Zt(Tt):function(e){return ar(e)&&ma(e)==b};function dr(e){return"string"==typeof e||!$s(e)&&ar(e)&&Si(e)==A}function hr(e){return"symbol"==typeof e||ar(e)&&Si(e)==L}var pr=kt?Zt(kt):function(e){return ar(e)&&ir(e.length)&&!!st[Si(e)]};var gr=$o(Fi),fr=$o((function(e,t){return e<=t}));function mr(e){if(!e)return[];if(Js(e))return dr(e)?pn(e):Ro(e);if(et&&e[et])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[et]());var t=ma(e);return(t==E?cn:t==b?dn:Hr)(e)}function _r(e){return e?(e=Ir(e))===d||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function vr(e){var t=_r(e),n=t%1;return t==t?n?t-n:t:0}function yr(e){return e?ci(vr(e),0,g):0}function Ir(e){if("number"==typeof e)return e;if(hr(e))return p;if(or(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=or(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var n=fe.test(e);return n||_e.test(e)?lt(e.slice(2),n?2:8):ge.test(e)?p:+e}function Mr(e){return wo(e,Ur(e))}function Cr(e){return null==e?"":lo(e)}var Er=No((function(e,t){if(ka(t)||Js(t))wo(t,Pr(t),e);else for(var n in t)Ue.call(t,n)&&ni(e,n,t[n])})),Tr=No((function(e,t){wo(t,Ur(t),e)})),kr=No((function(e,t,n,i){wo(t,Ur(t),e,i)})),Sr=No((function(e,t,n,i){wo(t,Pr(t),e,i)})),Dr=oa(ri);var br=Xi((function(e,t){e=De(e);var i=-1,o=t.length,a=o>2?t[2]:n;for(a&&Ma(t[0],t[1],a)&&(o=1);++i<o;)for(var s=t[i],r=Ur(s),c=-1,u=r.length;++c<u;){var l=r[c],d=e[l];(d===n||Hs(d,Oe[l])&&!Ue.call(e,l))&&(e[l]=s[l])}return e})),Ar=Xi((function(e){return e.push(n,ta),St(xr,n,e)}));function Lr(e,t,i){var o=null==e?n:Ti(e,t);return o===n?i:o}function Rr(e,t){return null!=e&&_a(e,t,Ai)}var wr=qo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),e[t]=n}),oc(rc)),Or=qo((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),Ue.call(e,t)?e[t].push(n):e[t]=[n]}),la),Nr=Xi(Ri);function Pr(e){return Js(e)?Xn(e):Gi(e)}function Ur(e){return Js(e)?Xn(e,!0):xi(e)}var Gr=No((function(e,t,n){qi(e,t,n)})),xr=No((function(e,t,n,i){qi(e,t,n,i)})),Fr=oa((function(e,t){var n={};if(null==e)return n;var i=!1;t=Nt(t,(function(t){return t=Mo(t,e),i||(i=t.length>1),t})),wo(e,sa(e),n),i&&(n=ui(n,7,na));for(var o=t.length;o--;)po(n,t[o]);return n}));var Br=oa((function(e,t){return null==e?{}:function(e,t){return zi(e,t,(function(t,n){return Rr(e,n)}))}(e,t)}));function Vr(e,t){if(null==e)return{};var n=Nt(sa(e),(function(e){return[e]}));return t=la(t),zi(e,n,(function(e,n){return t(e,n[0])}))}var jr=Zo(Pr),qr=Zo(Ur);function Hr(e){return null==e?[]:Qt(e,Pr(e))}var Kr=xo((function(e,t,n){return t=t.toLowerCase(),e+(n?zr(t):t)}));function zr(e){return ec(Cr(e).toLowerCase())}function Yr(e){return(e=Cr(e))&&e.replace(ye,on).replace(Qe,"")}var $r=xo((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Wr=xo((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Jr=Go("toLowerCase");var Xr=xo((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Zr=xo((function(e,t,n){return e+(n?" ":"")+ec(t)}));var Qr=xo((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),ec=Go("toUpperCase");function tc(e,t,i){return e=Cr(e),(t=i?n:t)===n?function(e){return it.test(e)}(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.match(ue)||[]}(e):e.match(t)||[]}var nc=Xi((function(e,t){try{return St(e,n,t)}catch(Ct){return er(Ct)?Ct:new Te(Ct)}})),ic=oa((function(e,t){return bt(t,(function(t){t=Va(t),si(e,t,Os(e[t],e))})),e}));function oc(e){return function(){return e}}var ac=Vo(),sc=Vo(!0);function rc(e){return e}function cc(e){return Ui("function"==typeof e?e:ui(e,1))}var uc=Xi((function(e,t){return function(n){return Ri(n,e,t)}})),lc=Xi((function(e,t){return function(n){return Ri(e,n,t)}}));function dc(e,t,n){var i=Pr(t),o=Ei(t,i);null!=n||or(t)&&(o.length||!i.length)||(n=t,t=e,e=this,o=Ei(t,Pr(t)));var a=!(or(n)&&"chain"in n&&!n.chain),s=tr(e);return bt(o,(function(n){var i=t[n];e[n]=i,s&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=Ro(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,Pt([this.value()],arguments))})})),e}function hc(){}var pc=Ko(Nt),gc=Ko(Lt),fc=Ko(xt);function mc(e){return Ca(e)?zt(Va(e)):function(e){return function(t){return Ti(t,e)}}(e)}var _c=Yo(),vc=Yo(!0);function yc(){return[]}function Ic(){return!1}var Mc=Ho((function(e,t){return e+t}),0),Cc=Jo("ceil"),Ec=Ho((function(e,t){return e/t}),1),Tc=Jo("floor");var kc,Sc=Ho((function(e,t){return e*t}),1),Dc=Jo("round"),bc=Ho((function(e,t){return e-t}),0);return Vn.after=function(e,t){if("function"!=typeof t)throw new Le(i);return e=vr(e),function(){if(--e<1)return t.apply(this,arguments)}},Vn.ary=Rs,Vn.assign=Er,Vn.assignIn=Tr,Vn.assignInWith=kr,Vn.assignWith=Sr,Vn.at=Dr,Vn.before=ws,Vn.bind=Os,Vn.bindAll=ic,Vn.bindKey=Ns,Vn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return $s(e)?e:[e]},Vn.chain=ms,Vn.chunk=function(e,t,i){t=(i?Ma(e,t,i):t===n)?1:yn(vr(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,r=Ce(ft(o/t));a<o;)r[s++]=oo(e,a,a+=t);return r},Vn.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,o=[];++t<n;){var a=e[t];a&&(o[i++]=a)}return o},Vn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Ce(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Pt($s(n)?Ro(n):[n],vi(t,1))},Vn.cond=function(e){var t=null==e?0:e.length,n=la();return e=t?Nt(e,(function(e){if("function"!=typeof e[1])throw new Le(i);return[n(e[0]),e[1]]})):[],Xi((function(n){for(var i=-1;++i<t;){var o=e[i];if(St(o[0],this,n))return St(o[1],this,n)}}))},Vn.conforms=function(e){return function(e){var t=Pr(e);return function(n){return li(n,e,t)}}(ui(e,1))},Vn.constant=oc,Vn.countBy=ys,Vn.create=function(e,t){var n=jn(e);return null==t?n:ai(n,t)},Vn.curry=function e(t,i,o){var a=Qo(t,8,n,n,n,n,n,i=o?n:i);return a.placeholder=e.placeholder,a},Vn.curryRight=function e(t,i,o){var a=Qo(t,s,n,n,n,n,n,i=o?n:i);return a.placeholder=e.placeholder,a},Vn.debounce=Ps,Vn.defaults=br,Vn.defaultsDeep=Ar,Vn.defer=Us,Vn.delay=Gs,Vn.difference=Ha,Vn.differenceBy=Ka,Vn.differenceWith=za,Vn.drop=function(e,t,i){var o=null==e?0:e.length;return o?oo(e,(t=i||t===n?1:vr(t))<0?0:t,o):[]},Vn.dropRight=function(e,t,i){var o=null==e?0:e.length;return o?oo(e,0,(t=o-(t=i||t===n?1:vr(t)))<0?0:t):[]},Vn.dropRightWhile=function(e,t){return e&&e.length?fo(e,la(t,3),!0,!0):[]},Vn.dropWhile=function(e,t){return e&&e.length?fo(e,la(t,3),!0):[]},Vn.fill=function(e,t,i,o){var a=null==e?0:e.length;return a?(i&&"number"!=typeof i&&Ma(e,t,i)&&(i=0,o=a),function(e,t,i,o){var a=e.length;for((i=vr(i))<0&&(i=-i>a?0:a+i),(o=o===n||o>a?a:vr(o))<0&&(o+=a),o=i>o?0:yr(o);i<o;)e[i++]=t;return e}(e,t,i,o)):[]},Vn.filter=function(e,t){return($s(e)?Rt:_i)(e,la(t,3))},Vn.flatMap=function(e,t){return vi(Ds(e,t),1)},Vn.flatMapDeep=function(e,t){return vi(Ds(e,t),d)},Vn.flatMapDepth=function(e,t,i){return i=i===n?1:vr(i),vi(Ds(e,t),i)},Vn.flatten=Wa,Vn.flattenDeep=function(e){return(null==e?0:e.length)?vi(e,d):[]},Vn.flattenDepth=function(e,t){return(null==e?0:e.length)?vi(e,t=t===n?1:vr(t)):[]},Vn.flip=function(e){return Qo(e,512)},Vn.flow=ac,Vn.flowRight=sc,Vn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var o=e[t];i[o[0]]=o[1]}return i},Vn.functions=function(e){return null==e?[]:Ei(e,Pr(e))},Vn.functionsIn=function(e){return null==e?[]:Ei(e,Ur(e))},Vn.groupBy=Ts,Vn.initial=function(e){return(null==e?0:e.length)?oo(e,0,-1):[]},Vn.intersection=Xa,Vn.intersectionBy=Za,Vn.intersectionWith=Qa,Vn.invert=wr,Vn.invertBy=Or,Vn.invokeMap=ks,Vn.iteratee=cc,Vn.keyBy=Ss,Vn.keys=Pr,Vn.keysIn=Ur,Vn.map=Ds,Vn.mapKeys=function(e,t){var n={};return t=la(t,3),Mi(e,(function(e,i,o){si(n,t(e,i,o),e)})),n},Vn.mapValues=function(e,t){var n={};return t=la(t,3),Mi(e,(function(e,i,o){si(n,i,t(e,i,o))})),n},Vn.matches=function(e){return Vi(ui(e,1))},Vn.matchesProperty=function(e,t){return ji(e,ui(t,1))},Vn.memoize=xs,Vn.merge=Gr,Vn.mergeWith=xr,Vn.method=uc,Vn.methodOf=lc,Vn.mixin=dc,Vn.negate=Fs,Vn.nthArg=function(e){return e=vr(e),Xi((function(t){return Hi(t,e)}))},Vn.omit=Fr,Vn.omitBy=function(e,t){return Vr(e,Fs(la(t)))},Vn.once=function(e){return ws(2,e)},Vn.orderBy=function(e,t,i,o){return null==e?[]:($s(t)||(t=null==t?[]:[t]),$s(i=o?n:i)||(i=null==i?[]:[i]),Ki(e,t,i))},Vn.over=pc,Vn.overArgs=Bs,Vn.overEvery=gc,Vn.overSome=fc,Vn.partial=Vs,Vn.partialRight=js,Vn.partition=bs,Vn.pick=Br,Vn.pickBy=Vr,Vn.property=mc,Vn.propertyOf=function(e){return function(t){return null==e?n:Ti(e,t)}},Vn.pull=ts,Vn.pullAll=ns,Vn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Yi(e,t,la(n,2)):e},Vn.pullAllWith=function(e,t,i){return e&&e.length&&t&&t.length?Yi(e,t,n,i):e},Vn.pullAt=is,Vn.range=_c,Vn.rangeRight=vc,Vn.rearg=qs,Vn.reject=function(e,t){return($s(e)?Rt:_i)(e,Fs(la(t,3)))},Vn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,o=[],a=e.length;for(t=la(t,3);++i<a;){var s=e[i];t(s,i,e)&&(n.push(s),o.push(i))}return $i(e,o),n},Vn.rest=function(e,t){if("function"!=typeof e)throw new Le(i);return Xi(e,t=t===n?t:vr(t))},Vn.reverse=os,Vn.sampleSize=function(e,t,i){return t=(i?Ma(e,t,i):t===n)?1:vr(t),($s(e)?Qn:Qi)(e,t)},Vn.set=function(e,t,n){return null==e?e:eo(e,t,n)},Vn.setWith=function(e,t,i,o){return o="function"==typeof o?o:n,null==e?e:eo(e,t,i,o)},Vn.shuffle=function(e){return($s(e)?ei:io)(e)},Vn.slice=function(e,t,i){var o=null==e?0:e.length;return o?(i&&"number"!=typeof i&&Ma(e,t,i)?(t=0,i=o):(t=null==t?0:vr(t),i=i===n?o:vr(i)),oo(e,t,i)):[]},Vn.sortBy=As,Vn.sortedUniq=function(e){return e&&e.length?co(e):[]},Vn.sortedUniqBy=function(e,t){return e&&e.length?co(e,la(t,2)):[]},Vn.split=function(e,t,i){return i&&"number"!=typeof i&&Ma(e,t,i)&&(t=i=n),(i=i===n?g:i>>>0)?(e=Cr(e))&&("string"==typeof t||null!=t&&!ur(t))&&!(t=lo(t))&&rn(e)?Eo(pn(e),0,i):e.split(t,i):[]},Vn.spread=function(e,t){if("function"!=typeof e)throw new Le(i);return t=null==t?0:yn(vr(t),0),Xi((function(n){var i=n[t],o=Eo(n,0,t);return i&&Pt(o,i),St(e,this,o)}))},Vn.tail=function(e){var t=null==e?0:e.length;return t?oo(e,1,t):[]},Vn.take=function(e,t,i){return e&&e.length?oo(e,0,(t=i||t===n?1:vr(t))<0?0:t):[]},Vn.takeRight=function(e,t,i){var o=null==e?0:e.length;return o?oo(e,(t=o-(t=i||t===n?1:vr(t)))<0?0:t,o):[]},Vn.takeRightWhile=function(e,t){return e&&e.length?fo(e,la(t,3),!1,!0):[]},Vn.takeWhile=function(e,t){return e&&e.length?fo(e,la(t,3)):[]},Vn.tap=function(e,t){return t(e),e},Vn.throttle=function(e,t,n){var o=!0,a=!0;if("function"!=typeof e)throw new Le(i);return or(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),Ps(e,t,{leading:o,maxWait:t,trailing:a})},Vn.thru=_s,Vn.toArray=mr,Vn.toPairs=jr,Vn.toPairsIn=qr,Vn.toPath=function(e){return $s(e)?Nt(e,Va):hr(e)?[e]:Ro(Ba(Cr(e)))},Vn.toPlainObject=Mr,Vn.transform=function(e,t,n){var i=$s(e),o=i||Zs(e)||pr(e);if(t=la(t,4),null==n){var a=e&&e.constructor;n=o?i?new a:[]:or(e)&&tr(a)?jn(Ye(e)):{}}return(o?bt:Mi)(e,(function(e,i,o){return t(n,e,i,o)})),n},Vn.unary=function(e){return Rs(e,1)},Vn.union=as,Vn.unionBy=ss,Vn.unionWith=rs,Vn.uniq=function(e){return e&&e.length?ho(e):[]},Vn.uniqBy=function(e,t){return e&&e.length?ho(e,la(t,2)):[]},Vn.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?ho(e,n,t):[]},Vn.unset=function(e,t){return null==e||po(e,t)},Vn.unzip=cs,Vn.unzipWith=us,Vn.update=function(e,t,n){return null==e?e:go(e,t,Io(n))},Vn.updateWith=function(e,t,i,o){return o="function"==typeof o?o:n,null==e?e:go(e,t,Io(i),o)},Vn.values=Hr,Vn.valuesIn=function(e){return null==e?[]:Qt(e,Ur(e))},Vn.without=ls,Vn.words=tc,Vn.wrap=function(e,t){return Vs(Io(t),e)},Vn.xor=ds,Vn.xorBy=hs,Vn.xorWith=ps,Vn.zip=gs,Vn.zipObject=function(e,t){return vo(e||[],t||[],ni)},Vn.zipObjectDeep=function(e,t){return vo(e||[],t||[],eo)},Vn.zipWith=fs,Vn.entries=jr,Vn.entriesIn=qr,Vn.extend=Tr,Vn.extendWith=kr,dc(Vn,Vn),Vn.add=Mc,Vn.attempt=nc,Vn.camelCase=Kr,Vn.capitalize=zr,Vn.ceil=Cc,Vn.clamp=function(e,t,i){return i===n&&(i=t,t=n),i!==n&&(i=(i=Ir(i))==i?i:0),t!==n&&(t=(t=Ir(t))==t?t:0),ci(Ir(e),t,i)},Vn.clone=function(e){return ui(e,4)},Vn.cloneDeep=function(e){return ui(e,5)},Vn.cloneDeepWith=function(e,t){return ui(e,5,t="function"==typeof t?t:n)},Vn.cloneWith=function(e,t){return ui(e,4,t="function"==typeof t?t:n)},Vn.conformsTo=function(e,t){return null==t||li(e,t,Pr(t))},Vn.deburr=Yr,Vn.defaultTo=function(e,t){return null==e||e!=e?t:e},Vn.divide=Ec,Vn.endsWith=function(e,t,i){e=Cr(e),t=lo(t);var o=e.length,a=i=i===n?o:ci(vr(i),0,o);return(i-=t.length)>=0&&e.slice(i,a)==t},Vn.eq=Hs,Vn.escape=function(e){return(e=Cr(e))&&W.test(e)?e.replace(Y,an):e},Vn.escapeRegExp=function(e){return(e=Cr(e))&&ie.test(e)?e.replace(ne,"\\$&"):e},Vn.every=function(e,t,i){var o=$s(e)?Lt:fi;return i&&Ma(e,t,i)&&(t=n),o(e,la(t,3))},Vn.find=Is,Vn.findIndex=Ya,Vn.findKey=function(e,t){return Bt(e,la(t,3),Mi)},Vn.findLast=Ms,Vn.findLastIndex=$a,Vn.findLastKey=function(e,t){return Bt(e,la(t,3),Ci)},Vn.floor=Tc,Vn.forEach=Cs,Vn.forEachRight=Es,Vn.forIn=function(e,t){return null==e?e:yi(e,la(t,3),Ur)},Vn.forInRight=function(e,t){return null==e?e:Ii(e,la(t,3),Ur)},Vn.forOwn=function(e,t){return e&&Mi(e,la(t,3))},Vn.forOwnRight=function(e,t){return e&&Ci(e,la(t,3))},Vn.get=Lr,Vn.gt=Ks,Vn.gte=zs,Vn.has=function(e,t){return null!=e&&_a(e,t,bi)},Vn.hasIn=Rr,Vn.head=Ja,Vn.identity=rc,Vn.includes=function(e,t,n,i){e=Js(e)?e:Hr(e),n=n&&!i?vr(n):0;var o=e.length;return n<0&&(n=yn(o+n,0)),dr(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&jt(e,t,n)>-1},Vn.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=null==n?0:vr(n);return o<0&&(o=yn(i+o,0)),jt(e,t,o)},Vn.inRange=function(e,t,i){return t=_r(t),i===n?(i=t,t=0):i=_r(i),function(e,t,n){return e>=In(t,n)&&e<yn(t,n)}(e=Ir(e),t,i)},Vn.invoke=Nr,Vn.isArguments=Ys,Vn.isArray=$s,Vn.isArrayBuffer=Ws,Vn.isArrayLike=Js,Vn.isArrayLikeObject=Xs,Vn.isBoolean=function(e){return!0===e||!1===e||ar(e)&&Si(e)==v},Vn.isBuffer=Zs,Vn.isDate=Qs,Vn.isElement=function(e){return ar(e)&&1===e.nodeType&&!cr(e)},Vn.isEmpty=function(e){if(null==e)return!0;if(Js(e)&&($s(e)||"string"==typeof e||"function"==typeof e.splice||Zs(e)||pr(e)||Ys(e)))return!e.length;var t=ma(e);if(t==E||t==b)return!e.size;if(ka(e))return!Gi(e).length;for(var n in e)if(Ue.call(e,n))return!1;return!0},Vn.isEqual=function(e,t){return Oi(e,t)},Vn.isEqualWith=function(e,t,i){var o=(i="function"==typeof i?i:n)?i(e,t):n;return o===n?Oi(e,t,n,i):!!o},Vn.isError=er,Vn.isFinite=function(e){return"number"==typeof e&&Yt(e)},Vn.isFunction=tr,Vn.isInteger=nr,Vn.isLength=ir,Vn.isMap=sr,Vn.isMatch=function(e,t){return e===t||Ni(e,t,ha(t))},Vn.isMatchWith=function(e,t,i){return i="function"==typeof i?i:n,Ni(e,t,ha(t),i)},Vn.isNaN=function(e){return rr(e)&&e!=+e},Vn.isNative=function(e){if(Ta(e))throw new Te("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Pi(e)},Vn.isNil=function(e){return null==e},Vn.isNull=function(e){return null===e},Vn.isNumber=rr,Vn.isObject=or,Vn.isObjectLike=ar,Vn.isPlainObject=cr,Vn.isRegExp=ur,Vn.isSafeInteger=function(e){return nr(e)&&e>=-9007199254740991&&e<=h},Vn.isSet=lr,Vn.isString=dr,Vn.isSymbol=hr,Vn.isTypedArray=pr,Vn.isUndefined=function(e){return e===n},Vn.isWeakMap=function(e){return ar(e)&&ma(e)==R},Vn.isWeakSet=function(e){return ar(e)&&"[object WeakSet]"==Si(e)},Vn.join=function(e,t){return null==e?"":_n.call(e,t)},Vn.kebabCase=$r,Vn.last=es,Vn.lastIndexOf=function(e,t,i){var o=null==e?0:e.length;if(!o)return-1;var a=o;return i!==n&&(a=(a=vr(i))<0?yn(o+a,0):In(a,o-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,a):Vt(e,Ht,a,!0)},Vn.lowerCase=Wr,Vn.lowerFirst=Jr,Vn.lt=gr,Vn.lte=fr,Vn.max=function(e){return e&&e.length?mi(e,rc,Di):n},Vn.maxBy=function(e,t){return e&&e.length?mi(e,la(t,2),Di):n},Vn.mean=function(e){return Kt(e,rc)},Vn.meanBy=function(e,t){return Kt(e,la(t,2))},Vn.min=function(e){return e&&e.length?mi(e,rc,Fi):n},Vn.minBy=function(e,t){return e&&e.length?mi(e,la(t,2),Fi):n},Vn.stubArray=yc,Vn.stubFalse=Ic,Vn.stubObject=function(){return{}},Vn.stubString=function(){return""},Vn.stubTrue=function(){return!0},Vn.multiply=Sc,Vn.nth=function(e,t){return e&&e.length?Hi(e,vr(t)):n},Vn.noConflict=function(){return pt._===this&&(pt._=Ve),this},Vn.noop=hc,Vn.now=Ls,Vn.pad=function(e,t,n){e=Cr(e);var i=(t=vr(t))?hn(e):0;if(!t||i>=t)return e;var o=(t-i)/2;return zo(_t(o),n)+e+zo(ft(o),n)},Vn.padEnd=function(e,t,n){e=Cr(e);var i=(t=vr(t))?hn(e):0;return t&&i<t?e+zo(t-i,n):e},Vn.padStart=function(e,t,n){e=Cr(e);var i=(t=vr(t))?hn(e):0;return t&&i<t?zo(t-i,n)+e:e},Vn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Cn(Cr(e).replace(oe,""),t||0)},Vn.random=function(e,t,i){if(i&&"boolean"!=typeof i&&Ma(e,t,i)&&(t=i=n),i===n&&("boolean"==typeof t?(i=t,t=n):"boolean"==typeof e&&(i=e,e=n)),e===n&&t===n?(e=0,t=1):(e=_r(e),t===n?(t=e,e=0):t=_r(t)),e>t){var o=e;e=t,t=o}if(i||e%1||t%1){var a=En();return In(e+a*(t-e+ut("1e-"+((a+"").length-1))),t)}return Wi(e,t)},Vn.reduce=function(e,t,n){var i=$s(e)?Ut:$t,o=arguments.length<3;return i(e,la(t,4),n,o,pi)},Vn.reduceRight=function(e,t,n){var i=$s(e)?Gt:$t,o=arguments.length<3;return i(e,la(t,4),n,o,gi)},Vn.repeat=function(e,t,i){return t=(i?Ma(e,t,i):t===n)?1:vr(t),Ji(Cr(e),t)},Vn.replace=function(){var e=arguments,t=Cr(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Vn.result=function(e,t,i){var o=-1,a=(t=Mo(t,e)).length;for(a||(a=1,e=n);++o<a;){var s=null==e?n:e[Va(t[o])];s===n&&(o=a,s=i),e=tr(s)?s.call(e):s}return e},Vn.round=Dc,Vn.runInContext=e,Vn.sample=function(e){return($s(e)?Zn:Zi)(e)},Vn.size=function(e){if(null==e)return 0;if(Js(e))return dr(e)?hn(e):e.length;var t=ma(e);return t==E||t==b?e.size:Gi(e).length},Vn.snakeCase=Xr,Vn.some=function(e,t,i){var o=$s(e)?xt:ao;return i&&Ma(e,t,i)&&(t=n),o(e,la(t,3))},Vn.sortedIndex=function(e,t){return so(e,t)},Vn.sortedIndexBy=function(e,t,n){return ro(e,t,la(n,2))},Vn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=so(e,t);if(i<n&&Hs(e[i],t))return i}return-1},Vn.sortedLastIndex=function(e,t){return so(e,t,!0)},Vn.sortedLastIndexBy=function(e,t,n){return ro(e,t,la(n,2),!0)},Vn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=so(e,t,!0)-1;if(Hs(e[n],t))return n}return-1},Vn.startCase=Zr,Vn.startsWith=function(e,t,n){return e=Cr(e),n=null==n?0:ci(vr(n),0,e.length),t=lo(t),e.slice(n,n+t.length)==t},Vn.subtract=bc,Vn.sum=function(e){return e&&e.length?Wt(e,rc):0},Vn.sumBy=function(e,t){return e&&e.length?Wt(e,la(t,2)):0},Vn.template=function(e,t,i){var o=Vn.templateSettings;i&&Ma(e,t,i)&&(t=n),e=Cr(e),t=kr({},t,o,ea);var a,s,r=kr({},t.imports,o.imports,ea),c=Pr(r),u=Qt(r,c),l=0,d=t.interpolate||Ie,h="__p += '",p=be((t.escape||Ie).source+"|"+d.source+"|"+(d===Z?he:Ie).source+"|"+(t.evaluate||Ie).source+"|$","g"),g="//# sourceURL="+(Ue.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(p,(function(t,n,i,o,r,c){return i||(i=o),h+=e.slice(l,c).replace(Me,sn),n&&(a=!0,h+="' +\n__e("+n+") +\n'"),r&&(s=!0,h+="';\n"+r+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),l=c+t.length,t})),h+="';\n";var f=Ue.call(t,"variable")&&t.variable;if(f){if(le.test(f))throw new Te("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(q,""):h).replace(H,"$1").replace(K,"$1;"),h="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=nc((function(){return ke(c,g+"return "+h).apply(n,u)}));if(m.source=h,er(m))throw m;return m},Vn.times=function(e,t){if((e=vr(e))<1||e>h)return[];var n=g,i=In(e,g);t=la(t),e-=g;for(var o=Jt(i,t);++n<e;)t(n);return o},Vn.toFinite=_r,Vn.toInteger=vr,Vn.toLength=yr,Vn.toLower=function(e){return Cr(e).toLowerCase()},Vn.toNumber=Ir,Vn.toSafeInteger=function(e){return e?ci(vr(e),-9007199254740991,h):0===e?e:0},Vn.toString=Cr,Vn.toUpper=function(e){return Cr(e).toUpperCase()},Vn.trim=function(e,t,i){if((e=Cr(e))&&(i||t===n))return Xt(e);if(!e||!(t=lo(t)))return e;var o=pn(e),a=pn(t);return Eo(o,tn(o,a),nn(o,a)+1).join("")},Vn.trimEnd=function(e,t,i){if((e=Cr(e))&&(i||t===n))return e.slice(0,gn(e)+1);if(!e||!(t=lo(t)))return e;var o=pn(e);return Eo(o,0,nn(o,pn(t))+1).join("")},Vn.trimStart=function(e,t,i){if((e=Cr(e))&&(i||t===n))return e.replace(oe,"");if(!e||!(t=lo(t)))return e;var o=pn(e);return Eo(o,tn(o,pn(t))).join("")},Vn.truncate=function(e,t){var i=30,o="...";if(or(t)){var a="separator"in t?t.separator:a;i="length"in t?vr(t.length):i,o="omission"in t?lo(t.omission):o}var s=(e=Cr(e)).length;if(rn(e)){var r=pn(e);s=r.length}if(i>=s)return e;var c=i-hn(o);if(c<1)return o;var u=r?Eo(r,0,c).join(""):e.slice(0,c);if(a===n)return u+o;if(r&&(c+=u.length-c),ur(a)){if(e.slice(c).search(a)){var l,d=u;for(a.global||(a=be(a.source,Cr(pe.exec(a))+"g")),a.lastIndex=0;l=a.exec(d);)var h=l.index;u=u.slice(0,h===n?c:h)}}else if(e.indexOf(lo(a),c)!=c){var p=u.lastIndexOf(a);p>-1&&(u=u.slice(0,p))}return u+o},Vn.unescape=function(e){return(e=Cr(e))&&$.test(e)?e.replace(z,fn):e},Vn.uniqueId=function(e){var t=++Ge;return Cr(e)+t},Vn.upperCase=Qr,Vn.upperFirst=ec,Vn.each=Cs,Vn.eachRight=Es,Vn.first=Ja,dc(Vn,(kc={},Mi(Vn,(function(e,t){Ue.call(Vn.prototype,t)||(kc[t]=e)})),kc),{chain:!1}),Vn.VERSION="4.17.21",bt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Vn[e].placeholder=Vn})),bt(["drop","take"],(function(e,t){Kn.prototype[e]=function(i){i=i===n?1:yn(vr(i),0);var o=this.__filtered__&&!t?new Kn(this):this.clone();return o.__filtered__?o.__takeCount__=In(i,o.__takeCount__):o.__views__.push({size:In(i,g),type:e+(o.__dir__<0?"Right":"")}),o},Kn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),bt(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;Kn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:la(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),bt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Kn.prototype[e]=function(){return this[n](1).value()[0]}})),bt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Kn.prototype[e]=function(){return this.__filtered__?new Kn(this):this[n](1)}})),Kn.prototype.compact=function(){return this.filter(rc)},Kn.prototype.find=function(e){return this.filter(e).head()},Kn.prototype.findLast=function(e){return this.reverse().find(e)},Kn.prototype.invokeMap=Xi((function(e,t){return"function"==typeof e?new Kn(this):this.map((function(n){return Ri(n,e,t)}))})),Kn.prototype.reject=function(e){return this.filter(Fs(la(e)))},Kn.prototype.slice=function(e,t){e=vr(e);var i=this;return i.__filtered__&&(e>0||t<0)?new Kn(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==n&&(i=(t=vr(t))<0?i.dropRight(-t):i.take(t-e)),i)},Kn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Kn.prototype.toArray=function(){return this.take(g)},Mi(Kn.prototype,(function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),a=Vn[o?"take"+("last"==t?"Right":""):t],s=o||/^find/.test(t);a&&(Vn.prototype[t]=function(){var t=this.__wrapped__,r=o?[1]:arguments,c=t instanceof Kn,u=r[0],l=c||$s(t),d=function(e){var t=a.apply(Vn,Pt([e],r));return o&&h?t[0]:t};l&&i&&"function"==typeof u&&1!=u.length&&(c=l=!1);var h=this.__chain__,p=!!this.__actions__.length,g=s&&!h,f=c&&!p;if(!s&&l){t=f?t:new Kn(this);var m=e.apply(t,r);return m.__actions__.push({func:_s,args:[d],thisArg:n}),new Hn(m,h)}return g&&f?e.apply(this,r):(m=this.thru(d),g?o?m.value()[0]:m.value():m)})})),bt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);Vn.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var o=this.value();return t.apply($s(o)?o:[],e)}return this[n]((function(n){return t.apply($s(n)?n:[],e)}))}})),Mi(Kn.prototype,(function(e,t){var n=Vn[t];if(n){var i=n.name+"";Ue.call(wn,i)||(wn[i]=[]),wn[i].push({name:t,func:n})}})),wn[jo(n,2).name]=[{name:"wrapper",func:n}],Kn.prototype.clone=function(){var e=new Kn(this.__wrapped__);return e.__actions__=Ro(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ro(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ro(this.__views__),e},Kn.prototype.reverse=function(){if(this.__filtered__){var e=new Kn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Kn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=$s(e),i=t<0,o=n?e.length:0,a=function(e,t,n){var i=-1,o=n.length;for(;++i<o;){var a=n[i],s=a.size;switch(a.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=In(t,e+s);break;case"takeRight":e=yn(e,t-s)}}return{start:e,end:t}}(0,o,this.__views__),s=a.start,r=a.end,c=r-s,u=i?r:s-1,l=this.__iteratees__,d=l.length,h=0,p=In(c,this.__takeCount__);if(!n||!i&&o==c&&p==c)return mo(e,this.__actions__);var g=[];e:for(;c--&&h<p;){for(var f=-1,m=e[u+=t];++f<d;){var _=l[f],v=_.iteratee,y=_.type,I=v(m);if(2==y)m=I;else if(!I){if(1==y)continue e;break e}}g[h++]=m}return g},Vn.prototype.at=vs,Vn.prototype.chain=function(){return ms(this)},Vn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},Vn.prototype.next=function(){this.__values__===n&&(this.__values__=mr(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?n:this.__values__[this.__index__++]}},Vn.prototype.plant=function(e){for(var t,i=this;i instanceof qn;){var o=qa(i);o.__index__=0,o.__values__=n,t?a.__wrapped__=o:t=o;var a=o;i=i.__wrapped__}return a.__wrapped__=e,t},Vn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Kn){var t=e;return this.__actions__.length&&(t=new Kn(this)),(t=t.reverse()).__actions__.push({func:_s,args:[os],thisArg:n}),new Hn(t,this.__chain__)}return this.thru(os)},Vn.prototype.toJSON=Vn.prototype.valueOf=Vn.prototype.value=function(){return mo(this.__wrapped__,this.__actions__)},Vn.prototype.first=Vn.prototype.head,et&&(Vn.prototype[et]=function(){return this}),Vn}();ft?((ft.exports=mn)._=mn,gt._=mn):pt._=mn}).call(uo)}(Dr,Dr.exports);var br=Dr.exports;const Ar="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Lr="undefined"!=typeof uni&&"undefined"==typeof window,Rr="undefined"!=typeof uni,wr=("undefined"!=typeof uni||"undefined"!=typeof window)&&!(Ar||Lr),Or=Ar?wx:Rr?uni:"undefined"!=typeof window?window:{},Nr=wr&&window&&window.navigator&&window.navigator.userAgent||"",Pr=/Android/i.test(Nr),Ur=/(?:Windows Phone)/.test(Nr),Gr=/(?:SymbianOS)/.test(Nr),xr=/OpenHarmony/i.test(Nr),Fr=wr&&("ontouchstart"in window||navigator.maxTouchPoints>0)&&function(){if(wr){if(/Tablet|Pad/i.test(Nr))return!0;if(180===window.orientation||0===window.orientation)return window.innerWidth>=768&&window.innerHeight>=1024;if(90===window.orientation||-90===window.orientation)return window.innerWidth>=1024&&window.innerHeight>=768}return!1}(),Br=/iPhone/i.test(Nr)||/iPod/i.test(Nr),Vr=Ar,jr=Pr||Ur||Gr||Br||Fr||xr,qr=wr&&!jr,Hr=Lr&&!Ar;function Kr(){let e="";return qr?e="pc":jr?e="h5":Vr?e="wechat":Hr&&(e="app"),e}const zr=new Map;function Yr(e,t){if(!e)return Promise.reject(new Error(`getBoundingClientRect get error selector ${typeof e}.`));if(window||document){const t="object"==typeof e?e:document.querySelector(e);if(!t)return Promise.reject(new Error(`getBoundingClientRect can't find ${e} dom.`));const n=t.getBoundingClientRect();return Promise.resolve({id:t.id,top:n.top,left:n.left,right:n.right,bottom:n.bottom,width:n.width,height:n.height,x:n.x,y:n.y})}if(Rr){if(!t)return Promise.reject(new Error("getBoundingClientRect need instanceName in params."));const n=uni.createSelectorQuery().in(zr.get(t));return new Promise(((t,i)=>{n.select(e).boundingClientRect((e=>{e&&t(e)})).exec(),setTimeout((()=>i(new Error(`getBoundingClientRect ${e} timeout.`))),500)}))}return Promise.reject(new Error("getBoundingClientRect occur error"))}function $r(e,t){if(!e)return Promise.reject(new Error(`getScrollInfo get error selector ${typeof e}.`));if(!Rr&&window){const t="object"==typeof e?e:document.querySelector(e);return t?Promise.resolve({id:t.id,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight}):Promise.reject(new Error(`getScrollInfo can't find ${e} dom.`))}if(Rr){if(!t)return Promise.reject(new Error("getScrollInfo need instanceName in params."));const n=uni.createSelectorQuery().in(zr.get(t));return new Promise(((t,i)=>{n.select(e).scrollOffset((e=>{e&&t(e)})).exec(),setTimeout((()=>i(new Error(`getScrollInfo ${e} timeout.`))),500)}))}return Promise.reject(new Error("getScrollInfo occur error"))}class Wr{constructor(){if(Wr.instance)return Wr.instance;Wr.instance=this,this.eventCallback=null,this.listener=null,this.button=0,this.init()}init(){wr&&(this.eventCallback=e=>{this.listener&&this.listener(e)},document.addEventListener("mousedown",this.eventCallback))}listen(e){if(wr){const{domRefs:t,ignoreDomRefs:n,handler:i,button:o=0}=e;this.button=o,this.listener=e=>{const o=Array.isArray(n)?n:[n];for(const t of o)if(t&&t.contains(e.target))return;const a=Array.isArray(t)?t:[t];for(const t of a)if(t&&t.contains(e.target)&&this.button===e.button)return;i(e),this.remove()}}}remove(){this.listener=null,this.button=-1}}c("log","at node_modules/@tencentcloud/universal-api/index.js:1","UniversalAPI.VERSION:2.4.0"),new Wr;const Jr="/assets/video-play.58b451c9.png",Xr="pc"===Kr(),Zr="h5"===Kr(),Qr="wechat"===Kr(),ec="app"===Kr(),tc="undefined"!=typeof uni,nc=Zr||Qr||ec,ic=e.defineComponent({__name:"Icon",props:{file:{default:""},size:{},width:{default:"20px"},height:{default:"20px"},hotAreaSize:{}},emits:["onClick"],setup(t,{emit:n}){const{withDefaults:i,computed:o}=co,a=n,s=t,r=o((()=>{if(s.hotAreaSize)return isNaN(Number(s.hotAreaSize))?String(s.hotAreaSize):`${s.hotAreaSize}px`})),c=o((()=>s.size?s.size:s.width)),u=o((()=>s.size?s.size:s.height)),l=e=>{a("onClick",e)};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["common-icon-container","common-icon-container-mobile"]),style:e.normalizeStyle({padding:e.unref(r)}),onClick:l},[e.unref(ec)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"common-icon",src:s.file,style:e.normalizeStyle({width:e.unref(c),height:e.unref(u)})},null,12,["src"])):(e.openBlock(),e.createElementBlock("img",{key:1,class:"common-icon",src:s.file,style:e.normalizeStyle({width:e.unref(c),height:e.unref(u)})},null,12,["src"]))],4))}}),oc=u(ic,[["__scopeId","data-v-cc878276"]]),ac=e.defineComponent({__name:"index",props:{url:{default:"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"},size:{default:"36px"},borderRadius:{default:"50%"},useSkeletonAnimation:{type:Boolean,default:!1}},emits:["onLoad","onError"],setup(t,{emit:n}){const{ref:i,toRefs:o}=co,a=i("https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"),s=n,r=t,{size:c,url:u,borderRadius:l,useSkeletonAnimation:d}=o(r);let h=0;const p=i(!1),g=i(!1);function f(e){p.value=!0,s("onLoad",e)}function m(e){h+=1,h>3||(g.value=!0,s("onError",e))}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"avatar-container",style:e.normalizeStyle({width:e.unref(c),height:e.unref(c),borderRadius:e.unref(l)})},[e.createElementVNode("template",null,[e.unref(g)?(e.openBlock(),e.createElementBlock("image",{key:1,class:"avatar-image",src:e.unref(a),onLoad:f,onError:m},null,40,["src"])):(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar-image",src:e.unref(u)||e.unref(a),onLoad:f,onError:m},null,40,["src"]))]),e.unref(d)&&!e.unref(p)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({placeholder:!0,hidden:e.unref(p),"skeleton-animation":e.unref(d)})},null,2)):e.createCommentVNode("",!0)],4))}}),sc=u(ac,[["__scopeId","data-v-9bb83222"]]),rc={OFFICIAL_ACCOUNT:"1",MINI_APP:"2",MINI_APP_SERVICE_ACCOUNT:"3",BACKEND_INTERNAL:"4",WEB:"5",SESSION_MESSAGE_SLICE:"6",MINI_APP_AUTO:"7",INTERNAL:"8",MENU:"9",MENU_SELECTED:"10",CLIENT_STATE:"11",TYPING_STATE:"12",ROBOT:"13",BRANCH:"15",BRANCH_NUMBER:15,MEMBER:"17",NO_SEAT_ONLINE:"18",END:"19",TIMEOUT:"20",FROM_INPUT:"21",PRODUCT_CARD:"22",SATISFACTION_CON:"23",USER_SATISFACTION:"24",SEAT_STATUS:"26",USER_END_SESSION:"27",ORDER:"28",ROBOT_MSG:"29",RICH_TEXT:"30",STREAM_TEXT:"31",MULTI_BRANCH:"32",MULTI_FORM:"33",THINKING:"35",CONCURRENCY_LIMIT:"36"},cc={STAR:1,NUMBER:2},uc="TIMCustomElem",lc="TIMGroupTipElem",dc={BASIC:"basic",BIG:"big",CUSTOM:"CUSTOM"},hc=[rc.MENU,rc.BRANCH,rc.BRANCH_NUMBER,rc.FROM_INPUT,rc.PRODUCT_CARD,rc.ROBOT_MSG,rc.RICH_TEXT,rc.STREAM_TEXT,rc.MULTI_BRANCH,rc.MULTI_FORM,rc.CONCURRENCY_LIMIT,rc.ORDER],pc={HUMAN_SERVICE:"humanService",SERVICE_RATING:"serviceRating",END_HUMAN_SERVICE:"endHumanService"};function gc(e){return function(e){if("string"==typeof e)try{return!!JSON.parse(e)}catch(t){return!1}return!1}(e)?JSON.parse(e):e}const fc=e=>{var t;const n=(null==e?void 0:e.type)===uc,i=gc(null==(t=null==e?void 0:e.payload)?void 0:t.data);return n&&(null==i?void 0:i.src)===rc.THINKING&&0===(null==i?void 0:i.thinkingStatus)},mc=e=>{var t,n;const i=gc(null==(t=null==e?void 0:e.payload)?void 0:t.data),o=(null==e?void 0:e.type)===uc,a=(null==e?void 0:e.type)===lc,s=(null==i?void 0:i.src)&&!hc.includes(null==i?void 0:i.src),r=null!==(null==i?void 0:i.src)&&(null==i?void 0:i.src)===rc.MULTI_FORM&&"out"===e.flow,c=(null==i?void 0:i.src)===rc.ROBOT&&-1!==["feedback","updateBotStatus"].indexOf(null==(n=null==i?void 0:i.content)?void 0:n.command);return o&&(s||c||r)||a},_c=e=>-1!==["zh","zh-TW","en","id","vi","ja","fil","ru"].indexOf(e),vc=(e,t)=>{var n;"undefined"!=typeof window&&(null==(n=window.navigator)?void 0:n.cookieEnabled)&&localStorage&&localStorage.removeItem(`TIM_${e}_${t}_conversationMap`)};let yc,Ic;yc="undefined"!=typeof console?console:"undefined"!=typeof global&&global.console?global.console:"undefined"!=typeof window&&window.console?window.console:{};const Mc=function(){},Cc=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];let Ec=Cc.length;for(;Ec--;)Ic=Cc[Ec],console[Ic]||(yc[Ic]=Mc);const Tc=yc;const kc=function(){const e=new Date;return e.setTime((new Date).getTime()+0),e},Sc=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"array"===function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()}(e)},Dc=function(e){return e instanceof Error};const bc={arguments2String(e){let t="";if(1===e.length)t=e[0];else for(let o=0,a=e.length;o<a;o++){if(n=e[o],Sc(n)||function(e){return null!==e&&"object"==typeof e}(n))try{t+=Dc(e[o])?JSON.stringify(e[o],["message","code"]):JSON.stringify(e[o])}catch(i){t+=i?i.message:"";break}else t+=e[o];t+=" "}var n;return t},_exec(e,t){Tc[e](`ai-desk-customer ${function(){const e=kc();return e.toLocaleTimeString("en-US",{hour12:!1})+"."+function(e){let t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}(e.getMilliseconds())}()} ${t}`)},d:function(){const e=this.arguments2String(arguments);this._exec("debug",e)},l:function(){const e=this.arguments2String(arguments);this._exec("log",e)},log:function(){const e=this.arguments2String(arguments);this._exec("log",e)},i:function(){const e=this.arguments2String(arguments);this._exec("info",e)},w:function(){const e=this.arguments2String(arguments);this._exec("warn",e)},e:function(){const e=this.arguments2String(arguments);this._exec("error",e)}};function Ac(e,t=new WeakMap){if("object"!=typeof e||null==e)return e;if(t.has(e))return t.get(e);const n=Object.create(Object.getPrototypeOf(e));return Object.keys(e).forEach((i=>{const o=e[i];"object"!=typeof o||null===o?n[i]=o:Array.isArray(o)?n[i]=[...o]:o instanceof Set?n[i]=new Set([...o]):o instanceof Map?n[i]=new Map([...o]):(t.set(e,e),n[i]=Ac(o,t))})),n}function Lc(){return zs.getData(To.USER,"displayMessageReadReceipt")&&zs.getData(To.APP,"enabledMessageReadReceipt")}function Rc(e){return Object.assign({},e)}function wc(e){const t=(new Date).setHours(0,0,0,0),n=new Date((new Date).getFullYear(),0,1,0,0,0,0).getTime(),i=new Date(e),o=864e5,a=t-i.getTime();function s(e){return e<10?"0"+e:e.toString()}if(a<=0)return`${s(i.getHours())}:${s(i.getMinutes())}`;if(a<=o)return`${Ys.t("Time.昨天")} ${s(i.getHours())}:${s(i.getMinutes())}`;if(a<=5184e5){const e=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][i.getDay()];return`${Ys.t("Time."+e)} ${s(i.getHours())}:${s(i.getMinutes())}`}return i.getTime()>=n?`${i.getMonth()+1}/${i.getDate()} ${s(i.getHours())}:${s(i.getMinutes())}`:`${i.getFullYear()}/${i.getMonth()+1}/${i.getDate()} ${s(i.getHours())}:${s(i.getMinutes())}`}const Oc=ec&&!1,Nc=ec&&!0;function Pc(e){const t=function(e){try{const t=decodeURIComponent(e);if("undefined"!=typeof URL){const e=new URL(t);return["http:","https:"].includes(e.protocol)?(e.username="",e.password="",e.href):null}return t}catch(Ct){return null}}(e);t?ec?plus.runtime.openURL(t):window.open(t,"_blank","noopener,noreferrer"):bc.w(`Invalid URL provided:${e}`)}function Uc(e){var t,n;return(null==(t=null==e?void 0:e.groupProfile)?void 0:t.groupID)||(null==(n=null==e?void 0:e.userProfile)?void 0:n.userID)}const Gc=u(e.defineComponent({__name:"message-container",props:{sender:{default:""},avatar:{default:""},type:{},time:{}},setup(t){const{computed:n}=co,i=t,o=Ks.TYPES,a=n((()=>[o.MSG_IMAGE,o.MSG_VIDEO,o.MSG_MERGER].includes(i.type)));return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"simple-message-container"},[e.createElementVNode("div",{class:"simple-message-avatar"},[e.createVNode(sc,{url:i.avatar},null,8,["url"])]),e.createElementVNode("div",null,[e.createElementVNode("div",{class:"simple-message-sender"},e.toDisplayString(i.sender),1),e.createElementVNode("div",{class:"simple-message-body"},[e.createElementVNode("div",{class:e.normalizeClass({"simple-message-content":!0,"no-padding":e.unref(a)})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2),e.createElementVNode("div",{class:"timestamp"},e.toDisplayString(e.unref(wc)(1e3*i.time)),1)])])]))}}),[["__scopeId","data-v-91f8557b"]]),xc={"[TUIEmoji_Smile]":"[微笑]","[TUIEmoji_Expect]":"[期待]","[TUIEmoji_Blink]":"[眨眼]","[TUIEmoji_Guffaw]":"[大笑]","[TUIEmoji_KindSmile]":"[姨母笑]","[TUIEmoji_Haha]":"[哈哈哈]","[TUIEmoji_Cheerful]":"[愉快]","[TUIEmoji_Speechless]":"[无语]","[TUIEmoji_Amazed]":"[惊讶]","[TUIEmoji_Sorrow]":"[悲伤]","[TUIEmoji_Complacent]":"[得意]","[TUIEmoji_Silly]":"[傻了]","[TUIEmoji_Lustful]":"[色]","[TUIEmoji_Giggle]":"[憨笑]","[TUIEmoji_Kiss]":"[亲亲]","[TUIEmoji_Wail]":"[大哭]","[TUIEmoji_TearsLaugh]":"[哭笑]","[TUIEmoji_Trapped]":"[困]","[TUIEmoji_Mask]":"[口罩]","[TUIEmoji_Fear]":"[恐惧]","[TUIEmoji_BareTeeth]":"[龇牙]","[TUIEmoji_FlareUp]":"[发怒]","[TUIEmoji_Yawn]":"[打哈欠]","[TUIEmoji_Tact]":"[机智]","[TUIEmoji_Stareyes]":"[星星眼]","[TUIEmoji_ShutUp]":"[闭嘴]","[TUIEmoji_Sigh]":"[叹气]","[TUIEmoji_Hehe]":"[呵呵]","[TUIEmoji_Silent]":"[收声]","[TUIEmoji_Surprised]":"[惊喜]","[TUIEmoji_Askance]":"[白眼]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[便便]","[TUIEmoji_Monster]":"[怪兽]","[TUIEmoji_Daemon]":"[恶魔]","[TUIEmoji_Rage]":"[恶魔怒]","[TUIEmoji_Fool]":"[衰]","[TUIEmoji_Pig]":"[猪]","[TUIEmoji_Cow]":"[牛]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[骷髅]","[TUIEmoji_Bombs]":"[炸弹]","[TUIEmoji_Coffee]":"[咖啡]","[TUIEmoji_Cake]":"[蛋糕]","[TUIEmoji_Beer]":"[啤酒]","[TUIEmoji_Flower]":"[花]","[TUIEmoji_Watermelon]":"[瓜]","[TUIEmoji_Rich]":"[壕]","[TUIEmoji_Heart]":"[爱心]","[TUIEmoji_Moon]":"[月亮]","[TUIEmoji_Sun]":"[太阳]","[TUIEmoji_Star]":"[星星]","[TUIEmoji_RedPacket]":"[红包]","[TUIEmoji_Celebrate]":"[庆祝]","[TUIEmoji_Bless]":"[福]","[TUIEmoji_Fortune]":"[发]","[TUIEmoji_Convinced]":"[服]","[TUIEmoji_Prohibit]":"[禁]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[刀]","[TUIEmoji_Like]":"[赞]"},Fc={"[TUIEmoji_Smile]":"[Smile]","[TUIEmoji_Expect]":"[Expect]","[TUIEmoji_Blink]":"[Blink]","[TUIEmoji_Guffaw]":"[Guffaw]","[TUIEmoji_KindSmile]":"[KindSmile]","[TUIEmoji_Haha]":"[Haha]","[TUIEmoji_Cheerful]":"[Cheerful]","[TUIEmoji_Speechless]":"[Speechless]","[TUIEmoji_Amazed]":"[Amazed]","[TUIEmoji_Sorrow]":"[Sorrow]","[TUIEmoji_Complacent]":"[Complacent]","[TUIEmoji_Silly]":"[Silly]","[TUIEmoji_Lustful]":"[Lustful]","[TUIEmoji_Giggle]":"[Giggle]","[TUIEmoji_Kiss]":"[Kiss]","[TUIEmoji_Wail]":"[Wail]","[TUIEmoji_TearsLaugh]":"[TearsLaugh]","[TUIEmoji_Trapped]":"[Trapped]","[TUIEmoji_Mask]":"[Mask]","[TUIEmoji_Fear]":"[Fear]","[TUIEmoji_BareTeeth]":"[BareTeeth]","[TUIEmoji_FlareUp]":"[FlareUp]","[TUIEmoji_Yawn]":"[Yawn]","[TUIEmoji_Tact]":"[Tact]","[TUIEmoji_Stareyes]":"[StarEyes]","[TUIEmoji_ShutUp]":"[ShutUp]","[TUIEmoji_Sigh]":"[Sigh]","[TUIEmoji_Hehe]":"[Hehe]","[TUIEmoji_Silent]":"[Silent]","[TUIEmoji_Surprised]":"[Surprised]","[TUIEmoji_Askance]":"[Askance]]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[Shit]","[TUIEmoji_Monster]":"[Monster]","[TUIEmoji_Daemon]":"[Daemon]","[TUIEmoji_Rage]":"[Rage]","[TUIEmoji_Fool]":"[Fool]","[TUIEmoji_Pig]":"[Pig]","[TUIEmoji_Cow]":"[Cow]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[Skull]","[TUIEmoji_Bombs]":"[Bombs]","[TUIEmoji_Coffee]":"[Coffee]","[TUIEmoji_Cake]":"[Cake]","[TUIEmoji_Beer]":"[Beer]","[TUIEmoji_Flower]":"[Flower]","[TUIEmoji_Watermelon]":"[Watermelon]","[TUIEmoji_Rich]":"[Rich]","[TUIEmoji_Heart]":"[Heart]","[TUIEmoji_Moon]":"[Moon]","[TUIEmoji_Sun]":"[Sun]","[TUIEmoji_Star]":"[Star]","[TUIEmoji_RedPacket]":"[RedPacket]","[TUIEmoji_Celebrate]":"[Celebrate]","[TUIEmoji_Bless]":"[Bless]","[TUIEmoji_Fortune]":"[Fortune]","[TUIEmoji_Convinced]":"[Convinced]","[TUIEmoji_Prohibit]":"[Prohibit]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[Knife]","[TUIEmoji_Like]":"[Like]"},Bc="https://web.sdk.qcloud.com/im/assets/face-elem/",Vc=[{emojiGroupID:1,type:dc.BIG,url:Bc,list:["yz00","yz01","yz02","yz03","yz04","yz05","yz06","yz07","yz08","yz09","yz10","yz11","yz12","yz13","yz14","yz15","yz16","yz17"]},{emojiGroupID:2,type:dc.BIG,url:Bc,list:["ys00","ys01","ys02","ys03","ys04","ys05","ys06","ys07","ys08","ys09","ys10","ys11","ys12","ys13","ys14","ys15"]},{emojiGroupID:3,type:dc.BIG,url:Bc,list:["gcs00","gcs01","gcs02","gcs03","gcs04","gcs05","gcs06","gcs07","gcs08","gcs09","gcs10","gcs11","gcs12","gcs13","gcs14","gcs15","gcs16"]}],jc={...Object.fromEntries(null==(t=Object.entries(xc))?void 0:t.map((([e,t])=>[t,e]))),...Object.fromEntries(null==(n=Object.entries(Fc))?void 0:n.map((([e,t])=>[t,e])))},qc="https://web.sdk.qcloud.com/im/assets/emoji-plugin/",Hc={"[TUIEmoji_Expect]":"emoji_0@2x.png","[TUIEmoji_Blink]":"emoji_1@2x.png","[TUIEmoji_Guffaw]":"emoji_2@2x.png","[TUIEmoji_KindSmile]":"emoji_3@2x.png","[TUIEmoji_Haha]":"emoji_4@2x.png","[TUIEmoji_Cheerful]":"emoji_5@2x.png","[TUIEmoji_Smile]":"emoji_6@2x.png","[TUIEmoji_Sorrow]":"emoji_7@2x.png","[TUIEmoji_Speechless]":"emoji_8@2x.png","[TUIEmoji_Amazed]":"emoji_9@2x.png","[TUIEmoji_Complacent]":"emoji_10@2x.png","[TUIEmoji_Lustful]":"emoji_11@2x.png","[TUIEmoji_Stareyes]":"emoji_12@2x.png","[TUIEmoji_Giggle]":"emoji_13@2x.png","[TUIEmoji_Daemon]":"emoji_14@2x.png","[TUIEmoji_Rage]":"emoji_15@2x.png","[TUIEmoji_Yawn]":"emoji_16@2x.png","[TUIEmoji_TearsLaugh]":"emoji_17@2x.png","[TUIEmoji_Silly]":"emoji_18@2x.png","[TUIEmoji_Wail]":"emoji_19@2x.png","[TUIEmoji_Kiss]":"emoji_20@2x.png","[TUIEmoji_Trapped]":"emoji_21@2x.png","[TUIEmoji_Fear]":"emoji_22@2x.png","[TUIEmoji_BareTeeth]":"emoji_23@2x.png","[TUIEmoji_FlareUp]":"emoji_24@2x.png","[TUIEmoji_Tact]":"emoji_25@2x.png","[TUIEmoji_Shit]":"emoji_26@2x.png","[TUIEmoji_ShutUp]":"emoji_27@2x.png","[TUIEmoji_Sigh]":"emoji_28@2x.png","[TUIEmoji_Hehe]":"emoji_29@2x.png","[TUIEmoji_Silent]":"emoji_30@2x.png","[TUIEmoji_Skull]":"emoji_31@2x.png","[TUIEmoji_Mask]":"emoji_32@2x.png","[TUIEmoji_Beer]":"emoji_33@2x.png","[TUIEmoji_Cake]":"emoji_34@2x.png","[TUIEmoji_RedPacket]":"emoji_35@2x.png","[TUIEmoji_Bombs]":"emoji_36@2x.png","[TUIEmoji_Ai]":"emoji_37@2x.png","[TUIEmoji_Celebrate]":"emoji_38@2x.png","[TUIEmoji_Bless]":"emoji_39@2x.png","[TUIEmoji_Flower]":"emoji_40@2x.png","[TUIEmoji_Watermelon]":"emoji_41@2x.png","[TUIEmoji_Cow]":"emoji_42@2x.png","[TUIEmoji_Fool]":"emoji_43@2x.png","[TUIEmoji_Surprised]":"emoji_44@2x.png","[TUIEmoji_Askance]":"emoji_45@2x.png","[TUIEmoji_Monster]":"emoji_46@2x.png","[TUIEmoji_Pig]":"emoji_47@2x.png","[TUIEmoji_Coffee]":"emoji_48@2x.png","[TUIEmoji_Ok]":"emoji_49@2x.png","[TUIEmoji_Heart]":"emoji_50@2x.png","[TUIEmoji_Sun]":"emoji_51@2x.png","[TUIEmoji_Moon]":"emoji_52@2x.png","[TUIEmoji_Star]":"emoji_53@2x.png","[TUIEmoji_Rich]":"emoji_54@2x.png","[TUIEmoji_Fortune]":"emoji_55@2x.png","[TUIEmoji_857]":"emoji_56@2x.png","[TUIEmoji_666]":"emoji_57@2x.png","[TUIEmoji_Prohibit]":"emoji_58@2x.png","[TUIEmoji_Convinced]":"emoji_59@2x.png","[TUIEmoji_Knife]":"emoji_60@2x.png","[TUIEmoji_Like]":"emoji_61@2x.png"},Kc=[{emojiGroupID:0,type:dc.BASIC,url:qc,list:Object.keys(Hc)},...Vc],zc=e=>Qr?xc[e]:Ys.t(`Emoji.${e}`),Yc=e=>{if(!e)return"";const t=/(\[.+?\])/g;let n=e;return t.test(e)&&(n=e.replace(t,(e=>Hc[e]?zc(e):e))),n},$c=e=>{if(!e)return"";const t=/(\[.+?\])/g;let n=e;return t.test(e)&&(n=e.replace(t,(e=>jc[e]||e))),n},Wc=e=>{const t=/\[([^\]]+)\]/g,n=[];let i,o=0;for(;null!==(i=t.exec(e));){const a=i.index,s=t.lastIndex,r=i[0];a>o&&n.push({type:"text",content:e.substring(o,a)});const c=qc+Hc[r];c?n.push({type:"image",content:c,emojiKey:r}):n.push({type:"text",content:r}),o=s,t.lastIndex=o}return o<e.length&&n.push({type:"text",content:e.substring(o)}),n},Jc=u(e.defineComponent({__name:"index",props:{renderData:{},disabled:{type:Boolean,default:!1},messageItem:{default:()=>({})}},emits:["assignMessageIDInUniapp"],setup(t,{emit:n}){const{ref:i,withDefaults:o}=co,a=n,s=t;function r(){s.disabled||a("assignMessageIDInUniapp",s.messageItem.ID)}return i(!1),(t,n)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:"message-record-container",onClick:r},[e.createElementVNode("div",{class:"record-title"},e.toDisplayString(s.renderData.title),1),e.createElementVNode("div",{class:"record-abstract-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.renderData.abstractList.slice(0,7),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:"record-abstract-item"},e.toDisplayString(e.unref(Yc)(t)),1)))),128))]),e.createElementVNode("div",{class:"record-footer"},e.toDisplayString(e.unref(Ys).t("TUIChat.聊天记录")),1)])]))}}),[["__scopeId","data-v-d00a1e07"]]),Xc=e.defineComponent({__name:"index",props:{messageID:{default:""},isMounted:{type:Boolean,default:!1}},emits:["closeOverlay"],setup(t,{emit:n}){const{computed:i,ref:o,watch:a}=co,s=n,r=t,c=Ks.TYPES,u=o(!1),l=o([]),d=o({title:"",messageList:[]}),h=o();a((()=>l.value.length),(async e=>{if(u.value=!1,e<1)return;const t=l.value[l.value.length-1];if(t.downloadKey&&0===t.messageList.length)try{const e=await Js.downloadMergedMessages({payload:t,type:Ks.TYPES.MSG_MERGER});l.value[l.value.length-1]=e.payload}catch(n){u.value=!0}d.value=l.value[l.value.length-1]})),a((()=>r.isMounted),(e=>{if(e){if(!r.messageID)throw new Error("messageID is required when first render of simple-message-list.");const e=zs.getMessageModel(r.messageID).getMessage().payload;l.value=[e]}else l.value=[]}),{immediate:!0});const p=i((()=>l.value.length>1)),g=i((()=>{var e;return!!(null==(e=d.value)?void 0:e.messageList)&&d.value.messageList.length>0}));function f(){l.value.pop(),l.value.length<1&&s("closeOverlay")}function m(e){let t="";return e.indexOf("@custom")>-1?t=""+e:(t=Bc+e,-1===t.indexOf("@2x")?t+="@2x.png":t+=".png"),t}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"simple-message-list-container":!0,"simple-message-list-container-mobile":e.unref(nc)})},[e.createElementVNode("div",{class:"header-container"},[e.createElementVNode("span",{class:"back",onClick:f},[e.createVNode(oc,{class:"close-icon",file:e.unref("/assets/back.e9626a2e.svg"),size:"18px"},null,8,["file"]),e.unref(p)?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(e.unref(Ys).t("TUIChat.返回")),1)):(e.openBlock(),e.createElementBlock("span",{key:1},e.toDisplayString(e.unref(Ys).t("TUIChat.关闭")),1))]),e.createElementVNode("span",{class:"title"},e.toDisplayString(e.unref(d).title),1)]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:0}," Load Merge Message Error ")):e.unref(g)?(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"simpleMessageListRef",ref:h,class:"message-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d).messageList,(t=>(e.openBlock(),e.createElementBlock("div",{key:t.ID,class:e.normalizeClass({"message-item":!0})},[e.createVNode(Gc,{sender:t.nick,avatar:t.avatar,type:t.messageBody[0].type,time:t.time},{default:e.withCtx((()=>[t.messageBody[0].type===e.unref(c).MSG_TEXT?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-text"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(Wc)(t.messageBody[0].payload.text),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:"message-text-container"},["text"===t.type?(e.openBlock(),e.createElementBlock("span",{key:0,class:"text"},e.toDisplayString(t.content),1)):(e.openBlock(),e.createElementBlock("img",{key:1,class:"simple-emoji",src:t.content,alt:"small-face"},null,8,["src"]))])))),128))])):t.messageBody[0].type===e.unref(c).MSG_IMAGE?(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-image"},[e.createElementVNode("img",{class:"image",src:t.messageBody[0].payload.imageInfoArray[2].url,mode:"widthFix",alt:"image"},null,8,["src"])])):t.messageBody[0].type===e.unref(c).MSG_VIDEO?(e.openBlock(),e.createElementBlock("div",{key:2,class:"message-video"},[e.createElementVNode("div",{onClick:e=>function(e){const t=encodeURIComponent(e);uni.navigateTo({url:`/TUIKit/components/TUIChat/video-play?videoUrl=${t}`})}(t.messageBody[0].payload.remoteVideoUrl)},[e.createElementVNode("image",{class:"image",src:t.messageBody[0].payload.thumbUrl,mode:"widthFix",alt:"image"},null,8,["src"]),e.createVNode(oc,{class:"video-play-icon",file:e.unref(Jr)},null,8,["file"])],8,["onClick"])])):t.messageBody[0].type===e.unref(c).MSG_AUDIO?(e.openBlock(),e.createElementBlock("div",{key:3,class:"message-audio"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(Ys).t("TUIChat.语音"))+" ",1),e.createElementVNode("span",null,e.toDisplayString(t.messageBody[0].payload.second)+"s",1)])):t.messageBody[0].type===e.unref(c).MSG_FACE?(e.openBlock(),e.createElementBlock("div",{key:4,class:"message-face"},[e.createElementVNode("img",{class:"image",src:m(t.messageBody[0].payload.data),alt:"face"},null,8,["src"])])):t.messageBody[0].type===e.unref(c).MSG_FILE?(e.openBlock(),e.createElementBlock("div",{key:5,class:"message-file"},e.toDisplayString(e.unref(Ys).t("TUIChat.[文件]")),1)):t.messageBody[0].type===e.unref(c).MSG_LOCATION?(e.openBlock(),e.createElementBlock("div",{key:6},e.toDisplayString(e.unref(Ys).t("TUIChat.[地理位置]")),1)):t.messageBody[0].type===e.unref(c).MSG_MERGER?(e.openBlock(),e.createElementBlock("div",{key:7,class:"message-merger",onClickCapture:e=>function(e,t){l.value.push(t.messageBody[0].payload),e.stopPropagation()}(e,t)},[e.createVNode(Jc,{disabled:"",renderData:t.messageBody[0].payload},null,8,["renderData"])],40,["onClickCapture"])):t.messageBody[0].type===e.unref(c).MSG_CUSTOM?(e.openBlock(),e.createElementBlock("div",{key:8},e.toDisplayString(e.unref(Ys).t("TUIChat.[自定义消息]")),1)):e.createCommentVNode("",!0)])),_:2},1032,["sender","avatar","type","time"])])))),128))],512)):e.createCommentVNode("",!0)],2))}}),Zc=u(Xc,[["__scopeId","data-v-106c11e0"]]),Qc=u(e.defineComponent({__name:"message-text",props:{content:{default:()=>({})}},setup(t){const{watchEffect:n,ref:i}=co,o=t,a=i();return n((()=>{var e;a.value=o.content,null==(e=a.value.text)||e.forEach((e=>{"img"===e.name&&"custom"===(null==e?void 0:e.type)&&c("warn","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-text.vue:47","CUSTOM_BASIC_EMOJI_URL is required for custom emoji, please check your CUSTOM_BASIC_EMOJI_URL.")}))})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-text-container"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a).text,((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n},["text"===t.name?(e.openBlock(),e.createElementBlock("span",{key:0,class:"text"},e.toDisplayString(t.text),1)):(e.openBlock(),e.createElementBlock("img",{key:1,class:"emoji",src:t.src,alt:t.emojiKey},null,8,["src","alt"]))])))),128))]))}}),[["__scopeId","data-v-b10ad6b7"]]),eu=155,tu=u(e.defineComponent({__name:"message-image-uniapp",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},emits:["previewImage"],setup(t,{emit:n}){const{watchEffect:i,ref:o}=co,a=n,s=t,r=o({width:"auto",height:"auto"}),c=e=>{const{width:t,height:n}=e;if(0===t||0===n)return;let i=0,o=0;t>=n?(i=eu,o=eu*n/t):(i=eu*t/n,o=eu),r.value.width=i+"px",r.value.height=o+"px"};i((()=>{c(s.content)}));const u=e=>{c(e.detail)},l=()=>{var e;"success"!==(null==(e=s.messageItem)?void 0:e.status)&&1!==s.messageItem.progress||a("previewImage")};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"image-container",onClick:l},[e.createElementVNode("image",{class:"message-image",mode:"aspectFit",src:s.content.url,style:e.normalizeStyle({width:e.unref(r).width,height:e.unref(r).height}),onLoad:u},null,44,["src"])]))}}),[["__scopeId","data-v-77505878"]]),nu="success",iu="warning",ou="error",au="normal",su=e=>{Or.showToast({title:e.message||"Toast",duration:e.duration||1500,icon:ru(e.type)})},ru=e=>{if(!e)return"none";switch(e){case ou:case iu:return"none";case nu:return"success";default:return"none"}},cu="/assets/msg-audio.ac2cd1c9.svg",uu=u(e.defineComponent({__name:"message-audio-uniapp",props:{broadcastNewAudioSrc:{},messageItem:{default:()=>({})},content:{default:()=>({})}},emits:["getGlobalAudioContext","setAudioPlayed"],setup(t,{emit:n}){const{onUnmounted:i,ref:o,watch:a}=co,s=n,r=t,u=new Map,l=o(!1);function d(){if(s("getGlobalAudioContext",u,{newAudioSrc:r.content.url}),r.messageItem.hasRiskContent||!r.content.url)return void su({message:"暂不支持播放"});_()||(u.set("audio",uni.createInnerAudioContext()),function(){const e=_();if(!e)return;e.src=r.content.url,l.value=!1,e.onPlay(p),e.onStop(g),e.onEnded(f),e.onError(m)}()),l.value?h():function(){const e=_();e&&(e.play(),"in"===r.messageItem.flow&&s("setAudioPlayed",r.messageItem.ID))}()}function h(){const e=_();if(e)try{e.stop()}catch{}}function p(){l.value=!0}function g(){l.value=!1}function f(){l.value=!1}function m(){c("warn","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-audio-uniapp.vue:160","audio played error")}function _(){return u.get("audio")}return i((()=>{var e;const t=_();l.value&&h(),null==(e=null==t?void 0:t.destroy)||e.call(t),u.delete("audio")})),a((()=>r.broadcastNewAudioSrc),(e=>{e!==r.content.url&&l.value&&(h(),l.value=!1)})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-audio":!0,reserve:"out"===r.messageItem.flow}),onClick:d},[e.createElementVNode("div",{class:"audio-icon-container"},[e.createVNode(oc,{class:e.normalizeClass({icon:!0,play:e.unref(l)}),width:"15px",height:"20px",file:e.unref(cu)},null,8,["class","file"])]),e.createElementVNode("div",{class:"time",style:e.normalizeStyle({width:5*r.content.second+"px"})},e.toDisplayString(r.content.second||1)+' " ',5)],2))}}),[["__scopeId","data-v-edd97798"]]),lu=u(e.defineComponent({__name:"message-file",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},setup(t){const n=t,i=()=>{if(!n.messageItem.hasRiskContent&&"out"!==n.messageItem.flow)if(Qr)c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:47","isWechat",n.content.url),wx.downloadFile({url:n.content.url,filePath:wx.env.USER_DATA_PATH+"/"+n.content.name,success:function(e){var t=e.filePath;const n=t.lastIndexOf("."),i=t.substring(n+1);c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:56",i),wx.openDocument({filePath:t,showMenu:!0,fileType:i,success:function(e){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:62","打开文档成功")},fail:function(){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:65","fail")}})}});else if(tc){const e=n.content.url.lastIndexOf("."),t=n.content.url.substring(e+1);uni.downloadFile({url:n.content.url,success:function(e){if(200==e.statusCode){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:77",e);const n=e.tempFilePath;uni.showToast({title:"下载成功"+n,icon:"success",duration:2e3}),c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:84",n),uni.openDocument({filePath:n,fileType:t,success:function(){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:89","打开文档成功")},fail:function(){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:92","打开文档失败")}})}}})}else{c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-file.vue:111","no window here");const e=document.createElement("a");e.href=n.content.url,e.target="_blank",e.download=n.content.name,e.click()}};return(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["file-message-montainer","in"===t.messageItem.flow?"file-in":""]),title:e.unref(Ys).t("TUIChat.单击下载"),onClick:i},[e.createVNode(oc,{file:e.unref("/assets/files.75008e25.svg"),class:"file-icon"},null,8,["file"]),e.createElementVNode("div",null,[e.createElementVNode("div",null,e.toDisplayString(n.content.name),1),e.createElementVNode("div",null,e.toDisplayString(n.content.size),1)])],10,["title"]))}}),[["__scopeId","data-v-2cc99e0c"]]),du=u(e.defineComponent({__name:"message-face",props:{content:{type:Object,default:()=>({})}},setup(t){const{ref:n,onMounted:i}=co,o=t,a=n(o.content.url);return i((()=>{"custom"===o.content.type&&c("warn","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-face.vue:28","CUSTOM_BIG_EMOJI_URL is required for custom emoji, please check your CUSTOM_BIG_EMOJI_URL.")})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"message-image"},[e.createElementVNode("img",{mode:"aspectFit",class:"message-image",src:e.unref(a)},null,8,["src"])]))}}),[["__scopeId","data-v-3b30ab2a"]]),hu=e.defineComponent({__name:"message-custom",setup:t=>(t,n)=>(e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(e.unref(Ys).t("TUIChat.[自定义消息]")),1))}),pu=u(e.defineComponent({__name:"index",props:{message:{default:()=>({})}},setup(t){const{computed:n,ref:i,onMounted:o,onUnmounted:a}=co,s=t,r=Ks.TYPES,c=i(!0);o((()=>{zs.watch(To.USER,{displayMessageReadReceipt:p})})),a((()=>{zs.unwatch(To.USER,{displayMessageReadReceipt:p})}));const u=n((()=>{if(!c.value)return!1;const{ID:e,type:t,flow:n,status:i,hasRiskContent:o,conversationID:a,conversationType:u,needReadReceipt:l=!1}=s.message;if(o)return!1;const{groupProfile:d}=zs.getConversationModel(a)||{};if((null==d?void 0:d.type)===r.GRP_AVCHATROOM||(null==d?void 0:d.type)===r.GRP_COMMUNITY)return!1;if(t===r.MSG_CUSTOM){const t=zs.getMessageModel(e);if(null!==(null==t?void 0:t.getSignalingInfo()))return!1}return"out"===n&&"success"===i&&("GROUP"===u?l:"C2C"===u)})),l=n((()=>{const{conversationType:e,needReadReceipt:t=!1,isPeerRead:n=!1}=s.message,{readCount:i=0,unreadCount:o=0,isPeerRead:a=!1}=s.message.readReceiptInfo;return"C2C"===e?t?a?0:1:n?0:1:"GROUP"===e?t?0===i?1:0===o?2:4:3:1})),d=n((()=>{const{readCount:e=0}=s.message.readReceiptInfo;switch(l.value){case 0:return Ys.t("TUIChat.已读");case 1:return Ys.t("TUIChat.未读");case 2:return Ys.t("TUIChat.全部已读");case 4:return`${e}${Ys.t("TUIChat.人已读")}`;default:return""}})),h=n((()=>{const{conversationType:e}=s.message;return"C2C"===e?0!==l.value:"GROUP"===e&&2!==l.value}));function p(e){c.value=e}return(t,n)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-label":!0,unread:e.unref(h)})},[e.createElementVNode("span",null,e.toDisplayString(e.unref(d)),1)],2)),[[e.vShow,e.unref(u)]])}}),[["__scopeId","data-v-174fcc3b"]]);var gu=(e=>(e[e.TYPE_NONE=0]="TYPE_NONE",e[e.TYPE_TEXT=1]="TYPE_TEXT",e[e.TYPE_CUSTOM=2]="TYPE_CUSTOM",e[e.TYPE_IMAGE=3]="TYPE_IMAGE",e[e.TYPE_SOUND=4]="TYPE_SOUND",e[e.TYPE_VIDEO=5]="TYPE_VIDEO",e[e.TYPE_FILE=6]="TYPE_FILE",e[e.TYPE_LOCATION=7]="TYPE_LOCATION",e[e.TYPE_FACE=8]="TYPE_FACE",e[e.TYPE_GROUP_TIPS=9]="TYPE_GROUP_TIPS",e[e.TYPE_MERGER=10]="TYPE_MERGER",e))(gu||{});const fu=u(e.defineComponent({__name:"index-uniapp",props:{message:{default:()=>({})}},emits:["scrollTo","blinkMessage"],setup(t,{emit:n}){const{computed:i,ref:o,onMounted:a}=co,s=n,r=t;let u=0;const l=o(""),d=o(!1),h=o({}),p=i((()=>{var e;try{const t=JSON.parse((null==(e=r.message)?void 0:e.cloudCustomData)||"{}"),n=zs.getMessageModel(t.messageReply.messageID);return null==n?void 0:n.isRevoked}catch(t){return!0}}));async function g(){var e;if(p.value)return;const t=null==(e=h.value)?void 0:e.messageID,n=zs.getData(To.CHAT,"messageList").some((e=>e.ID===t));if(t&&n)try{const e=await Yr("#messageScrollList","messageList"),n=await Yr("#tui-"+t,"messageList"),{scrollTop:i}=await $r("#messageScrollList","messageList"),o=n.top+i-e.top-u++%2;n.top<e.top&&s("scrollTo",o),s("blinkMessage",t)}catch(i){c("error","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-quote/index-uniapp.vue:196",i)}else su({message:Ys.t("TUIChat.无法定位到原消息"),type:iu})}return a((()=>{var e;try{const t=JSON.parse((null==(e=r.message)?void 0:e.cloudCustomData)||"{}");d.value=Boolean(t.messageReply),d.value&&(h.value=t.messageReply,l.value=function(e){let t="",n="";switch(e.messageType){case gu.TYPE_TEXT:t="[文本]";break;case gu.TYPE_CUSTOM:t="[自定义消息]";break;case gu.TYPE_IMAGE:t="[图片]";break;case gu.TYPE_SOUND:t="[音频]";break;case gu.TYPE_VIDEO:t="[视频]";break;case gu.TYPE_FILE:t="[文件]";break;case gu.TYPE_LOCATION:t="[地理位置]";break;case gu.TYPE_FACE:t="[动画表情]";break;case gu.TYPE_GROUP_TIPS:t="[群提示]";break;case gu.TYPE_MERGER:t="[聊天记录]";break;default:t="[消息]"}[gu.TYPE_TEXT,gu.TYPE_MERGER].includes(e.messageType)&&(n=e.messageAbstract);return n||Ys.t(`TUIChat.${t}`)}(h.value))}catch(t){d.value=!1}})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{style:{display:"flex",width:"fit-content"}},[e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"mobile-left-box":!0,reverse:"out"===t.message.flow,in:"in"===t.message.flow})},null,2)):e.createCommentVNode("",!0),e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass({"reference-content":!0,reverse:"out"===t.message.flow,in:"in"===t.message.flow,isMobile:!0}),onClick:g},[e.unref(p)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"revoked-text"},e.toDisplayString(e.unref(Ys).t("TUIChat.引用内容已撤回")),1)):(e.openBlock(),e.createElementBlock("div",{key:1},[e.createElementVNode("div",{class:"mobile-quote-sender"},e.toDisplayString(e.unref(h).messageSender),1),e.createElementVNode("div",{class:"max-double-line"},e.toDisplayString(e.unref(Yc)(e.unref(l))),1)]))],2)):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-9a02bc34"]]),mu={data:{},get(e){return this.data[e]},set(e,t){this.data[e]=t}},_u=u(e.defineComponent({__name:"message-bubble-uniapp",props:{messageItem:{default:()=>({})},content:{default:()=>({})},classNameList:{default:()=>[]},blinkMessageIDList:{default:()=>[]},isAudioPlayed:{type:Boolean,default:!1}},emits:["resendMessage","blinkMessage","scrollTo","handleTouchStart","handleTouchEnd","handleToggleMessageItem"],setup(t,{emit:n}){const{computed:i,toRefs:o}=co,a=n,s=t,r=Ks.TYPES,u=[r.MSG_LOCATION,r.MSG_TEXT,r.MSG_CUSTOM,r.MSG_MERGER,r.MSG_FACE],{blinkMessageIDList:l,messageItem:d}=o(s),{showAvatar:h,showNickName:p,robotAvatar:g,staffAvatar:f,userAvatar:m,robotNickName:_,staffNickName:v,userNickName:y}=mu.get("avatarNickName"),I=i((()=>"in"===d.value.flow&&"success"===d.value.status&&d.value.type===r.MSG_AUDIO&&!s.isAudioPlayed)),M=i((()=>{var e;if("TIMCustomElem"===(null==(e=d.value)?void 0:e.type)){const e=JSON.parse(d.value.payload.data).src;if(e===rc.MULTI_BRANCH||e===rc.BRANCH||e===rc.BRANCH_NUMBER)return!0}return!1}));function C(e){try{const t=gc(e);return t.hasOwnProperty("role")&&"robot"===t.role}catch(Ct){return!1}}const E=i((()=>{var e,t,n,i,o;let a="";return a="in"===(null==(e=d.value)?void 0:e.flow)?C(null==(t=d.value)?void 0:t.cloudCustomData)?g||(null==(n=d.value)?void 0:n.avatar)||customerAvatar:f||(null==(i=d.value)?void 0:i.avatar):m||(null==(o=d.value)?void 0:o.avatar)||"",a})),T=i((()=>{var e,t;let n="";return n="in"===(null==(e=d.value)?void 0:e.flow)?C(null==(t=d.value)?void 0:t.cloudCustomData)?_||s.content.showName:v||s.content.showName:y||s.content.showName,n})),k=i((()=>["message-bubble",...s.classNameList])),S=i((()=>{var e;if("TIMCustomElem"==(null==(e=d.value)?void 0:e.type)){const e=JSON.parse(d.value.payload.data).src;if(e===rc.PRODUCT_CARD||e===rc.ORDER)return!0}return!1})),D=i((()=>[r.MSG_IMAGE,r.MSG_VIDEO,r.MSG_MERGER].includes(d.value.type))),b=i((()=>{let e=Ys.t("TUIChat.涉及敏感内容")+", ";return"out"===d.value.flow?e+=Ys.t("TUIChat.发送失败"):e+=Ys.t(d.value.type===r.MSG_AUDIO?"TUIChat.无法收听":"TUIChat.无法查看"),e})),A=i((()=>{var e,t;return!!(null==(e=d.value)?void 0:e.ID)&&(null==(t=null==l?void 0:l.value)?void 0:t.includes(d.value.ID))}));function L(e){a("blinkMessage",e)}function R(e){a("scrollTo",e)}function w(){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-bubble-uniapp.vue:308","handleToggle"),a("handleToggleMessageItem")}function O(){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-bubble-uniapp.vue:312","handleTouchStart"),a("handleTouchStart")}function N(){a("handleTouchEnd")}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(k))},[e.createElementVNode("div",{class:e.normalizeClass({"control-reverse":"out"===e.unref(d).flow})},[e.createElementVNode("div",{class:"message-bubble-content"},[e.createElementVNode("div",{class:e.normalizeClass(["message-bubble-main-content",["in"===e.unref(d).flow?"":"reverse"]]),onLongpress:w,onTouchstart:O,onTouchend:N,onMouseover:N},[e.unref(Xr)&&1===e.unref(h)?(e.openBlock(),e.createBlock(sc,{key:0,useSkeletonAnimation:"",url:e.unref(E),style:{flex:"0 0 auto"}},null,8,["url"])):e.createCommentVNode("",!0),e.createElementVNode("main",{class:"message-body",onClick:n[1]||(n[1]=e.withModifiers((()=>{}),["stop"]))},[e.unref(Xr)&&1===e.unref(p)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-body-nick-name"},e.toDisplayString(e.unref(T)),1)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["message-body-main","out"===e.unref(d).flow&&"message-body-main-reverse"])},[e.createElementVNode("div",{class:e.normalizeClass(["blink","message-body-content","out"===e.unref(d).flow?"content-out":"content-in",e.unref(d).hasRiskContent&&"content-has-risk",e.unref(D)?"content-no-padding":"",e.unref(D)&&e.unref(A)?"blink-shadow":"",!e.unref(D)&&e.unref(A)?"blink-content":"",e.unref(M)?"multi-branch-message":"",e.unref(S)?"product-order-message-bubble":""])},[e.createElementVNode("div",{class:"message-bubble-extra-content"},[e.createVNode(fu,{class:e.normalizeClass("out"===e.unref(d).flow?"reverse":"flex-row"),message:e.unref(d),onBlinkMessage:L,onScrollTo:R},null,8,["class","message"])]),e.createElementVNode("div",{class:"content-main"},[e.unref(d).type!==e.unref(r).MSG_IMAGE&&e.unref(d).type!==e.unref(r).MSG_VIDEO||!e.unref(d).hasRiskContent?e.renderSlot(t.$slots,"default",{key:1},void 0,!0):(e.openBlock(),e.createElementBlock("img",{key:0,class:e.normalizeClass(["message-risk-replace","message-risk-replace-h5"]),src:"https://web.sdk.qcloud.com/component/TUIKit/assets/has_risk_default.png"}))]),e.unref(d).hasRiskContent?(e.openBlock(),e.createElementBlock("div",{key:0,class:"content-has-risk-tips"},e.toDisplayString(e.unref(b)),1)):e.createCommentVNode("",!0)],2),e.unref(I)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"audio-unplay-mark"})):e.createCommentVNode("",!0),"fail"===e.unref(d).status||e.unref(d).hasRiskContent?(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-label fail",onClick:n[0]||(n[0]=e=>{var t;(null==(t=d.value)?void 0:t.hasRiskContent)||a("resendMessage")})}," ! ")):e.createCommentVNode("",!0),"unSend"===e.unref(d).status&&u.includes(e.unref(d).type)?(e.openBlock(),e.createBlock(oc,{key:2,class:"message-label loading-circle",file:e.unref("/assets/loading.2a143778.png"),width:"15px",height:"15px"},null,8,["file"])):e.createCommentVNode("",!0),e.createVNode(pu,{class:"message-label align-self-bottom",message:e.unref(Rc)(e.unref(d))},null,8,["message"])],2)])],34)])],2)],2))}}),[["__scopeId","data-v-aba45eda"]]),vu=u(e.defineComponent({__name:"message-location",props:{content:{type:Object,default:()=>({})}},setup(t){const{watchEffect:n,ref:i}=co,o=t,a=i();return n((()=>{a.value=o.content})),(t,n)=>(e.openBlock(),e.createElementBlock("a",{class:"message-location",href:e.unref(a).href,target:"_blank",title:e.unref(Ys).t("AIDesk.跳转")},[e.createElementVNode("span",{class:"el-icon-location-outline"},e.toDisplayString(e.unref(a).description),1),e.createElementVNode("img",{src:e.unref(a).url},null,8,["src"])],8,["href","title"]))}}),[["__scopeId","data-v-039f7362"]]),yu=u(e.defineComponent({__name:"message-timestamp",props:{currTime:{type:Number,default:0},prevTime:{type:Number,default:0}},setup(t){const{toRefs:n,ref:i,watch:o}=co,a=t,{currTime:s,prevTime:r}=n(a),c=i(!1),u=i("");return o((()=>[s.value,r.value]),((e,t)=>{var n,i;(null==e?void 0:e.toString())!==(null==t?void 0:t.toString())&&(u.value=(n=s.value,i=r.value,c.value=!1,n<=0?"":!i||i<=0||n-i>=600?(c.value=!0,wc(1e3*n)):""))}),{immediate:!0}),(t,n)=>e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-timestamp"},e.toDisplayString(e.unref(u)),1)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-619eb6ac"]]),Iu=u(e.defineComponent({__name:"message-video-uniapp",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},setup(t){const{withDefaults:n,ref:i}=co,o=t,a=i(),s=i(!1);function r(){s.value=!0,a.value=o.content.url}function c(){s.value=!1}return(t,n)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:"message-video"},[e.createElementVNode("div",{class:"message-video-box",onClick:r},[e.createElementVNode("image",{src:o.content.snapshotUrl,class:"message-video-box",mode:"widthFix"},null,8,["src"]),"success"===o.messageItem.status||1===o.messageItem.progress?(e.openBlock(),e.createBlock(oc,{key:0,class:"video-play",file:e.unref(Jr)},null,8,["file"])):e.createCommentVNode("",!0)])]),e.unref(s)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"video-overlay"},[e.createElementVNode("view",{class:"overlay-background",onClick:c}),e.createElementVNode("video",{class:"video-container",src:e.unref(a),controls:""},null,8,["src"])])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-3f725dff"]]);function Mu(e){const t=zs.getData(To.APP,"tasks");e in t&&!t[e]&&(t[e]=!0,zs.update(To.APP,"tasks",t))}const Cu=u(e.defineComponent({__name:"index-uniapp",props:{messageItem:{default:()=>({})}},setup(t,{expose:n}){const{ref:i,watchEffect:o,computed:a}=co,s=t,r=Ks.TYPES,c=i([{key:"copy",text:Ys.t("TUIChat.复制"),iconUrl:"/assets/msg-copy.91b797d7.svg",renderCondition:()=>!!u.value&&u.value.type===r.MSG_TEXT,clickEvent:async function(){var e,t;null==Or||Or.setClipboardData({data:Yc(null==(t=null==(e=u.value)?void 0:e.payload)?void 0:t.text)})}},{key:"revoke",text:Ys.t("TUIChat.撤回"),iconUrl:"/assets/msg-revoke.a0b46d31.svg",renderCondition:()=>!!u.value&&("out"===u.value.flow&&"success"===u.value.status),clickEvent:function(){if(!u.value)return;zs.getMessageModel(u.value.ID).revokeMessage().then((()=>{Mu("revokeMessage")})).catch((e=>{if(20016===e.code){const e=Ys.t("TUIChat.已过撤回时限");su({message:e,type:ou})}}))}}]),u=i(),l=i();o((()=>{u.value=zs.getMessageModel(s.messageItem.ID)}));const d=a((()=>{for(let e=0;e<c.value.length;++e)if(c.value[e].renderCondition())return!1;return!0}));return n({messageToolDom:l}),(t,n)=>e.unref(d)||t.messageItem.hasRiskContent?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"messageToolDom",ref:l,class:e.normalizeClass(["dialog-item","dialog-item-h5"])},[e.createElementVNode("div",{class:e.normalizeClass(["dialog-item-list","dialog-item-list-h5"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[t.renderCondition()?(e.openBlock(),e.createElementBlock("div",{key:t.key,class:"list-item",onClick:e=>function(e){c.value[e].clickEvent()}(n),onMousedown:e=>{t.key}},[e.createVNode(oc,{file:t.iconUrl,size:"15px"},null,8,["file"]),e.createElementVNode("span",{class:"list-item-text"},e.toDisplayString(t.text),1)],40,["onClick","onMousedown"])):e.createCommentVNode("",!0)],64)))),256))])],512))}}),[["__scopeId","data-v-94d2e380"]]),Eu=u(e.defineComponent({__name:"message-revoked",props:{isEdit:{type:Boolean,default:()=>!1},messageItem:{type:Object,default:()=>({})}},emits:["messageEdit"],setup(t,{emit:n}){const{watchEffect:i,ref:o}=co,a=t,s=o(),r=o(!1),c=n;i((()=>{s.value=a.messageItem,r.value=a.isEdit}));const u=()=>{c("messageEdit")};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"revoke"},["in"===e.unref(s).flow?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(e.unref(s).nick||e.unref(s).from),1)):e.unref(s).from===e.unref(s).revoker?(e.openBlock(),e.createElementBlock("span",{key:1},e.toDisplayString(e.unref(Ys).t("TUIChat.您")),1)):(e.openBlock(),e.createElementBlock("span",{key:2},e.toDisplayString(e.unref(s).revoker),1)),e.createElementVNode("span",null,e.toDisplayString(e.unref(Ys).t("TUIChat.撤回了一条消息")),1),"out"===e.unref(s).flow&&e.unref(r)?(e.openBlock(),e.createElementBlock("span",{key:3,class:"edit",onClick:u},e.toDisplayString(e.unref(Ys).t("TUIChat.重新编辑")),1)):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-2bea502e"]]),Tu="1.4.0";const ku=(i=class{constructor(){__publicField(this,"isLoggedIn"),__publicField(this,"customerServiceAccounts"),__publicField(this,"loggedInUserID"),__publicField(this,"myProfile"),Sr.registerService(cr.SERVICE.NAME,this),Sr.registerExtension(or.EXTENSION.CONTACT_LIST.EXT_ID,this),this.customerServiceAccounts=["@customer_service_account"],this.isLoggedIn=!1,this.loggedInUserID="",this.myProfile={}}static getInstance(){return i.instance||(i.instance=new i),i.instance}loginCustomerUIKit(e,t,n){vc(e,t),Ks.login({SDKAppID:e,userID:t,userSig:n,useUploadPlugin:!0}).then((()=>{bc.i(`login success. userID:${t}`),this.isLoggedIn=!0,this.loggedInUserID=t,$s.switchConversation("C2C@customer_service_account"),1!==mu.get("showReadStatus")?Ws.switchMessageReadStatus(!1):Ws.switchMessageReadStatus(!0),Ks.chat.callExperimentalAPI("isFeatureEnabledForStat",Math.pow(2,42))})).catch((e=>{su({message:Ys.t("TUIChat.登录失败"),type:ou,duration:3e4}),bc.l(e)}))}init(e,t,n){if(bc.l(`TUICustomerServer.init vue:3 version:${Tu} SDKAppID:${e} userID:${t} isLoggedIn:${this.isLoggedIn} loggedInUserID:${this.loggedInUserID}`),this.isLoggedIn){if(this.loggedInUserID===t)return;this.unInit().finally((()=>{this.isLoggedIn=!1,this.loginCustomerUIKit(e,t,n)}))}else this.loginCustomerUIKit(e,t,n)}initWithProfile(e){const{SDKAppID:t,userID:n,userSig:i,nickName:o,avatar:a}=e;bc.l(`TUICustomerServer.initWithProfile version:${Tu}`),o&&(this.myProfile.nick=o),a&&(this.myProfile.avatar=a),this.init(t,n,i)}unInit(){return Ks.logout()}sendTextMessage(e,t){return Js.sendTextMessage(e,t)}sendCustomMessage(e,t){return Js.sendCustomMessage(e,t)}changeLanguage(e){return Ys.changeLanguage(e).then((()=>{bc.i(`language changed to ${e}`)}))}getLoggedInUserID(){return this.loggedInUserID}isCustomerConversation(e){const t=e&&e.slice(3)||"";return this.customerServiceAccounts.indexOf(t)>-1}isCustomerServicePluginMessage(e){return!(!e||!this.isCustomerConversation(e.conversationID))&&(!fc(e)&&(function(e){var t;const n=gc(null==(t=null==e?void 0:e.payload)?void 0:t.data);return 0===Number(null==n?void 0:n.customerServicePlugin)||1===Number(null==n?void 0:n.chatbotPlugin)}(e)||mc(e)))}onGetExtension(e){if(e===or.EXTENSION.CONTACT_LIST.EXT_ID)return[{weight:0,icon:"",text:"智能客服",data:{name:"customer",accountList:this.customerServiceAccounts}}]}onCall(e,t){bc.l(`TUICustomerServer.onCall method:${e} params:`,t),e===cr.SERVICE.METHOD.ACTIVE_CONVERSATION&&this.isCustomerConversation(t.conversationID)&&(Object.keys(this.myProfile).length>0?(bc.l(`TUICustomerServer.onCall updateMyProfile:${JSON.stringify(this.myProfile)}`),Ws.updateMyProfile({...this.myProfile}).finally((()=>{this.activeServiceFlow(t)}))):this.activeServiceFlow(t))}activeServiceFlow(e){Js.sendCustomMessage({to:e.conversationID.slice(3),conversationType:Ks.TYPES.CONV_C2C,payload:{data:JSON.stringify({src:"7",customerServicePlugin:0,triggeredContent:void 0===e.robotLang?void 0:{language:e.robotLang}})}},{onlineUserOnly:!0})}},__publicField(i,"instance"),i).getInstance(),Su=ku.isCustomerServicePluginMessage.bind(ku),Du=ku.isCustomerConversation.bind(ku),bu=e.defineComponent({__name:"message-plugin-layout-uniapp",props:{message:{default:()=>({})},showStyle:{default:""},bubbleClassNameList:{default:()=>[]},blinkMessageIDList:{default:()=>[]}},emits:["resendMessage","handleToggleMessageItem","handleH5LongPress"],setup(t,{emit:n}){const{computed:i}=co,o=t,a=n,s=i((()=>{var e;return zs.getMessageModel(null==(e=o.message)?void 0:e.ID)})),r=(e,t,n=!1)=>{a("handleToggleMessageItem",e,t,n)},c=(e,t,n)=>{a("handleH5LongPress",e,t,n)};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"message-plugin"},["tip"===o.showStyle?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-plugin-tip"},[e.renderSlot(t.$slots,"messageTip",{},void 0,!0)])):"bubble"===o.showStyle?(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-plugin-bubble-content",onLongpress:n[1]||(n[1]=t=>r(t,e.unref(s),!0)),onContextmenu:n[2]||(n[2]=e.withModifiers((t=>r(t,e.unref(s))),["prevent","right"])),onTouchstart:n[3]||(n[3]=t=>c(t,e.unref(s),"touchstart")),onTouchend:n[4]||(n[4]=t=>c(t,e.unref(s),"touchend")),onMouseover:n[5]||(n[5]=t=>c(t,e.unref(s),"touchend"))},[e.createVNode(_u,{messageItem:e.unref(s),content:e.unref(s).getMessageContent(),blinkMessageIDList:o.blinkMessageIDList,classNameList:o.bubbleClassNameList,onResendMessage:n[0]||(n[0]=t=>{return n=e.unref(s),void a("resendMessage",n);var n})},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"messageBubble",{},void 0,!0)])),_:3},8,["messageItem","content","blinkMessageIDList","classNameList"])],32)):e.createCommentVNode("",!0)]))}}),Au=u(bu,[["__scopeId","data-v-006cf00c"]]);const Lu=u({props:{src:{type:String,default:""},width:{type:String,default:"16px"},height:{type:String,default:"16px"}},setup:e=>({props:e,isApp:ec})},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"common-icon-container"},[o.isApp?(e.openBlock(),e.createElementBlock("image",{key:0,class:"common-icon",src:o.props.src,style:e.normalizeStyle({width:o.props.width,height:o.props.height})},null,12,["src"])):(e.openBlock(),e.createElementBlock("img",{key:1,class:"common-icon",src:o.props.src,style:e.normalizeStyle({width:o.props.width,height:o.props.height})},null,12,["src"]))])}],["__scopeId","data-v-5b74c745"]]),{computed:Ru,ref:wu,watchEffect:Ou}=co;const Nu=u({components:{Icon:Lu},props:{ratingTemplate:{type:Object,default:()=>({})}},emits:["sendMessage"],setup(e,{emit:t}){const n=wu(!1),i=wu(""),o=wu(-1),a=wu(-1),s=wu(!1);Ou((()=>{if(i.value=e.ratingTemplate.sessionId||"",null!=e.ratingTemplate.selected)for(let t=0;t<e.ratingTemplate.menu.length;t++)if(e.ratingTemplate.menu[t].id==e.ratingTemplate.selected.id){n.value=!0,o.value=t;break}Math.floor((new Date).getTime()/1e3)>e.ratingTemplate.expireTime&&(s.value=!0)}));const r=Ru((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map((e=>e.content))})),c=Ru((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map(((e,t)=>-1!==a.value?t<=a.value?1:0:t<=o.value?1:0))}));return{props:e,hasReply:n,sessionId:i,value:o,hoverValue:a,hasExpire:s,desc:r,starList:c,setValue:e=>{n.value||(o.value=e)},setHoverValue:e=>{n.value||(a.value=e)},submitRatingStar:async()=>{if(o.value<0)return;const a={data:JSON.stringify({src:rc.MENU_SELECTED,menuSelected:{id:e.ratingTemplate.menu[o.value].id,content:e.ratingTemplate.menu[o.value].content,sessionId:i.value},customerServicePlugin:0})};n.value=!0,t("sendMessage",a)},star:"/assets/star.0d13712b.png",starLine:"/assets/starLine.f4211758.png",TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{class:"message-rating-star"},[e.createElementVNode("p",{class:"rating-head"},e.toDisplayString(o.props.ratingTemplate.head),1),e.createElementVNode("div",{class:"rating-card"},[e.createElementVNode("span",{class:"card-title"},e.toDisplayString(o.TUITranslateService.t("AIDesk.请对本次服务进行评价")),1),e.createElementVNode("div",{class:"card-wrapper"},[e.createElementVNode("div",{style:{"max-width":"200px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.starList,((t,i)=>(e.openBlock(),e.createElementBlock("div",{key:i,style:{display:"inline-block"},onClick:e=>o.setValue(i),onMouseenter:e=>o.setHoverValue(i),onMouseleave:n[0]||(n[0]=e=>o.setHoverValue(-1))},[1===t?(e.openBlock(),e.createBlock(r,{key:0,src:o.star,width:"25px",height:"25px"},null,8,["src"])):(e.openBlock(),e.createBlock(r,{key:1,src:o.starLine,width:"25px",height:"25px"},null,8,["src"]))],40,["onClick","onMouseenter"])))),128))])]),e.createElementVNode("div",{style:{marginTop:"10px",marginBottom:"10px",wordBreak:"normal"}},e.toDisplayString(-1===o.hoverValue?-1===o.value?o.TUITranslateService.t("AIDesk.如果满意请给好评哦～"):o.desc[o.value]:o.desc[o.hoverValue]),1),e.createElementVNode("button",{class:"submit-button",disabled:o.hasReply||o.hasExpire,onClick:n[1]||(n[1]=(...e)=>o.submitRatingStar&&o.submitRatingStar(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.提交评价")),9,["disabled"])]),o.hasReply?(e.openBlock(),e.createElementBlock("p",{key:0,class:"rating-tail",style:{marginTop:"20px"}},e.toDisplayString(o.props.ratingTemplate.tail),1)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-77705a46"]]),{computed:Pu,ref:Uu,watchEffect:Gu}=co;const xu=u({props:{ratingTemplate:{type:Object,default:()=>({})}},emits:["sendMessage"],setup(e,{emit:t}){const n=Uu(!1),i=Uu(""),o=Uu(-1),a=Uu(-1),s=Uu(!1),r=Pu((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map((e=>e.content))})),c=Pu((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map(((e,t)=>t))}));Gu((()=>{if(i.value=e.ratingTemplate.sessionId||"",null!=e.ratingTemplate.selected)for(let t=0;t<e.ratingTemplate.menu.length;t++)if(e.ratingTemplate.menu[t].id==e.ratingTemplate.selected.id){n.value=!0,o.value=t;break}Math.floor((new Date).getTime()/1e3)>e.ratingTemplate.expireTime&&(s.value=!0)}));return{props:e,hasReply:n,sessionId:i,selectValue:o,hoverValue:a,hasExpire:s,desc:r,numberList:c,setValue:e=>{n.value||(o.value=e)},setHoverValue:e=>{n.value||(a.value=e)},submitRatingStar:()=>{if(o.value>=0){const a={data:JSON.stringify({src:rc.MENU_SELECTED,menuSelected:{id:e.ratingTemplate.menu[o.value].id,content:e.ratingTemplate.menu[o.value].content,sessionId:i.value},customerServicePlugin:0})};n.value=!0,t("sendMessage",a)}},TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"message-rating-star"},[e.createElementVNode("p",{class:"rating-head"},e.toDisplayString(o.props.ratingTemplate.head),1),e.createElementVNode("div",{class:"rating-card"},[e.createElementVNode("span",{class:"card-title"},e.toDisplayString(o.TUITranslateService.t("AIDesk.请对本次服务进行评价")),1),e.createElementVNode("div",{class:"card-wrapper"},[e.createElementVNode("div",{style:{"max-width":"250px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.numberList,((t,i)=>(e.openBlock(),e.createElementBlock("div",{key:i,class:e.normalizeClass({active:!(i!==o.selectValue&&i!==o.hoverValue),"de-active":i!==o.selectValue&&i!==o.hoverValue}),style:e.normalizeStyle({marginLeft:0===i?"0px":"20px",margin:"5px"}),onClick:e=>o.setValue(i),onMouseenter:e=>o.setHoverValue(i),onMouseleave:n[0]||(n[0]=e=>o.setHoverValue(-1))},e.toDisplayString(t+1),47,["onClick","onMouseenter"])))),128))])]),e.createElementVNode("div",{style:{marginTop:"10px",marginBottom:"10px",wordBreak:"normal"}},e.toDisplayString(-1===o.hoverValue?-1===o.selectValue?o.TUITranslateService.t("AIDesk.如果满意请给好评哦～"):o.desc[o.selectValue]:o.desc[o.hoverValue]),1),e.createElementVNode("button",{class:"submit-button",disabled:o.hasReply||o.hasExpire,onClick:n[1]||(n[1]=(...e)=>o.submitRatingStar&&o.submitRatingStar(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.提交评价")),9,["disabled"])]),o.hasReply?(e.openBlock(),e.createElementBlock("p",{key:0,class:"rating-tail",style:{marginTop:"20px"}},e.toDisplayString(o.props.ratingTemplate.tail),1)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-567c6765"]]),{computed:Fu}=co;const Bu=u({components:{RatingStar:Nu,RatingNumber:xu},props:{message:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:(e,{emit:t})=>({sendCustomMessage:e=>{t("sendMessage",e)},ratingTemplate:Fu((()=>{const t=e.message&&gc(e.message.payload.data);return null==t?void 0:t.menuContent})),RATING_TEMPLATE_TYPE:cc})},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("RatingStar"),c=e.resolveComponent("RatingNumber");return o.ratingTemplate.type===o.RATING_TEMPLATE_TYPE.STAR?(e.openBlock(),e.createBlock(r,{key:0,ratingTemplate:o.ratingTemplate,onSendMessage:o.sendCustomMessage},null,8,["ratingTemplate","onSendMessage"])):(e.openBlock(),e.createBlock(c,{key:1,ratingTemplate:o.ratingTemplate,onSendMessage:o.sendCustomMessage},null,8,["ratingTemplate","onSendMessage"]))}]]),Vu="/assets/iconRight.eac74a1a.svg",ju="/assets/icon_question.3adf663c.png",{computed:qu,ref:Hu}=co;const Ku=u({components:{Icon:Lu},props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage","heightChanged"],setup(e,{emit:t}){const n=Hu(!1);return{content:qu((()=>{var t;return(null==(t=null==e?void 0:e.payload)?void 0:t.content)||{header:void 0,items:[]}})),handleContentListItemClick:e=>{e.content&&(n.value||(n.value=!0,t("sendMessage",{text:e.content})))},iconRight:Vu,iconQuestion:ju,isSelected:n,isPC:Xr,TUITranslateService:Ys}},mounted(){this.$emit("heightChanged")}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{class:"branch-card"},[o.content.header||o.content.title?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["branch-body",o.isPC?"branch-bubble":"branch-bubble-h5"])},[e.createVNode(r,{src:o.iconQuestion,class:"branch-title-icon"},null,8,["src"]),e.createTextVNode(" "+e.toDisplayString(o.content.header||o.content.title),1)],2)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.content.items,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["branch-body",o.isPC?"branch-bubble":"branch-bubble-h5","branch-item",o.isSelected?"branch-item-selected":"",t.content?"":"warning-item"]),style:e.normalizeStyle({borderWidth:o.content.header?"1px 0 0px 0":""}),onClick:e=>o.handleContentListItemClick(t)},e.toDisplayString(t.content||o.TUITranslateService.t("AIDesk.分支选项异常")),15,["onClick"])))),128))])}],["__scopeId","data-v-35283a9e"]]);const zu=u({props:{title:{type:String,default:""},list:{type:Array,default:()=>[]}},emits:["input-click"],setup:(e,{emit:t})=>({props:e,listItemClick:e=>{t("input-click",e)}})},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"form-branch-container"},[o.props.title?(e.openBlock(),e.createElementBlock("p",{key:0,class:"card-title"},e.toDisplayString(o.props.title),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.props.list,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:"form-branch-item",onClick:e=>o.listItemClick(t)},e.toDisplayString(t.content),9,["onClick"])))),128))])}],["__scopeId","data-v-13ef4800"]]),Yu="/assets/icon_form.3e84e438.png",{computed:$u,ref:Wu}=co;const Ju=u({components:{Icon:Lu},props:{title:{type:String,default:""}},emits:["input-submit"],setup(e,{emit:t}){const n=Wu(!1),i=Wu(""),o=Wu(!1),a=Wu(!1);return{disabled:n,text:i,listItemClick:()=>{n.value=!0,o.value=!1,a.value=!0},props:e,iconForm:Yu,isShowForm:o,showForm:()=>{o.value=!0},iconSucess:"/assets/icon_success.ff1614ac.png",isFinish:a,TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Icon");return o.isShowForm||o.isFinish?o.isShowForm&&!o.isFinish?(e.openBlock(),e.createElementBlock("div",{key:1,class:"form-input-container"},[e.createElementVNode("div",{class:"card-title"}," title "),e.createElementVNode("div",{class:"form-input-box"},[e.createElementVNode("div",{class:"form-input-line"},[e.createElementVNode("div",{class:"form-label"},[(e.openBlock(),e.createElementBlock("span",{key:0,class:"required-icon"},e.toDisplayString("*"))),e.createElementVNode("label",null,"label")]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>o.text=e),class:"form-input",placeholder:"TUITranslateService.t('AIDesk.请输入内容')"},null,512),[[e.vModelText,o.text]])])])])):o.isFinish?(e.openBlock(),e.createElementBlock("div",{key:2,class:"form-finish-container"},[e.createElementVNode("div",{class:"card-title"},[e.createElementVNode("div",null,e.toDisplayString(o.props.title),1),e.createElementVNode("div",{class:"form-finish-title-right"},[e.createVNode(r,{src:o.iconSucess,style:{margin:"0px 4px"}},null,8,["src"]),e.createTextVNode(" "+e.toDisplayString(o.TUITranslateService.t("AIDesk.已提交")),1)])]),e.createElementVNode("div",null,e.toDisplayString(o.text),1)])):e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"form-container"},[e.createVNode(r,{src:o.iconForm,width:"65px",height:"65px"},null,8,["src"]),e.createElementVNode("div",{class:"right-container"},[e.createElementVNode("div",{class:"card-title"},e.toDisplayString(o.props.title),1),e.createElementVNode("div",{class:"form-button",onClick:n[0]||(n[0]=(...e)=>o.showForm&&o.showForm(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.立即填写")),1)])]))}],["__scopeId","data-v-879a143b"]]),{computed:Xu}=co;const Zu=u({components:{FormBranch:zu,FormInput:Ju},props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:(e,{emit:t})=>({content:Xu((()=>{var t;return(null==(t=e.payload)?void 0:t.content)||{type:0,header:"",items:[]}})),handleContentListItemClick:e=>{t("sendMessage",{text:e.content})},handleFormSaveInputSubmit:e=>{t("sendMessage",{text:e})}})},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("FormBranch"),c=e.resolveComponent("FormInput");return 1===o.content.type?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-form"},[e.createElementVNode("div",{class:"message-form"},[e.createVNode(r,{title:o.content.header,list:o.content.items,onInputClick:o.handleContentListItemClick},null,8,["title","list","onInputClick"])])])):(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-form"},[e.createVNode(c,{title:o.content.header,onInputSubmit:o.handleFormSaveInputSubmit},null,8,["title","onInputSubmit"])]))}],["__scopeId","data-v-685304f4"]]),{reactive:Qu,toRefs:el}=co;const tl=u({components:{Icon:Lu},props:{payload:{type:Object,default:()=>({content:{title:"",items:[]}})}},emits:["sendMessage"],setup(e,{emit:t}){var n,i,o,a,s,r;const c=Qu({title:(null==(i=null==(n=e.payload)?void 0:n.content)?void 0:i.title)||"",list:(null==(a=null==(o=e.payload)?void 0:o.content)?void 0:a.items)||[],showList:((null==(r=null==(s=e.payload)?void 0:s.content)?void 0:r.items)||[]).slice(0,3),pageNumber:1});return{...el(c),handleContentListItemClick:e=>{t("sendMessage",{text:e.content})},imRobotGuess:"/assets/imRobotGuess.5fc0b4ca.svg",refresh:"/assets/refresh.8efc59f5.svg",iconRight:Vu,changeBranchList:()=>{var e,t;3*c.pageNumber>=(null==(e=c.list)?void 0:e.length)&&(c.pageNumber=0),c.showList=null==(t=c.list)?void 0:t.slice(3*c.pageNumber,3*c.pageNumber+3),c.pageNumber+=1},iconQuestion:ju,iconRefresh:"/assets/icon_refresh.d269e542.png"}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{class:"welcome-card"},[e.createElementVNode("div",{class:"welcome-title"},[e.createElementVNode("div",{class:"welcome-title-left-container"},[e.createVNode(r,{src:o.iconQuestion},null,8,["src"]),t.title?(e.openBlock(),e.createElementBlock("p",{key:0,class:"card-title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:"change-wrapper",onClick:n[0]||(n[0]=e=>o.changeBranchList())},[e.createVNode(r,{src:o.iconRefresh},null,8,["src"])])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.showList,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:"welcome-item",onClick:e=>o.handleContentListItemClick(t)},[e.createElementVNode("div",null,e.toDisplayString(t.content),1)],8,["onClick"])))),128))])}],["__scopeId","data-v-63dfbb5c"]]);const nl=u({props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:e=>({props:e,isApp:ec,jumpProductCard:()=>{const{url:t}=e.payload.content;t.startsWith("https://")||t.startsWith("http://")?plus.runtime.openURL(t):uni.navigateTo({url:t})},TUITranslateService:Ys})},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"message-product-card"},[o.isApp?(e.openBlock(),e.createElementBlock("image",{key:0,class:"product-img",src:o.props.payload.content.pic},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:1,class:"product-img",src:o.props.payload.content.pic},null,8,["src"])),e.createElementVNode("div",{class:"product-card-information"},[e.createElementVNode("div",{class:"product-card-title"},e.toDisplayString(o.props.payload.content.header),1),e.createElementVNode("div",{class:"product-card-description-block"},[e.createElementVNode("div",{class:"product-card-description"},e.toDisplayString(o.props.payload.content.desc),1),e.createElementVNode("div",{class:"product-card-link",onClick:n[0]||(n[0]=(...e)=>o.jumpProductCard&&o.jumpProductCard(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.跳转")),1)])])])}],["__scopeId","data-v-56436816"]]);function il(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let ol={baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};const al=/[&<>"']/,sl=/[&<>"']/g,rl=/[<>"']|&(?!#?\w+;)/,cl=/[<>"']|&(?!#?\w+;)/g,ul={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ll=e=>ul[e];function dl(e,t){if(t){if(al.test(e))return e.replace(sl,ll)}else if(rl.test(e))return e.replace(cl,ll);return e}const hl=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function pl(e){return e.replace(hl,((e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const gl=/(^|[^\[])\^/g;function fl(e,t){e=e.source||e,t=t||"";const n={replace:(t,i)=>(i=(i=i.source||i).replace(gl,"$1"),e=e.replace(t,i),n),getRegex:()=>new RegExp(e,t)};return n}const ml=/[^\w:]/g,_l=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function vl(e,t,n){if(e){let e;try{e=decodeURIComponent(pl(n)).replace(ml,"").toLowerCase()}catch(Ct){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!_l.test(n)&&(n=function(e,t){yl[" "+e]||(Il.test(e)?yl[" "+e]=e+"/":yl[" "+e]=Sl(e,"/",!0));e=yl[" "+e];const n=-1===e.indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(Ml,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(Cl,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(Ct){return null}return n}const yl={},Il=/^[^:]+:\/*[^/]*$/,Ml=/^([^:]+:)[\s\S]*$/,Cl=/^([^:]+:\/*[^/]*)[\s\S]*$/;const El={exec:function(){}};function Tl(e){let t,n,i=1;for(;i<arguments.length;i++)for(n in t=arguments[i],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function kl(e,t){const n=e.replace(/\|/g,((e,t,n)=>{let i=!1,o=t;for(;--o>=0&&"\\"===n[o];)i=!i;return i?"|":" |"})).split(/ \|/);let i=0;if(n[0].trim()||n.shift(),n[n.length-1].trim()||n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function Sl(e,t,n){const i=e.length;if(0===i)return"";let o=0;for(;o<i;){const a=e.charAt(i-o-1);if(a!==t||n){if(a===t||!n)break;o++}else o++}return e.substr(0,i-o)}function Dl(e){e&&e.sanitize&&!e.silent&&c("warn","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/lib-marked.js:261","marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function bl(e,t){if(t<1)return"";let n="";for(;t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}function Al(e,t,n,i){const o=t.href,a=t.title?dl(t.title):null,s=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){i.state.inLink=!0;const e={type:"link",raw:n,href:o,title:a,text:s,tokens:i.inlineTokens(s,[])};return i.state.inLink=!1,e}return{type:"image",raw:n,href:o,title:a,text:dl(s)}}class Ll{constructor(e){this.options=e||ol}space(e){const t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:Sl(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t){const n=e.match(/^(\s+)(?:```)/);if(null===n)return t;const i=n[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[n]=t;return n.length>=i.length?e.slice(i.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim():t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=Sl(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}const n={type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(e,[]),text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,i,o,a,s,r,c,u,l,d,h=t[1].trim();const p=h.length>1,g={type:"list",raw:"",ordered:p,start:p?+h.slice(0,-1):"",loose:!1,items:[]};h=p?`\\d{1,9}\\${h.slice(-1)}`:`\\${h}`,this.options.pedantic&&(h=p?h:"[*+-]");const f=new RegExp(`^( {0,3}${h})((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);for(;e&&!this.rules.block.hr.test(e)&&(t=f.exec(e));){l=t[2].split("\n"),this.options.pedantic?(a=2,d=l[0].trimLeft()):(a=t[2].search(/[^ ]/),a=t[1].length+(a>4?1:a),d=l[0].slice(a-t[1].length)),r=!1,n=t[0],!l[0]&&/^ *$/.test(l[1])&&(n=t[1]+l.slice(0,2).join("\n")+"\n",g.loose=!0,l=[]);const h=new RegExp(`^ {0,${Math.min(3,a-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(s=1;s<l.length;s++){if(u=l[s],this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),h.test(u)){n=t[1]+l.slice(0,s).join("\n")+"\n";break}if(r){if(!(u.search(/[^ ]/)>=a)&&u.trim()){n=t[1]+l.slice(0,s).join("\n")+"\n";break}d+="\n"+u.slice(a)}else u.trim()||(r=!0),u.search(/[^ ]/)>=a?d+="\n"+u.slice(a):d+="\n"+u}g.loose||(c?g.loose=!0:/\n *\n *$/.test(n)&&(c=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(d),i&&(o="[ ] "!==i[0],d=d.replace(/^\[[ xX]\] +/,""))),g.items.push({type:"list_item",raw:n,task:!!i,checked:o,loose:!1,text:d}),g.raw+=n,e=e.slice(n.length)}g.items[g.items.length-1].raw=n.trimRight(),g.items[g.items.length-1].text=d.trimRight(),g.raw=g.raw.trimRight();const m=g.items.length;for(s=0;s<m;s++)this.lexer.state.top=!1,g.items[s].tokens=this.lexer.blockTokens(g.items[s].text,[]),g.items[s].tokens.some((e=>"space"===e.type))&&(g.loose=!0,g.items[s].loose=!0);return g}}html(e){const t=this.rules.block.html.exec(e);if(t){const e={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};return this.options.sanitize&&(e.type="paragraph",e.text=this.options.sanitizer?this.options.sanitizer(t[0]):dl(t[0]),e.tokens=[],this.lexer.inline(e.text,e.tokens)),e}}def(e){const t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));return{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}}table(e){const t=this.rules.block.table.exec(e);if(t){const e={type:"table",header:kl(t[1]).map((e=>({text:e}))),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let n,i,o,a,s=e.align.length;for(n=0;n<s;n++)/^ *-+: *$/.test(e.align[n])?e.align[n]="right":/^ *:-+: *$/.test(e.align[n])?e.align[n]="center":/^ *:-+ *$/.test(e.align[n])?e.align[n]="left":e.align[n]=null;for(s=e.rows.length,n=0;n<s;n++)e.rows[n]=kl(e.rows[n],e.header.length).map((e=>({text:e})));for(s=e.header.length,i=0;i<s;i++)e.header[i].tokens=[],this.lexer.inlineTokens(e.header[i].text,e.header[i].tokens);for(s=e.rows.length,i=0;i<s;i++)for(a=e.rows[i],o=0;o<a.length;o++)a[o].tokens=[],this.lexer.inlineTokens(a[o].text,a[o].tokens);return e}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const e={type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e={type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}text(e){const t=this.rules.block.text.exec(e);if(t){const e={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:dl(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):dl(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=Sl(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;const n=e.length;let i=0,o=0;for(;o<n;o++)if("\\"===e[o])o++;else if(e[o]===t[0])i++;else if(e[o]===t[1]&&(i--,i<0))return o;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],i="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],i=e[3])}else i=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),Al(t,{href:n?n.replace(this.rules.inline._escapes,"$1"):n,title:i?i.replace(this.rules.inline._escapes,"$1"):i},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=(n[2]||n[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e||!e.href){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return Al(n,e,n[0],this.lexer)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i)return;if(i[3]&&n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))return;const o=i[1]||i[2]||"";if(!o||o&&(""===n||this.rules.inline.punctuation.exec(n))){const n=i[0].length-1;let o,a,s=n,r=0;const c="*"===i[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+n);null!=(i=c.exec(t));){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(a=o.length,i[3]||i[4]){s+=a;continue}if((i[5]||i[6])&&n%3&&!((n+a)%3)){r+=a;continue}if(s-=a,s>0)continue;if(a=Math.min(a,a+s+r),Math.min(n,a)%2){const t=e.slice(1,n+i.index+a);return{type:"em",raw:e.slice(0,n+i.index+a+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}const t=e.slice(2,n+i.index+a-1);return{type:"strong",raw:e.slice(0,n+i.index+a+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const n=/[^ ]/.test(e),i=/^ /.test(e)&&/ $/.test(e);return n&&i&&(e=e.substring(1,e.length-1)),e=dl(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let e,i;return"@"===n[2]?(e=dl(this.options.mangle?t(n[1]):n[1]),i="mailto:"+e):(e=dl(n[1]),i=e),{type:"link",raw:n[0],text:e,href:i,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let e,i;if("@"===n[2])e=dl(this.options.mangle?t(n[0]):n[0]),i="mailto:"+e;else{let t;do{t=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(t!==n[0]);e=dl(n[0]),i="www."===n[1]?"http://"+e:e}return{type:"link",raw:n[0],text:e,href:i,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let e;return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):dl(n[0]):n[0]:dl(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:e}}}}const Rl={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:El,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Rl.def=fl(Rl.def).replace("label",Rl._label).replace("title",Rl._title).getRegex(),Rl.bullet=/(?:[*+-]|\d{1,9}[.)])/,Rl.listItemStart=fl(/^( *)(bull) */).replace("bull",Rl.bullet).getRegex(),Rl.list=fl(Rl.list).replace(/bull/g,Rl.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Rl.def.source+")").getRegex(),Rl._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Rl._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Rl.html=fl(Rl.html,"i").replace("comment",Rl._comment).replace("tag",Rl._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Rl.paragraph=fl(Rl._paragraph).replace("hr",Rl.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rl._tag).getRegex(),Rl.blockquote=fl(Rl.blockquote).replace("paragraph",Rl.paragraph).getRegex(),Rl.normal=Tl({},Rl),Rl.gfm=Tl({},Rl.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Rl.gfm.table=fl(Rl.gfm.table).replace("hr",Rl.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rl._tag).getRegex(),Rl.pedantic=Tl({},Rl.normal,{html:fl("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Rl._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:El,paragraph:fl(Rl.normal._paragraph).replace("hr",Rl.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Rl.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const wl={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:El,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:El,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function Ol(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Nl(e){let t,n,i="";const o=e.length;for(t=0;t<o;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),i+="&#"+n+";";return i}wl._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",wl.punctuation=fl(wl.punctuation).replace(/punctuation/g,wl._punctuation).getRegex(),wl.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,wl.escapedEmSt=/\\\*|\\_/g,wl._comment=fl(Rl._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),wl.emStrong.lDelim=fl(wl.emStrong.lDelim).replace(/punct/g,wl._punctuation).getRegex(),wl.emStrong.rDelimAst=fl(wl.emStrong.rDelimAst,"g").replace(/punct/g,wl._punctuation).getRegex(),wl.emStrong.rDelimUnd=fl(wl.emStrong.rDelimUnd,"g").replace(/punct/g,wl._punctuation).getRegex(),wl._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,wl._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,wl._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,wl.autolink=fl(wl.autolink).replace("scheme",wl._scheme).replace("email",wl._email).getRegex(),wl._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,wl.tag=fl(wl.tag).replace("comment",wl._comment).replace("attribute",wl._attribute).getRegex(),wl._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,wl._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,wl._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,wl.link=fl(wl.link).replace("label",wl._label).replace("href",wl._href).replace("title",wl._title).getRegex(),wl.reflink=fl(wl.reflink).replace("label",wl._label).getRegex(),wl.reflinkSearch=fl(wl.reflinkSearch,"g").replace("reflink",wl.reflink).replace("nolink",wl.nolink).getRegex(),wl.normal=Tl({},wl),wl.pedantic=Tl({},wl.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:fl(/^!?\[(label)\]\((.*?)\)/).replace("label",wl._label).getRegex(),reflink:fl(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",wl._label).getRegex()}),wl.gfm=Tl({},wl.normal,{escape:fl(wl.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),wl.gfm.url=fl(wl.gfm.url,"i").replace("email",wl.gfm._extended_email).getRegex(),wl.breaks=Tl({},wl.gfm,{br:fl(wl.br).replace("{2,}","*").getRegex(),text:fl(wl.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});let Pl=class e{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ol,this.options.tokenizer=this.options.tokenizer||new Ll,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Rl.normal,inline:wl.normal};this.options.pedantic?(t.block=Rl.pedantic,t.inline=wl.pedantic):this.options.gfm&&(t.block=Rl.gfm,this.options.breaks?t.inline=wl.breaks:t.inline=wl.gfm),this.tokenizer.rules=t}static get rules(){return{block:Rl,inline:wl}}static lex(t,n){return new e(n).lex(t)}static lexInline(t,n){return new e(n).inlineTokens(t)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let n,i,o,a;for(this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((i=>!!(n=i.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))))if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),n.type&&t.push(n);else if(n=this.tokenizer.code(e))e=e.substring(n.raw.length),i=t[t.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?t.push(n):(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.list(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.def(e))e=e.substring(n.raw.length),i=t[t.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(i.raw+="\n"+n.raw,i.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else{if(o=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const n=e.slice(1);let i;this.options.extensions.startBlock.forEach((function(e){i=e.call({lexer:this},n),"number"==typeof i&&i>=0&&(t=Math.min(t,i))})),t<1/0&&t>=0&&(o=e.substring(0,t+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o)))i=t[t.length-1],a&&"paragraph"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),a=o.length!==e.length,e=e.substring(n.raw.length);else if(n=this.tokenizer.text(e))e=e.substring(n.raw.length),i=t[t.length-1],i&&"text"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){c("error","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/lib-marked.js:1600",t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let n,i,o,a,s,r,u=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(u));)e.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(u=u.slice(0,a.index)+"["+bl("a",a[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(u));)u=u.slice(0,a.index)+"["+bl("a",a[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(a=this.tokenizer.rules.inline.escapedEmSt.exec(u));)u=u.slice(0,a.index)+"++"+u.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(s||(r=""),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((i=>!!(n=i.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))))if(n=this.tokenizer.escape(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.tag(e))e=e.substring(n.raw.length),i=t[t.length-1],i&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);else if(n=this.tokenizer.link(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(n.raw.length),i=t[t.length-1],i&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);else if(n=this.tokenizer.emStrong(e,u,r))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.codespan(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.br(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.del(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.autolink(e,Nl))e=e.substring(n.raw.length),t.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(e,Nl))){if(o=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const n=e.slice(1);let i;this.options.extensions.startInline.forEach((function(e){i=e.call({lexer:this},n),"number"==typeof i&&i>=0&&(t=Math.min(t,i))})),t<1/0&&t>=0&&(o=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(o,Ol))e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(r=n.raw.slice(-1)),s=!0,i=t[t.length-1],i&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){c("error","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/lib-marked.js:1784",t);break}throw new Error(t)}}else e=e.substring(n.raw.length),t.push(n);return t}};class Ul{constructor(e){this.options=e||ol}code(e,t,n){const i=(t||"").match(/\S*/)[0];if(this.options.highlight){const t=this.options.highlight(e,i);null!=t&&t!==e&&(n=!0,e=t)}return e=e.replace(/\n$/,"")+"\n",i?'<pre><code class="'+this.options.langPrefix+dl(i,!0)+'">'+(n?e:dl(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:dl(e,!0))+"</code></pre>\n"}blockquote(e){return"<blockquote>\n"+e+"</blockquote>\n"}html(e){return e}heading(e,t,n,i){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+i.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,n){const i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+i+">\n"}listitem(e){return"<li>"+e+"</li>\n"}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+"</p>\n"}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return"<tr>\n"+e+"</tr>\n"}tablecell(e,t){const n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,n){if(null===(e=vl(this.options.sanitize,this.options.baseUrl,e)))return n;let i='<a href="'+dl(e)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>",i}image(e,t,n){if(null===(e=vl(this.options.sanitize,this.options.baseUrl,e)))return n;let i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">",i}text(e){return e}}class Gl{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class xl{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do{i++,n=e+"-"+i}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}let Fl=class e{constructor(e){this.options=e||ol,this.options.renderer=this.options.renderer||new Ul,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Gl,this.slugger=new xl}static parse(t,n){return new e(n).parse(t)}static parseInline(t,n){return new e(n).parseInline(t)}parse(e,t=!0){let n,i,o,a,s,r,u,l,d,h,p,g,f,m,_,v,y,I,M,C="";const E=e.length;for(n=0;n<E;n++)if(h=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type]&&(M=this.options.extensions.renderers[h.type].call({parser:this},h),!1!==M||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type)))C+=M||"";else switch(h.type){case"space":continue;case"hr":C+=this.renderer.hr();continue;case"heading":C+=this.renderer.heading(this.parseInline(h.tokens),h.depth,pl(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":C+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(l="",u="",a=h.header.length,i=0;i<a;i++)u+=this.renderer.tablecell(this.parseInline(h.header[i].tokens),{header:!0,align:h.align[i]});for(l+=this.renderer.tablerow(u),d="",a=h.rows.length,i=0;i<a;i++){for(r=h.rows[i],u="",s=r.length,o=0;o<s;o++)u+=this.renderer.tablecell(this.parseInline(r[o].tokens),{header:!1,align:h.align[o]});d+=this.renderer.tablerow(u)}C+=this.renderer.table(l,d);continue;case"blockquote":d=this.parse(h.tokens),C+=this.renderer.blockquote(d);continue;case"list":for(p=h.ordered,g=h.start,f=h.loose,a=h.items.length,d="",i=0;i<a;i++)_=h.items[i],v=_.checked,y=_.task,m="",_.task&&(I=this.renderer.checkbox(v),f?_.tokens.length>0&&"paragraph"===_.tokens[0].type?(_.tokens[0].text=I+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&"text"===_.tokens[0].tokens[0].type&&(_.tokens[0].tokens[0].text=I+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:I}):m+=I),m+=this.parse(_.tokens,f),d+=this.renderer.listitem(m,y,v);C+=this.renderer.list(d,p,g);continue;case"html":C+=this.renderer.html(h.text);continue;case"paragraph":C+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(d=h.tokens?this.parseInline(h.tokens):h.text;n+1<E&&"text"===e[n+1].type;)h=e[++n],d+="\n"+(h.tokens?this.parseInline(h.tokens):h.text);C+=t?this.renderer.paragraph(d):d;continue;default:{const e='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void c("error","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/lib-marked.js:2238",e);throw new Error(e)}}return C}parseInline(e,t){t=t||this.renderer;let n,i,o,a="";const s=e.length;for(n=0;n<s;n++)if(i=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]&&(o=this.options.extensions.renderers[i.type].call({parser:this},i),!1!==o||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)))a+=o||"";else switch(i.type){case"escape":case"text":a+=t.text(i.text);break;case"html":a+=t.html(i.text);break;case"link":a+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break;case"image":a+=t.image(i.href,i.title,i.text);break;case"strong":a+=t.strong(this.parseInline(i.tokens,t));break;case"em":a+=t.em(this.parseInline(i.tokens,t));break;case"codespan":a+=t.codespan(i.text);break;case"br":a+=t.br();break;case"del":a+=t.del(this.parseInline(i.tokens,t));break;default:{const e='Token with "'+i.type+'" type was not found.';if(this.options.silent)return void c("error","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/message-elements/message-desk/message-desk-elements/lib-marked.js:2317",e);throw new Error(e)}}return a}};function Bl(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),Dl(t=Tl({},Bl.defaults,t||{})),n){const i=t.highlight;let o;try{o=Pl.lex(e,t)}catch(Ct){return n(Ct)}const a=function(e){let a;if(!e)try{t.walkTokens&&Bl.walkTokens(o,t.walkTokens),a=Fl.parse(o,t)}catch(Ct){e=Ct}return t.highlight=i,e?n(e):n(null,a)};if(!i||i.length<3)return a();if(delete t.highlight,!o.length)return a();let s=0;return Bl.walkTokens(o,(function(e){"code"===e.type&&(s++,setTimeout((()=>{i(e.text,e.lang,(function(t,n){if(t)return a(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),s--,0===s&&a()}))}),0))})),void(0===s&&a())}try{const n=Pl.lex(e,t);return t.walkTokens&&Bl.walkTokens(n,t.walkTokens),Fl.parse(n,t)}catch(Ct){if(Ct.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+dl(Ct.message+"",!0)+"</pre>";throw Ct}}Bl.options=Bl.setOptions=function(e){var t;return Tl(Bl.defaults,e),t=Bl.defaults,ol=t,Bl},Bl.getDefaults=il,Bl.defaults=ol,Bl.use=function(...e){const t=Tl({},...e),n=Bl.defaults.extensions||{renderers:{},childTokens:{}};let i;e.forEach((e=>{if(e.extensions&&(i=!0,e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if(e.renderer){const t=n.renderers?n.renderers[e.name]:null;n.renderers[e.name]=t?function(...n){let i=e.renderer.apply(this,n);return!1===i&&(i=t.apply(this,n)),i}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");n[e.level]?n[e.level].unshift(e.tokenizer):n[e.level]=[e.tokenizer],e.start&&("block"===e.level?n.startBlock?n.startBlock.push(e.start):n.startBlock=[e.start]:"inline"===e.level&&(n.startInline?n.startInline.push(e.start):n.startInline=[e.start]))}e.childTokens&&(n.childTokens[e.name]=e.childTokens)}))),e.renderer){const n=Bl.defaults.renderer||new Ul;for(const t in e.renderer){const i=n[t];n[t]=(...o)=>{let a=e.renderer[t].apply(n,o);return!1===a&&(a=i.apply(n,o)),a}}t.renderer=n}if(e.tokenizer){const n=Bl.defaults.tokenizer||new Ll;for(const t in e.tokenizer){const i=n[t];n[t]=(...o)=>{let a=e.tokenizer[t].apply(n,o);return!1===a&&(a=i.apply(n,o)),a}}t.tokenizer=n}if(e.walkTokens){const n=Bl.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens.call(this,t),n&&n.call(this,t)}}i&&(t.extensions=n),Bl.setOptions(t)}))},Bl.walkTokens=function(e,t){for(const n of e)switch(t.call(Bl,n),n.type){case"table":for(const e of n.header)Bl.walkTokens(e.tokens,t);for(const e of n.rows)for(const n of e)Bl.walkTokens(n.tokens,t);break;case"list":Bl.walkTokens(n.items,t);break;default:Bl.defaults.extensions&&Bl.defaults.extensions.childTokens&&Bl.defaults.extensions.childTokens[n.type]?Bl.defaults.extensions.childTokens[n.type].forEach((function(e){Bl.walkTokens(n[e],t)})):n.tokens&&Bl.walkTokens(n.tokens,t)}},Bl.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");Dl(t=Tl({},Bl.defaults,t||{}));try{const n=Pl.lexInline(e,t);return t.walkTokens&&Bl.walkTokens(n,t.walkTokens),Fl.parseInline(n,t)}catch(Ct){if(Ct.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+dl(Ct.message+"",!0)+"</pre>";throw Ct}},Bl.Parser=Fl,Bl.parser=Fl.parse,Bl.Renderer=Ul,Bl.TextRenderer=Gl,Bl.Lexer=Pl,Bl.lexer=Pl.lex,Bl.Tokenizer=Ll,Bl.Slugger=xl,Bl.parse=Bl,Bl.options,Bl.setOptions,Bl.use,Bl.walkTokens,Bl.parseInline,Fl.parse,Pl.lex;const Vl=new Bl.Renderer;Vl.image=(e,t,n)=>`\n        <img src="${e}" alt="${n}" style="max-width: 100%;">\n    `,Vl.link=(e,t,n)=>e&&/[^\x00-\x7F]/g.test(e)?n:`<a target="_blank" rel="noreferrer noopenner" class="message-marked_link" href="${e||""}" title="${t}">${n}</a>`,Bl.setOptions({gfm:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1});const jl=e=>Bl.parse(e,{renderer:Vl}),ql=e=>{(e.$wxs||(e.$wxs=[])).push("handler"),(e.$wxsModules||(e.$wxsModules={})).handler="550457a8"},Hl={name:"node",options:{},data:()=>({ctrl:{}}),props:{name:String,attrs:{type:Object,default:()=>({})},childs:Array,opts:Array},components:{},mounted(){if(this.$nextTick((()=>{for(this.root=this.$parent;"mp-html"!==this.root.$options.name;this.root=this.root.$parent);})),this.opts[0]){let e;for(e=this.childs.length;e--&&"img"!==this.childs[e].name;);-1!==e&&(this.observer=uni.createIntersectionObserver(this).relativeToViewport({top:500,bottom:500}),this.observer.observe("._img",(e=>{e.intersectionRatio&&(this.$set(this.ctrl,"load",1),this.observer.disconnect())})))}},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{play(e){const t=e.currentTarget.dataset.i,n=this.childs[t];this.root.$emit("play",{source:n.name,attrs:{...n.attrs,src:n.src[this.ctrl[t]||0]}})},imgTap(e){const t=this.childs[e.currentTarget.dataset.i];t.a?this.linkTap(t.a):t.attrs.ignore||(t.attrs.src=t.attrs.src||t.attrs["data-src"],this.root.$emit("imgtap",t.attrs),this.root.previewImg&&uni.previewImage({current:parseInt(t.attrs.i),urls:this.root.imgList}))},imgLongTap(e){const t=this.childs[e.currentTarget.dataset.i].attrs;this.opts[3]&&!t.ignore&&uni.showActionSheet({itemList:["保存图片"],success:()=>{const e=e=>{uni.saveImageToPhotosAlbum({filePath:e,success(){uni.showToast({title:"保存成功"})}})};this.root.imgList[t.i].startsWith("http")?uni.downloadFile({url:this.root.imgList[t.i],success:t=>e(t.tempFilePath)}):e(this.root.imgList[t.i])}})},imgLoad(e){const t=e.currentTarget.dataset.i;this.childs[t].w?(this.opts[1]&&!this.ctrl[t]||-1===this.ctrl[t])&&this.$set(this.ctrl,t,1):this.$set(this.ctrl,t,e.detail.width),this.checkReady()},checkReady(){this.root&&!this.root.lazyLoad&&(this.root._unloadimgs-=1,this.root._unloadimgs||setTimeout((()=>{this.root.getRect().then((e=>{this.root.$emit("ready",e)})).catch((()=>{this.root.$emit("ready",{})}))}),350))},linkTap(e){const t=e.currentTarget?this.childs[e.currentTarget.dataset.i]:{},n=t.attrs||e,i=n.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(t.children||[])},n)),i&&("#"===i[0]?this.root.navigateTo(i.substring(1)).catch((()=>{})):i.split("?")[0].includes("://")?this.root.copyLink&&plus.runtime.openWeb(i):uni.navigateTo({url:i,fail(){uni.switchTab({url:i,fail(){}})}}))},mediaError(e){const t=e.currentTarget.dataset.i,n=this.childs[t];if("video"===n.name||"audio"===n.name){let e=(this.ctrl[t]||0)+1;if(e>n.src.length&&(e=0),e<n.src.length)return void this.$set(this.ctrl,t,e)}else"img"===n.name&&(this.opts[2]&&this.$set(this.ctrl,t,-1),this.checkReady());this.root&&this.root.$emit("error",{source:n.name,attrs:n.attrs,errMsg:e.detail.errMsg})}}};ql(Hl);const Kl=u(Hl,[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("node",!0);return e.openBlock(),e.createElementBlock("view",{id:i.attrs.id,class:e.normalizeClass("_block _"+i.name+" "+i.attrs.class),style:e.normalizeStyle(i.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.childs,((t,o)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},["img"===t.name&&!t.t&&(i.opts[1]&&!a.ctrl[o]||a.ctrl[o]<0)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"_img",style:e.normalizeStyle(t.attrs.style),src:a.ctrl[o]<0?i.opts[2]:i.opts[1],mode:"widthFix"},null,12,["src"])):e.createCommentVNode("",!0),"img"===t.name&&t.t?(e.openBlock(),e.createElementBlock("rich-text",{key:1,style:e.normalizeStyle("display:"+t.t),nodes:[{attrs:{style:t.attrs.style||"",src:t.attrs.src},name:"img"}],"data-i":o,onClick:n[0]||(n[0]=e.withModifiers(((...e)=>s.imgTap&&s.imgTap(...e)),["stop"]))},null,12,["nodes","data-i"])):"img"===t.name?(e.openBlock(),e.createElementBlock("image",{key:2,id:t.attrs.id,class:e.normalizeClass("_img "+t.attrs.class),style:e.normalizeStyle((-1===a.ctrl[o]?"display:none;":"")+"width:"+(a.ctrl[o]||1)+"px;"+t.attrs.style),src:t.attrs.src||(a.ctrl.load?t.attrs["data-src"]:""),mode:t.h?t.w?t.m||"":"heightFix":"widthFix","data-i":o,onLoad:n[1]||(n[1]=(...e)=>s.imgLoad&&s.imgLoad(...e)),onError:n[2]||(n[2]=(...e)=>s.mediaError&&s.mediaError(...e)),onClick:n[3]||(n[3]=e.withModifiers(((...e)=>s.imgTap&&s.imgTap(...e)),["stop"])),onLongpress:n[4]||(n[4]=(...e)=>s.imgLongTap&&s.imgLongTap(...e))},null,46,["id","src","mode","data-i"])):t.text?(e.openBlock(),e.createElementBlock("text",{key:3,decode:""},e.toDisplayString(t.text),1)):"br"===t.name?(e.openBlock(),e.createElementBlock("text",{key:4},"\\n")):"a"===t.name?(e.openBlock(),e.createElementBlock("view",{key:5,id:t.attrs.id,class:e.normalizeClass((t.attrs.href?"_a ":"")+t.attrs.class),"hover-class":"_hover",style:e.normalizeStyle("display:inline;"+t.attrs.style),"data-i":o,onClick:n[5]||(n[5]=e.withModifiers(((...e)=>s.linkTap&&s.linkTap(...e)),["stop"]))},[e.createVNode(r,{name:"span",childs:t.children,opts:i.opts,style:{display:"inherit"}},null,8,["childs","opts"])],14,["id","data-i"])):t.html?(e.openBlock(),e.createElementBlock("view",{key:6,id:t.attrs.id,class:e.normalizeClass("_video "+t.attrs.class),style:e.normalizeStyle(t.attrs.style),innerHTML:t.html,onVplay:n[6]||(n[6]=e.withModifiers(((...e)=>s.play&&s.play(...e)),["stop"]))},null,46,["id","innerHTML"])):"iframe"===t.name?(e.openBlock(),e.createElementBlock("iframe",{key:7,style:e.normalizeStyle(t.attrs.style),allowfullscreen:t.attrs.allowfullscreen,frameborder:t.attrs.frameborder,src:t.attrs.src},null,12,["allowfullscreen","frameborder","src"])):"embed"===t.name?(e.openBlock(),e.createElementBlock("embed",{key:8,style:e.normalizeStyle(t.attrs.style),src:t.attrs.src},null,12,["src"])):"table"===t.name&&t.c||"li"===t.name?(e.openBlock(),e.createElementBlock("view",{key:9,id:t.attrs.id,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},["li"===t.name?(e.openBlock(),e.createBlock(r,{key:0,childs:t.children,opts:i.opts},null,8,["childs","opts"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.children,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},["td"===t.name||"th"===t.name?(e.openBlock(),e.createBlock(r,{key:0,childs:t.children,opts:i.opts},null,8,["childs","opts"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.children,((t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},["td"===t.name||"th"===t.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[e.createVNode(r,{childs:t.children,opts:i.opts},null,8,["childs","opts"])],6)):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[e.createVNode(r,{childs:t.children,opts:i.opts},null,8,["childs","opts"])],6)))),128))],6))],64)))),128))],6)))),128))],14,["id"])):t.c?2===t.c?(e.openBlock(),e.createElementBlock("view",{key:11,id:t.attrs.id,class:e.normalizeClass("_block _"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.f+";"+t.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((t,n)=>(e.openBlock(),e.createBlock(r,{key:n,style:e.normalizeStyle(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:i.opts},null,8,["style","name","attrs","childs","opts"])))),128))],14,["id"])):(e.openBlock(),e.createBlock(r,{key:12,style:e.normalizeStyle(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:i.opts},null,8,["style","name","attrs","childs","opts"])):(e.openBlock(),e.createElementBlock("rich-text",{key:10,id:t.attrs.id,style:e.normalizeStyle("display:inline;"+t.f),preview:!1,selectable:i.opts[4],"user-select":i.opts[4],nodes:[t]},null,12,["id","selectable","user-select","nodes"]))],64)))),128))],14,["id"])}],["__scopeId","data-v-8ff4af66"]]),zl={trustTags:Xl("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,ruby,rt,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags:Xl("address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section"),inlineTags:Xl("abbr,b,big,code,del,em,i,ins,label,q,small,span,strong,sub,sup"),ignoreTags:Xl("area,base,canvas,embed,frame,head,iframe,input,link,map,meta,param,rp,script,source,style,textarea,title,track,wbr"),voidTags:Xl("area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),entities:{lt:"<",gt:">",quot:'"',apos:"'",ensp:" ",emsp:" ",nbsp:" ",semi:";",ndash:"–",mdash:"—",middot:"·",lsquo:"‘",rsquo:"’",ldquo:"“",rdquo:"”",bull:"•",hellip:"…",larr:"←",uarr:"↑",rarr:"→",darr:"↓"},tagStyle:{address:"font-style:italic",big:"display:inline;font-size:1.2em",caption:"display:table-caption;text-align:center",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",mark:"background-color:yellow",pre:"font-family:monospace;white-space:pre",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",strike:"text-decoration:line-through",u:"text-decoration:underline"},svgDict:{animatetransform:"animateTransform",lineargradient:"linearGradient",viewbox:"viewBox",attributename:"attributeName",repeatcount:"repeatCount",repeatdur:"repeatDur",foreignobject:"foreignObject"}},Yl={},{windowWidth:$l}=uni.getSystemInfoSync(),Wl=Xl(" ,\r,\n,\t,\f");let Jl=0;function Xl(e){const t=Object.create(null),n=e.split(",");for(let i=n.length;i--;)t[n[i]]=!0;return t}function Zl(e,t){let n=e.indexOf("&");for(;-1!==n;){const i=e.indexOf(";",n+3);let o;if(-1===i)break;"#"===e[n+1]?(o=parseInt(("x"===e[n+2]?"0":"")+e.substring(n+2,i)),isNaN(o)||(e=e.substr(0,n)+String.fromCharCode(o)+e.substr(i+1))):(o=e.substring(n+1,i),(zl.entities[o]||"amp"===o&&t)&&(e=e.substr(0,n)+(zl.entities[o]||"&")+e.substr(i+1))),n=e.indexOf("&",n+1)}return e}function Ql(e){let t=e.length-1;for(let n=t;n>=-1;n--)(-1===n||e[n].c||!e[n].name||"div"!==e[n].name&&"p"!==e[n].name&&"h"!==e[n].name[0]||(e[n].attrs.style||"").includes("inline"))&&(t-n>=5&&e.splice(n+1,t-n,{name:"div",attrs:{},children:e.slice(n+1,t+1)}),t=n-1)}function ed(e){this.options=e||{},this.tagStyle=Object.assign({},zl.tagStyle,this.options.tagStyle),this.imgList=e.imgList||[],this.imgList._unloadimgs=0,this.plugins=e.plugins||[],this.attrs=Object.create(null),this.stack=[],this.nodes=[],this.pre=(this.options.containerStyle||"").includes("white-space")&&this.options.containerStyle.includes("pre")?2:0}function td(e){this.handler=e}zl.ignoreTags.iframe=void 0,zl.trustTags.iframe=!0,zl.ignoreTags.embed=void 0,zl.trustTags.embed=!0,ed.prototype.parse=function(e){for(let t=this.plugins.length;t--;)this.plugins[t].onUpdate&&(e=this.plugins[t].onUpdate(e,zl)||e);for(new td(this).parse(e);this.stack.length;)this.popNode();return this.nodes.length>50&&Ql(this.nodes),this.nodes},ed.prototype.expose=function(){for(let e=this.stack.length;e--;){const t=this.stack[e];if(t.c||"a"===t.name||"video"===t.name||"audio"===t.name)return;t.c=1}},ed.prototype.hook=function(e){for(let t=this.plugins.length;t--;)if(this.plugins[t].onParse&&!1===this.plugins[t].onParse(e,this))return!1;return!0},ed.prototype.getUrl=function(e){const t=this.options.domain;return"/"===e[0]?e="/"===e[1]?(t?t.split("://")[0]:"http")+":"+e:t?t+e:plus.io.convertLocalFileSystemURL(e):e.includes("data:")||e.includes("://")||(e=t?t+"/"+e:plus.io.convertLocalFileSystemURL(e)),e},ed.prototype.parseStyle=function(e){const t=e.attrs,n=(this.tagStyle[e.name]||"").split(";").concat((t.style||"").split(";")),i={};let o="";t.id&&!this.xml&&(this.options.useAnchor?this.expose():"img"!==e.name&&"a"!==e.name&&"video"!==e.name&&"audio"!==e.name&&(t.id=void 0)),t.width&&(i.width=parseFloat(t.width)+(t.width.includes("%")?"%":"px"),t.width=void 0),t.height&&(i.height=parseFloat(t.height)+(t.height.includes("%")?"%":"px"),t.height=void 0);for(let a=0,s=n.length;a<s;a++){const e=n[a].split(":");if(e.length<2)continue;const t=e.shift().trim().toLowerCase();let s=e.join(":").trim();if("-"===s[0]&&s.lastIndexOf("-")>0||s.includes("safe"))o+=`;${t}:${s}`;else if(!i[t]||s.includes("import")||!i[t].includes("import")){if(s.includes("url")){let e=s.indexOf("(")+1;if(e){for(;'"'===s[e]||"'"===s[e]||Wl[s[e]];)e++;s=s.substr(0,e)+this.getUrl(s.substr(e))}}else s.includes("rpx")&&(s=s.replace(/[0-9.]+\s*rpx/g,(e=>parseFloat(e)*$l/750+"px")));i[t]=s}}return e.attrs.style=o,i},ed.prototype.onTagName=function(e){this.tagName=this.xml?e:e.toLowerCase(),"svg"===this.tagName&&(this.xml=(this.xml||0)+1,zl.ignoreTags.style=void 0)},ed.prototype.onAttrName=function(e){(e=this.xml?e:e.toLowerCase()).includes("?")||e.includes(";")?this.attrName=void 0:"data-"===e.substr(0,5)?"data-src"!==e||this.attrs.src?"img"===this.tagName||"a"===this.tagName?this.attrName=e:this.attrName=void 0:this.attrName="src":(this.attrName=e,this.attrs[e]="T")},ed.prototype.onAttrVal=function(e){const t=this.attrName||"";"style"===t||"href"===t?this.attrs[t]=Zl(e,!0):t.includes("src")?this.attrs[t]=this.getUrl(Zl(e,!0)):t&&(this.attrs[t]=e)},ed.prototype.onOpenTag=function(e){const t=Object.create(null);t.name=this.tagName,t.attrs=this.attrs,this.options.nodes.length&&(t.type="node"),this.attrs=Object.create(null);const n=t.attrs,i=this.stack[this.stack.length-1],o=i?i.children:this.nodes,a=this.xml?e:zl.voidTags[t.name];if(Yl[t.name]&&(n.class=Yl[t.name]+(n.class?" "+n.class:"")),"embed"===t.name&&this.expose(),"video"!==t.name&&"audio"!==t.name||("video"!==t.name||n.id||(n.id="v"+Jl++),n.controls||n.autoplay||(n.controls="T"),t.src=[],n.src&&(t.src.push(n.src),n.src=void 0),this.expose()),a){if(!this.hook(t)||zl.ignoreTags[t.name])return void("base"!==t.name||this.options.domain?"source"===t.name&&i&&("video"===i.name||"audio"===i.name)&&n.src&&i.src.push(n.src):this.options.domain=n.href);const e=this.parseStyle(t);if("img"===t.name){if(n.src&&(n.src.includes("webp")&&(t.webp="T"),n.src.includes("data:")&&"all"!==this.options.previewImg&&!n["original-src"]&&(n.ignore="T"),!n.ignore||t.webp||n.src.includes("cloud://"))){for(let o=this.stack.length;o--;){const i=this.stack[o];"a"===i.name&&(t.a=i.attrs),"table"!==i.name||t.webp||n.src.includes("cloud://")||(!e.display||e.display.includes("inline")?t.t="inline-block":t.t=e.display,e.display=void 0),i.c=1}n.i=this.imgList.length.toString();let i=n["original-src"]||n.src;this.imgList.push(i),t.t||(this.imgList._unloadimgs+=1),this.options.lazyLoad&&(n["data-src"]=n.src,n.src=void 0)}"inline"===e.display&&(e.display=""),n.ignore&&(e["max-width"]=e["max-width"]||"100%",n.style+=";-webkit-touch-callout:none"),parseInt(e.width)>$l&&(e.height=void 0),isNaN(parseInt(e.width))||(t.w="T"),!isNaN(parseInt(e.height))&&(!e.height.includes("%")||i&&(i.attrs.style||"").includes("height"))&&(t.h="T"),t.w&&t.h&&e["object-fit"]&&("contain"===e["object-fit"]?t.m="aspectFit":"cover"===e["object-fit"]&&(t.m="aspectFill"))}else if("svg"===t.name)return o.push(t),this.stack.push(t),void this.popNode();for(const t in e)e[t]&&(n.style+=`;${t}:${e[t].replace(" !important","")}`);n.style=n.style.substr(1)||void 0}else("pre"===t.name||(n.style||"").includes("white-space")&&n.style.includes("pre"))&&2!==this.pre&&(this.pre=t.pre=1),t.children=[],this.stack.push(t);o.push(t)},ed.prototype.onCloseTag=function(e){let t;for(e=this.xml?e:e.toLowerCase(),t=this.stack.length;t--&&this.stack[t].name!==e;);if(-1!==t)for(;this.stack.length>t;)this.popNode();else if("p"===e||"br"===e){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push({name:e,attrs:{class:Yl[e]||"",style:this.tagStyle[e]||""}})}},ed.prototype.popNode=function(){const e=this.stack.pop();let t=e.attrs;const n=e.children,i=this.stack[this.stack.length-1],o=i?i.children:this.nodes;if(!this.hook(e)||zl.ignoreTags[e.name])return"title"===e.name&&n.length&&"text"===n[0].type&&this.options.setTitle&&uni.setNavigationBarTitle({title:n[0].text}),void o.pop();if(e.pre&&2!==this.pre){this.pre=e.pre=void 0;for(let e=this.stack.length;e--;)this.stack[e].pre&&(this.pre=1)}const a={};if("svg"===e.name){if(this.xml>1)return void this.xml--;let n="";const i=t.style;return t.style="",t.xmlns="http://www.w3.org/2000/svg",function e(t){if("text"===t.type)return void(n+=t.text);const i=zl.svgDict[t.name]||t.name;if("foreignObject"===i)for(const n of t.children||[])if(n.attrs&&!n.attrs.xmlns){n.attrs.xmlns="http://www.w3.org/1999/xhtml";break}n+="<"+i;for(const o in t.attrs){const e=t.attrs[o];e&&(n+=` ${zl.svgDict[o]||o}="${e.replace(/"/g,"")}"`)}if(t.children){n+=">";for(let n=0;n<t.children.length;n++)e(t.children[n]);n+="</"+i+">"}else n+="/>"}(e),e.name="img",e.attrs={src:"data:image/svg+xml;utf8,"+n.replace(/#/g,"%23"),style:i,ignore:"T"},e.children=void 0,this.xml=!1,void(zl.ignoreTags.style=!0)}if(t.align&&("table"===e.name?"center"===t.align?a["margin-inline-start"]=a["margin-inline-end"]="auto":a.float=t.align:a["text-align"]=t.align,t.align=void 0),t.dir&&(a.direction=t.dir,t.dir=void 0),"font"===e.name&&(t.color&&(a.color=t.color,t.color=void 0),t.face&&(a["font-family"]=t.face,t.face=void 0),t.size)){let e=parseInt(t.size);isNaN(e)||(e<1?e=1:e>7&&(e=7),a["font-size"]=["x-small","small","medium","large","x-large","xx-large","xxx-large"][e-1]),t.size=void 0}if((t.class||"").includes("align-center")&&(a["text-align"]="center"),Object.assign(a,this.parseStyle(e)),"table"!==e.name&&parseInt(a.width)>$l&&(a["max-width"]="100%",a["box-sizing"]="border-box"),zl.blockTags[e.name]?e.name="div":zl.trustTags[e.name]||this.xml||(e.name="span"),"a"===e.name||"ad"===e.name||"iframe"===e.name)this.expose();else if("video"===e.name){(a.height||"").includes("auto")&&(a.height=void 0);let n='<video style="width:100%;height:100%"';for(const e in t)t[e]&&(n+=" "+e+'="'+t[e]+'"');this.options.pauseVideo&&(n+=" onplay=\"this.dispatchEvent(new CustomEvent('vplay',{bubbles:!0}));for(var e=document.getElementsByTagName('video'),t=0;t<e.length;t++)e[t]!=this&&e[t].pause()\""),n+=">";for(let t=0;t<e.src.length;t++)n+='<source src="'+e.src[t]+'">';n+="</video>",e.html=n}else if("ul"!==e.name&&"ol"!==e.name||!e.c)if("table"===e.name){let i=parseFloat(t.cellpadding),o=parseFloat(t.cellspacing);const s=parseFloat(t.border),r=a["border-color"],c=a["border-style"];if(e.c&&(isNaN(i)&&(i=2),isNaN(o)&&(o=2)),s&&(t.style+=`;border:${s}px ${c||"solid"} ${r||"gray"}`),e.flag&&e.c){a.display="grid","collapse"===a["border-collapse"]&&(a["border-collapse"]=void 0,o=0),o?(a["grid-gap"]=o+"px",a.padding=o+"px"):s&&(t.style+=";border-left:0;border-top:0");const u=[],l=[],d=[],h={};!function e(t){for(let n=0;n<t.length;n++)if("tr"===t[n].name)l.push(t[n]);else if("colgroup"===t[n].name){let e=1;for(const i of t[n].children||[])if("col"===i.name){const t=i.attrs.style||"",n=t.indexOf("width")?t.indexOf(";width"):0;if(-1!==n){let i=t.indexOf(";",n+6);-1===i&&(i=t.length),u[e]=t.substring(n?n+7:6,i)}e+=1}}else e(t[n].children||[])}(n);for(let e=1;e<=l.length;e++){let t=1;for(let n=0;n<l[e-1].children.length;n++){const a=l[e-1].children[n];if("td"===a.name||"th"===a.name){for(;h[e+"."+t];)t++;let n=a.attrs.style||"",l=n.indexOf("width")?n.indexOf(";width"):0;if(-1!==l){let e=n.indexOf(";",l+6);-1===e&&(e=n.length),a.attrs.colspan||(u[t]=n.substring(l?l+7:6,e)),n=n.substr(0,l)+n.substr(e)}if(n+=";display:flex",l=n.indexOf("vertical-align"),-1!==l){const e=n.substr(l+15,10);e.includes("middle")?n+=";align-items:center":e.includes("bottom")&&(n+=";align-items:flex-end")}else n+=";align-items:center";if(l=n.indexOf("text-align"),-1!==l){const e=n.substr(l+11,10);e.includes("center")?n+=";justify-content: center":e.includes("right")&&(n+=";justify-content: right")}if(n=(s?`;border:${s}px ${c||"solid"} ${r||"gray"}`+(o?"":";border-right:0;border-bottom:0"):"")+(i?`;padding:${i}px`:"")+";"+n,a.attrs.colspan&&(n+=`;grid-column-start:${t};grid-column-end:${t+parseInt(a.attrs.colspan)}`,a.attrs.rowspan||(n+=`;grid-row-start:${e};grid-row-end:${e+1}`),t+=parseInt(a.attrs.colspan)-1),a.attrs.rowspan){n+=`;grid-row-start:${e};grid-row-end:${e+parseInt(a.attrs.rowspan)}`,a.attrs.colspan||(n+=`;grid-column-start:${t};grid-column-end:${t+1}`);for(let n=1;n<a.attrs.rowspan;n++)for(let i=0;i<(a.attrs.colspan||1);i++)h[e+n+"."+(t-i)]=1}n&&(a.attrs.style=n),d.push(a),t++}}if(1===e){let e="";for(let n=1;n<t;n++)e+=(u[n]?u[n]:"auto")+" ";a["grid-template-columns"]=e}}e.children=d}else e.c&&(a.display="table"),isNaN(o)||(a["border-spacing"]=o+"px"),(s||i)&&function e(t){for(let n=0;n<t.length;n++){const o=t[n];"th"===o.name||"td"===o.name?(s&&(o.attrs.style=`border:${s}px ${c||"solid"} ${r||"gray"};${o.attrs.style||""}`),i&&(o.attrs.style=`padding:${i}px;${o.attrs.style||""}`)):o.children&&e(o.children)}}(n);if(this.options.scrollTable&&!(t.style||"").includes("inline")){const n=Object.assign({},e);e.name="div",e.attrs={style:"overflow:auto"},e.children=[n],t=n.attrs}}else if(("tbody"===e.name||"tr"===e.name)&&e.flag&&e.c)e.flag=void 0,function e(t){for(let n=0;n<t.length;n++)if("td"===t[n].name)for(const e of["color","background","background-color"])a[e]&&(t[n].attrs.style=e+":"+a[e]+";"+(t[n].attrs.style||""));else e(t[n].children||[])}(n);else if("td"!==e.name&&"th"!==e.name||!t.colspan&&!t.rowspan)if("ruby"===e.name){e.name="span";for(let e=0;e<n.length-1;e++)"text"===n[e].type&&"rt"===n[e+1].name&&(n[e]={name:"div",attrs:{style:"display:inline-block;text-align:center"},children:[{name:"div",attrs:{style:"font-size:50%;"+(n[e+1].attrs.style||"")},children:n[e+1].children},n[e]]},n.splice(e+1,1))}else e.c&&function e(t){t.c=2;for(let n=t.children.length;n--;){const i=t.children[n];i.name&&(zl.inlineTags[i.name]||(i.attrs.style||"").includes("inline")&&i.children)&&!i.c&&e(i),i.c&&"table"!==i.name||(t.c=1)}}(e);else for(let r=this.stack.length;r--;)"table"!==this.stack[r].name&&"tbody"!==this.stack[r].name&&"tr"!==this.stack[r].name||(this.stack[r].flag=1);else{const e={a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"};e[t.type]&&(t.style+=";list-style-type:"+e[t.type],t.type=void 0);for(let t=n.length;t--;)"li"===n[t].name&&(n[t].c=1)}if((a.display||"").includes("flex")&&!e.c)for(let r=n.length;r--;){const e=n[r];e.f&&(e.attrs.style=(e.attrs.style||"")+e.f,e.f=void 0)}const s=i&&((i.attrs.style||"").includes("flex")||(i.attrs.style||"").includes("grid"))&&!e.c;s&&(e.f=";max-width:100%"),n.length>=50&&e.c&&!(a.display||"").includes("flex")&&Ql(n);for(const r in a)if(a[r]){const n=`;${r}:${a[r].replace(" !important","")}`;s&&(r.includes("flex")&&"flex-direction"!==r||"align-self"===r||r.includes("grid")||"-"===a[r][0]||r.includes("width")&&n.includes("%"))?(e.f+=n,"width"===r&&(t.style+=";width:100%")):t.style+=n}t.style=t.style.substr(1)||void 0},ed.prototype.onText=function(e){if(!this.pre){let t,n="";for(let i=0,o=e.length;i<o;i++)Wl[e[i]]?(" "!==n[n.length-1]&&(n+=" "),"\n"!==e[i]||t||(t=!0)):n+=e[i];if(" "===n){if(t)return;{const e=this.stack[this.stack.length-1];if(e&&"t"===e.name[0])return}}e=n}const t=Object.create(null);if(t.type="text",t.text=Zl(e),this.hook(t)){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push(t)}},td.prototype.parse=function(e){this.content=e||"",this.i=0,this.start=0,this.state=this.text;for(let t=this.content.length;-1!==this.i&&this.i<t;)this.state()},td.prototype.checkClose=function(e){const t="/"===this.content[this.i];return!!(">"===this.content[this.i]||t&&">"===this.content[this.i+1])&&(e&&this.handler[e](this.content.substring(this.start,this.i)),this.i+=t?2:1,this.start=this.i,this.handler.onOpenTag(t),"script"===this.handler.tagName?(this.i=this.content.indexOf("</",this.i),-1!==this.i&&(this.i+=2,this.start=this.i),this.state=this.endTag):this.state=this.text,!0)},td.prototype.text=function(){if(this.i=this.content.indexOf("<",this.i),-1===this.i)return void(this.start<this.content.length&&this.handler.onText(this.content.substring(this.start,this.content.length)));const e=this.content[this.i+1];if(e>="a"&&e<="z"||e>="A"&&e<="Z")this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i)),this.start=++this.i,this.state=this.tagName;else if("/"===e||"!"===e||"?"===e){this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i));const t=this.content[this.i+2];if("/"===e&&(t>="a"&&t<="z"||t>="A"&&t<="Z"))return this.i+=2,this.start=this.i,void(this.state=this.endTag);let n="--\x3e";"!"===e&&"-"===this.content[this.i+2]&&"-"===this.content[this.i+3]||(n=">"),this.i=this.content.indexOf(n,this.i),-1!==this.i&&(this.i+=n.length,this.start=this.i)}else this.i++},td.prototype.tagName=function(){if(Wl[this.content[this.i]]){for(this.handler.onTagName(this.content.substring(this.start,this.i));Wl[this.content[++this.i]];);this.i<this.content.length&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)}else this.checkClose("onTagName")||this.i++},td.prototype.attrName=function(){let e=this.content[this.i];if(Wl[e]||"="===e){this.handler.onAttrName(this.content.substring(this.start,this.i));let t="="===e;const n=this.content.length;for(;++this.i<n;)if(e=this.content[this.i],!Wl[e]){if(this.checkClose())return;if(t)return this.start=this.i,void(this.state=this.attrVal);if("="!==this.content[this.i])return this.start=this.i,void(this.state=this.attrName);t=!0}}else this.checkClose("onAttrName")||this.i++},td.prototype.attrVal=function(){const e=this.content[this.i],t=this.content.length;if('"'===e||"'"===e){if(this.start=++this.i,this.i=this.content.indexOf(e,this.i),-1===this.i)return;this.handler.onAttrVal(this.content.substring(this.start,this.i))}else for(;this.i<t;this.i++){if(Wl[this.content[this.i]]){this.handler.onAttrVal(this.content.substring(this.start,this.i));break}if(this.checkClose("onAttrVal"))return}for(;Wl[this.content[++this.i]];);this.i<t&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)},td.prototype.endTag=function(){const e=this.content[this.i];if(Wl[e]||">"===e||"/"===e){if(this.handler.onCloseTag(this.content.substring(this.start,this.i)),">"!==e&&(this.i=this.content.indexOf(">",this.i),-1===this.i))return;this.start=++this.i,this.state=this.text}else this.i++};const nd=[];const id=u({name:"mp-html",data:()=>({nodes:[]}),props:{containerStyle:{type:String,default:""},content:{type:String,default:""},copyLink:{type:[Boolean,String],default:!0},domain:String,errorImg:{type:String,default:""},lazyLoad:{type:[Boolean,String],default:!1},loadingImg:{type:String,default:""},pauseVideo:{type:[Boolean,String],default:!0},previewImg:{type:[Boolean,String],default:!0},scrollTable:[Boolean,String],selectable:[Boolean,String],setTitle:{type:[Boolean,String],default:!0},showImgMenu:{type:[Boolean,String],default:!0},tagStyle:Object,useAnchor:[Boolean,Number]},emits:["load","ready","imgtap","linktap","play","error"],components:{node:Kl},watch:{content(e){this.setContent(e)}},created(){this.plugins=[];for(let e=nd.length;e--;)this.plugins.push(new nd[e](this))},mounted(){this.content&&!this.nodes.length&&this.setContent(this.content)},beforeDestroy(){this._hook("onDetached")},methods:{in(e,t,n){e&&t&&n&&(this._in={page:e,selector:t,scrollTop:n})},navigateTo(e,t){return new Promise(((n,i)=>{if(!this.useAnchor)return void i(Error("Anchor is disabled"));t=t||parseInt(this.useAnchor)||0;const o=uni.createSelectorQuery().in(this._in?this._in.page:this).select((this._in?this._in.selector:"._root")+(e?` #${e}`:"")).boundingClientRect();this._in?o.select(this._in.selector).scrollOffset().select(this._in.selector).boundingClientRect():o.selectViewport().scrollOffset(),o.exec((e=>{if(!e[0])return void i(Error("Label not found"));const o=e[1].scrollTop+e[0].top-(e[2]?e[2].top:0)+t;this._in?this._in.page[this._in.scrollTop]=o:uni.pageScrollTo({scrollTop:o,duration:300}),n()}))}))},getText(e){let t="";return function e(n){for(let i=0;i<n.length;i++){const o=n[i];if("text"===o.type)t+=o.text.replace(/&amp;/g,"&");else if("br"===o.name)t+="\n";else{const n="p"===o.name||"div"===o.name||"tr"===o.name||"li"===o.name||"h"===o.name[0]&&o.name[1]>"0"&&o.name[1]<"7";n&&t&&"\n"!==t[t.length-1]&&(t+="\n"),o.children&&e(o.children),n&&"\n"!==t[t.length-1]?t+="\n":"td"!==o.name&&"th"!==o.name||(t+="\t")}}}(e||this.nodes),t},getRect(){return new Promise(((e,t)=>{uni.createSelectorQuery().in(this).select("#_root").boundingClientRect().exec((n=>n[0]?e(n[0]):t(Error("Root label not found"))))}))},pauseMedia(){for(let t=(this._videos||[]).length;t--;)this._videos[t].pause();let e=this.$parent;for(;!e.$scope;)e=e.$parent;e.$scope.$getAppWebview().evalJS('for(var e=document.getElementsByTagName("video"),i=e.length;i--;)e[i].pause()')},setPlaybackRate(e){this.playbackRate=e;for(let i=(this._videos||[]).length;i--;)this._videos[i].playbackRate(e);const t='for(var e=document.getElementsByTagName("video"),i=e.length;i--;)e[i].playbackRate='+e;let n=this.$parent;for(;!n.$scope;)n=n.$parent;n.$scope.$getAppWebview().evalJS(t)},setContent(e,t){t&&this.imgList||(this.imgList=[]);const n=new ed(this).parse(e);if(this.$set(this,"nodes",t?(this.nodes||[]).concat(n):n),this._videos=[],this.$nextTick((()=>{this._hook("onLoad"),this.$emit("load")})),this.lazyLoad||this.imgList._unloadimgs<this.imgList.length/2){let e=0;const t=n=>{n&&n.height||(n={}),n.height===e?this.$emit("ready",n):(e=n.height,setTimeout((()=>{this.getRect().then(t).catch(t)}),350))};this.getRect().then(t).catch(t)}else this.imgList._unloadimgs||this.getRect().then((e=>{this.$emit("ready",e)})).catch((()=>{this.$emit("ready",{})}))},_hook(e){for(let t=nd.length;t--;)this.plugins[t][e]&&this.plugins[t][e]()}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("node");return e.openBlock(),e.createElementBlock("view",{id:"_root",class:e.normalizeClass((i.selectable?"_select ":"")+"_root"),style:e.normalizeStyle(i.containerStyle)},[a.nodes[0]?(e.openBlock(),e.createBlock(r,{key:1,childs:a.nodes,opts:[i.lazyLoad,i.loadingImg,i.errorImg,i.showImgMenu,i.selectable],name:"span"},null,8,["childs","opts"])):e.renderSlot(t.$slots,"default",{key:0},void 0,!0)],6)}],["__scopeId","data-v-8217dd80"]]),{computed:od,ref:ad}=co;const sd=u({components:{mpHtml:id},props:{payload:{type:Object,default:()=>({})}},setup(e){const t=od((()=>jl(e.payload.content)));return{props:e,parsedContent:t}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("mpHtml");return e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",null,[e.createVNode(r,{content:o.parsedContent},null,8,["content"])])])}]]),rd=/[\u4e00-\u9fa5]/,cd=/\b\w+\b|[^\w]+/g;class ud{constructor(e){__publicField(this,"strings",[]),__publicField(this,"isTyping",!1),__publicField(this,"typeSpeed",0),__publicField(this,"curArrayPos",0),__publicField(this,"curCharPos",0),__publicField(this,"timer"),__publicField(this,"onTyping"),__publicField(this,"onStart"),__publicField(this,"onStop"),__publicField(this,"onComplete");const{defaultStrings:t,typeSpeed:n,onTyping:i,onComplete:o,onStart:a,onStop:s}=e;var r;t&&(r=t,Array.isArray(r)&&!r.some((e=>"string"!=typeof e)))&&this.add(t),"number"==typeof n&&(this.typeSpeed=n),"function"==typeof i&&(this.onTyping=i),"function"==typeof o&&(this.onComplete=o),"function"==typeof a&&(this.onStart=a),"function"==typeof s&&(this.onStop=s)}add(e){e&&e.length&&e.forEach((e=>{if(rd.test(e)){const t=e.split("");this.strings.push(...t)}else{const t=e.match(cd)||e.split("");this.strings.push(...t)}}))}start(){this.isTyping||(this.isTyping=!0,this.onStart&&this.onStart(this.curArrayPos,this.curCharPos,this),this._next())}stop(){this.isTyping&&(this.isTyping=!1,clearTimeout(this.timer),this.onStop&&this.onStop(this.curArrayPos,this.curCharPos,this))}done(){var e;this.stop();let t=this.strings[this.curArrayPos].slice(this.curCharPos);t+=this.strings.slice(this.curArrayPos+1).join(""),this.curArrayPos=this.strings.length-1,this.curCharPos=(null==(e=this.strings[this.curArrayPos])?void 0:e.length)-1,this.onTyping&&this.onTyping(t,this.curArrayPos,this.curCharPos,this),this.strings=[]}_consume(){var e,t,n;if(!this.strings.length)return;if(this.curArrayPos>=this.strings.length)return this.isTyping=!1,void(null==(e=this.onComplete)||e.call(this,this));const i=null==(t=this.strings[this.curArrayPos])?void 0:t[this.curCharPos];i&&this.onTyping&&this.onTyping(i,this.curArrayPos,this.curCharPos,this),this.curCharPos<(null==(n=this.strings[this.curArrayPos])?void 0:n.length)-1?this.curCharPos++:(this.curArrayPos++,this.curCharPos=0)}_next(){this._consume(),this.timer=setTimeout((()=>{this._consume(),this.isTyping&&this._next()}),this.typeSpeed||this._dynamicSpeed())}_dynamicSpeed(){var e,t;let n=0;n+=((null==(e=this.strings[this.curArrayPos])?void 0:e.length)||0)-this.curCharPos-1;for(let o=this.curArrayPos+1;o<this.strings.length;o++)n+=(null==(t=this.strings[o])?void 0:t.length)||0;n<=0&&(n=10);const i=1500/n;return i>=150?150:i}}const ld=u(e.defineComponent({__name:"message-stream",props:{payload:{default:()=>({})},messageID:{default:""}},emits:["heightChanged"],setup(t,{emit:n}){const{ref:i,computed:o,withDefaults:a,defineProps:s,watch:r,onMounted:c,onUnmounted:u}=co,l=t,d=i(!0),h=i(!1),p=i(!1),g=i(""),f=i(""),m=i(!0),_=i(0),v=i(""),y=i(""),I=i(),M=n,C="undefined"!=typeof ResizeObserver,E=i("");let T,k=0,S=0;const D=new ud({onTyping:e=>{v.value+=e,y.value=jl(v.value)},onComplete(){h.value=!1}});r((()=>l.payload),((e,t)=>{var n;if(e===t)return;const i=gc(l.payload);if(f.value=Array.isArray(i.chunks)?i.chunks.join(""):i.chunks,m.value=1===i.isFinished,f.value.length>0&&(d.value=!1),Qr||e&&!t&&m.value)v.value=f.value,_.value=f.value.length,y.value=jl(v.value);else if(f.value.length>_.value){const e=null==(n=f.value)?void 0:n.slice(_.value);_.value=f.value.length,o=[e],h.value?D.add(o):(h.value=!0,D.add(o),D.start())}var o}),{deep:!0,immediate:!0});const b=e=>{if(e!==E.value||m.value)return;const t=zs.getMessageModel(e);if(t&&t.payload.data){const e=gc(t.payload.data),n=Array.isArray(e.chunks)?e.chunks.join(""):e.chunks;n!==v.value&&(v.value=n,_.value=n.length,y.value=jl(v.value)),n.length>0&&(d.value=!1),m.value=e.isFinished}};c((()=>{E.value=l.messageID,zs.watch(To.CUSTOM,{hackedMessageID:b}),C?(T=new ResizeObserver((e=>{for(let t of e)A(t.contentRect.height)})),T.observe(I.value)):Nc&&(T=setInterval((()=>{uni.createSelectorQuery().in(this).selectAll(".message-stream").boundingClientRect((e=>{if(e.length>=1){const t=e[e.length-1];A(t.height)}})).exec()}),100))})),u((()=>{zs.unwatch(To.CUSTOM,{hackedMessageID:b}),C?T&&(T.disconnect(),T=null):L()}));const A=e=>{k!==e?(k=e,M("heightChanged")):C||(S+=1,S>=80&&L())},L=()=>{clearInterval(T),k=0,S=0},R=()=>{p.value=!p.value,g.value=""},w=e=>{if(Xr||Zr){const t=e.target,n=e.target.tagName.toLowerCase();"img"!==n&&"image"!==n||(p.value=!0,g.value=t.src)}};return(t,n)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:"message-stream"},[e.unref(d)?(e.openBlock(),e.createElementBlock("span",{key:0,class:"blinking-cursor"},"|")):e.createCommentVNode("",!0),e.createElementVNode("pre",{ref_key:"preRef",ref:I,class:e.normalizeClass(["message-marked"]),innerHTML:e.unref(y),onClick:w},null,8,["innerHTML"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"markdown-image-previewer",onClick:R},[e.createElementVNode("img",{class:"markdown-image",src:e.unref(g)},null,8,["src"])])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-9cbcc60c"]]);const dd=u({props:{payload:{type:Object,default:()=>({content:{header:"",items:[]},status:0})}},emits:["input-click"],setup(e,{emit:t}){let n=!1;return{props:e,isClicked:n,listItemClick:e=>{e.content&&(t("input-click",e),n=!0)},isPC:Xr,TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"form-branch-container"},[o.props.payload.content.header?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["card-title-container",o.isPC?"card-title":"card-title-h5"])},e.toDisplayString(o.props.payload.content.header),3)):e.createCommentVNode("",!0),0!=o.props.payload.status||o.isClicked?e.createCommentVNode("",!0):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(o.props.payload.content.items,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["form-branch-item",t.content?"":"warning-item"]),onClick:e=>o.listItemClick(t)},e.toDisplayString(t.content||o.TUITranslateService.t("AIDesk.分支选项异常")),11,["onClick"])))),128))])}],["__scopeId","data-v-81fac529"]]),{computed:hd}=co;const pd=u({components:{BranchPc:dd},props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage","heightChanged"],setup:(e,{emit:t})=>({payload:hd((()=>e.payload)),handleContentListItemClick:e=>{t("sendMessage",{text:e.content})},handleFormSaveInputSubmit:e=>{t("sendMessage",{text:e})}}),mounted(){this.$emit("heightChanged")}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("BranchPc");return e.openBlock(),e.createElementBlock("div",{class:"message-form"},[e.createVNode(r,{payload:o.payload,onInputClick:o.handleContentListItemClick},null,8,["payload","onInputClick"])])}]]);const gd=u({props:{name:{type:String,default:""},isRequired:{type:Number,default:0}},setup(e){}},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"form-label"},[e.createTextVNode(e.toDisplayString(i.name)+" ",1),i.isRequired?(e.openBlock(),e.createElementBlock("div",{key:0,style:{color:"red"}},"  * ")):e.createCommentVNode("",!0)])}],["__scopeId","data-v-b38da16f"]]),{computed:fd,ref:md}=co;const _d=u({components:{LabelMobile:gd},props:{placeholder:{type:String,default:""},variableValue:{type:String,default:""},name:{type:String,default:""},isRequired:{type:Number,default:0},nodeStatus:{type:Number,default:0},validator:{type:Boolean,default:!1}},emits:["input-change"],setup(e,{emit:t}){const n=md("");0!=e.variableValue.length&&(n.value=e.variableValue);return{text:n,onInputChanged:()=>{t("input-change",{name:e.name,value:n.value})},props:e,TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("LabelMobile");return e.openBlock(),e.createElementBlock("div",{class:"form-input-box-mobile"},[e.createVNode(r,{name:i.name,"is-required":i.isRequired},null,8,["name","is-required"]),e.createElementVNode("div",{class:"form-input-line"},[e.withDirectives(e.createElementVNode("input",{class:"form-input-mobile","onUpdate:modelValue":n[0]||(n[0]=e=>o.text=e),placeholder:i.placeholder,onInput:n[1]||(n[1]=(...e)=>o.onInputChanged&&o.onInputChanged(...e))},null,40,["placeholder"]),[[e.vModelText,o.text]]),i.validator?(e.openBlock(),e.createElementBlock("div",{key:0,class:"validator-line"},e.toDisplayString(o.TUITranslateService.t("AIDesk.请填写必填项")),1)):e.createCommentVNode("",!0)])])}],["__scopeId","data-v-e52baf71"]]),vd="/assets/radio-uncheck.91f8c900.png",yd="/assets/radio-check.4ea41c38.png",{ref:Id}=co;const Md=u({components:{Label:gd,Icon:Lu},props:{chooseItemList:{type:Array,default:[]},name:{type:String,default:""},isRequired:{type:Number,default:0},validator:{type:Boolean,default:!1}},emits:["input-change"],setup(e,{emit:t}){const n=Id(""),i=Id("");return{onInputChanged:()=>{t("input-change",{name:e.name,value:n.value})},selectedOption:n,clickItem:i=>{n.value=e.chooseItemList[i],t("input-change",{name:e.name,value:n.value})},isUniFrameWork:tc,radioUncheckIcon:vd,radioCheckIcon:yd,changeSelectedIcon:e=>n.value===e?yd:vd,checkedIcon:i,TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Label");return e.openBlock(),e.createElementBlock("div",{class:"label-container"},[e.createElementVNode("div",null,[e.createVNode(r,{name:i.name,"is-required":i.isRequired},null,8,["name","is-required"])]),e.createElementVNode("div",{class:"radio-container"},[i.validator?(e.openBlock(),e.createElementBlock("div",{key:0,class:"validator-line"},e.toDisplayString(o.TUITranslateService.t("AIDesk.请填写必填项")),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.chooseItemList,((t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"form-radio-box-mobile",key:n},[e.createElementVNode("div",{class:"radio-container-uni",onClick:e=>o.clickItem(n)},[e.createElementVNode("div",{class:"radio-icon-uni"},[o.isUniFrameWork?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createElementVNode("image",{src:o.changeSelectedIcon(t),alt:"",style:{width:"20px",height:"20px","vertical-align":"middle"}},null,8,["src"])])):(e.openBlock(),e.createElementBlock("div",{key:1},[e.createElementVNode("img",{src:o.changeSelectedIcon(t),alt:"",style:{width:"20px",height:"20px","vertical-align":"middle"}},null,8,["src"])]))]),e.createElementVNode("div",{class:"radio-label-uni"},e.toDisplayString(t),1)],8,["onClick"])])))),128))])])}],["__scopeId","data-v-0f972b33"]]),Cd=u(e.defineComponent({__name:"index",props:{show:{type:Boolean,default:!1},modal:{type:Boolean,default:!0},height:{type:String,default:"fit-content"},closeByClickOutside:{type:Boolean,default:!0},borderRadius:{type:String,default:"0px"},title:{type:String,default:""},showHeaderCloseButton:{type:Boolean,default:!1},showFooterSubmitButton:{type:Boolean,default:!1},submitButtonContent:{type:String,default:()=>Ys.t("确定")}},emits:["onOpen","onClose","onSubmit"],setup(t,{emit:n}){const{ref:i,watch:o,nextTick:a}=co,s=t,r=n,c=i();o((()=>s.show),((e,t)=>{if(e!==t)switch(e){case!0:r("onOpen",c);break;case!1:r("onClose",c)}}));const u=()=>{(tc||Zr)&&r("onClose",c)},l=()=>{r("onSubmit"),u()};return(n,i)=>s.show?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createElementVNode("div",{class:e.normalizeClass(["bottom-popup",e.unref(tc)&&"bottom-popup-uni","bottom-popup-h5",s.modal&&"bottom-popup-modal"]),onClick:u},[e.createElementVNode("div",{ref_key:"dialogRef",ref:c,class:e.normalizeClass(["bottom-popup-main","bottom-popup-h5-main"]),style:e.normalizeStyle({height:s.height,borderTopLeftRadius:s.borderRadius,borderTopRightRadius:s.borderRadius}),onClick:i[0]||(i[0]=e.withModifiers((()=>{}),["stop"]))},[t.title||t.showHeaderCloseButton?(e.openBlock(),e.createElementBlock("div",{key:0,class:"header"},[t.title?(e.openBlock(),e.createElementBlock("div",{key:0,class:"header-title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0),t.showHeaderCloseButton?(e.openBlock(),e.createElementBlock("div",{key:1,class:"header-close",onClick:u},e.toDisplayString(e.unref(Ys).t("关闭")),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.renderSlot(n.$slots,"default",{},void 0,!0),t.showFooterSubmitButton?(e.openBlock(),e.createElementBlock("div",{key:1,class:"footer"},[e.createElementVNode("div",{class:"footer-submit",onClick:l},e.toDisplayString(t.submitButtonContent),1)])):e.createCommentVNode("",!0)],4)],2)])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-9b84d46c"]]),Ed=e.defineComponent({__name:"form-popup",props:{show:{type:Boolean,default:!1},title:{default:""}},emits:["onClose","onSubmit"],setup(t,{emit:n}){const i=t,o=n;function a(){o("onClose")}function s(){o("onSubmit")}return(t,n)=>(e.openBlock(),e.createBlock(e.unref(Cd),{class:"form-item-bottom-popup",show:i.show,title:i.title,borderRadius:"20px",onOnClose:a,onOnSubmit:s},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default")])),_:3},8,["show","title"]))}}),{ref:Td,onMounted:kd,computed:Sd}=co;const Dd=u({components:{Icon:Lu,InputMobile:_d,RadioMobile:Md,FormPopup:Ed,LabelMobile:gd},props:{payload:{type:Object,default:()=>({})}},options:{styleIsolation:"apply-shared"},emits:["sendMessage","showFormPopup"],setup(e,{emit:t}){const n=Td(!1),i=Td({}),o=Td(!1),a=Td(!1),s=Td(!0);kd((()=>{let t=e.payload.content.inputVariables??[];for(let e=0;e<t.length;e++){const n=t[e].name,o=t[e].variableValue;i.value[n]=o}}));const r=e=>(s.value=!1,1==o.value&&(null==i.value[e]||""==i.value[e])&&(s.value=!0,!0));return{props:e,iconForm:Yu,iconFormFilled:"/assets/icon_form_filled.97201783.png",showDialog:n,clickShowDialog:()=>{n.value=!0,t("showFormPopup",!0)},iconClose:"/assets/dialog-close.263c1aa9.png",checkValidator:r,finishSubmit:a,showValue:(e,t)=>null!=t&&""!=t?t:i.value[e],mapValue:i,isSubmit:o,handleInputChange:({name:e,value:t})=>{i.value[e]=t},handleSendForm:n=>{o.value=!0;let s=e.payload.content.inputVariables;for(let e=0;e<s.length;e++){let t=i.value[s[e].name];if(""!=t&&null!=t)s[e].variableValue=t;else if(1===s[e].isRequired&&r(s[e].name))return}const c={data:JSON.stringify({src:rc.MULTI_FORM,content:{inputVariables:s},customerServicePlugin:0})};t("sendMessage",c),a.value=!0,o.value=!1},closeDialog:()=>{n.value=!1,t("showFormPopup",!1)},isValid:e=>o.value&&(null==i.value[e]||""==i.value[e]||null==i.value[e]),TUITranslateService:Ys}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Icon"),c=e.resolveComponent("InputMobile"),u=e.resolveComponent("RadioMobile"),l=e.resolveComponent("FormPopup");return e.openBlock(),e.createElementBlock("div",null,[o.finishSubmit||0!=o.props.payload.nodeStatus?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"before-form"},[e.createVNode(r,{src:o.iconForm,width:"60px",height:"60px",style:{margin:"5px 4px"}},null,8,["src"]),e.createElementVNode("div",{class:"form-button",onClick:n[0]||(n[0]=(...e)=>o.clickShowDialog&&o.clickShowDialog(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.立即填写")),1)])),e.createElementVNode("div",{class:"edit-form"},[e.createElementVNode("div",{class:"edit-form-item"},[e.createVNode(l,{class:"form-item",show:o.showDialog,showHeaderCloseButton:!1,onOnClose:o.closeDialog,title:""},{default:e.withCtx((()=>[e.createElementVNode("div",{style:{height:"100%","overflow-y":"auto"}},[e.createElementVNode("div",{class:"dialog-title"},[e.createElementVNode("div",null,e.toDisplayString(o.props.payload.content.tip),1),e.createElementVNode("div",{onClick:n[1]||(n[1]=(...e)=>o.closeDialog&&o.closeDialog(...e))},[e.createVNode(r,{src:o.iconClose,width:"16px",height:"16px"},null,8,["src"])])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.props.payload.content.inputVariables,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n},[o.finishSubmit||0!=t.formType||0!=o.props.payload.nodeStatus?o.finishSubmit||1!=t.formType||0!=o.props.payload.nodeStatus?(e.openBlock(),e.createElementBlock("div",{key:2,class:"variable-value-container-mobile"},[e.createElementVNode("div",{style:{width:"70px"}},e.toDisplayString(t.name),1),e.createElementVNode("div",null,e.toDisplayString(""==t.variableValue||null==t.variableValue?o.mapValue[t.name]:t.variableValue),1)])):(e.openBlock(),e.createElementBlock("div",{key:1},[e.createVNode(u,{chooseItemList:t.chooseItemList,name:t.name,isRequired:t.isRequired,onInputChange:o.handleInputChange,validator:1==t.isRequired&&o.isValid(t.name)},null,8,["chooseItemList","name","isRequired","onInputChange","validator"])])):(e.openBlock(),e.createElementBlock("div",{key:0},[e.createVNode(c,{placeholder:t.placeholder,variableValue:t.variableValue,name:t.name,isRequired:t.isRequired,onInputChange:o.handleInputChange,validator:1==t.isRequired&&o.isValid(t.name)},null,8,["placeholder","variableValue","name","isRequired","onInputChange","validator"])]))])))),128)),o.finishSubmit||0!=o.props.payload.nodeStatus?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"button-container"},[e.createElementVNode("div",{class:"button",onClick:n[2]||(n[2]=(...e)=>o.handleSendForm&&o.handleSendForm(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.提交")),1)]))])])),_:1},8,["show","onOnClose"])])]),o.finishSubmit||0!=o.props.payload.nodeStatus?(e.openBlock(),e.createElementBlock("div",{key:1,class:"before-form"},[e.createElementVNode("div",{class:"icon-container"},[e.createVNode(r,{class:"form-icon",src:o.iconForm,width:"60px",height:"60px",style:{margin:"5px 4px"}},null,8,["src"]),o.finishSubmit||2==o.props.payload.nodeStatus?(e.openBlock(),e.createBlock(r,{key:0,class:"form-icon-check",width:"26px",height:"26px",src:o.iconFormFilled},null,8,["src"])):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:"form-button",onClick:n[3]||(n[3]=(...e)=>o.clickShowDialog&&o.clickShowDialog(...e))},e.toDisplayString(o.TUITranslateService.t("AIDesk.查看内容")),1)])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-3507ea0b"]]),{computed:bd}=co;const Ad=u({components:{FormMobile:Dd},props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage","showFormPopup"],setup:(e,{emit:t})=>({payloads:bd((()=>e.payload)),handleSendForm:e=>{t("sendMessage",e)},handleShowFormPopup:e=>{t("showFormPopup",e)}})},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("FormMobile");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(r,{payload:o.payloads,onSendMessage:o.handleSendForm,onShowFormPopup:o.handleShowFormPopup},null,8,["payload","onSendMessage","onShowFormPopup"])])}]]),Ld=u(e.defineComponent({__name:"message-concurrency-limit",setup:t=>(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-text-container"])},[e.createElementVNode("span",{class:"text"},e.toDisplayString(e.unref(Ys).t("AIDesk.并发限制")),1)]))}),[["__scopeId","data-v-dee16c8c"]]);const Rd=u({props:{payload:{type:Object,default:()=>({})}},setup:e=>({props:e})},[["render",function(t,n,i,o,a,s){return e.openBlock(),e.createElementBlock("div",{class:"message-order"},[e.createElementVNode("div",{class:"order-guide"},e.toDisplayString(o.props.payload.content.guide),1),e.createElementVNode("div",{class:"order-main"},[o.props.payload.content.pic?(e.openBlock(),e.createElementBlock("img",{key:0,class:"order-img",src:o.props.payload.content.pic},null,8,["src"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"order-information"},[e.createElementVNode("div",{class:"order-name"},e.toDisplayString(o.props.payload.content.name),1),e.createElementVNode("div",{class:"order-description"},e.toDisplayString(o.props.payload.content.desc),1)])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.props.payload.content.customField,(t=>(e.openBlock(),e.createElementBlock("div",{class:"order-custom"},[e.createElementVNode("div",{class:"order-field"},[e.createElementVNode("span",{class:"field-name"},e.toDisplayString(t.name),1),e.createElementVNode("span",{class:"field-value"},e.toDisplayString(t.value),1),e.createElementVNode("span",{class:"field-customer-value"},e.toDisplayString(t.customerValue),1)])])))),256))])}],["__scopeId","data-v-c330224a"]]),{computed:wd}=co;const Od=u({components:{MessageConcurrencyLimit:Ld,MessageBranch:Ku,MessageForm:Zu,MessageProductCard:nl,MessageRichText:sd,MessageIMRobotWelcome:tl,MessageStream:ld,MessageMultiBranch:pd,MessageMultiForm:Ad,MessageRating:Bu,MessageOrder:Rd},props:{message:{type:Object,default:()=>({})}},emits:["showFormPopup","heightChanged"],setup:(e,{emit:t})=>({payload:wd((()=>{var t,n;return e.message&&gc(null==(n=null==(t=e.message)?void 0:t.payload)?void 0:n.data)})),messageID:wd((()=>e.message.ID)),props:e,sendTextMessage:e=>{Js.sendTextMessage({payload:e})},CUSTOM_MESSAGE_SRC:rc,sendCustomMessage:e=>{Js.sendCustomMessage({payload:e})},handleShowFormPopup:e=>{t("showFormPopup",e)},onHeightChanged:()=>{t("heightChanged")}})},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("MessageBranch"),c=e.resolveComponent("MessageIMRobotWelcome"),u=e.resolveComponent("MessageForm"),l=e.resolveComponent("MessageProductCard"),d=e.resolveComponent("MessageRichText"),h=e.resolveComponent("MessageStream"),p=e.resolveComponent("MessageMultiBranch"),g=e.resolveComponent("MessageMultiForm"),f=e.resolveComponent("MessageRating"),m=e.resolveComponent("MessageConcurrencyLimit"),_=e.resolveComponent("MessageOrder");return e.openBlock(),e.createElementBlock("div",{class:"message-custom"},[e.createElementVNode("div",{class:"custom"},[o.payload.src===o.CUSTOM_MESSAGE_SRC.BRANCH||o.payload.src===o.CUSTOM_MESSAGE_SRC.BRANCH_NUMBER||o.payload.src===o.CUSTOM_MESSAGE_SRC.ROBOT_MSG&&"welcome_msg"!==o.payload.subtype?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createVNode(r,{payload:o.payload,onSendMessage:o.sendTextMessage,onHeightChanged:o.onHeightChanged},null,8,["payload","onSendMessage","onHeightChanged"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.ROBOT_MSG?(e.openBlock(),e.createElementBlock("div",{key:1},[e.createVNode(c,{payload:o.payload,onSendMessage:o.sendTextMessage},null,8,["payload","onSendMessage"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.FROM_INPUT?(e.openBlock(),e.createElementBlock("div",{key:2},[e.createVNode(u,{payload:o.payload,onSendMessage:o.sendTextMessage},null,8,["payload","onSendMessage"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.PRODUCT_CARD?(e.openBlock(),e.createElementBlock("div",{key:3},[e.createVNode(l,{payload:o.payload},null,8,["payload"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.RICH_TEXT?(e.openBlock(),e.createElementBlock("div",{key:4},[e.createVNode(d,{payload:o.payload},null,8,["payload"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.STREAM_TEXT?(e.openBlock(),e.createElementBlock("div",{key:5},[e.createVNode(h,{payload:o.payload,messageID:o.messageID,onHeightChanged:o.onHeightChanged},null,8,["payload","messageID","onHeightChanged"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.MULTI_BRANCH?(e.openBlock(),e.createElementBlock("div",{key:6},[e.createVNode(p,{payload:o.payload,onSendMessage:o.sendTextMessage,onHeightChanged:o.onHeightChanged},null,8,["payload","onSendMessage","onHeightChanged"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.MULTI_FORM&&"in"==i.message.flow?(e.openBlock(),e.createElementBlock("div",{key:7},[e.createVNode(g,{payload:o.payload,onSendMessage:o.sendCustomMessage,onShowFormPopup:o.handleShowFormPopup},null,8,["payload","onSendMessage","onShowFormPopup"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.MENU?(e.openBlock(),e.createElementBlock("div",{key:8},[e.createVNode(f,{message:o.props.message,onSendMessage:o.sendCustomMessage},null,8,["message","onSendMessage"])])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.CONCURRENCY_LIMIT?(e.openBlock(),e.createElementBlock("div",{key:9},[e.createVNode(m)])):e.createCommentVNode("",!0),o.payload.src===o.CUSTOM_MESSAGE_SRC.ORDER?(e.openBlock(),e.createElementBlock("div",{key:10},[e.createVNode(_,{payload:o.payload},null,8,["payload"])])):e.createCommentVNode("",!0)])])}]]),Nd=e.defineComponent({__name:"message-plugin-uniapp",props:{message:{default:()=>({})},blinkMessageIDList:{default:()=>[]}},emits:["resendMessage","handleToggleMessageItem","handleH5LongPress","showFormPopup","heightChanged"],setup(t,{emit:n}){const{computed:i}=co,o=t,a=n,s=i((()=>zs.getMessageModel(o.message.ID))),r=i((()=>{var e;e=s.value.payload.data,Oc&&gc(e).src===rc.STREAM_TEXT&&zs.update(To.CUSTOM,"hackedMessageID",o.message.ID);let t={pluginType:"",showStyle:""};return Su(s.value)&&(t={pluginType:"customer",showStyle:mc(s.value)?"":"bubble"}),t})),c=e=>{a("resendMessage",e)},u=(e,t,n=!1)=>{a("handleToggleMessageItem",e,t,n)},l=(e,t,n)=>{a("handleH5LongPress",e,t,n)},d=e=>{a("showFormPopup",e)},h=()=>{a("heightChanged")};return(t,n)=>(e.openBlock(),e.createBlock(Au,{message:o.message,showStyle:e.unref(r).showStyle,bubbleClassNameList:["room"===e.unref(r).pluginType?"message-bubble-room":""],onResendMessage:c,onHandleToggleMessageItem:u,onHandleH5LongPress:l},{messageBubble:e.withCtx((()=>["customer"===e.unref(r).pluginType?(e.openBlock(),e.createBlock(Od,{key:0,message:o.message,onShowFormPopup:d,onHeightChanged:h},null,8,["message"])):e.createCommentVNode("",!0)])),_:1},8,["message","showStyle","bubbleClassNameList"]))}}),Pd=u(Nd,[["__scopeId","data-v-f7a47393"]]),{ref:Ud,watchEffect:Gd,onMounted:xd,onUnmounted:Fd}=co;const Bd=u({components:{Icon:oc},setup(){const e=Ud([!1,!1,!1]),t=Ud(0);let n;return xd((()=>{n=setInterval((()=>{t.value<e.value.length?(e.value=e.value.map(((e,n)=>n===t.value||e)),t.value+=1):(e.value=e.value.map((()=>!1)),t.value=0)}),500)})),Fd((()=>{n&&clearInterval(n),n=null})),{icons:e,loading_message:"/assets/loading_message.5533086c.svg"}}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{class:"message-thinking"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.icons,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n},[t?(e.openBlock(),e.createBlock(r,{key:0,file:o.loading_message,width:"14px",height:"14px"},null,8,["file"])):e.createCommentVNode("",!0)])))),128))])}],["__scopeId","data-v-88f8d393"]]),Vd=e.defineComponent({__name:"index",emits:["scrollToLatestMessage"],setup(t,{expose:n,emit:i}){const{ref:o,onMounted:a,onUnmounted:s,computed:r,watch:c}=co,u=i,l=o([]),d=o(""),h=o(0),p=o(0),g=o(!1),f=o(!1),m=o(!1),_=r((()=>p.value?`${p.value}${Ys.t("TUIChat.条新消息")}`:Ys.t("TUIChat.回到最新位置")));function v(e){var t,n;l.value=e||[];const i=null==(n=l.value)?void 0:n[(null==(t=l.value)?void 0:t.length)-1];f.value=!!(i&&!(null==i?void 0:i._message._onlineOnlyFlag)&&(null==i?void 0:i.time)<(null==h?void 0:h.value))}function y(e){Array.isArray(e)&&m.value&&e.forEach((e=>{!e||e.conversationID!==d.value||e.isDeleted||e.isRevoked||function(e){var t,n;return"user_typing_status"===(null==(n=gc(null==(t=e.payload)?void 0:t.data))?void 0:n.businessID)}(e)||e._message._onlineOnlyFlag||(p.value+=1)}))}function I(e){var t;(null==e?void 0:e.conversationID)!==d.value&&M(),d.value=(null==e?void 0:e.conversationID)||"",h.value=(null==(t=null==e?void 0:e.lastMessage)?void 0:t.lastTime)||0}function M(){p.value=0}function C(){void 0!==zs.getData(To.CHAT,"messageSource")&&zs.update(To.CHAT,"messageSource",void 0),M(),u("scrollToLatestMessage")}return c((()=>[g.value,f.value]),(()=>{m.value=g.value||f.value,m.value||M()}),{immediate:!0}),a((()=>{zs.watch(To.CHAT,{messageList:v,newMessageList:y}),zs.watch(To.CONV,{currentConversation:I})})),s((()=>{zs.unwatch(To.CHAT,{messageList:v,newMessageList:y}),zs.unwatch(To.CONV,{currentConversation:I})})),n({judgeScrollOverOneScreen:async function(e){var t,n,i,o,a;if(e.target)try{const{height:s}=await Yr(`#${null==(t=e.target)?void 0:t.id}`,"messageList")||{},r=(null==(n=e.target)?void 0:n.scrollHeight)||(null==(i=e.detail)?void 0:i.scrollHeight);if(r-((null==(o=e.target)?void 0:o.scrollTop)||(null==(a=e.detail)?void 0:a.scrollTop)||0)>2*s)return void(g.value=!0);g.value=!1}catch(s){g.value=!1}},isScrollButtonVisible:m,hideScrollButton:function(){m.value&&(m.value=!1,M())}}),(t,n)=>e.unref(m)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"scroll-button",onClick:C},[e.createVNode(oc,{width:"10px",height:"10px",file:e.unref("/assets/double-arrow.a1a15b8b.svg")},null,8,["file"]),e.createElementVNode("div",{class:"scroll-button-text"},e.toDisplayString(e.unref(_)),1)])):e.createCommentVNode("",!0)}}),qd=u(Vd,[["__scopeId","data-v-0c42fb78"]]);function Hd(e){return e.type===Ks.TYPES.MSG_CUSTOM&&Su(e)}const Kd=u(e.defineComponent({__name:"index",props:{show:{type:Boolean,default:!1},isHeaderShow:{type:Boolean,default:!0},isFooterShow:{type:Boolean,default:!0},background:{type:Boolean,default:!0},title:{type:String,default:""},center:{type:Boolean,default:!1}},emits:["update:show","submit"],setup(t,{emit:n}){const{ref:i,watchEffect:o}=co,a="outside",s="inside",r=t,c=i(!1),u=i(!0),l=i(!0),d=i(!0),h=i("");o((()=>{c.value=r.show,h.value=r.title,u.value=r.isHeaderShow,l.value=r.isFooterShow,d.value=r.background}));const p=n,g=e=>{e===a&&f()},f=()=>{c.value=!c.value,p("update:show",c.value)},m=()=>{p("submit"),f()};return(n,i)=>e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["dialog",["dialog-h5",t.center?"center":""]]),onClick:i[1]||(i[1]=e.withModifiers((e=>g(a)),["stop","prevent"]))},[e.createElementVNode("main",{class:e.normalizeClass(["dialog-main",[e.unref(d)?"":"dialog-main-back"]]),onClick:i[0]||(i[0]=e.withModifiers((e=>g(s)),["stop","prevent"]))},[e.unref(u)?(e.openBlock(),e.createElementBlock("header",{key:0,class:"dialog-main-header"},[e.createElementVNode("h1",{class:"dialog-main-title"},e.toDisplayString(e.unref(h)),1),e.createElementVNode("i",{class:"icon icon-close",onClick:f})])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["dialog-main-content",[e.unref(tc)&&e.unref(Zr)?"dialog-main-content-uniapp":""]])},[e.renderSlot(n.$slots,"default",{},void 0,!0)],2),e.unref(l)?(e.openBlock(),e.createElementBlock("footer",{key:1,class:"dialog-main-footer"},[e.createElementVNode("button",{class:"btn btn-cancel",onClick:f},e.toDisplayString(e.unref(Ys).t("取消")),1),e.createElementVNode("button",{class:"btn btn-default",onClick:m},e.toDisplayString(e.unref(Ys).t("确定")),1)])):e.createCommentVNode("",!0)],2)],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-b04e57a3"]]),zd=u(e.defineComponent({__name:"index",props:{visible:{type:Boolean,default:!0},zIndex:{default:9999},useMask:{type:Boolean,default:!0},maskColor:{default:"rgba(0, 0, 0, 0.6)"},isFullScreen:{type:Boolean,default:!0},width:{default:"auto"},height:{default:"auto"}},emits:["onOverlayClick"],setup(t,{expose:n,emit:i}){const{ref:o,watch:a,withDefaults:s}=co,r=i,c=t,u=o(),l=o(c.visible);function d(){r("onOverlayClick")}return a((()=>c.visible),(e=>{e?l.value=!0:setTimeout((()=>{l.value=!1}),150)}),{immediate:!0}),n({overlayDomRef:u}),(t,n)=>e.unref(l)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"overlayDomRef",ref:u,class:"overlay-container",style:e.normalizeStyle({position:c.isFullScreen?"fixed":"absolute",zIndex:c.zIndex})},[c.useMask?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"overlay-mask":!0,"fade-in":c.visible}),style:e.normalizeStyle({backgroundColor:c.maskColor}),onClick:d,onTouchstart:e.withModifiers(d,["prevent","stop"])},null,38)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass({"overlay-content":!0,"full-screen":c.isFullScreen})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2)],4)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-43d666ce"]]),Yd=e.defineComponent({__name:"index",props:{visible:{type:Boolean,default:!0},popDirection:{default:"bottom"},useMask:{type:Boolean,default:!0},isFullScreen:{type:Boolean,default:!0},overlayColor:{},drawerStyle:{default:()=>({})}},emits:["onOverlayClick"],setup(t,{expose:n,emit:i}){var o;const{ref:a,watch:s}=co,r=i,c=t,u=a(),l=a(),d=a(!1),h=a(c.drawerStyle[c.popDirection]||{});function p(e){r("onOverlayClick",e)}return s((()=>c.visible),(e=>{e?d.value=!0:setTimeout((()=>{d.value=!1}),150)}),{immediate:!0}),n({drawerDomRef:u,overlayDomRef:null==(o=l.value)?void 0:o.overlayDomRef}),(t,n)=>(e.openBlock(),e.createBlock(zd,{ref_key:"overlayDomInstanceRef",ref:l,visible:c.visible,useMask:c.useMask,maskColor:c.overlayColor,isFullScreen:c.isFullScreen,onOnOverlayClick:p},{default:e.withCtx((()=>[e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"drawerDomRef",ref:u,class:e.normalizeClass({drawer:!0,"origin-bottom":"bottom"===c.popDirection,"origin-right":"right"===c.popDirection,"slide-bottom":t.visible&&"bottom"===c.popDirection,"slide-right":t.visible&&"right"===c.popDirection}),style:e.normalizeStyle({minHeight:e.unref(h).minHeight,maxHeight:e.unref(h).maxHeight,borderRadius:e.unref(h).borderRadius,boxShadow:e.unref(h).boxShadow,width:e.unref(h).width})},[e.createElementVNode("div",{class:"drawer-container"},[e.renderSlot(t.$slots,"default",{},void 0,!0)])],6)):e.createCommentVNode("",!0)])),_:3},8,["visible","useMask","maskColor","isFullScreen"]))}}),$d=u(Yd,[["__scopeId","data-v-1760599f"]]),Wd=u(e.defineComponent({__name:"index",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},setup(t){const n=t;return(t,i)=>(e.openBlock(),e.createElementBlock("div",{class:"progress-message"},[e.renderSlot(t.$slots,"default",{},void 0,!0),"unSend"===n.messageItem.status&&n.messageItem.progress<1?(e.openBlock(),e.createElementBlock("div",{key:0,class:"progress-container"},[e.createElementVNode("progress",{activeColor:"#006EFF",class:"progress-common",percent:Math.round(100*n.messageItem.progress)},null,8,["percent"])])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-7704b30a"]]),Jd=class e{constructor(){__publicField(this,"chatStorage",null)}static getInstance(){return e.instance||(e.instance=new e),e.instance}getChatStorage(e){if(this.chatStorage||(this.chatStorage=this.getChatStorageFromLocalStorage()),e)return this.chatStorage[e];throw new Error("No key provided")}setChatStorage(t,n){this.chatStorage||(this.chatStorage=this.getChatStorageFromLocalStorage()),this.chatStorage[t]=n;try{tc?Or.setStorageSync(e.CHAT_STORAGE_KEY,JSON.stringify(this.chatStorage)):localStorage.setItem(e.CHAT_STORAGE_KEY,JSON.stringify(this.chatStorage))}catch(i){throw new Error("Fail to set chat storage")}}getChatStorageFromLocalStorage(){let t="";if(t=tc?Or.getStorageSync(e.CHAT_STORAGE_KEY)||"":localStorage.getItem(e.CHAT_STORAGE_KEY)||"",!t)return{};try{this.chatStorage=JSON.parse(t)}catch(n){this.chatStorage={}}return this.chatStorage}};__publicField(Jd,"instance",null),__publicField(Jd,"CHAT_STORAGE_KEY","TUI_CHAT_STORAGE");const Xd=Jd.getInstance(),Zd=e.defineComponent({__name:"index-uniapp",emits:["closeInputToolBar","handleEditor","showFormPopup"],setup(t,{expose:n,emit:i}){var o;const{ref:a,nextTick:s,onMounted:r,onUnmounted:u,getCurrentInstance:l}=co,d=i;let h=0,p=null;const g=new Set,f=(null==(o=l())?void 0:o.proxy)||l(),m=a([]),_=a(!1),v=a(""),y=a(""),I=a(5e3),M=a(Ks.TYPES),C=a(!1),E=a(!1),T=a([]),k=a(),S=a(),D=a(""),b=a(!1),A=a(),L=a({}),R=a(""),w=a(!1),O=a(),N=()=>{I.value+=300;const e=setTimeout((()=>{I.value+=1,clearTimeout(e)}),300)},P=e=>{v.value=e,Object.keys(L.value).length>0&&Xd.setChatStorage("audioPlayedMapping",L.value)};r((()=>{L.value=Xd.getChatStorage("audioPlayedMapping")||{},zs.watch(To.CONV,{currentConversationID:P}),zs.watch(To.CHAT,{messageList:F,messageSource:V,isCompleted:q,newMessageList:x}),function(e,t){zr.set(e,t)}("messageList",f),uni.$on("scroll-to-bottom",B)})),u((()=>{zs.unwatch(To.CHAT,{messageList:F,messageSource:V,isCompleted:q,newMessageList:x}),zs.unwatch(To.CONV,{currentConversationID:P}),null==p||p.disconnect(),p=null,uni.$off("scroll-to-bottom"),Object.keys(L.value).length>0&&Xd.setChatStorage("audioPlayedMapping",L.value)}));const U=br.throttle((function(e){var t;null==(t=S.value)||t.judgeScrollOverOneScreen(e)}),500,{leading:!0});function G(e,t){(null==t?void 0:t.newAudioSrc)&&(R.value=t.newAudioSrc)}function x(e){e.forEach((e=>{var t;if((null==e?void 0:e.type)===Ks.TYPES.MSG_CUSTOM){const n=gc(null==(t=null==e?void 0:e.payload)?void 0:t.data);(null==n?void 0:n.src)===rc.SEAT_STATUS?"updateSeatStatus"===(null==n?void 0:n.content.command)&&("inSeat"===n.content.content?zs.update(To.CUSTOM,"isInHumanService",!0):"outSeat"===n.content.content&&zs.update(To.CUSTOM,"isInHumanService",!1)):(null==n?void 0:n.src)===rc.TYPING_STATE&&(1===(null==n?void 0:n.typingStatus)?zs.update(To.CUSTOM,"isTyping",!0):zs.update(To.CUSTOM,"isTyping",!1))}}))}async function F(e){var t;Du(v.value)&&(null==p||p.disconnect(),m.value=e.filter((e=>fc(e)?(e=>{const t=1e3*e.time;return!(Date.now()-t>6e4)})(e):!e.isDeleted&&!mc(e))).map((e=>(e.vueForRenderKey=`${e.ID}`,e))),k.value?j(k.value):C.value||(null==(t=S.value)?void 0:t.isScrollButtonVisible)&&"in"===(null==newLastMessage?void 0:newLastMessage.flow)||s((()=>{N()})),Lc()&&s((()=>async function(){if(!m.value||0===m.value.length)return;null==p||p.disconnect(),p=uni.createIntersectionObserver(f,{threshold:[.7],observeAll:!0}).relativeTo("#messageScrollList",{top:-70}),null==p||p.observe(".message-li.in .message-bubble-container",(e=>{var t;if(g.has(e.id))return;const n=m.value.find((t=>e.id.indexOf(t.ID)>-1));n&&n.needReadReceipt&&"in"===n.flow&&!(null==(t=n.readReceiptInfo)?void 0:t.isPeerRead)&&(Js.sendMessageReadReceipt([n]),g.add(e.id))}))}())))}async function B(){var e;try{const{scrollHeight:e}=await $r("#messageScrollList","messageList");e?I.value===e?I.value=e+1:I.value=e:N()}catch(t){N()}null==(e=S.value)||e.hideScrollButton()}async function V(e){k.value=e,j(k.value)}function j(e){var t;(null==(t=m.value)?void 0:t.some((t=>(null==t?void 0:t.ID)===(null==e?void 0:e.ID))))&&s((async()=>{await async function(e){const t=e.ID,n=m.value&&m.value.some((e=>e.ID===t));if(t&&n){const e=setTimeout((async()=>{try{const n=await Yr("#messageScrollList","messageList"),i=await Yr("#tui-"+t,"messageList"),{scrollTop:o}=await $r("#messageScrollList","messageList");J(i.top+o-n.top-h++%2),clearTimeout(e)}catch(n){}}),500)}else su({message:Ys.t("TUIChat.无法定位到原消息"),type:iu})}(e),await W(null==e?void 0:e.ID),k.value=void 0}))}function q(e){_.value=e}const H=()=>{var e,t;C.value=!0;const n=(null==(t=null==(e=m.value)?void 0:e[0])?void 0:t.ID)||"";Js.getMessageList().then((()=>{s((()=>{D.value=n;const e=setTimeout((()=>{D.value="",C.value=!1,clearTimeout(e)}),500)}))}))},K=(e,t,n,i=!1)=>{i&&(E.value=!0),y.value=t.ID};let z;const Y=(e,t,n,i)=>{if(Zr)switch(i){case"touchstart":z=setTimeout(o,500);break;case"touchend":clearTimeout(z),setTimeout((()=>{E.value=!1}),200)}function o(){clearTimeout(z),K(0,t,0,!0)}},$=e=>{w.value=!0,O.value=e};function W(e){return new Promise((t=>{if(T.value.indexOf(e)<0){T.value.push(e);const n=setTimeout((()=>{T.value.splice(T.value.indexOf(e),1),clearTimeout(n),t()}),3e3)}}))}function J(e){I.value=e}function X(){d("closeInputToolBar")}function Z(e){A.value=e,b.value=!0}function Q(e){L.value[e]=!0}function ee(e){c("log","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/message-list/index-uniapp.vue:658","handleshowformpopup-messagelist",e),d("showFormPopup",e)}function te(){N()}return n({scrollToLatestMessage:B}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"tui-chat":!0,"tui-chat-h5":e.unref(tc)}),onClick:X},[e.createElementVNode("div",{class:"tui-chat-main"},[e.createElementVNode("scroll-view",{id:"messageScrollList",class:"tui-message-list","scroll-y":"true","scroll-top":e.unref(I),"scroll-into-view":`tui-${e.unref(D)}`,onScroll:n[1]||(n[1]=(...t)=>e.unref(U)&&e.unref(U)(...t))},[e.unref(m).length&&!e.unref(_)?(e.openBlock(),e.createElementBlock("p",{key:0,class:"message-more",onClick:H},e.toDisplayString(e.unref(Ys).t("TUIChat.查看更多")),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),((t,i)=>(e.openBlock(),e.createElementBlock("li",{id:`tui-${t.ID}`,key:t.vueForRenderKey,class:e.normalizeClass("message-li "+t.flow)},[e.createVNode(yu,{currTime:t.time,prevTime:i>0?e.unref(m)[i-1].time:0},null,8,["currTime","prevTime"]),e.createElementVNode("div",{class:"message-item",onClick:n[0]||(n[0]=e=>y.value="")},[t.isRevoked||e.unref(Hd)(t)?!t.isRevoked&&e.unref(Hd)(t)?(e.openBlock(),e.createBlock(Pd,{key:1,message:e.unref(Ac)(t),onResendMessage:$,onHandleToggleMessageItem:K,onHandleH5LongPress:Y,onShowFormPopup:ee,onHeightChanged:te},null,8,["message"])):(e.openBlock(),e.createBlock(Eu,{key:2,isEdit:t.type===e.unref(M).MSG_TEXT,messageItem:t,onMessageEdit:e=>{d("handleEditor",t,"reedit")}},null,8,["isEdit","messageItem","onMessageEdit"])):(e.openBlock(),e.createElementBlock("div",{key:0,id:`msg-bubble-${t.ID}`,class:"message-bubble-container"},[e.createVNode(_u,{messageItem:e.unref(Ac)(t),content:t.getMessageContent(),isAudioPlayed:e.unref(L)[t.ID],blinkMessageIDList:e.unref(T),onResendMessage:e=>$(t),onBlinkMessage:W,onScrollTo:J,onHandleToggleMessageItem:e=>K(0,t,0,!0),onHandleTouchStart:e=>Y(0,t,0,"touchstart"),onHandleTouchEnd:e=>Y(0,t,0,"touchend")},{default:e.withCtx((()=>[e.unref(fc)(t)?(e.openBlock(),e.createBlock(Bd,{key:0})):t.type===e.unref(M).MSG_TEXT?(e.openBlock(),e.createBlock(Qc,{key:1,content:t.getMessageContent()},null,8,["content"])):t.type===e.unref(M).MSG_IMAGE?(e.openBlock(),e.createBlock(Wd,{key:2,content:t.getMessageContent(),messageItem:e.unref(Ac)(t)},{default:e.withCtx((()=>[e.createVNode(tu,{content:t.getMessageContent(),messageItem:t,onPreviewImage:e=>(e=>{if(!m.value)return;const t=[],n=m.value.filter(((e,n)=>!e.isRevoked&&!e.hasRiskContent&&e.type===M.value.MSG_IMAGE&&(t.push(n),!0)));uni.previewImage({current:t.indexOf(e),urls:n.map((e=>{var t;return null==(t=e.payload.imageInfoArray)?void 0:t[2].url})),indicator:"number"})})(i)},null,8,["content","messageItem","onPreviewImage"])])),_:2},1032,["content","messageItem"])):t.type===e.unref(M).MSG_VIDEO?(e.openBlock(),e.createBlock(Wd,{key:3,content:t.getMessageContent(),messageItem:e.unref(Ac)(t)},{default:e.withCtx((()=>[e.createVNode(Iu,{content:t.getMessageContent(),messageItem:t},null,8,["content","messageItem"])])),_:2},1032,["content","messageItem"])):t.type===e.unref(M).MSG_AUDIO?(e.openBlock(),e.createBlock(uu,{key:4,content:t.getMessageContent(),messageItem:t,broadcastNewAudioSrc:e.unref(R),onSetAudioPlayed:Q,onGetGlobalAudioContext:G},null,8,["content","messageItem","broadcastNewAudioSrc"])):t.type===e.unref(M).MSG_MERGER?(e.openBlock(),e.createBlock(Jc,{key:5,renderData:t.payload,messageItem:t,onAssignMessageIDInUniapp:Z},null,8,["renderData","messageItem"])):t.type===e.unref(M).MSG_FILE?(e.openBlock(),e.createBlock(lu,{key:6,content:t.getMessageContent()},null,8,["content"])):t.type===e.unref(M).MSG_FACE?(e.openBlock(),e.createBlock(du,{key:7,content:t.getMessageContent()},null,8,["content"])):t.type===e.unref(M).MSG_LOCATION?(e.openBlock(),e.createBlock(vu,{key:8,content:t.getMessageContent()},null,8,["content"])):t.type===e.unref(M).MSG_CUSTOM?(e.openBlock(),e.createBlock(hu,{key:9,content:t.getMessageContent(),messageItem:t},null,8,["content","messageItem"])):e.createCommentVNode("",!0)])),_:2},1032,["messageItem","content","isAudioPlayed","blinkMessageIDList","onResendMessage","onHandleToggleMessageItem","onHandleTouchStart","onHandleTouchEnd"])],8,["id"])),t.ID===e.unref(y)?(e.openBlock(),e.createBlock(Cu,{key:3,class:e.normalizeClass({"message-tool":!0,"message-tool-out":"out"===t.flow,"message-tool-in":"in"===t.flow}),messageItem:t},null,8,["class","messageItem"])):e.createCommentVNode("",!0)])],10,["id"])))),128))],40,["scroll-top","scroll-into-view"]),e.createVNode(qd,{ref_key:"scrollButtonInstanceRef",ref:S,onScrollToLatestMessage:B},null,512),e.unref(w)?(e.openBlock(),e.createBlock(Kd,{key:0,show:e.unref(w),isH5:!0,center:!0,isHeaderShow:!1,onSubmit:n[2]||(n[2]=e=>(w.value=!w.value,void O.value.resendMessage())),"onUpdate:show":n[3]||(n[3]=e=>w.value=e)},{default:e.withCtx((()=>[e.createElementVNode("p",{class:"delDialog-title"},e.toDisplayString(e.unref(Ys).t("TUIChat.确认重发该消息？")),1)])),_:1},8,["show"])):e.createCommentVNode("",!0),e.createVNode($d,{visible:e.unref(b),overlayColor:"transparent",popDirection:"right"},{default:e.withCtx((()=>[e.createVNode(Zc,{style:{height:"100%"},isMounted:e.unref(b),messageID:e.unref(A),onCloseOverlay:n[4]||(n[4]=e=>b.value=!1)},null,8,["isMounted","messageID"])])),_:1},8,["visible"])])],2))}}),Qd=u(Zd,[["__scopeId","data-v-59061170"]]),eh=class e{constructor(){__publicField(this,"quoteMessageMap",new Map)}static getInstance(){return e.instance||(e.instance=new e),e.instance}setStore(e,t,n,i){var o,a;if(e&&(this.isEditorNotEmpty(t)||(null==(o=null==i?void 0:i.message)?void 0:o.ID))){let o={};(null==(a=null==i?void 0:i.message)?void 0:a.ID)&&(this.quoteMessageMap.set(i.message.ID,i.message),o={messageID:i.message.ID,type:i.type});const s={conversationID:e,draftInfo:{html:t,abstract:n,...o}};$s.setConversationDraft(s),zs.update(To.CHAT,"quoteMessage",{message:void 0,type:"quote"})}}getStore(e,t){const n=zs.getConversationModel(e);if(n){if(n.conversationID&&n.draftText){const e=gc(n.draftText);zs.update(To.CHAT,"quoteMessage",{message:this.quoteMessageMap.get(e.messageID)||void 0,type:e.type}),t(e.html)}$s.setConversationDraft({conversationID:n.conversationID})}}generateAbstract(e){let t="";return null==e||e.forEach((e=>{switch(e.type){case"text":t+=Yc(e.payload.text||"");break;case"image":t+=Ys.t("TUIChat.图片");break;case"video":t+=Ys.t("TUIChat.视频");break;case"file":t+=Ys.t("TUIChat.文件")}})),t}isEditorNotEmpty(e){return e&&!e.includes("is-empty")&&"<p></p>"!==e}};__publicField(eh,"instance",null);const th=eh.getInstance(),nh=async(e,t)=>{zs.getData(To.CHAT,"messageSource")&&zs.update(To.CHAT,"messageSource",void 0),null==e||e.forEach((async e=>{var n,i,o,a,s,r,u;try{const c={to:(null==(n=null==t?void 0:t.groupProfile)?void 0:n.groupID)||(null==(i=null==t?void 0:t.userProfile)?void 0:i.userID),conversationType:null==t?void 0:t.type,payload:{},needReadReceipt:Lc()};let l;const d={offlinePushInfo:{}};switch(null==e?void 0:e.type){case"text":if(l=JSON.parse(JSON.stringify(null==(o=e.payload)?void 0:o.text)),!l)break;c.payload={text:l},(null==(a=e.payload)?void 0:a.atUserList)?(c.payload.atUserList=e.payload.atUserList,await Js.sendTextAtMessage(c,d)):await Js.sendTextMessage(c,d);break;case"image":c.payload={file:null==(s=e.payload)?void 0:s.file},await Js.sendImageMessage(c,d);break;case"video":c.payload={file:null==(r=e.payload)?void 0:r.file},await Js.sendVideoMessage(c,d);break;case"file":c.payload={file:null==(u=e.payload)?void 0:u.file},await Js.sendFileMessage(c,d)}Mu("sendMessage")}catch(l){c("error","at pages-ai-desk/ai-desk-customer-uniapp/components/CustomerServiceChat/utils/sendMessage.ts:114",l),zs.getData(To.CHAT,"quoteMessage")&&zs.update(To.CHAT,"quoteMessage",{})}}))},ih=e.defineComponent({__name:"message-input-editor-uniapp",props:{placeholder:{type:String,default:""},replayOrReferenceMessage:{type:Object,default:()=>({}),required:!1},isMuted:{type:Boolean,default:!0},muteText:{type:String,default:""},enableInput:{type:Boolean,default:!0},enableTyping:{type:Boolean,default:!0}},emits:["onTyping","onFocus","isInputNotEmpty"],setup(t,{expose:n,emit:i}){const{ref:o,watch:a,onMounted:s,onUnmounted:r}=co,c=t,u=i,l=o(""),d=o(),h=o(!0),p=o(!0),g=o(),f=o(""),m=o();s((()=>{zs.watch(To.CONV,{currentConversation:T}),zs.watch(To.CHAT,{quoteMessage:k}),uni.$on("insert-emoji",(e=>{var t;l.value+=null==(t=null==e?void 0:e.emoji)?void 0:t.name,u("isInputNotEmpty",!0)})),uni.$on("send-message-in-emoji-picker",(()=>{_()}))})),r((()=>{f.value&&th.setStore(f.value,l.value,l.value,m.value),uni.$off("insertEmoji"),uni.$off("send-message-in-emoji-picker"),zs.unwatch(To.CONV,{currentConversation:T}),zs.unwatch(To.CHAT,{quoteMessage:k}),h.value=!0,g.value=null,f.value="",m.value=null,y()}));const _=()=>{const e=v();y(),nh(e,g.value)},v=()=>{let e=l.value;e=$c(e);return[{type:"text",payload:{text:e}}]},y=()=>{l.value="",p.value=!0,u("isInputNotEmpty",!1)},I=e=>{l.value=e},M=()=>{h.value=!0},C=e=>{var t;h.value=!1,u("onFocus",null==(t=null==e?void 0:e.detail)?void 0:t.height)},E=()=>{var e;p.value=!(null==(e=null==l?void 0:l.value)?void 0:e.length),u("isInputNotEmpty",!p.value)};function T(e){const t=f.value;g.value=e,f.value=null==e?void 0:e.conversationID,t!==f.value&&(t&&th.setStore(t,l.value,l.value,m.value),y(),f.value&&th.getStore(f.value,I))}function k(e){m.value=e}return a((()=>[p.value,h.value]),((e,t)=>{e!==t&&u("onTyping",p.value,h.value)}),{immediate:!0,deep:!0}),n({resetEditor:y,setEditorContent:I,getEditorContent:v}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-input-container":!0,"message-input-container-h5":!0})},[c.isMuted?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-input-mute"},e.toDisplayString(c.muteText),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",{id:"editor",ref_key:"inputRef",ref:d,"onUpdate:modelValue":n[0]||(n[0]=t=>e.isRef(l)?l.value=t:null),"adjust-position":!0,"cursor-spacing":"20","confirm-type":"send","confirm-hold":!0,type:"text",class:"message-input-area","auto-blur":"",onConfirm:_,onInput:E,onBlur:M,onFocus:C},null,544),[[e.vModelText,e.unref(l)]])]))}}),oh=u(ih,[["__scopeId","data-v-b78ec19b"]]),ah=e.defineComponent({__name:"message-input-audio-uniapp",props:{isEnableAudio:{type:Boolean,default:!1}},emits:["changeDisplayType"],setup(t,{emit:n}){const{ref:i,onMounted:o,onUnmounted:a}=co,s=n,r=t;let c,u=0,l=!1,d=-1,h=!1,p=!1;const g=null==Or?void 0:Or.getRecorderManager(),f=i(!1),m=i("按住说话"),_=i("正在录音"),v=i(!1),y=i(),I=i(!1),M={duration:6e4,sampleRate:44100,numberOfChannels:1,encodeBitRate:192e3,format:"mp3"};function C(){s("changeDisplayType",r.isEnableAudio?"editor":"audio")}function E(e){y.value=e}function T(){S(),k()}function k(){f.value=!1,m.value="按住说话",_.value="正在录音"}function S(e){clearInterval(c),c=void 0,u=0,d=-1,l=!1,(null==e?void 0:e.hasError)||g.stop()}function D(){h&&(p=!0)}function b(){h=!0,g.start(M)}o((()=>{g.onStart(R),g.onStop(w),g.onError(O),zs.watch(To.CONV,{currentConversation:E})})),a((()=>{zs.unwatch(To.CONV,{currentConversation:E})}));const A=br.throttle((function(e){if(f.value){const t=e.changedTouches[e.changedTouches.length-1].pageY;d<0&&(d=t);const n=d-t;n>110?(m.value="抬起取消",_.value="松开手指 取消发送",l=!0,I.value=!0):n>50?(m.value="抬起发送",_.value="继续上滑可取消",l=!1,I.value=!1):(m.value="抬起发送",_.value="正在录音",l=!1,I.value=!1)}}),100);function L(){h=!1,g.stop()}function R(){if(!h)return p=!0,void g.stop();c=setInterval((()=>{u+=1}),1e3),m.value="抬起发送",f.value=!0}function w(e){var t,n,i,o,a;if(p)return p=!1,void T();if(l||!f.value)return void T();clearInterval(c);const s=e.tempFilePath,r=e.duration?e.duration:1e3*u,d=e.fileSize?e.fileSize:48*u/8*1024;if(r<1e3)su({message:"录音时间太短",type:au,duration:1500});else{const e={to:(null==(n=null==(t=null==y?void 0:y.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(o=null==(i=null==y?void 0:y.value)?void 0:i.userProfile)?void 0:o.userID),conversationType:null==(a=null==y?void 0:y.value)?void 0:a.type,payload:{file:{duration:r,tempFilePath:s,fileSize:d}},needReadReceipt:Lc()};null==Js||Js.sendAudioMessage(e)}T()}function O(){S({hasError:!0}),k()}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-input-audio":!0,"message-input-audio-open":e.unref(v)})},[e.createElementVNode("div",{class:"audio-message-icon-container"},[e.createVNode(oc,{class:"audio-message-icon",file:r.isEnableAudio?e.unref("/assets/keyboard_icon.805d32e0.png"):e.unref("/assets/audio-blue.0f75fab8.png"),size:"23px",hotAreaSize:"3px",onOnClick:C},null,8,["file"])]),r.isEnableAudio?(e.openBlock(),e.createElementBlock("view",{key:0,class:"audio-input-touch-bar",onTouchstart:D,onLongpress:b,onTouchmove:n[0]||(n[0]=(...t)=>e.unref(A)&&e.unref(A)(...t)),onTouchend:L},[e.createElementVNode("span",null,e.toDisplayString(e.unref(Ys).t(`TUIChat.${e.unref(m)}`)),1),e.unref(f)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"record-container"},[e.createElementVNode("view",{class:"audio-bubble-blue"},[e.createVNode(oc,{file:e.unref(I)?e.unref("/assets/audio-bubble-red.a6dbf796.svg"):e.unref("/assets/audio-bubble-blue.d189d196.svg"),width:"160px",height:"74px"},null,8,["file"]),e.createElementVNode("view",{class:"loading"},[e.createElementVNode("view",{class:"line1"}),e.createElementVNode("view",{class:"line3"}),e.createElementVNode("view",{class:"line2"}),e.createElementVNode("view",{class:"line4"}),e.createElementVNode("view",{class:"line1"}),e.createElementVNode("view",{class:"line3"}),e.createElementVNode("view",{class:"line4"}),e.createElementVNode("view",{class:"line1"}),e.createElementVNode("view",{class:"line2"}),e.createElementVNode("view",{class:"line1"}),e.createElementVNode("view",{class:"line4"}),e.createElementVNode("view",{class:"line3"})])]),e.createElementVNode("view",{class:"modal-text"},e.toDisplayString(e.unref(Ys).t(`TUIChat.${e.unref(_)}`)),1),e.createVNode(oc,{class:"audio-delete-icon",file:e.unref(I)?e.unref("/assets/audio-delete.c78dd270.svg"):e.unref("/assets/audio-before-delete.3d34f0bf.svg"),width:"54px",height:"54px"},null,8,["file"]),e.createVNode(oc,{class:"audio-record-icon",width:"16px",height:"20px",file:e.unref(cu)},null,8,["file"]),e.createElementVNode("view",{class:"icon-container"})])):e.createCommentVNode("",!0)],32)):e.createCommentVNode("",!0)],2))}}),sh=u(ah,[["__scopeId","data-v-3412535c"]]),rh=u(e.defineComponent({__name:"index",props:{displayType:{default:"editor"}},setup(t){const{ref:n,computed:i,onMounted:o,onUnmounted:a}=co,s=t,r=Ks.TYPES,c=n();o((()=>{zs.watch(To.CHAT,{quoteMessage:d})})),a((()=>{zs.unwatch(To.CHAT,{quoteMessage:d})}));const u=i((()=>{var e,t;let n;switch(null==(e=c.value)?void 0:e.type){case r.MSG_TEXT:n=Yc(null==(t=c.value.payload)?void 0:t.text);break;case r.MSG_IMAGE:n=Ys.t("TUIChat.图片");break;case r.MSG_AUDIO:n=Ys.t("TUIChat.语音");break;case r.MSG_VIDEO:n=Ys.t("TUIChat.视频");break;case r.MSG_FILE:n=Ys.t("TUIChat.文件");break;case r.MSG_CUSTOM:n=Ys.t("TUIChat.自定义");break;case r.MSG_FACE:n=Ys.t("TUIChat.表情");break;case r.MSG_MERGER:n=Ys.t("TUIChat.聊天记录");break;default:n=Ys.t("TUIChat.消息")}return n}));function l(){zs.update(To.CHAT,"quoteMessage",{message:void 0,type:"quote"})}function d(e){(null==e?void 0:e.message)&&"quote"===(null==e?void 0:e.type)?c.value=e.message:c.value=void 0}return(t,n)=>Boolean(e.unref(c))&&"audio"!==s.displayType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"input-quote-container":!0,"input-quote-container-h5":e.unref(Zr)||e.unref(tc)})},[e.createElementVNode("div",{class:"input-quote-content-h5"},[e.createElementVNode("div",null,[e.createElementVNode("div",{class:"input-quote-sender-h5"},e.toDisplayString(e.unref(c).nick||e.unref(c).from),1),e.createElementVNode("div",{class:"max-one-line"},e.toDisplayString(e.unref(u)),1)]),e.createVNode(oc,{class:"input-quote-close-icon",file:e.unref("/assets/close-quote-icon.6181703e.svg"),width:"11px",height:"11px",onOnClick:l},null,8,["file"])])],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-07dc46cd"]]),ch=u(e.defineComponent({__name:"index-uniapp",props:{placeholder:{default:""},isMuted:{type:Boolean,default:!0},muteText:{default:""},enableInput:{type:Boolean,default:!0},enableTyping:{type:Boolean,default:!0},canSendAudio:{type:Boolean,default:!1},replyOrReference:{default:()=>({})},inputToolbarDisplayType:{default:"none"}},emits:["changeToolbarDisplayType","sendMessage"],setup(t,{expose:n,emit:i}){const{ref:o,watch:a,onMounted:s,onUnmounted:r}=co,c=i,u=t,l=o(),d=o(),h=o("editor"),p=o(!1);function g(e){h.value=e,"audio"===e&&c("changeToolbarDisplayType","none")}function f(e){c("changeToolbarDisplayType",e)}s((()=>{zs.watch(To.CONV,{currentConversation:v}),zs.watch(To.CHAT,{quoteMessage:y})})),r((()=>{zs.unwatch(To.CONV,{currentConversation:v}),zs.unwatch(To.CHAT,{quoteMessage:y})})),a((()=>u.inputToolbarDisplayType),(e=>{"none"!==e&&g("editor")}));const m=(e,t)=>{((e,t)=>{e||t?Js.leaveTypingState():Js.enterTypingState()})(e,t)},_=()=>{Zr&&c("changeToolbarDisplayType","none")};function v(e){d.value=e}function y(e){(null==e?void 0:e.message)&&"quote"===(null==e?void 0:e.type)&&g("editor")}const I=async()=>{var e,t;const n=null==(e=l.value)?void 0:e.getEditorContent();if(!n||!d.value)return;const i=n.map((e=>("text"===e.type&&(e.payload.text=$c(e.payload.text)),e)));await nh(i,d.value),null==(t=l.value)||t.resetEditor(),p.value=!1},M=e=>{p.value=e};return n({insertEmoji:e=>{var t,n;(null==(t=null==l?void 0:l.value)?void 0:t.addEmoji)&&(null==(n=null==l?void 0:l.value)||n.addEmoji(e)),p.value=!0},reEdit:e=>{var t,n;null==(t=null==l?void 0:l.value)||t.resetEditor(),p.value=!1,null==(n=null==l?void 0:l.value)||n.setEditorContent(e)}}),(t,n)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:"message-quote-uni-container"},[e.createVNode(rh,{style:{minWidth:0},displayType:e.unref(h)},null,8,["displayType"])]),e.createElementVNode("div",{class:e.normalizeClass(["message-input","message-input-h5"])},[e.createElementVNode("div",{class:"audio-main-content-line"},[e.unref(Qr)&&u.canSendAudio?(e.openBlock(),e.createBlock(sh,{key:0,class:e.normalizeClass({"message-input-wx-audio-open":"audio"===e.unref(h)}),isEnableAudio:"audio"===e.unref(h),onChangeDisplayType:g},null,8,["class","isEnableAudio"])):e.createCommentVNode("",!0),e.withDirectives(e.createVNode(oh,{ref_key:"editor",ref:l,class:"message-input-editor",placeholder:u.placeholder,isMuted:u.isMuted,muteText:u.muteText,enableInput:u.enableInput,enableTyping:u.enableTyping,onOnTyping:m,onOnFocus:_,onIsInputNotEmpty:M},null,8,["placeholder","isMuted","muteText","enableInput","enableTyping"]),[[e.vShow,"editor"===e.unref(h)]]),e.createElementVNode("div",{class:"icon-face-uniapp"},[e.createVNode(oc,{class:"icon icon-face",file:e.unref("/assets/emoji.40a1c90c.png"),size:"23px",hotAreaSize:"3px",onOnClick:n[0]||(n[0]=e=>f("emojiPicker"))},null,8,["file"])]),e.unref(p)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:1,class:"icon-tool-uniapp"},[e.createVNode(oc,{class:"icon icon-more",file:e.unref("/assets/more_tools.cb5342a1.png"),size:"23px",hotAreaSize:"3px",onOnClick:n[1]||(n[1]=e=>f("tools"))},null,8,["file"])])),e.unref(p)?(e.openBlock(),e.createElementBlock("div",{key:2,class:"send-button",onClick:I},[e.createVNode(oc,{file:e.unref("/assets/send-button.a3bf19cb.svg"),width:"35px",height:"35px"},null,8,["file"])])):e.createCommentVNode("",!0)])])]))}}),[["__scopeId","data-v-3f0e501b"]]),uh=u(e.defineComponent({__name:"index",props:{iconFile:{type:String,required:!0},title:{type:String,default:""},needDialog:{type:Boolean,default:!0},iconWidth:{type:String,default:"20px"},iconHeight:{type:String,default:"20px"},needBottomPopup:{type:Boolean,default:!1},isH5EmojiShow:{type:Boolean,default:!1},isH5Emoji:{type:Boolean,default:!1},isH5ToolShow:{type:Boolean,default:!1}},emits:["onIconClick","onDialogClose","onDialogShow"],setup(t,{expose:n,emit:i}){const{ref:o}=co,a=t,s=i,r=o(!1),c=o(),u=o(),l=()=>{s("onIconClick",u),a.needDialog&&d(!r.value)},d=e=>{if(r.value!==e)switch(r.value=e,e){case!0:s("onDialogShow",u);break;case!1:s("onDialogClose",u)}},h=()=>{r.value=!1};return n({toggleDialogDisplay:d}),(n,i)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"toolbarItemRef",ref:c,class:e.normalizeClass(["toolbar-item-container","toolbar-item-container-h5","toolbar-item-container-uni"])},[e.unref(Zr)&&!t.isH5Emoji&&t.isH5ToolShow||e.unref(tc)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["toolbar-item-container-icon","toolbar-item-container-uni-icon",e.unref(Zr)&&"toolbar-item-container-h5-icon"]),onClick:l},[e.createVNode(oc,{file:a.iconFile,class:"icon",width:a.iconWidth,height:a.iconHeight},null,8,["file","width","height"])],2)):e.createCommentVNode("",!0),e.unref(tc)||e.unref(Zr)&&!t.isH5Emoji&&t.isH5ToolShow?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["toolbar-item-container-uni-title"])},e.toDisplayString(a.title),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("div",{ref_key:"dialogRef",ref:u,class:e.normalizeClass(["toolbar-item-container-dialog","toolbar-item-container-h5-dialog","toolbar-item-container-uni-dialog"])},[a.needBottomPopup?(e.openBlock(),e.createBlock(Cd,{key:0,class:"toolbar-bottom-popup",show:e.unref(r)||t.isH5EmojiShow,onTouchmove:i[0]||(i[0]=e.withModifiers((()=>{}),["stop","prevent"])),onOnClose:h},{default:e.withCtx((()=>[e.renderSlot(n.$slots,"default",{},void 0,!0)])),_:3},8,["show"])):e.renderSlot(n.$slots,"default",{key:1},void 0,!0)],512),[[e.vShow,e.unref(r)||t.isH5EmojiShow]])],512))}}),[["__scopeId","data-v-929df81d"]]),lh="/assets/camera-uni.e7fd6e1a.png",dh=u(e.defineComponent({__name:"index",props:{imageSourceType:{type:String,default:"album"},isH5ToolShow:{type:Boolean,default:!1}},setup(t){const{ref:n,computed:i}=co,o=t;n();const a=n(),s={uni_album:{icon:"/assets/image-uni.3e951cbb.png",title:Ys.t("图片")},uni_camera:{icon:lh,title:Ys.t("拍照")}};zs.watch(To.CONV,{currentConversation:e=>{a.value=e}});const r=i((()=>"camera"===o.imageSourceType?s.uni_camera:s.uni_album)),c=()=>{Qr&&(null==Or?void 0:Or.chooseMedia)?null==Or||Or.chooseMedia({count:1,mediaType:["image","video"],sizeType:["original","compressed"],sourceType:[o.imageSourceType],success:function(e){"image"==e.tempFiles[0].fileType?u(e):"video"==e.tempFiles[0].fileType&&l(e)}}):null==Or||Or.chooseImage({count:1,sourceType:[o.imageSourceType],success:function(e){u(e)}})},u=e=>{var t,n,i,o,s;if(!e)return;const r={to:(null==(n=null==(t=null==a?void 0:a.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(o=null==(i=null==a?void 0:a.value)?void 0:i.userProfile)?void 0:o.userID),conversationType:null==(s=null==a?void 0:a.value)?void 0:s.type,payload:{file:e},needReadReceipt:Lc()};Js.sendImageMessage(r,{})},l=e=>{var t,n,i,o,s;if(!e)return;const r={to:(null==(n=null==(t=null==a?void 0:a.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(o=null==(i=null==a?void 0:a.value)?void 0:i.userProfile)?void 0:o.userID),conversationType:null==(s=null==a?void 0:a.value)?void 0:s.type,payload:{file:e},needReadReceipt:Lc()};Js.sendVideoMessage(r,{})};return(n,i)=>(e.openBlock(),e.createBlock(uh,{iconFile:e.unref(r).icon,title:e.unref(r).title,iconWidth:e.unref(tc)?"32px":"21px",iconHeight:e.unref(tc)?"25px":"18px",needDialog:!1,onOnIconClick:c,isH5ToolShow:t.isH5ToolShow},null,8,["iconFile","title","iconWidth","iconHeight","isH5ToolShow"]))}}),[["__scopeId","data-v-4cc23d33"]]),hh="/assets/video-uni.0b4d3e53.png",ph=e.defineComponent({__name:"index",props:{videoSourceType:{type:String,default:"album"}},setup(t){const{ref:n}=co,i=t,o=n(),a=n();zs.watch(To.CONV,{currentConversation:e=>{a.value=e}});const s=()=>{switch(i.videoSourceType){case"album":default:return hh;case"camera":return lh}},r=()=>{Qr&&(null==Or?void 0:Or.chooseMedia)?null==Or||Or.chooseMedia({mediaType:["video"],count:1,sourceType:[i.videoSourceType],maxDuration:60,success:function(e){u(e)}}):null==Or||Or.chooseVideo({count:1,sourceType:[i.videoSourceType],compressed:!1,success:function(e){u(e)}})},c=e=>{var t,n;(null==(n=null==(t=null==e?void 0:e.target)?void 0:t.files)?void 0:n.length)<=0||(u(null==e?void 0:e.target),e.target.value="")},u=e=>{var t,n,i,o,s;if(!e)return;const r={to:(null==(n=null==(t=null==a?void 0:a.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(o=null==(i=null==a?void 0:a.value)?void 0:i.userProfile)?void 0:o.userID),conversationType:null==(s=null==a?void 0:a.value)?void 0:s.type,payload:{file:e},needReadReceipt:Lc()};Js.sendVideoMessage(r,{})};return(t,n)=>(e.openBlock(),e.createBlock(uh,{iconFile:s(),title:"camera"===i.videoSourceType?Ys.t("录制"):Ys.t("视频"),needDialog:!1,iconWidth:e.unref(tc)?"32px":"21px",iconHeight:e.unref(tc)?"album"===i.videoSourceType?"20px":"25px":"18px",onOnIconClick:r},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(["video-upload","video-upload-h5"])},[e.createElementVNode("input",{ref_key:"inputRef",ref:o,title:e.unref(Ys).t("视频"),type:"file","data-type":"video",accept:"video/*",onChange:c},null,40,["title"])])])),_:1},8,["iconFile","title","iconWidth","iconHeight"]))}}),gh=u(ph,[["__scopeId","data-v-b4935e46"]]),fh=u(e.defineComponent({__name:"emoji-picker-dialog",emits:["insertEmoji","onClose","sendMessage"],setup(t,{emit:n}){var i;const{ref:o,onMounted:a,onUnmounted:s}=co,r=o(0),c=o(),u=o(),l=o(),d=o(Kc),h=o(null==d?void 0:d.value[0]),p=o(null==(i=null==d?void 0:d.value[0])?void 0:i.list);a((()=>{zs.watch(To.CONV,{currentConversation:m})})),s((()=>{zs.unwatch(To.CONV,{currentConversation:m})}));const g=(e,t)=>{var n,i,o,a,s;const r={to:(null==(i=null==(n=null==c?void 0:c.value)?void 0:n.groupProfile)?void 0:i.groupID)||(null==(a=null==(o=null==c?void 0:c.value)?void 0:o.userProfile)?void 0:a.userID),conversationType:null==(s=null==c?void 0:c.value)?void 0:s.type,payload:{index:t.emojiGroupID,data:t.list[e]},needReadReceipt:Lc()};Js.sendFaceMessage(r)};function f(){uni.$emit("send-message-in-emoji-picker")}function m(e){c.value=e}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"emojiPickerDialog",ref:u,class:e.normalizeClass({"emoji-picker":!0,"emoji-picker-h5":!0})},[e.createElementVNode("ul",{ref_key:"emojiPickerListRef",ref:l,class:e.normalizeClass(["emoji-picker-list","emoji-picker-h5-list"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"emoji-picker-list-item",onClick:e=>((e,t)=>{var n,i,o;const a={emoji:{key:e,name:zc(e)},type:null==(n=null==h?void 0:h.value)?void 0:n.type};switch(null==(i=null==h?void 0:h.value)?void 0:i.type){case dc.BASIC:a.url=(null==(o=null==h?void 0:h.value)?void 0:o.url)+Hc[e],uni.$emit("insert-emoji",a);break;case dc.BIG:case dc.CUSTOM:g(t,h.value)}})(t,n)},[e.unref(h).type===e.unref(dc).BASIC?(e.openBlock(),e.createElementBlock("img",{key:0,class:"emoji",src:e.unref(h).url+e.unref(Hc)[t]},null,8,["src"])):e.unref(h).type===e.unref(dc).BIG?(e.openBlock(),e.createElementBlock("img",{key:1,class:"emoji-big",src:e.unref(h).url+t+"@2x.png"},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:2,class:"emoji-custom emoji-big",src:e.unref(h).url+t},null,8,["src"]))],8,["onClick"])))),128))],512),e.createElementVNode("ul",{class:"emoji-picker-tab"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"emoji-picker-tab-item",onClick:e=>(e=>{var t;r.value=e,h.value=null==d?void 0:d.value[e],p.value=null==(t=null==d?void 0:d.value[e])?void 0:t.list})(n)},[t.type===e.unref(dc).BASIC?(e.openBlock(),e.createBlock(oc,{key:0,class:"icon",file:e.unref("/assets/face.78c88f77.png")},null,8,["file"])):t.type===e.unref(dc).BIG?(e.openBlock(),e.createElementBlock("img",{key:1,class:"icon-big",src:t.url+t.list[0]+"@2x.png"},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:2,class:"icon-custom icon-big",src:t.url+t.list[0]},null,8,["src"]))],8,["onClick"])))),128)),e.unref(tc)||e.unref(Zr)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"send-btn",onClick:f},e.toDisplayString(e.unref(Ys).t("发送")),1)):e.createCommentVNode("",!0)])],512))}}),[["__scopeId","data-v-ea666957"]]),mh=u(e.defineComponent({options:{styleIsolation:"shared"},__name:"index-uniapp",props:{displayType:{},isH5EmojiShow:{type:Boolean},isH5ToolShow:{type:Boolean}},setup(t){const{ref:n,onUnmounted:i,onMounted:o}=co,a=t,s=n(),r=n(!1),c=n(!1),u=e=>{var t;s.value=e,r.value=(null==(t=null==s?void 0:s.value)?void 0:t.type)===Ks.TYPES.CONV_GROUP};return o((()=>{zs.watch(To.CONV,{currentConversation:u})})),i((()=>{zs.unwatch(To.CONV,{currentConversation:u})})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-input-toolbar","message-input-toolbar-h5","message-input-toolbar-uni"])},["emojiPicker"===a.displayType?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createVNode(fh)])):(e.openBlock(),e.createElementBlock("div",{key:1},[e.createElementVNode("swiper",{class:e.normalizeClass(["message-input-toolbar-swiper"]),"indicator-dots":e.unref(c),autoplay:!1,circular:!1},[e.createElementVNode("swiper-item",{class:e.normalizeClass(["message-input-toolbar-list","message-input-toolbar-h5-list","message-input-toolbar-uni-list"])},[e.createVNode(dh,{imageSourceType:"camera"}),e.createVNode(dh,{imageSourceType:"album"}),e.unref(Qr)&&void 0!==e.unref(Or).chooseMedia?(e.openBlock(),e.createBlock(gh,{key:0,videoSourceType:"album"})):e.createCommentVNode("",!0),e.unref(Qr)&&void 0!==e.unref(Or).chooseMedia?(e.openBlock(),e.createBlock(gh,{key:1,videoSourceType:"camera"})):e.createCommentVNode("",!0)])],8,["indicator-dots"])]))]))}}),[["__scopeId","data-v-7b01ff21"]]),_h=u(e.defineComponent({__name:"toolbar-button-human-service",props:{title:{default:""},icon:{default:""}},setup(t){const{ref:n,onMounted:i,onUnmounted:o}=co,a=n(),s=t;i((()=>{zs.watch(To.CONV,{currentConversation:r})})),o((()=>{zs.unwatch(To.CONV,{currentConversation:r})}));const r=e=>{a.value=e},c=()=>{var e;Js.sendTextMessage({to:Uc(null==a?void 0:a.value),conversationType:null==(e=null==a?void 0:a.value)?void 0:e.type,payload:{text:Ys.t("AIDesk.转人工服务")},needReadReceipt:Lc()})};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["toolbar-button",e.unref(Zr)?"toolbar-button-h5":""]),onClick:c},[s.icon?(e.openBlock(),e.createBlock(oc,{key:0,class:"toolbar-button-icon",file:s.icon,width:"14px",height:"14px"},null,8,["file"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"toolbar-button-text"},e.toDisplayString(s.title||e.unref(Ys).t("AIDesk.转人工服务")),1)],2))}}),[["__scopeId","data-v-caaaee96"]]),vh=u(e.defineComponent({__name:"toolbar-button-service-rating",props:{title:{default:""},icon:{default:""}},setup(t){const{ref:n,onMounted:i,onUnmounted:o}=co,a=n(),s=t;i((()=>{zs.watch(To.CONV,{currentConversation:r})})),o((()=>{zs.unwatch(To.CONV,{currentConversation:r})}));const r=e=>{a.value=e},c=()=>{var e;Js.sendCustomMessage({to:Uc(null==a?void 0:a.value),conversationType:null==(e=null==a?void 0:a.value)?void 0:e.type,payload:{data:JSON.stringify({src:rc.USER_SATISFACTION,customerServicePlugin:0})},needReadReceipt:Lc()},{onlineUserOnly:!0})};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["toolbar-button",e.unref(Zr)?"toolbar-button-h5":""]),onClick:c},[s.icon?(e.openBlock(),e.createBlock(oc,{key:0,class:"toolbar-button-icon",file:s.icon,width:"14px",height:"14px"},null,8,["file"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"toolbar-button-text"},e.toDisplayString(s.title||e.unref(Ys).t("AIDesk.服务评价")),1)],2))}}),[["__scopeId","data-v-ac660e6e"]]),yh=u(e.defineComponent({__name:"toolbar-button-end-human-service",props:{title:{default:""},icon:{default:""}},setup(t){const{ref:n,onMounted:i,onUnmounted:o}=co,a=n(),s=t;i((()=>{zs.watch(To.CONV,{currentConversation:r})})),o((()=>{zs.unwatch(To.CONV,{currentConversation:r})}));const r=e=>{a.value=e},c=()=>{var e;Js.sendCustomMessage({to:Uc(null==a?void 0:a.value),conversationType:null==(e=null==a?void 0:a.value)?void 0:e.type,payload:{data:JSON.stringify({customerServicePlugin:0,src:rc.USER_END_SESSION})},needReadReceipt:Lc()},{onlineUserOnly:!0})};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["toolbar-button",e.unref(Zr)?"toolbar-button-h5":""]),onClick:c},[s.icon?(e.openBlock(),e.createBlock(oc,{key:0,class:"toolbar-button-icon",file:s.icon,width:"14px",height:"14px"},null,8,["file"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"toolbar-button-text"},e.toDisplayString(s.title||e.unref(Ys).t("AIDesk.结束人工会话")),1)],2))}}),[["__scopeId","data-v-32f9f476"]]),Ih=u(e.defineComponent({__name:"index",props:{toolbarButtonList:{default:()=>[]}},setup(t){const{ref:n,onMounted:i,onUnmounted:o}=co,a=t,s=n(!1),r=n();i((()=>{zs.watch(To.CONV,{currentConversation:c}),zs.watch(To.CUSTOM,{isInHumanService:u})})),o((()=>{zs.unwatch(To.CONV,{currentConversation:c}),zs.unwatch(To.CUSTOM,{isInHumanService:u})}));const c=e=>{r.value=e},u=e=>{s.value=e};function l(e){return 1===e.isEnabled||0!==e.isEnabled&&(!!e.renderCondition&&("function"==typeof e.renderCondition&&e.renderCondition()))}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"toolbar-button-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.toolbarButtonList,((t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[t.presetId===e.unref(pc).HUMAN_SERVICE&&l(t)&&!e.unref(s)?(e.openBlock(),e.createBlock(_h,{key:0,title:t.title,icon:t.icon},null,8,["title","icon"])):t.presetId===e.unref(pc).SERVICE_RATING&&l(t)&&e.unref(s)?(e.openBlock(),e.createBlock(vh,{key:1,title:t.title,icon:t.icon},null,8,["title","icon"])):t.presetId===e.unref(pc).END_HUMAN_SERVICE&&l(t)&&e.unref(s)?(e.openBlock(),e.createBlock(yh,{key:2,title:t.title,icon:t.icon},null,8,["title","icon"])):l(t)&&!t.presetId?(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["toolbar-button",e.unref(Zr)?"toolbar-button-h5":""]),onClick:e=>function(e,t){var n;1===e.type&&e.content?Js.sendTextMessage({to:Uc(null==r?void 0:r.value),conversationType:null==(n=null==r?void 0:r.value)?void 0:n.type,payload:{text:e.content},needReadReceipt:Lc()}):2===e.type&&e.content?Pc(e.content):void 0!==a.toolbarButtonList&&"function"==typeof a.toolbarButtonList[t].clickEvent&&a.toolbarButtonList[t].clickEvent()}(t,n)},[t.icon?(e.openBlock(),e.createBlock(oc,{key:0,class:"toolbar-button-icon",file:t.icon,width:"18px",height:"18px"},null,8,["file"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"toolbar-button-text"},e.toDisplayString(t.title),1)],10,["onClick"])):e.createCommentVNode("",!0)],64)))),256))]))}}),[["__scopeId","data-v-a22d6d87"]]),Mh={...{en:{"取消":"Cancel","确定":"Confirm","发送":"Send","系统通知":"System notification","关闭":"Close","图片":"Image","文件":"File","表情":"Emoji","视频":"Video","录制":"Record","拍照":"Take a photo",AIDesk:{"结束人工会话":"End human service","转人工服务":"Human service","跳转":"Goto","立即填写":"Fill now","已提交":"Submitted","提交":"Submit","查看内容":"View content","请填写必填项":"Please fill in the required fields","Hi，我是":"Hi, I'm ","请输入内容":"Please enter the content","如果满意请给好评哦～":"If you're satisfied, please give a good review~","请对本次服务进行评价":"Please rate this service","提交评价":"Feedback","服务评价":"Feedback","并发限制":"There are currently too many users accessing the service. Please try again later","分支选项异常":"Content is abnormal, please check the task flow configuration"},TUIChat:{"按Enter发送，Ctrl+Enter换行":"Press Enter to send a message and Ctrl+Enter to start a new line","表情":"[Face]","查看更多":"View more","撤回":"Recall","撤回了一条消息":" recalled a message","打开":"Open","单击下载":"Click download","下载":"Download","点此投诉":"Complain","点击处理":"Click action","对方正在输入":"Typing...","发起群视频":"Make group video call","发起群语音":"Make group voice call","发起通话":"Start Call","发送失败":"send failed","复制":"Copy","复制成功":"Copied to clipboard","该消息不存在":"The message does not exist","关闭阅读状态":"Read status closed","管理员开启全员禁言":"The admin enables Mute All","欢迎使用TUICallKit":"Welcome to TUICallKit","回到最新位置":"Back to the latest location","回复":"Reply","回复详情":"Replies","集成TUICallKit":" Integrate TUICallKit ","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"It is detected that you have not integrated TUI CallKit yet, so you cannot experience the audio and video call. ","结束群聊":"Edit Group Call","进行体验":"to experience.","经度":"Longitude","拒绝":"Reject","拒绝通话":"Decline Call","开通腾讯实时音视频服务":"Integration Tencent Real-Time Communication","聊天记录":"[Chat history]","描述":"Description","内容包含敏感词汇":"Content contains sensitive words","您":"You","您当前购买使用的套餐包暂未开通此功能":"The package you purchased does not support this ability.","您当前购买使用的套餐包暂未开通群消息已读回执功能":"The package you purchased does not support the read receipt of group messages.","您当前购买使用的套餐包暂未开通在线用户列表功能":"The package you purchased does not support the online user list.","您已被管理员禁言":"You have been muted by the admin","您有":"You have","请点击":"Please click","请输入消息":"Enter a message","取消":"Cancel","取消通话":"Cancel Call","全部已读":"All read","确定":"Submit","确认重发该消息？":"Confirm to resend the message?","人关闭阅读状态":" read status closed","人未读":" unread","人已读":" read","删除":"Delete","涉及敏感内容":"Sensitive content","申请加入":"Application for join in","视频":"[video]","视频通话":"Video Call","条回复":"replies","条入群申请":"Item group application","条新消息":" new messages","通话时长":"Duration","同意":"Agree","图片":"[Image]","图片消息失败,无效的图片格式":"Image message failed, invalid image format.","纬度":"Latitude","未读":"Unread","位置":"[Location]","文件":"[File]","文件不存在,请检查文件路径是否正确":"The file does not exist, please check if the file path is correct.","文件大小超出了限制,如果上传文件,最大限制是100MB":"The file size exceeds the limit; if uploading a file, the maximum limit is 100MB.","文件消息失败,禁止发送违规封禁的文件":"File message failed, sending prohibited and banned files is not allowed.","我":"I","无法查看":"unable to view","无法定位到原消息":"Unable to navigate to the original message","无法收听":"unable to listen","正在加载":"Loading...","加载结束":"Load end","无应答":"No Answer","系统消息":"System message","消息":"[message]","消息或者资料中文本存在敏感内容,发送失败":"Sensitive content found in the message or information text, sending failed.","消息详情":"Message Detail","消息长度超出限制,消息长度不要超过12K":"Message length exceeds the limit; please keep the message length under 12K.","消息中图片存在敏感内容,发送失败":" Sensitive content is found in the picture in the message, sending failed.","选择提醒的人":"Select Contact","已读":"Read","已过撤回时限":"Withdrawal deadline has passed","已接听":"Answered","已拒绝":"Rejected","已同意":"Approved","引用":"Reference","引用失败":"quote failed","语音":"[Voice]","语音通话":"Voice Call","重新编辑":"Re-edit","重新发送":"Resend","转发":"Forward","翻译":"Translate","转文字":"Convert","隐藏":"Hidden","转发给":"Forward to","自定义":"[custom message]","自定义消息":"Custom message","腾讯云 IM":"Tencent Cloud Chat","空":"Empty","文本包含本地审核拦截词":"Text contains local moderation blocking words","按住说话":"Hold to speak","抬起发送":"Release to send","抬起取消":"Release to cancel","正在录音":"Recording","继续上滑可取消":"Continue to swipe to cancel","松开手指 取消发送":"Release to cancel","此机型暂不支持复制功能":"This model does not support the copy","请开通翻译功能":"Please open the translation feature","请开通语音转文字功能":"Please open the convert feature","翻译中":"Translating","转换中":"Converting","由IM提供翻译支持":"support by IM","所有人":"All","已达到表情回应上限数量":"You have reached the max reaction limit","等":"and others","人":"users","返回":"Back","关闭":"Close","多选":"Select","合并转发":"Combine Forward","逐条转发":"One-By-One Forward","未选择消息":"No message selected","[草稿]":"[Drafts]","[消息]":"[Message]","[文本]":"[Text]","[自定义消息]":"[Custom Message]","[图片]":"[Image]","[音频]":"[Voice]","[语音]":"[Voice]","[视频]":"[Video]","[文件]":"[File]","[位置]":"[Location]","[地理位置]":"[Location]","[动画表情]":"[Animated Sticker]","[群提示]":"[Group Tip]","[群提示消息]":"[Group Notification]","[聊天记录]":"[Chat History]","[机器人自定义消息]":"[Robot Custom Message]","引用内容已撤回":"The quoted message has been withdrawn","群聊的聊天记录":"Chat history for Group Chat","和":"and","的聊天记录":"chat history","请升级IMSDK到v2.10.1或更高版本查看此消息":"Please upgrade IMSDK to v2.10.1 or higher to view this message","该群聊已被解散":"The group has been dismissed","您已被管理员移出群聊":"You have been removed from the group by the admin.","您已退出该群聊":"You have left the group.","您已被禁止聊天":"you have been forbidden to speak","账号被强制下线":"Account forcibly logged out","登录失败":"Login failed"},Component:{"图片 url 不存在":"Image url does not exist","暂不支持下载此类型图片":"Downloading this type of image is not currently supported","大图提取中":"Processing large image","已保存至相册":"Saved to album","图片下载失败":"Image download failed"},Time:{"周":"week(s) ","天":"day(s)","小时":"hour(s) ","分钟":"minute(s)","刚刚":"Just now","前":" ago","昨天":"Yesterday","星期一":"Monday","星期二":"Tuesday","星期三":"Wednesday","星期四":"Thursday","星期五":"Friday","星期六":"Saturday","星期日":"Sunday","一月":"January","二月":"February","三月":"March","四月":"April","五月":"May","六月":"June","七月":"July","八月":"August","九月":"September","十月":"October","十一月":"November","十二月":"December","一":"Mon","二":"Tues","三":"Wed","四":"Thur","五":"Fri","六":"Sat","日":"Sun"},Emoji:Fc}},...{zh:{"取消":"取消","确定":"确定","发送":"发送","系统通知":"系统通知","关闭":"关闭","图片":"图片","文件":"文件","表情":"表情","视频":"视频","录制":"录制","拍照":"拍照",TUIChat:{"按Enter发送，Ctrl+Enter换行":"按Enter发送，Ctrl+Enter换行","表情":"[表情]","查看更多":"查看更多","撤回":"撤回","撤回了一条消息":"撤回了一条消息","打开":"打开","单击下载":"单击下载","下载":"下载","点此投诉":"点此投诉","点击处理":"点击处理","对方正在输入":"对方正在输入...","发起群视频":"发起群视频","发起群语音":"发起群语音","发起通话":"发起通话","发送失败":"发送失败","复制":"复制","复制成功":"文本复制成功","该消息不存在":"该消息不存在","关闭阅读状态":"关闭","管理员开启全员禁言":"管理员开启全员禁言","欢迎使用TUICallKit":"欢迎使用腾讯云音视频通话组件TUICallKit ","回到最新位置":"回到最新位置","回复":"回复","回复详情":"回复详情","集成TUICallKit":"集成 TUICallKit ","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"检测到您暂未集成TUICallKit，无法体验音视频通话功能。","结束群聊":"结束群聊","进行体验":"进行体验。","经度":"经度","拒绝":"拒绝","拒绝通话":"拒绝通话","开通腾讯实时音视频服务":"开通腾讯实时音视频服务","聊天记录":"[聊天记录]","描述":"描述","内容包含敏感词汇":"内容包含敏感词汇","您":"您","您当前购买使用的套餐包暂未开通此功能":"您当前购买使用的套餐包暂未开通此功能。","您当前购买使用的套餐包暂未开通群消息已读回执功能":"您当前购买使用的套餐包暂未开通【群消息已读回执】功能，请升级至旗舰版进行体验","您当前购买使用的套餐包暂未开通在线用户列表功能":"您当前购买使用的套餐包暂未开通【在线用户列表】功能，请升级至旗舰版进行体验","您已被管理员禁言":"您已被管理员禁言","您有":"您有","请点击":"请点击","请输入消息":"请输入消息","取消":"取消","取消通话":"取消通话","全部已读":"全部已读","确定":"确定","确认重发该消息？":"确认重发该消息？","人关闭阅读状态":"人关闭阅读状态","人未读":"人未读","人已读":"人已读","删除":"删除","涉及敏感内容":"涉及敏感内容","申请加入":"申请加入","视频":"[视频]","视频通话":"视频通话","条回复":"条回复","条入群申请":"条入群申请","条新消息":"条新消息","通话时长":"通话时长","同意":"同意","图片":"[图片]","图片消息失败,无效的图片格式":"图片消息失败,无效的图片格式","纬度":"纬度","未读":"未读","位置":"[位置]","文件":"[文件]","文件不存在,请检查文件路径是否正确":"文件不存在,请检查文件路径是否正确","文件大小超出了限制,如果上传文件,最大限制是100MB":"文件大小超出了限制,如果上传文件,最大限制是100MB","文件消息失败,禁止发送违规封禁的文件":"文件消息失败,禁止发送违规封禁的文件","我":"我","无法查看":"无法查看","无法定位到原消息":"无法定位到原消息","无法收听":"无法收听","正在加载":"正在加载...","加载结束":"加载结束","无应答":"无应答","系统消息":"系统消息","消息":"message","消息或者资料中文本存在敏感内容,发送失败":"消息或者资料中文本存在敏感内容,发送失败","消息详情":"消息详情","消息长度超出限制,消息长度不要超过12K":"消息长度超出限制,消息长度不要超过12K","消息中图片存在敏感内容,发送失败":"消息中图片存在敏感内容,发送失败","选择提醒的人":"选择提醒的人","已读":"已读","已过撤回时限":"已过撤回时限","已接听":"已接听","已拒绝":"已拒绝","已同意":"已同意","引用":"引用","引用失败":"引用失败","语音":"[语音]","语音通话":"语音通话","重新编辑":"重新编辑","重新发送":"重新发送","转发":"转发","翻译":"翻译","转文字":"转文字","隐藏":"隐藏","转发给":"转发给","自定义":"[自定义消息]","自定义消息":"自定义消息","腾讯云 IM":"腾讯云 IM","空":"空","文本包含本地审核拦截词":"文本包含本地审核拦截词","按住说话":"按住说话","抬起发送":"抬起发送","抬起取消":"抬起取消","正在录音":"正在录音","继续上滑可取消":"继续上滑可取消","松开手指 取消发送":"松开手指 取消发送","此机型暂不支持复制功能":"此机型暂不支持复制功能","请开通翻译功能":"请开通翻译功能","请开通语音转文字功能":"请开通语音转文字功能","翻译中":"翻译中","转换中":"转换中","由IM提供翻译支持":"由IM提供翻译支持","所有人":"所有人","已达到表情回应上限数量":"已达到表情回应上限数量","等":"等","人":"人","返回":"返回","关闭":"关闭","多选":"多选","合并转发":"合并转发","逐条转发":"逐条转发","未选择消息":"未选择消息","引用内容已撤回":"引用内容已撤回","[草稿]":"[草稿]","[消息]":"[消息]","[文本]":"[文本]","[自定义消息]":"[自定义消息]","[图片]":"[图片]","[音频]":"[音频]","[语音]":"[语音]","[视频]":"[视频]","[文件]":"[文件]","[位置]":"[地理位置]","[地理位置]":"[地理位置]","[动画表情]":"[动画表情]","[群提示]":"[群提示]","[群提示消息]":"[群提示消息]","[聊天记录]":"[聊天记录]","[机器人自定义消息]":"[机器人自定义消息]","群聊的聊天记录":"群聊的聊天记录","和":"和","的聊天记录":"的聊天记录","请升级IMSDK到v2.10.1或更高版本查看此消息":"请升级IMSDK到v2.10.1或更高版本查看此消息","您已被管理员移出群聊":"您已被管理员移出群聊","该群聊已被解散":"该群聊已被解散","您已退出该群聊":"您已退出该群聊","您已被禁止聊天":"您已被禁止聊天","账号被强制下线":"账号被强制下线","登录失败":"登录失败"},Component:{"图片 url 不存在":"图片 url 不存在","暂不支持下载此类型图片":"暂不支持下载此类型图片","大图提取中":"大图提取中","已保存至相册":"已保存至相册","图片下载失败":"图片下载失败"},Time:{"周":"周","天":"天","小时":"小时","分钟":"分钟","刚刚":"刚刚","前":"前","昨天":"昨天","星期一":"星期一","星期二":"星期二","星期三":"星期三","星期四":"星期四","星期五":"星期五","星期六":"星期六","星期日":"星期日","一月":"一月","二月":"二月","三月":"三月","四月":"四月","五月":"五月","六月":"六月","七月":"七月","八月":"八月","九月":"九月","十月":"十月","十一月":"十一月","十二月":"十二月","一":"一","二":"二","三":"三","四":"四","五":"五","六":"六","日":"日"},AIDesk:{"结束人工会话":"结束会话","转人工服务":"转人工服务","跳转":"跳转","立即填写":"立即填写","已提交":"已提交","提交":"提交","查看内容":"查看内容","请填写必填项":"请填写必填项","Hi，我是":"Hi，我是","请输入内容":"请输入内容","如果满意请给好评哦～":"如果满意请给好评哦～","请对本次服务进行评价":"请对本次服务进行评价","提交评价":"提交评价","服务评价":"服务评价","并发限制":"当前咨询人数较多，请稍后再试","分支选项异常":"内容异常，请检查任务流配置"},Emoji:xc}},...{zh_tw:{"取消":"取消","确定":"確定","发送":"發送","系统通知":"系統通知","关闭":"關閉","图片":"圖片","文件":"文件","表情":"表情","视频":"視頻","录制":"錄製","拍照":"拍照",AIDesk:{"结束人工会话":"結束會話","转人工服务":"轉人工服務","跳转":"跳轉","立即填写":"立即填寫","已提交":"已提交","提交":"提交","查看内容":"查看內容","请填写必填项":"請填寫必填項","Hi，我是":"Hi，我是","请输入内容":"請輸入內容","如果满意请给好评哦～":"如果滿意請給好評哦～","请对本次服务进行评价":"請對本次服務進行評價","提交评价":"提交評價","服务评价":"服務評價","并发限制":"目前諮詢人數較多，請稍後再試","分支选项异常":"內容異常，請檢查任務流配置"},TUIChat:{"按Enter发送，Ctrl+Enter换行":"按Enter發送，Ctrl+Enter換行","表情":"[表情]","查看更多":"查看更多","撤回":"撤回","撤回了一条消息":"撤回了一條消息","打开":"打開","单击下载":"單擊下載","下载":"下載","点此投诉":"點此投訴","点击处理":"點擊處理","对方正在输入":"對方正在輸入...","发起群视频":"發起群視頻","发起群语音":"發起群語音","发起通话":"發起通話","发送失败":"發送失敗","复制":"複製","复制成功":"文本複製成功","该消息不存在":"該消息不存在","关闭阅读状态":"關閉","管理员开启全员禁言":"管理員開啟全員禁言","欢迎使用TUICallKit":"歡迎使用騰訊雲音視頻通話組件TUICallKit","回到最新位置":"回到最新位置","回复":"回覆","回复详情":"回覆詳情","集成TUICallKit":"集成 TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"檢測到您暫未集成TUICallKit，無法體驗音視頻通話功能。","结束群聊":"結束群聊","进行体验":"進行體驗。","经度":"經度","拒绝":"拒絕","拒绝通话":"拒絕通話","开通腾讯实时音视频服务":"開通騰訊實時音視頻服務","聊天记录":"[聊天記錄]","描述":"描述","内容包含敏感词汇":"內容包含敏感詞彙","您":"您","您当前购买使用的套餐包暂未开通此功能":"您當前購買使用的套餐包暫未開通此功能。","您当前购买使用的套餐包暂未开通群消息已读回执功能":"您當前購買使用的套餐包暫未開通【群消息已讀回執】功能，請升級至旗艦版進行體驗","您当前购买使用的套餐包暂未开通在线用户列表功能":"您當前購買使用的套餐包暫未開通【在線用戶列表】功能，請升級至旗艦版進行體驗","您已被管理员禁言":"您已被管理員禁言","您有":"您有","请点击":"請點擊","请输入消息":"請輸入消息","取消":"取消","取消通话":"取消通話","全部已读":"全部已讀","确定":"確定","确认重发该消息？":"確認重發該消息？","人关闭阅读状态":"人關閉閱讀狀態","人未读":"人未讀","人已读":"人已讀","删除":"刪除","涉及敏感内容":"涉及敏感內容","申请加入":"申請加入","视频":"[視頻]","视频通话":"視頻通話","条回复":"條回覆","条入群申请":"條入群申請","条新消息":"條新消息","通话时长":"通話時長","同意":"同意","图片":"[圖片]","图片消息失败,无效的图片格式":"圖片消息失敗,無效的圖片格式","纬度":"緯度","未读":"未讀","位置":"[位置]","文件":"[文件]","文件不存在,请检查文件路径是否正确":"文件不存在,請檢查文件路徑是否正確","文件大小超出了限制,如果上传文件,最大限制是100MB":"文件大小超出了限制,如果上傳文件,最大限制是100MB","文件消息失败,禁止发送违规封禁的文件":"文件消息失敗,禁止發送違規封禁的文件","我":"我","无法查看":"無法查看","无法定位到原消息":"無法定位到原消息","无法收听":"無法收聽","正在加载":"正在加載...","加载结束":"加載結束","无应答":"無應答","系统消息":"系統消息","消息":"message","消息或者资料中文本存在敏感内容,发送失败":"消息或者資料中文本存在敏感內容,發送失敗","消息详情":"消息詳情","消息长度超出限制,消息长度不要超过12K":"消息長度超出限制,消息長度不要超過12K","消息中图片存在敏感内容,发送失败":"消息中圖片存在敏感內容,發送失敗","选择提醒的人":"選擇提醒的人","已读":"已讀","已过撤回时限":"已過撤回時限","已接听":"已接聽","已拒绝":"已拒絕","已同意":"已同意","引用":"引用","引用失败":"引用失敗","语音":"[語音]","语音通话":"語音通話","重新编辑":"重新編輯","重新发送":"重新發送","转发":"轉發","翻译":"翻譯","转文字":"轉文字","隐藏":"隱藏","转发给":"轉發給","自定义":"[自定義消息]","自定义消息":"自定義消息","腾讯云 IM":"騰訊雲 IM","空":"空","文本包含本地审核拦截词":"文本包含本地審核攔截詞","按住说话":"按住說話","抬起发送":"抬起發送","抬起取消":"抬起取消","正在录音":"正在錄音","继续上滑可取消":"繼續上滑可取消","松开手指 取消发送":"松開手指 取消發送","此机型暂不支持复制功能":"此機型暫不支持複製功能","请开通翻译功能":"請開通翻譯功能","请开通语音转文字功能":"請開通語音轉文字功能","翻译中":"翻譯中","转换中":"轉換中","由IM提供翻译支持":"由IM提供翻譯支持","所有人":"所有人","已达到表情回应上限数量":"已達到表情回應上限數量","等":"等","人":"人","返回":"返回","关闭":"關閉","多选":"多選","合并转发":"合併轉發","逐条转发":"逐條轉發","未选择消息":"未選擇消息","引用内容已撤回":"引用內容已撤回","[草稿]":"[草稿]","[消息]":"[消息]","[文本]":"[文本]","[自定义消息]":"[自定義消息]","[图片]":"[圖片]","[音频]":"[音頻]","[语音]":"[語音]","[视频]":"[視頻]","[文件]":"[文件]","[位置]":"[地理位置]","[地理位置]":"[地理位置]","[动画表情]":"[動畫表情]","[群提示]":"[群提示]","[群提示消息]":"[群提示消息]","[聊天记录]":"[聊天記錄]","[机器人自定义消息]":"[機器人自訂訊息]","群聊的聊天记录":"群聊的聊天記錄","和":"和","的聊天记录":"的聊天記錄","请升级IMSDK到v2.10.1或更高版本查看此消息":"請升級IMSDK到v2.10.1或更高版本查看此消息","您已被管理员移出群聊":"您已被管理員移出群聊","该群聊已被解散":"該群聊已被解散","您已退出该群聊":"您已退出該群聊","您已被禁止聊天":"您已被禁止聊天","账号被强制下线":"帳號被強制下線","登录失败":"登入失敗"},Component:{"图片 url 不存在":"圖片 url 不存在","暂不支持下载此类型图片":"暫不支持下載此類型圖片","大图提取中":"大圖提取中","已保存至相册":"已儲存至相簿","图片下载失败":"圖片下載失敗"},Time:{"周":"週","天":"天","小时":"小時","分钟":"分鐘","刚刚":"剛剛","前":"前","昨天":"昨天","星期一":"星期一","星期二":"星期二","星期三":"星期三","星期四":"星期四","星期五":"星期五","星期六":"星期六","星期日":"星期日","一月":"一月","二月":"二月","三月":"三月","四月":"四月","五月":"五月","六月":"六月","七月":"七月","八月":"八月","九月":"九月","十月":"十月","十一月":"十一月","十二月":"十二月","一":"一","二":"二","三":"三","四":"四","五":"五","六":"六","日":"日"},Emoji:{"[TUIEmoji_Smile]":"[微笑]","[TUIEmoji_Expect]":"[期待]","[TUIEmoji_Blink]":"[眨眼]","[TUIEmoji_Guffaw]":"[大笑]","[TUIEmoji_KindSmile]":"[姨母笑]","[TUIEmoji_Haha]":"[哈哈哈]","[TUIEmoji_Cheerful]":"[愉快]","[TUIEmoji_Speechless]":"[無語]","[TUIEmoji_Amazed]":"[驚訝]","[TUIEmoji_Sorrow]":"[悲傷]","[TUIEmoji_Complacent]":"[得意]","[TUIEmoji_Silly]":"[傻了]","[TUIEmoji_Lustful]":"[色]","[TUIEmoji_Giggle]":"[憨笑]","[TUIEmoji_Kiss]":"[親親]","[TUIEmoji_Wail]":"[大哭]","[TUIEmoji_TearsLaugh]":"[哭笑]","[TUIEmoji_Trapped]":"[困]","[TUIEmoji_Mask]":"[口罩]","[TUIEmoji_Fear]":"[恐懼]","[TUIEmoji_BareTeeth]":"[齜牙]","[TUIEmoji_FlareUp]":"[發怒]","[TUIEmoji_Yawn]":"[打哈欠]","[TUIEmoji_Tact]":"[機智]","[TUIEmoji_Stareyes]":"[星星眼]","[TUIEmoji_ShutUp]":"[閉嘴]","[TUIEmoji_Sigh]":"[嘆氣]","[TUIEmoji_Hehe]":"[呵呵]","[TUIEmoji_Silent]":"[收聲]","[TUIEmoji_Surprised]":"[驚喜]","[TUIEmoji_Askance]":"[白眼]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[便便]","[TUIEmoji_Monster]":"[怪獸]","[TUIEmoji_Daemon]":"[惡魔]","[TUIEmoji_Rage]":"[惡魔怒]","[TUIEmoji_Fool]":"[衰]","[TUIEmoji_Pig]":"[豬]","[TUIEmoji_Cow]":"[牛]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[骷髏]","[TUIEmoji_Bombs]":"[炸彈]","[TUIEmoji_Coffee]":"[咖啡]","[TUIEmoji_Cake]":"[蛋糕]","[TUIEmoji_Beer]":"[啤酒]","[TUIEmoji_Flower]":"[花]","[TUIEmoji_Watermelon]":"[瓜]","[TUIEmoji_Rich]":"[壕]","[TUIEmoji_Heart]":"[愛心]","[TUIEmoji_Moon]":"[月亮]","[TUIEmoji_Sun]":"[太陽]","[TUIEmoji_Star]":"[星星]","[TUIEmoji_RedPacket]":"[紅包]","[TUIEmoji_Celebrate]":"[慶祝]","[TUIEmoji_Bless]":"[福]","[TUIEmoji_Fortune]":"[發]","[TUIEmoji_Convinced]":"[服]","[TUIEmoji_Prohibit]":"[禁]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[刀]","[TUIEmoji_Like]":"[讚]"}}},...{fil:{"取消":"Kanselahin","确定":"Kumpirmahin","发送":"Ipadala","系统通知":"Abiso ng Sistema","关闭":"Isara","图片":"Larawan","文件":"dokumento","表情":"Emoji","视频":"Bidyo","录制":"Magkuha ng audio","拍照":"Magkuha ng larawan",AIDesk:{"结束人工会话":"Tapusin ang Usapan","转人工服务":"Ilipat sa Serbisyo ng Tao","跳转":"Tumalon","立即填写":"Punan Agad","已提交":"Naisumite Na","提交":"Isumite","查看内容":"Tingnan ang Nilalaman","请填写必填项":"Mangyaring punan ang mga kinakailangang field","Hi，我是":"Hi, ako ","请输入内容":"Pakilagay ang nilalaman","如果满意请给好评哦～":"Kung nasiyahan ka, mangyaring magbigay ng magandang pagsusuri~","请对本次服务进行评价":"Mangyaring suriin ang serbisyong ito","提交评价":"Ipasa ang pagsusuri","服务评价":"Pagsusuri ng Serbisyo","并发限制":"Maraming tao ang naghahanap ng tulong ngayon, subukan muli mamaya.","分支选项异常":"Ang nilalaman ay abnormal, pakisuri ang configuration ng task flow"},TUIChat:{"撤回":"Bawiin","删除":"Tanggalin","复制":"Kopyahin","重新发送":"Ipadala Muli","转发":"I-forward","引用":"I-quote","打开":"Buksan","已读":"Nabasa Na","未读":"Hindi Pa Nabasa","人已读":"tao ang nakabasa","人未读":"tao ang hindi pa nakabasa","人关闭阅读状态":"tao ang nagsara ng estado ng pagbabasa","全部已读":"Lahat ay Nabasa Na","消息详情":"Detalye ng Mensahe","关闭阅读状态":"Isara ang Estado ng Pagbabasa","您":"Ikaw","撤回了一条消息":"binawi ang isang mensahe","重新编辑":"I-edit Muli","我":"Ako","自定义消息":"Pasadyang Mensahe","查看更多":"Tingnan ang Higit Pa","确认重发该消息？":"Kumpirmahin ang muling pagpapadala ng mensaheng ito?","取消":"Kanselahin","确定":"Kumpirmahin","转发给":"I-forward sa","请输入消息":"Pakilagay ang mensahe","描述":"Paglalarawan","经度":"Longhitud","纬度":"Latitud","图片":"[Larawan]","语音":"[Boses]","视频":"[Bidyo]","表情":"[Emoji]","文件":"[File]","自定义":"[Pasadyang Mensahe]","管理员开启全员禁言":"In-activate ng Administrator ang Pagkatahimik ng Lahat","您已被管理员禁言":"Ikaw ay pinatahimik ng Administrator","按Enter发送":"Pindutin ang Enter para Ipadala","单击下载":"I-click para I-download","下载":"download","该消息不存在":"Ang mensaheng ito ay hindi umiiral","无法定位到原消息":"Hindi mahanap ang orihinal na mensahe","对方正在输入":"Ang kabilang panig ay nagta-type...","回到最新位置":"Bumalik sa Pinakabagong Posisyon","条新消息":"bagong mensahe","点此投诉":"I-click dito para magreklamo","语音通话":"Voice Call","视频通话":"Video Call","发起群语音":"Simulan ang Group Voice Call","发起群视频":"Simulan ang Group Video Call","已接听":"Nasagot Na","拒绝通话":"Tinanggihan ang Tawag","无应答":"Walang Sagot","取消通话":"Kanselahin ang Tawag","发起通话":"Simulan ang Tawag","结束群聊":"Tapusin ang Group Chat","通话时长":"Tagal ng Tawag","欢迎使用TUICallKit":"Maligayang Pagdating sa Paggamit ng TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"Nadiskubre na hindi mo pa na-integrate ang TUICallKit, hindi mo magagamit ang mga tampok ng audio at video call.","请点击":"Paki-click","集成TUICallKit":"Integrate ang TUICallKit","开通腾讯实时音视频服务":"I-activate ang Tencent Real-time Audio at Video Service","进行体验":"para sa karanasan.","您当前购买使用的套餐包暂未开通此功能":"Ang kasalukuyang package na binili mo ay hindi pa na-activate ang tampok na ito.","系统消息":"Mensahe ng Sistema","转人工服务":"Ilipat sa Serbisyo ng Tao","点击处理":"Mag-click ng aksyon","发送失败":"Nabigo ang pagpapadala","复制成功":"Nakopya sa clipboard","回复":"Tumugon","回复详情":"Mga Tugon","拒绝":"Tanggihan","聊天记录":"[Kasaysayan ng Chat]","内容包含敏感词汇":"May sensitibong mga salita ang nilalaman","您当前购买使用的套餐包暂未开通群消息已读回执功能":"Ang package na binili mo ay hindi pa nagbubukas ng pagbabasa ng resibo ng mga mensahe sa grupo.","您当前购买使用的套餐包暂未开通在线用户列表功能":"Ang package na binili mo ay hindi pa nagbubukas ng listahan ng mga online na gumagamit.","您有":"Mayroon kang","涉及敏感内容":"May kaugnayan sa sensitibong nilalaman","申请加入":"Mag-apply para sumali","条回复":"mga tugon","条入群申请":"Mga aplikasyon para sumali sa grupo","同意":"Sumasang-ayon","图片消息失败,无效的图片格式":"Nabigo ang mensahe ng larawan, hindi wastong format ng larawan.","位置":"[Lokasyon]","文件不存在,请检查文件路径是否正确":"Hindi umiiral ang file, mangyaring suriin kung tama ang landas ng file.","文件大小超出了限制,如果上传文件,最大限制是100MB":"Lumampas sa limitasyon ang laki ng file, kung nag-upload ng file, ang maximum limitasyon ay 100MB.","文件消息失败,禁止发送违规封禁的文件":"Nabigo ang mensahe ng file, ipinagbabawal ang pagpapadala ng mga ipinagbabawal na file.","无法查看":"Hindi maaring tingnan","无法收听":"Hindi maaring pakinggan","正在加载":"Naglo-load...","加载结束":"Pag-load natapos","消息":"[mensahe]","消息或者资料中文本存在敏感内容,发送失败":"May sensitibong nilalaman sa teksto ng mensahe o impormasyon, nabigo ang pagpapadala.","消息长度超出限制,消息长度不要超过12K":"Lumampas sa limitasyon ang haba ng mensahe, huwag lampasang 12K.","消息中图片存在敏感内容,发送失败":"May sensitibong nilalaman sa larawan sa mensahe, nabigo ang pagpapadala.","选择提醒的人":"Pumili ng mga taong paalalahanan","已过撤回时限":"Lumampas na sa takdang oras ng pag-withdraw","已拒绝":"Tinanggihan na","已同意":"Pinayagan na","引用失败":"Nabigo ang pag-quote","翻译":"Isalin","转文字":"I-convert sa teksto","隐藏":"Itago","腾讯云 IM":"Tencent Cloud Chat","空":"Walang laman","文本包含本地审核拦截词":"May mga salitang sinusuri sa lokal na pagbabawal sa teksto","按住说话":"Pindutin at magsalita","抬起发送":"Ibaba at ipadala","抬起取消":"Ibaba at kanselahin","正在录音":"Nagre-record","继续上滑可取消":"Magpatuloy sa pag-swipe pataas para kanselahin","松开手指 取消发送":"Bitawan ang daliri para kanselahin","此机型暂不支持复制功能":"Hindi suportado ng kasalukuyang modelo ang pagkopya","请开通翻译功能":"Mangyaring buksan ang tampok na pagsasalin","请开通语音转文字功能":"Mangyaring buksan ang tampok na pag-convert ng boses sa teksto","翻译中":"Nagpapalit ng wika","转换中":"Nagco-convert","由IM提供翻译支持":"Suportado ng IM ang pagsasalin","所有人":"Lahat","已达到表情回应上限数量":"Nakamit mo na ang maximum na limitasyon ng mga reaksyon","等":"at iba pa","人":"mga gumagamit","返回":"Bumalik","关闭":"Isara","多选":"Pumili","合并转发":"Pagsamahin ang Pagpapadala","逐条转发":"Isang-isa Pagpapadala","未选择消息":"Walang napiling mensahe","[草稿]":"[Drafts]","[消息]":"[Mensahe]","[文本]":"[Teksto]","[自定义消息]":"[Pasadyang Mensahe]","[图片]":"[Larawan]","[音频]":"[Boses]","[语音]":"[Boses]","[视频]":"[Bideo]","[文件]":"[File]","[位置]":"[Lokasyon]","[地理位置]":"[Lokasyon]","[动画表情]":"[Animated Sticker]","[群提示]":"[Group Tip]","[群提示消息]":"[Group Notification]","[聊天记录]":"[Kasaysayan ng Chat]","[机器人自定义消息]":"[Pasadyang Mensahe ng Robot]","引用内容已撤回":"Ang na-quote na nilalaman ay na-withdraw","群聊的聊天记录":"Kasaysayan ng Chat para sa Group Chat","和":"at","的聊天记录":"kasaysayan ng chat","请升级IMSDK到v2.10.1或更高版本查看此消息":"Mangyaring i-upgrade ang IMSDK sa v2.10.1 o mas mataas na bersyon upang tingnan ang mensaheng ito","该群聊已被解散":"Ang grupo ay na-disband na","您已被管理员移出群聊":"Kayo ay tinanggal na ng admin sa grupo","您已退出该群聊":"Kayo ay umalis na sa grupo","您已被禁止聊天":"Kayo ay ipinagbawal na makipag-chat","按Enter发送，Ctrl+Enter换行":"Pindutin ang Enter upang ipadala, Ctrl+Enter upang pumunta ng bara","账号被强制下线":"Ang account ay pina-force log out","登录失败":"Hindi makapag-login"},Component:{"图片 url 不存在":"Ang URL ng larawan ay hindi umiiral","暂不支持下载此类型图片":"Hindi pa suportado ang pag-download ng uri ng larawang ito","大图提取中":"Prosesyo ng malaking imahe","已保存至相册":"Naka-save na sa album","图片下载失败":"Hindi na-download ang larawan"},Time:{"周":"linggo/linggo ","天":"araw","小时":"oras/oras ","分钟":"minuto/minuto","刚刚":"Kamakailan lang","前":" nakaraan","昨天":"Kahapon","星期一":"Lunes","星期二":"Martes","星期三":"Miyerkules","星期四":"Huwebes","星期五":"Biyernes","星期六":"Sabado","星期日":"Linggo"},Emoji:Fc}},...{id:{"取消":"Batal","确定":"Sahkan","发送":"Kirim","系统通知":"Pemberitahuan Sistem","关闭":"Tutup","图片":"Gambar","文件":"Berkas","表情":"wajah","视频":"rekaman video","录制":"Merekam","拍照":"Memotret",AIDesk:{"结束人工会话":"Selesai","转人工服务":"Layanan manusia","跳转":"Goto","立即填写":"Isi sekarang","已提交":"Terkirim","提交":"Kirim","查看内容":"Lihat konten","请填写必填项":"Harap isi bidang yang wajib diisi","Hi，我是":"Hai, saya adalah ","请输入内容":"Silakan masukkan konten","如果满意请给好评哦～":"Jika Anda puas, silakan berikan ulasan yang bagus~","请对本次服务进行评价":"Silakan beri penilaian untuk layanan ini","提交评价":"Kirim Ulasan","服务评价":"Ulasan Layanan","并发限制":"Saat ini banyak pengguna yang mengakses. Mohon coba lagi nanti","分支选项异常":"Konten tidak normal, silakan periksa konfigurasi alur tugas"},TUIChat:{"查看内容":"Lihat konten","立即填写":"Isi sekarang","已提交":"Terkirim","不能为空":"Tidak boleh kosong","提交":"Kirim","撤回":"Tarik kembali","删除":"Hapus","复制":"Salin","重新发送":"Kirim ulang","转发":"Teruskan","引用":"Kutip","打开":"Buka","已读":"Dibaca","全部已读":"Semua dibaca","人已读":" dibaca","人未读":" belum dibaca","人关闭阅读状态":" status baca ditutup","消息详情":"Detail Pesan","关闭阅读状态":"Status baca ditutup","该消息不存在":"Pesan tidak ada","无法定位到原消息":"Tidak dapat menavigasi ke pesan asli","未读":"Belum dibaca","您":"Anda","撤回了一条消息":"menarik kembali pesan","重新编辑":"Edit ulang","我":"Saya","查看更多":"Lihat lebih banyak","转发给":"Teruskan ke","请输入消息":"Masukkan pesan","描述":"Deskripsi","经度":"Garis bujur","纬度":"Garis lintang","自定义消息":"Pesan kustom","图片":"[foto]","语音":"[suara]","视频":"[rekaman video]","表情":"[wajah]","文件":"[dokumen]","自定义":"[pesan kustom]","管理员开启全员禁言":"Admin mengaktifkan Bisukan Semua","您已被管理员禁言":"Anda telah dibisukan oleh admin","按Enter发送":"Tekan Enter untuk mengirim pesan","单击下载":"Klik untuk mengunduh","下载":"Unduh","确认重发该消息？":"Konfirmasi untuk mengirim ulang pesan?","取消":"Batal","确定":"Kirim","对方正在输入":"Sedang mengetik...","回到最新位置":"Kembali ke lokasi terbaru","条新消息":" pesan baru","点此投诉":"Keluhan","语音通话":"Panggilan Suara","视频通话":"Panggilan Video","发起群语音":"Mulai panggilan suara grup","发起群视频":"Mulai panggilan video grup","已接听":"Dijawab","拒绝通话":"Tolak Panggilan","无应答":"Tidak Ada Jawaban","取消通话":"Batalkan Panggilan","发起通话":"Mulai Panggilan","结束群聊":"Akhiri Panggilan Grup","通话时长":"Durasi","欢迎使用TUICallKit":"Selamat datang di TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"Terdeteksi bahwa Anda belum mengintegrasikan TUI CallKit, sehingga Anda tidak dapat merasakan panggilan audio dan video.","请点击":"Silakan klik","集成TUICallKit":" Integrasikan TUICallKit ","开通腾讯实时音视频服务":"Integrasi Komunikasi Real-Time Tencent","进行体验":"untuk merasakan.","您当前购买使用的套餐包暂未开通此功能":"Paket yang Anda beli tidak mendukung kemampuan ini.","系统消息":"Bot","转人工服务":"layanan manusia","点击处理":"Klik Proses","发送失败":"Gagal mengirim","复制成功":"Berhasil disalin ke clipboard","回复":"Balas","回复详情":"Detail Balasan","拒绝":"Tolak","聊天记录":"Riwayat Obrolan","内容包含敏感词汇":"Konten mengandung kata-kata sensitif","您当前购买使用的套餐包暂未开通群消息已读回执功能":"Paket yang Anda beli saat ini belum mengaktifkan fungsi resi baca pesan grup","您当前购买使用的套餐包暂未开通在线用户列表功能":"Paket yang Anda beli saat ini belum mengaktifkan fungsi daftar pengguna online","您有":"Anda memiliki","涉及敏感内容":"Melibatkan konten sensitif","申请加入":"Ajukan untuk bergabung","条回复":"balasan","条入群申请":"permintaan untuk bergabung dengan grup","同意":"Setuju","图片消息失败,无效的图片格式":"Gagal mengirim pesan gambar, format gambar tidak valid","位置":"Lokasi","文件不存在,请检查文件路径是否正确":"File tidak ada, silakan periksa apakah jalur file benar","文件大小超出了限制,如果上传文件,最大限制是100MB":"Ukuran file melebihi batas, jika mengunggah file, batas maksimum adalah 100MB","文件消息失败,禁止发送违规封禁的文件":"Gagal mengirim pesan file, dilarang mengirim file yang dilarang","无法查看":"Tidak dapat dilihat","无法收听":"Tidak dapat didengar","正在加载":"Sedang memuat...","加载结束":"Pemuatan selesai","消息":"Pesan","消息或者资料中文本存在敏感内容,发送失败":"Ada konten sensitif dalam teks pesan atau informasi, gagal mengirim","消息长度超出限制,消息长度不要超过12K":"Panjang pesan melebihi batas, panjang pesan tidak boleh lebih dari 12K","消息中图片存在敏感内容,发送失败":"Ada konten sensitif dalam gambar pesan, gagal mengirim","选择提醒的人":"Pilih orang yang akan diingatkan","已过撤回时限":"Batas waktu penarikan telah berlalu","已拒绝":"Sudah ditolak","已同意":"Sudah disetujui","引用失败":"Gagal mengutip","翻译":"menerjemahkan","隐藏":"bersembunyi","腾讯云 IM":"Tencent Cloud Chat","空":"Kosong","文本包含本地审核拦截词":"Teks mengandung kata-kata yang dicegah oleh peninjauan lokal","按住说话":"Tahan dan bicara","抬起发送":"Lepaskan untuk mengirim","抬起取消":"Lepaskan untuk membatalkan","正在录音":"Sedang merekam","继续上滑可取消":"Lanjutkan menggeser ke atas untuk membatalkan","松开手指 取消发送":"Lepaskan jari untuk membatalkan","此机型暂不支持复制功能":"Fungsi menyalin tidak didukung oleh model ini","请开通翻译功能":"Harap aktifkan fitur terjemahan","请开通语音转文字功能":"Harap aktifkan fitur konversi suara ke teks","翻译中":"Menerjemahkan","转换中":"Mengonversi","由IM提供翻译支持":"Didukung oleh IM untuk terjemahan","所有人":"Semua orang","已达到表情回应上限数量":"Telah mencapai batas maksimum respons emoji","等":"dll","人":"orang","返回":"Kembali","关闭":"Tutup","多选":"Pilih banyak","合并转发":"Gabungkan dan teruskan","逐条转发":"Teruskan satu per satu","未选择消息":"Tidak ada pesan yang dipilih","[草稿]":"[Draf]","[消息]":"[Pesan]","[文本]":"[Teks]","[自定义消息]":"[Pesan Kustom]","[图片]":"[foto]","[音频]":"[Suara]","[语音]":"[Suara]","[视频]":"[Video]","[文件]":"[File]","[位置]":"[Lokasi]","[地理位置]":"[Lokasi]","[动画表情]":"[Stiker Animasi]","[群提示]":"[Petunjuk Grup]","[群提示消息]":"[Pesan Petunjuk Grup]","[聊天记录]":"[Riwayat Chat]","[机器人自定义消息]":"[Pesan Kustom Robot]","引用内容已撤回":"Konten kutipan telah ditarik kembali","群聊的聊天记录":"Riwayat Chat Grup","和":"dan","的聊天记录":"riwayat chat","请升级IMSDK到v2.10.1或更高版本查看此消息":"Harap tingkatkan IMSDK ke versi 2.10.1 atau yang lebih tinggi untuk melihat pesan ini","该群聊已被解散":"Grup ini telah dibubarkan","您已被管理员移出群聊":"Anda telah dikeluarkan dari grup oleh administrator","您已退出该群聊":"Anda telah keluar dari grup ini","您已被禁止聊天":"Anda telah dilarang untuk mengobrol","按Enter发送，Ctrl+Enter换行":"Tekan Enter untuk mengirim, Ctrl+Enter untuk ganti baris","账号被强制下线":"Akun dipaksa keluar","登录失败":"Gagal masuk"},Component:{"图片 url 不存在":"URL gambar tidak ada","暂不支持下载此类型图片":"Pengunduhan jenis gambar ini saat ini tidak didukung","大图提取中":"Memproses gambar besar","已保存至相册":"Tersimpan di album","图片下载失败":"Gagal mengunduh gambar"},Time:{"周":"minggu","天":"hari","小时":"jam","分钟":"menit","刚刚":"Baru saja","前":" yang lalu","昨天":"Kemarin","星期一":"Senin","星期二":"Selasa","星期三":"Rabu","星期四":"Kamis","星期五":"Jumat","星期六":"Sabtu","星期日":"Minggu"},Emoji:Fc}},...{ja:{"取消":"キャンセル","确定":"確認","发送":"送信","系统通知":"システム通知","关闭":"閉じる","图片":"画像","文件":"ファイル","表情":"表情","视频":"動画","录制":"録画する","拍照":"写真を撮る",AIDesk:{"结束人工会话":"終了","转人工服务":"人工サービスに転送する","跳转":"リンク","立即填写":"今すぐ記入","已提交":"提出済み","提交":"提出する","查看内容":"内容を表示","请填写必填项":"必須項目を入力してください","Hi，我是":"こんにちは、私は","请输入内容":"内容を入力してください","如果满意请给好评哦～":"ご満足いただけましたら、ぜひ良いレビューをお願いします〜","请对本次服务进行评价":"このサービスについて評価をお願いします","提交评价":"評価を提出する","服务评价":"サービス評価","并发限制":"現在アクセスが集中しております。しばらくしてから再度お試しください","分支选项异常":"コンテンツに異常があります。タスクフローの設定を確認してください"},TUIChat:{"查看内容":"内容を查看する","立即填写":"すぐに填写する","已提交":"既に提交されました","不能为空":"空にできません","提交":"提交する","撤回":"撤回する","删除":"削除する","复制":"コピーする","重新发送":"再送信する","转发":"転送する","引用":"引用する","打开":"開く","已读":"既読","未读":"未読","人已读":"人が既読","人未读":"人が未読","人关闭阅读状态":"人が阅读状态を关闭する","全部已读":"全部既読","消息详情":"消息の詳細","关闭阅读状态":"阅读状态を关闭する","您":"あなた","撤回了一条消息":"一条の消息を撤回しました","重新编辑":"再編集する","我":"私","自定义消息":"カスタムメッセージ","查看更多":"もっと見る","确认重发该消息？":"この消息を再送信しますか？","取消":"キャンセル","确定":"確定","转发给":"～に転送する","请输入消息":"メッセージを入力してください","描述":"説明","经度":"経度","纬度":"緯度","图片":"[画像]","语音":"[音声]","视频":"[動画]","表情":"[表情]","文件":"[ファイル]","自定义":"[カスタムメッセージ]","管理员开启全员禁言":"管理者が全员禁言を开启する","您已被管理员禁言":"あなたは管理者によって禁言されました","按Enter发送":"Enterを押して送信する","单击下载":"クリックしてダウンロード","下载":"ダウンロード","该消息不存在":"その消息は存在しません","无法定位到原消息":"元の消息を特定できません","对方正在输入":"相手が入力中...","回到最新位置":"最新位置に戻る","条新消息":"件の新しい消息","点此投诉":"ここをクリックして投诉する","语音通话":"音声通話","视频通话":"ビデオ通話","发起群语音":"群音声を发起する","发起群视频":"群ビデオを发起する","已接听":"応答済み","拒绝通话":"通話を拒否する","无应答":"応答なし","取消通话":"通話をキャンセルする","发起通话":"通話を发起する","结束群聊":"群聊を終了する","通话时长":"通話時間","欢迎使用TUICallKit":"騰訊雲音视频通話コンポーネントTUICallKitのご使用を歓迎します","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"TUICallKitをまだ統合していないため、音视频通話機能を体験できません","请点击":"クリックしてください","集成TUICallKit":"TUICallKitを統合する","开通腾讯实时音视频服务":"騰訊のリアルタイム音视频サービスを開通する","进行体验":"体験を行う","您当前购买使用的套餐包暂未开通此功能":"現在購入使用している套餐包ではこの機能は開通していません","系统消息":"システムメッセージ","转人工服务":"人工サービスに転送する","点击处理":"クリックして処理","发送失败":"送信に失敗しました","复制成功":"コピーに成功しました","回复":"返信","回复详情":"返信の詳細","拒绝":"拒否","聊天记录":"[チャット履歴]","内容包含敏感词汇":"コンテンツには機密語句が含まれています","您当前购买使用的套餐包暂未开通群消息已读回执功能":"現在ご利用のパッケージには、グループメッセージの既読通知機能がまだ開通されていません","您当前购买使用的套餐包暂未开通在线用户列表功能":"現在ご利用のパッケージには、オンラインユーザーリスト機能がまだ開通されていません","您有":"あなたは","涉及敏感内容":"機密内容に関連しています","申请加入":"参加申請","条回复":"件の返信","条入群申请":"件のグループ参加申請","同意":"同意","图片消息失败,无效的图片格式":"画像メッセージが失敗しました、無効な画像形式です","位置":"[位置]","文件不存在,请检查文件路径是否正确":"ファイルが存在しません、ファイルパスが正しいか確認してください","文件大小超出了限制,如果上传文件,最大限制是100MB":"ファイルサイズが制限を超えています、ファイルの最大制限は100MBです","文件消息失败,禁止发送违规封禁的文件":"ファイルメッセージが失敗しました、違反ファイルの送信は禁止されています","无法查看":"表示できません","无法收听":"聞くことができません","正在加载":"読み込み中","加载结束":"読み込み完了","消息":"[メッセージ]","消息或者资料中文本存在敏感内容,发送失败":"メッセージまたはデータに機密内容が含まれているため、送信に失敗しました","消息长度超出限制,消息长度不要超过12K":"メッセージの長さが制限を超えています、メッセージの長さは12Kを超えないでください","消息中图片存在敏感内容,发送失败":"メッセージに機密内容のある画像が含まれているため、送信に失敗しました","选择提醒的人":"通知する人を選択","已过撤回时限":"撤回期限が過ぎました","已拒绝":"拒否済み","已同意":"同意済み","引用失败":"引用に失敗しました","翻译":"翻訳","转文字":"テキストに変換","隐藏":"非表示","腾讯云 IM":"Tencent Cloud Chat","空":"空です","文本包含本地审核拦截词":"テキストにはローカルの検閲ワードが含まれています","按住说话":"押し続けて話す","抬起发送":"上げて送信","抬起取消":"上げてキャンセル","正在录音":"録音中","继续上滑可取消":"上にスワイプし続けるとキャンセルできます","松开手指 取消发送":"指を離して送信をキャンセル","此机型暂不支持复制功能":"この機種ではコピー機能はサポートされていません","请开通翻译功能":"翻訳機能を有効にしてください","请开通语音转文字功能":"音声をテキストに変換する機能を有効にしてください","翻译中":"翻訳中","转换中":"変換中","由IM提供翻译支持":"IMが翻訳サポートを提供","所有人":"全て","已达到表情回应上限数量":"表情の反応の上限数に達しました","等":"など","人":"人","返回":"戻る","关闭":"閉じる","多选":"複数選択","合并转发":"転送を結合","逐条转发":"一つずつ転送","未选择消息":"メッセージが選択されていません","[草稿]":"[下書き]","[消息]":"[メッセージ]","[文本]":"[テキスト]","[自定义消息]":"[カスタムメッセージ]","[图片]":"[画像]","[音频]":"[音声]","[语音]":"[音声]","[视频]":"[ビデオ]","[文件]":"[ファイル]","[位置]":"[位置]","[地理位置]":"[位置]","[动画表情]":"[アニメステッカー]","[群提示]":"[グループヒント]","[群提示消息]":"[グループ通知]","[聊天记录]":"[チャット履歴]","[机器人自定义消息]":"[カスタムロボットメッセージ]","引用内容已撤回":"引用された内容は取り消されました","群聊的聊天记录":"グループチャットのチャット履歴","和":"と","的聊天记录":"のチャット履歴","请升级IMSDK到v2.10.1或更高版本查看此消息":"このメッセージを表示するには、IMSDKをv2.10.1またはそれ以上のバージョンにアップグレードしてください","该群聊已被解散":"このグループチャットは解散されました","您已被管理员移出群聊":"管理者によってグループチャットから削除されました","您已退出该群聊":"このグループチャットから退出しました","您已被禁止聊天":"チャットが禁止されています","按Enter发送，Ctrl+Enter换行":"Enterキーで送信、Ctrl+Enterキーで改行","账号被强制下线":"アカウントが強制的にログアウト","登录失败":"ログインに失敗しました"},Component:{"图片 url 不存在":"画像のURLが存在しません","暂不支持下载此类型图片":"このタイプの画像のダウンロードは現在サポートされていません","大图提取中":"大きな画像を処理中です","已保存至相册":"アルバムに保存されました","图片下载失败":"画像のダウンロードに失敗しました"},Time:{"周":"週","天":"日","小时":"時間","分钟":"分","刚刚":"たった今","前":"前","昨天":"昨日","星期一":"月曜日","星期二":"火曜日","星期三":"水曜日","星期四":"木曜日","星期五":"金曜日","星期六":"土曜日","星期日":"日曜日"},Emoji:Fc}},...{vi:{"取消":"Hủy bỏ","确定":"Lưu lại","发送":"Gửi","系统通知":"Thông báo hệ thống","关闭":"Đóng","图片":"Hình ảnh","文件":"Tệp","表情":"biểu tượng cảm xúc","视频":"video","录制":"Ghi hình","拍照":"Chụp ảnh",AIDesk:{"结束人工会话":"Kết thúc cuộc trò chuyện với người","转人工服务":"Chuyển sang dịch vụ của người","跳转":"Chuyển hướng","立即填写":"Điền ngay","已提交":"Đã gửi","提交":"Gửi","查看内容":"Xem nội dung","请填写必填项":"Vui lòng điền vào các mục bắt buộc","Hi，我是":"Xin chào, tôi là ","请输入内容":"Vui lòng nhập nội dung","如果满意请给好评哦～":"Nếu bạn hài lòng, hãy cho chúng tôi một đánh giá tốt nhé~","请对本次服务进行评价":"Vui lòng đánh giá dịch vụ này","提交评价":"Gửi đánh giá","服务评价":" Đánh giá dịch vụ","并发限制":"Hiện có quá nhiều người đang truy cập. Vui lòng thử lại sau","分支选项异常":"Nội dung bất thường, vui lòng kiểm tra cấu hình luồng tác vụ"},TUIChat:{"查看内容":"Xem nội dung","立即填写":"Điền ngay","已提交":"Đã gửi","不能为空":"Không được để trống","提交":"Gửi","撤回":"Thu hồi","删除":"Xóa","复制":"Sao chép","重新发送":"Gửi lại","转发":"Chuyển tiếp","引用":"Trích dẫn","打开":"Mở","已读":"Đã đọc","全部已读":"Đã đọc hết","人已读":" đã đọc","人未读":" chưa đọc","人关闭阅读状态":" đóng trạng thái đọc","消息详情":"Thông tin tin nhắn","关闭阅读状态":"Đóng trạng thái đọc","该消息不存在":"Tin nhắn không tồn tại","无法定位到原消息":"Không thể xác định được tin nhắn gốc","未读":"Chưa đọc","您":"Bạn","撤回了一条消息":"Đã thu hồi một tin nhắn","重新编辑":"Chỉnh sửa lại","我":"Tôi","查看更多":"Xem thêm","转发给":"Chuyển tiếp đến","请输入消息":"Nhập tin nhắn","描述":"Mô tả","经度":"Kinh độ","纬度":"Vĩ độ","自定义消息":"Tin nhắn tùy chỉnh","图片":"[hình ảnh]","语音":"[âm thanh]","视频":"[video]","表情":"[biểu tượng cảm xúc]","文件":"[tệp tin]","自定义":"[tin nhắn tùy chỉnh]","管理员开启全员禁言":"Quản trị viên mở chế độ im lặng cho tất cả mọi người","您已被管理员禁言":"Bạn đã bị quản trị viên im lặng","按Enter发送":"Nhấn Enter để gửi tin nhắn","单击下载":"Nhấp để tải xuống","下载":"tải về","确认重发该消息？":"Xác nhận gửi lại tin nhắn này?","取消":"Hủy","确定":"Xác nhận","对方正在输入":"Đang nhập tin...","回到最新位置":"Quay lại vị trí mới nhất","条新消息":" tin nhắn mới","点此投诉":"Khiếu nại","语音通话":"Cuộc gọi thoại","视频通话":"Cuộc gọi video","发起群语音":"Bắt đầu cuộc gọi thoại nhóm","发起群视频":"Bắt đầu cuộc gọi video nhóm","已接听":"Đã trả lời","拒绝通话":"Từ chối cuộc gọi","无应答":"Không trả lời","取消通话":"Hủy cuộc gọi","发起通话":"Bắt đầu cuộc gọi","结束群聊":"Chỉnh sửa cuộc gọi nhóm","通话时长":"Thời gian gọi","欢迎使用TUICallKit":"Chào mừng đến với TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"Phát hiện rằng bạn chưa tích hợp TUI CallKit, vì vậy bạn không thể trải nghiệm chức năng cuộc gọi âm thanh và video.","请点击":"Vui lòng nhấp chuột","集成TUICallKit":" Tích hợp TUICallKit ","开通腾讯实时音视频服务":"Tích hợp Tencent Real-Time Communication","进行体验":"để trải nghiệm.","您当前购买使用的套餐包暂未开通此功能":"Gói dịch vụ mà bạn đang sử dụng không hỗ trợ tính năng này.","系统消息":"Bot","转人工服务":"Chuyển sang dịch vụ nhân tạo","点击处理":"Nhấp để xử lý","发送失败":"Gửi thất bại","复制成功":"Sao chép thành công","回复":"Trả lời","回复详情":"Chi tiết trả lời","拒绝":"Từ chối","聊天记录":"Lịch sử trò chuyện","内容包含敏感词汇":"Nội dung chứa từ ngữ nhạy cảm","您当前购买使用的套餐包暂未开通群消息已读回执功能":"Gói dịch vụ bạn đang sử dụng hiện chưa mở chức năng xác nhận đã đọc tin nhắn nhóm","您当前购买使用的套餐包暂未开通在线用户列表功能":"Gói dịch vụ bạn đang sử dụng hiện chưa mở chức năng danh sách người dùng trực tuyến","您有":"Bạn có","涉及敏感内容":"Liên quan đến nội dung nhạy cảm","申请加入":"Đăng ký tham gia","条回复":"phản hồi","条入群申请":"đơn xin tham gia nhóm","同意":"Đồng ý","图片消息失败,无效的图片格式":"Gửi tin nhắn hình ảnh thất bại, định dạng hình ảnh không hợp lệ","位置":"Vị trí","文件不存在,请检查文件路径是否正确":"Tệp không tồn tại, vui lòng kiểm tra đường dẫn tệp có đúng không","文件大小超出了限制,如果上传文件,最大限制是100MB":"Kích thước tệp vượt quá giới hạn, nếu tải lên tệp, giới hạn tối đa là 100MB","文件消息失败,禁止发送违规封禁的文件":"Gửi tin nhắn tệp thất bại, không được phép gửi tệp vi phạm","无法查看":"Không thể xem","无法收听":"Không thể nghe","正在加载":"Đang tải","加载结束":"Tải xong","消息":"Tin nhắn","消息或者资料中文本存在敏感内容,发送失败":"Tin nhắn hoặc nội dung văn bản chứa nội dung nhạy cảm, gửi thất bại","消息长度超出限制,消息长度不要超过12K":"Độ dài tin nhắn vượt quá giới hạn, độ dài tin nhắn không vượt quá 12K","消息中图片存在敏感内容,发送失败":"Tin nhắn chứa hình ảnh có nội dung nhạy cảm, gửi thất bại","选择提醒的人":"Chọn người để thông báo","已过撤回时限":"Quá thời hạn rút lại","已拒绝":"Đã từ chối","已同意":"Đã đồng ý","引用失败":"Trích dẫn thất bại","翻译":"Dịch","转文字":"Chuyển thành văn bản","隐藏":"Ẩn","空":"Trống","文本包含本地审核拦截词":"Văn bản chứa từ cấm kiểm duyệt địa phương","按住说话":"Nhấn và nói","抬起发送":"Nhấc lên để gửi","抬起取消":"Nhấc lên để hủy","正在录音":"Đang ghi âm","继续上滑可取消":"Tiếp tục vuốt lên để hủy","松开手指 取消发送":"Nhả tay để hủy gửi","此机型暂不支持复制功能":"Máy này tạm thời không hỗ trợ chức năng sao chép","请开通翻译功能":"Vui lòng bật chức năng dịch","请开通语音转文字功能":"Vui lòng bật chức năng chuyển đổi giọng nói thành văn bản","翻译中":"Đang dịch","转换中":"Đang chuyển đổi","由IM提供翻译支持":"Được hỗ trợ dịch bởi IM","所有人":"Tất cả mọi người","已达到表情回应上限数量":"Đã đạt đến số lượng giới hạn phản hồi biểu cảm","等":"và nhiều hơn nữa","人":"người","返回":"Quay lại","关闭":"Đóng","多选":"Chọn nhiều","合并转发":"Chuyển tiếp kết hợp","逐条转发":"Chuyển tiếp từng mục","未选择消息":"Chưa chọn tin nhắn","草稿":"Bản nháp","文本":"Văn bản","音频":"Âm thanh","地理位置":"Vị trí địa lý","动画表情":"Biểu cảm động","群提示":"Nhắc nhở nhóm","群提示消息":"Tin nhắn nhắc nhở nhóm","机器人自定义消息":"Tin nhắn tùy chỉnh của robot","引用内容已撤回":"Nội dung trích dẫn đã bị thu hồi","群聊的聊天记录":"Lịch sử trò chuyện nhóm","和":"và","的聊天记录":"của lịch sử trò chuyện","请升级IMSDK到v2.10.1或更高版本查看此消息":"Vui lòng nâng cấp IMSDK lên phiên bản v2.10.1 hoặc cao hơn để xem tin nhắn này","该群聊已被解散":"Nhóm trò chuyện đã bị giải tán","您已被管理员移出群聊":"Bạn đã bị loại khỏi nhóm bởi quản trị viên","您已退出该群聊":"Bạn đã rời khỏi nhóm","您已被禁止聊天":"Bạn đã bị cấm trò chuyện","按Enter发送，Ctrl+Enter换行":"Nhấn Enter để gửi, Ctrl+Enter để xuống dòng","账号被强制下线":"Tài khoản bị buộc đăng xuất","登录失败":"Đăng nhập thất bại"},Component:{"图片 url 不存在":"Url hình ảnh không tồn tại","暂不支持下载此类型图片":"Hiện tại không hỗ trợ tải xuống loại hình ảnh này","大图提取中":"Đang xử lý hình ảnh lớn","已保存至相册":"Đã lưu vào album","图片下载失败":"Tải hình ảnh thất bại"},Time:{"周":"tuần","天":"ngày","小时":"giờ","分钟":"phút","刚刚":"vừa mới","前":"trước","昨天":"hôm qua","星期一":"thứ hai","星期二":"thứ ba","星期三":"thứ tư","星期四":"thứ năm","星期五":"thứ sáu","星期六":"thứ bảy","星期日":"chủ nhật"},Emoji:Fc}},...{ms:{"取消":"Batal","确定":"Sahkan","发送":"Hantar","系统通知":"Pemberitahuan Sistem","关闭":"Tutup","图片":"Imej","文件":"Fail","表情":"Emotikon","视频":"Video","录制":"Merekam","拍照":"Memotret",AIDesk:{"结束人工会话":"Tamatkan Sesi","转人工服务":"Alihkan ke Perkhidmatan Manusia","跳转":"Pergi ke","立即填写":"Isi Sekarang","已提交":"Telah Dihantar","提交":"Hantar","查看内容":"Lihat Kandungan","请填写必填项":"Sila isi ruangan yang wajib","Hi，我是":"Hai, saya ","请输入内容":"Sila masukkan kandungan","如果满意请给好评哦～":"Jika anda berpuas hati, sila berikan ulasan yang baik~","请对本次服务进行评价":"Sila beri penilaian untuk perkhidmatan ini","提交评价":"Hantar Penilaian","服务评价":"Penilaian Perkhidmatan","并发限制":"Terdapat terlalu ramai pengguna pada masa ini. Sila cuba lagi nanti","分支选项异常":"Kandungan tidak normal, sila semak konfigurasi aliran tugas"},TUIChat:{"查看内容":"Lihat kandungan","立即填写":"Isi segera","已提交":"Telah dihantar","不能为空":"Tidak boleh kosong","提交":"Hantar","撤回":"Tarik Balik","删除":"Padam","复制":"Salin","重新发送":"Hantar Semula","转发":"Teruskan","引用":"Petik","打开":"Buka","已读":"Telah Dibaca","未读":"Belum Dibaca","人已读":"Orang Telah Membaca","人未读":"Orang Belum Membaca","人关闭阅读状态":"Orang Menutup Status Bacaan","全部已读":"Semua Telah Dibaca","消息详情":"Butiran Mesej","关闭阅读状态":"Tutup","您":"Anda","撤回了一条消息":"Telah Menarik Balik Satu Mesej","重新编辑":"Edit Semula","我":"Saya","自定义消息":"Mesej Tersuai","查看更多":"Lihat Lebih Banyak","确认重发该消息？":"Sahkan Untuk Hantar Semula Mesej Ini?","取消":"Batal","确定":"Sahkan","转发给":"Teruskan Kepada","请输入消息":"Sila Masukkan Mesej","描述":"Deskripsi","经度":"Longitud","纬度":"Latitud","图片":"[Gambar]","语音":"[Suara]","视频":"[Video]","表情":"[Emotikon]","文件":"[Fail]","自定义":"[Mesej Tersuai]","管理员开启全员禁言":"Pentadbir Mengaktifkan Senyap Semua","您已被管理员禁言":"Anda Telah Disenyapkan Oleh Pentadbir","按Enter发送":"Tekan Enter Untuk Hantar","单击下载":"Klik Untuk Muat Turun","下载":"Muat turun","该消息不存在":"Mesej Ini Tidak Wujud","无法定位到原消息":"Tidak Dapat Menemukan Mesej Asal","对方正在输入":"Pihak Lain Sedang Menulis...","回到最新位置":"Kembali Ke Lokasi Terkini","条新消息":"Mesej Baru","点此投诉":"Klik Sini Untuk Aduan","语音通话":"Panggilan Suara","视频通话":"Panggilan Video","发起群语音":"Mulakan Panggilan Suara Kumpulan","发起群视频":"Mulakan Panggilan Video Kumpulan","已接听":"Telah Dijawab","拒绝通话":"Tolak Panggilan","无应答":"Tiada Jawapan","取消通话":"Batal Panggilan","发起通话":"Mulakan Panggilan","结束群聊":"Tamatkan Sembang Kumpulan","通话时长":"Tempoh Panggilan","欢迎使用TUICallKit":"Selamat Datang Menggunakan Komponen Panggilan Audio dan Video Tencent Cloud TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"Dikesan Anda Belum Mengintegrasikan TUICallKit, Tidak Dapat Mengalami Fungsi Panggilan Audio dan Video.","请点击":"Sila Klik","集成TUICallKit":"Integrasi TUICallKit","开通腾讯实时音视频服务":"Aktifkan Perkhidmatan Audio dan Video Masa Nyata Tencent","进行体验":"Untuk Mengalami.","您当前购买使用的套餐包暂未开通此功能":"Pakej yang Anda Beli Sekarang Tidak Mengaktifkan Fungsi Ini.","系统消息":"Mesej Sistem","转人工服务":"Alihkan Ke Perkhidmatan Manusia","点击处理":"Klik untuk proses","发送失败":"Gagal menghantar","复制成功":"Berjaya disalin","回复":"Balas","回复详情":"Butiran Balasan","拒绝":"Menolak","聊天记录":"Rekod Perbualan","内容包含敏感词汇":"Kandungan mengandungi perkataan sensitif","您当前购买使用的套餐包暂未开通群消息已读回执功能":"Pakej yang anda beli dan gunakan belum membuka fungsi tanda terima bacaan mesej kumpulan","您当前购买使用的套餐包暂未开通在线用户列表功能":"Pakej yang anda beli dan gunakan belum membuka fungsi senarai pengguna dalam talian","您有":"Anda mempunyai","涉及敏感内容":"Melibatkan kandungan sensitif","申请加入":"Permohonan Sertai","条回复":"balasan","条入群申请":"permohonan sertai kumpulan","同意":"Setuju","图片消息失败,无效的图片格式":"Gagal menghantar mesej gambar, format gambar tidak sah","位置":"Lokasi","文件不存在,请检查文件路径是否正确":"Fail tidak wujud, sila periksa laluan fail sama ada betul","文件大小超出了限制,如果上传文件,最大限制是100MB":"Saiz fail melebihi had, jika memuat naik fail, had maksimum adalah 100MB","文件消息失败,禁止发送违规封禁的文件":"Gagal menghantar mesej fail, larangan menghantar fail yang melanggar peraturan","无法查看":"Tidak dapat dilihat","无法收听":"Tidak dapat didengar","正在加载":"Sedang dimuatkan","加载结束":"Pemuatan selesai","消息":"Mesej","消息或者资料中文本存在敏感内容,发送失败":"Gagal menghantar mesej atau maklumat, terdapat kandungan sensitif dalam teks","消息长度超出限制,消息长度不要超过12K":"Panjang mesej melebihi had, panjang mesej tidak boleh melebihi 12K","消息中图片存在敏感内容,发送失败":"Gagal menghantar mesej, terdapat kandungan sensitif dalam gambar","选择提醒的人":"Pilih orang yang ingin diingatkan","已过撤回时限":"Had masa untuk menarik balik telah berlalu","已拒绝":"Ditolak","已同意":"Disetujui","引用失败":"Gagal mengutip","翻译":"Terjemahan","转文字":"Teks ke Audio","隐藏":"Sembunyi","腾讯云 IM":"Tencent Cloud Chat","空":"Kosong","文本包含本地审核拦截词":"Teks mengandungi perkataan penyaringan tempatan","按住说话":"Tekan dan bercakap","抬起发送":"Angkat untuk menghantar","抬起取消":"Angkat untuk membatalkan","正在录音":"Sedang merekod","继续上滑可取消":"Terus geser ke atas untuk membatalkan","松开手指 取消发送":"Lepaskan jari untuk membatalkan penghantaran","此机型暂不支持复制功能":"Model ini tidak menyokong fungsi salin sementara","请开通翻译功能":"Sila aktifkan fungsi terjemahan","请开通语音转文字功能":"Sila aktifkan fungsi penukaran suara ke teks","翻译中":"Sedang diterjemahkan","转换中":"Sedang menukar","由IM提供翻译支持":"Disokong oleh IM untuk terjemahan","所有人":"Semua orang","已达到表情回应上限数量":"Jumlah had tindak balas emosi telah dicapai","等":"dan lain-lain","人":"orang","返回":"Kembali","关闭":"Tutup","多选":"Pilihan pelbagai","合并转发":"Gabungkan dan hantar","逐条转发":"Hantar satu persatu","未选择消息":"Tiada mesej dipilih","[草稿]":"[Draf]","[消息]":"[Mesej]","[文本]":"[Teks]","[自定义消息]":"[Mesej Tersuai]","[图片]":"[Gambar]","[音频]":"[Audio]","[语音]":"[Suara]","[视频]":"[Video]","[文件]":"[Fail]","[位置]":"[Lokasi]","[地理位置]":"[Lokasi]","[动画表情]":"[Emoji Animasi]","[群提示]":"[Petunjuk Kumpulan]","[群提示消息]":"[Mesej Petunjuk Kumpulan]","[聊天记录]":"[Rekod Perbualan]","[机器人自定义消息]":"[Mesej Tersuai Robot]","引用内容已撤回":"Kandungan rujukan telah ditarik balik","群聊的聊天记录":"Rekod perbualan dalam kumpulan","和":"dan","的聊天记录":"rekod perbualan","请升级IMSDK到v2.10.1或更高版本查看此消息":"Sila naik tarafkan IMSDK ke v2.10.1 atau versi yang lebih tinggi untuk melihat mesej ini","该群聊已被解散":"Perbualan kumpulan ini telah dibubarkan","您已被管理员移出群聊":"Anda telah dikeluarkan daripada perbualan kumpulan oleh pentadbir","您已退出该群聊":"Anda telah keluar daripada perbualan kumpulan ini","您已被禁止聊天":"Anda telah dilarang berbual","按Enter发送，Ctrl+Enter换行":"Tekan Enter untuk menghantar, Ctrl+Enter untuk baris baru","账号被强制下线":"Akaun dipaksa keluar","登录失败":"Gagal log masuk"},Component:{"图片 url 不存在":"Url imej tidak wujud","暂不支持下载此类型图片":"Memuat turun imej jenis ini tidak disokong pada masa ini","大图提取中":"Memproses imej besar","已保存至相册":"Disimpan dalam album","图片下载失败":"Gagal memuat turun gambar"},Time:{"周":"Minggu","天":"Hari","小时":"Jam","分钟":"Minit","刚刚":"Baru sahaja","前":"Lalu","昨天":"Semalam","星期一":"Isnin","星期二":"Selasa","星期三":"Rabu","星期四":"Khamis","星期五":"Jumaat","星期六":"Sabtu","星期日":"Ahad"},Emoji:Fc}},...{th:{"取消":"ยกเลิก","确定":"ยืนยัน","发送":"ส่ง","系统通知":"การแจ้งเตือนของระบบ","关闭":"ปิด","图片":"รูปภาพ","文件":"ไฟล์","表情":"อีโมจิ","视频":"วิดีโอ","录制":"บันทึกวิดีโอ","拍照":"ถ่ายรูป",AIDesk:{"结束人工会话":"สิ้นสุดการสนทนากับพนักงาน","转人工服务":"เปลี่ยนไปยังบริการพนักงาน","跳转":"ไปยัง","立即填写":"กรอกทันที","已提交":"เสนอแล้ว","提交":"เสนอ","查看内容":"ดูเนื้อหา","请填写必填项":"โปรดกรอกข้อมูลที่จำเป็น","Hi，我是":"สวัสดี ฉันเป็น ","请输入内容":"กรุณากรอกเนื้อหา","如果满意请给好评哦～":"หากพอใจแล้วก็อย่าลืมรีวิวให้ด้วยนะ~","请对本次服务进行评价":"กรุณาประเมินบริการครั้งนี้","提交评价":"ส่งการประเมิน","服务评价":"การประเมินบริการ","并发限制":"ปัจจุบันมีผู้ใช้งานจำนวนมาก กรุณาลองใหม่ในภายหลัง","分支选项异常":"เนื้อหาผิดปกติ กรุณาตรวจสอบการตั้งค่ากระบวนการงาน"},TUIChat:{"查看内容":"ดูเนื้อหา","立即填写":"กรอกทันที","已提交":"ส่งแล้ว","不能为空":"ต้องไม่ว่างเปล่า","提交":"ส่ง","撤回":"ถอนกลับ","删除":"ลบ","复制":"คัดลอก","重新发送":"ส่งใหม่","转发":"ส่งต่อ","引用":"อ้างอิง","打开":"เปิด","已读":"อ่านแล้ว","未读":"ยังไม่ได้อ่าน","人已读":"คนอ่านแล้ว","人未读":"คนยังไม่ได้อ่าน","人关闭阅读状态":"คนปิดสถานะการอ่าน","全部已读":"อ่านทั้งหมดแล้ว","消息详情":"รายละเอียดข้อความ","关闭阅读状态":"ปิดสถานะการอ่าน","您":"คุณ","撤回了一条消息":"ถอนกลับข้อความหนึ่ง","重新编辑":"แก้ไขใหม่","我":"ฉัน","自定义消息":"ข้อความที่กำหนดเอง","查看更多":"ดูเพิ่มเติม","确认重发该消息？":"ยืนยันการส่งข้อความนี้อีกครั้ง?","取消":"ยกเลิก","确定":"ยืนยัน","转发给":"ส่งต่อให้","请输入消息":"กรุณาใส่ข้อความ","描述":"คำอธิบาย","经度":"ลองจิจูด","纬度":"ละติจูด","图片":"[รูปภาพ]","语音":"[เสียง]","视频":"[วิดีโอ]","表情":"[อีโมจิ]","文件":"[ไฟล์]","自定义":"[ข้อความที่กำหนดเอง]","管理员开启全员禁言":"ผู้ดูแลระบบเปิดการปิดเสียงทั้งหมด","您已被管理员禁言":"คุณถูกผู้ดูแลระบบปิดเสียง","按Enter发送":"กด Enter เพื่อส่ง","单击下载":"คลิกเพื่อดาวน์โหลด","下载":"ดาวน์โหลด","该消息不存在":"ข้อความนี้ไม่มีอยู่","无法定位到原消息":"ไม่สามารถระบุตำแหน่งข้อความต้นฉบับได้","对方正在输入":"อีกฝ่ายกำลังพิมพ์...","回到最新位置":"กลับไปยังตำแหน่งล่าสุด","条新消息":"ข้อความใหม่","点此投诉":"คลิกที่นี่เพื่อร้องเรียน","语音通话":"การโทรด้วยเสียง","视频通话":"การโทรด้วยวิดีโอ","发起群语音":"เริ่มการโทรด้วยเสียงกลุ่ม","发起群视频":"เริ่มการโทรด้วยวิดีโอกลุ่ม","已接听":"รับสายแล้ว","拒绝通话":"ปฏิเสธการโทร","无应答":"ไม่มีการตอบรับ","取消通话":"ยกเลิกการโทร","发起通话":"เริ่มการโทร","结束群聊":"สิ้นสุดการแชทกลุ่ม","通话时长":"ระยะเวลาการโทร","欢迎使用TUICallKit":"ยินดีต้อนรับสู่การใช้ TUICallKit ของ Tencent Cloud","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"ตรวจพบว่าคุณยังไม่ได้รวม TUICallKit ไม่สามารถใช้ฟังก์ชันการโทรด้วยเสียงและวิดีโอได้","请点击":"กรุณาคลิก","集成TUICallKit":"รวม TUICallKit","开通腾讯实时音视频服务":"เปิดบริการเสียงและวิดีโอเรียลไทม์ของ Tencent","进行体验":"เพื่อทดลองใช้","您当前购买使用的套餐包暂未开通此功能":"แพ็คเกจที่คุณซื้อในปัจจุบันยังไม่ได้เปิดใช้งานฟังก์ชันนี้","系统消息":"ข้อความระบบ","转人工服务":"เปลี่ยนเป็นบริการมนุษย์","点击处理":"คลิกเพื่อดำเนินการ","发送失败":"ส่งไม่สำเร็จ","复制成功":"คัดลอกสำเร็จ","回复":"ตอบกลับ","回复详情":"รายละเอียดการตอบกลับ","拒绝":"ปฏิเสธ","聊天记录":"บันทึกการสนทนา","内容包含敏感词汇":"เนื้อหามีคำที่ละเมิด","您当前购买使用的套餐包暂未开通群消息已读回执功能":"แพ็กเกจที่คุณซื้อและใช้ยังไม่เปิดใช้งานฟังก์ชันการแจ้งเตือนอ่านข้อความในกลุ่ม","您当前购买使用的套餐包暂未开通在线用户列表功能":"แพ็กเกจที่คุณซื้อและใช้ยังไม่เปิดใช้งานฟังก์ชันรายชื่อผู้ใช้ออนไลน์","您有":"คุณมี","涉及敏感内容":"เกี่ยวข้องกับเนื้อหาที่ละเมิด","申请加入":"สมัครเข้าร่วม","条回复":"ข้อความตอบกลับ","条入群申请":"คำขอเข้าร่วมกลุ่ม","同意":"ยอมรับ","图片消息失败,无效的图片格式":"ส่งข้อความรูปภาพล้มเหลว รูปแบบรูปภาพไม่ถูกต้อง","位置":"ตำแหน่ง","文件不存在,请检查文件路径是否正确":"ไม่พบไฟล์ โปรดตรวจสอบที่อยู่ไฟล์ว่าถูกต้องหรือไม่","文件大小超出了限制,如果上传文件,最大限制是100MB":"ขนาดไฟล์เกินขีดจำกัด หากอัปโหลดไฟล์ ขีดจำกัดสูงสุดคือ 100MB","文件消息失败,禁止发送违规封禁的文件":"ส่งข้อความไฟล์ล้มเหลว ไม่อนุญาตให้ส่งไฟล์ที่ถูกห้าม","无法查看":"ไม่สามารถดูได้","无法收听":"ไม่สามารถฟังได้","正在加载":"กำลังโหลด","加载结束":"โหลดเสร็จสิ้น","消息":"ข้อความ","消息或者资料中文本存在敏感内容,发送失败":"ข้อความหรือข้อมูลมีเนื้อหาที่ละเมิด ส่งไม่สำเร็จ","消息长度超出限制,消息长度不要超过12K":"ข้อความยาวเกินขีดจำกัด ความยาวข้อความไม่ควรเกิน 12K","消息中图片存在敏感内容,发送失败":"รูปภาพในข้อความมีเนื้อหาที่ละเมิด ส่งไม่สำเร็จ","选择提醒的人":"เลือกบุคคลที่ต้องการแจ้งเตือน","已过撤回时限":"เกินเวลาการถอนคำสั่ง","已拒绝":"ปฏิเสธแล้ว","已同意":"ยอมรับแล้ว","引用失败":"การอ้างอิงล้มเหลว","翻译":"แปล","转文字":"แปลเป็นข้อความ","隐藏":"ซ่อน","腾讯云 IM":"Tencent Cloud Chat","空":"ว่างเปล่า","文本包含本地审核拦截词":"ข้อความมีคำที่ถูกตรวจสอบและบล็อกในท้องถิ่น","按住说话":"กดค้างเพื่อพูด","抬起发送":"ยกขึ้นเพื่อส่ง","抬起取消":"ยกขึ้นเพื่อยกเลิก","正在录音":"กำลังบันทึกเสียง","继续上滑可取消":"เลื่อนขึ้นต่อเพื่อยกเลิก","松开手指 取消发送":"ปล่อยนิ้วเพื่อยกเลิกการส่ง","此机型暂不支持复制功能":"รุ่นเครื่องนี้ยังไม่รองรับฟังก์ชันคัดลอก","请开通翻译功能":"โปรดเปิดใช้งานฟังก์ชันแปล","请开通语音转文字功能":"โปรดเปิดใช้งานฟังก์ชันแปลงเสียงเป็นข้อความ","翻译中":"กำลังแปล","转换中":"กำลังแปลง","由IM提供翻译支持":"รองรับการแปลโดย IM","所有人":"ทุกคน","已达到表情回应上限数量":"เต็มจำนวนสูงสุดของการตอบสนองด้วยอารมณ์แล้ว","等":"และอื่นๆ","人":"คน","返回":"ย้อนกลับ","关闭":"ปิด","多选":"เลือกหลายรายการ","合并转发":"รวมการส่งต่อ","逐条转发":"ส่งต่อทีละรายการ","未选择消息":"ไม่ได้เลือกข้อความ","[草稿]":"[ร่าง]","[消息]":"[ข้อความ]","[文本]":"[ข้อความ]","[自定义消息]":"[ข้อความที่กำหนดเอง]","[图片]":"[รูปภาพ]","[音频]":"[เสียง]","[语音]":"[เสียง]","[视频]":"[วิดีโอ]","[文件]":"[ไฟล์]","[位置]":"[ตำแหน่ง]","[地理位置]":"[ตำแหน่งทางภูมิศาสตร์]","[动画表情]":"[สติกเกอร์แบบเคลื่อนไหว]","[群提示]":"[เคล็ดลับกลุ่ม]","[群提示消息]":"[ข้อความเคล็ดลับกลุ่ม]","[聊天记录]":"[บันทึกการสนทนา]","[机器人自定义消息]":"[ข้อความที่กำหนดเองของหุ่นยนต์]","引用内容已撤回":"เนื้อหาที่อ้างถึงถูกเพิกถอนแล้ว","群聊的聊天记录":"บันทึกการสนทน","和":"และ","的聊天记录":"บันทึกการสนทนาของ","请升级IMSDK到v2.10.1或更高版本查看此消息":"โปรดอัปเกรด IMSDK เป็นเวอร์ชัน 2.10.1 หรือสูงกว่าเพื่อดูข้อความนี้","该群聊已被解散":"การสนทนากลุ่มนี้ได้ถูกยุบเลิกแล้ว","您已被管理员移出群聊":"คุณถูกผู้ดูแลระบบเอาออกจากการสนทนากลุ่มแล้ว","您已退出该群聊":"คุณได้ออกจากการสนทนากลุ่มนี้แล้ว","您已被禁止聊天":"คุณถูกห้ามสนทนา","按Enter发送，Ctrl+Enter换行":"กด Enter เพื่อส่ง กด Ctrl+Enter เพื่อขึ้นบรรทัดใหม่","账号被强制下线":"บัญชีถูกบังคับให้ออกจากระบบ","登录失败":"เข้าสู่ระบบไม่สำเร็จ"},Component:{"图片 url 不存在":"URL ของรูปภาพไม่มีอยู่","暂不支持下载此类型图片":"การดาวน์โหลดภาพประเภทนี้ยังไม่ได้รับการสนับสนุนในขณะนี้","大图提取中":"กำลังประมวลผลภาพขนาดใหญ่","已保存至相册":"บันทึกลงในอัลบั้มแล้ว","图片下载失败":"ดาวน์โหลดรูปภาพไม่สำเร็จ"},Time:{"周":"สัปดาห์","天":"วัน","小时":"ชั่วโมง","分钟":"นาที","刚刚":"เมื่อกี้","前":"ก่อน","昨天":"เมื่อวาน","星期一":"วันจันทร์","星期二":"วันอังคาร","星期三":"วันพุธ","星期四":"วันพฤหัสบดี","星期五":"วันศุกร์","星期六":"วันเสาร์","星期日":"วันอาทิตย์"},Emoji:Fc}},...{ru:{"取消":"Отмена","确定":"Подтвердить","发送":"Отправить","系统通知":"Системное уведомление","关闭":"Закрыть","图片":"Изображение","文件":"Файл","表情":"Эмоция","视频":"Видео","录制":"Записать","拍照":"Сделать фото",TUIChat:{"按Enter发送，Ctrl+Enter换行":"Enter - отправить, Ctrl+Enter - новая строка","表情":"[Эмоция]","查看更多":"Показать ещё","撤回":"Отозвать","撤回了一条消息":" отозвал(а) сообщение","打开":"Открыть","单击下载":"Нажмите для скачивания","下载":"Скачать","点此投诉":"Пожаловаться","点击处理":"Обработать","对方正在输入":"Печатает...","发起群视频":"Начать групповой видеозвонок","发起群语音":"Начать групповой аудиозвонок","发起通话":"Начать звонок","发送失败":"Ошибка отправки","复制":"Копировать","复制成功":"Скопировано","该消息不存在":"Сообщение не существует","关闭阅读状态":"Отключить статус прочтения","管理员开启全员禁言":'Админ включил режим "Только чтение"',"欢迎使用TUICallKit":"Добро пожаловать в TUICallKit","回到最新位置":"Вернуться к новым сообщениям","回复":"Ответить","回复详情":"Детали ответа","集成TUICallKit":"Интеграция TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"Обнаружено, что TUICallKit не интегрирован - аудио/видеозвонки недоступны","结束群聊":"Завершить групповой звонок","进行体验":"для тестирования","经度":"Долгота","拒绝":"Отклонить","拒绝通话":"Отклонить звонок","开通腾讯实时音视频服务":"Активировать Tencent RTC","聊天记录":"[История чата]","描述":"Описание","内容包含敏感词汇":"Обнаружены запрещённые слова","您":"Вы","您当前购买使用的套餐包暂未开通此功能":"Ваш текущий тарифный план не поддерживает эту функцию","您当前购买使用的套餐包暂未开通群消息已读回执功能":"Ваш тариф не включает подтверждение прочтения групповых сообщений","您当前购买使用的套餐包暂未开通在线用户列表功能":"Ваш тариф не поддерживает список онлайн-пользователей","您已被管理员禁言":"Администратор отключил вам возможность писать","您有":"У вас есть","请点击":"Нажмите","请输入消息":"Введите сообщение","取消":"Отмена","取消通话":"Отменить звонок","全部已读":"Все прочитано","确定":"Подтвердить","确认重发该消息？":"Подтвердить повторную отправку?","人关闭阅读状态":" чел. отключили статус прочтения","人未读":" не прочитали","人已读":" прочитали","删除":"Удалить","涉及敏感内容":"Обнаружен чувствительный контент","申请加入":"Запрос на вступление","视频":"[Видео]","视频通话":"Видеозвонок","条回复":" ответов","条入群申请":" заявок в группу","条新消息":" новых сообщений","通话时长":"Длительность звонка","同意":"Согласиться","图片":"[Изображение]","图片消息失败,无效的图片格式":"Ошибка: неверный формат изображения","纬度":"Широта","未读":"Не прочитано","位置":"[Местоположение]","文件":"[Файл]","文件不存在,请检查文件路径是否正确":"Файл не найден, проверьте путь","文件大小超出了限制,如果上传文件,最大限制是100MB":"Превышен лимит (макс. 100MB)","文件消息失败,禁止发送违规封禁的文件":"Ошибка: запрещённый файл","我":"Я","无法查看":"Невозможно просмотреть","无法定位到原消息":"Не удалось найти исходное сообщение","无法收听":"Невозможно прослушать","正在加载":"Загрузка...","加载结束":"Завершено","无应答":"Нет ответа","系统消息":"Системное сообщение","消息":"[Сообщение]","消息或者资料中文本存在敏感内容,发送失败":"Обнаружен запрещённый контент в сообщении - отправка отклонена","消息详情":"Детали сообщения","消息长度超出限制,消息长度不要超过12K":"Превышен лимит длины (макс. 12K)","消息中图片存在敏感内容,发送失败":"Обнаружена запрещённая картинка - отправка отклонена","选择提醒的人":"Выбрать контакт","已读":"Прочитано","已过撤回时限":"Срок отзыва истёк","已接听":"Принят","已拒绝":"Отклонён","已同意":"Одобрено","引用":"Цитата","引用失败":"Ошибка цитирования","语音":"[Голосовое]","语音通话":"Аудиозвонок","重新编辑":"Редактировать","重新发送":"Отправить повторно","转发":"Переслать","翻译":"Перевести","转文字":"В текст","隐藏":"Скрыть","转发给":"Переслать в","自定义":"[Своё сообщение]","自定义消息":"Своё сообщение","腾讯云 IM":"Tencent Cloud IM","空":"Пусто","文本包含本地审核拦截词":"Текст содержит запрещённые слова","按住说话":"Удерживайте для записи","抬起发送":"Отпустите для отправки","抬起取消":"Отпустите для отмены","正在录音":"Идёт запись","继续上滑可取消":"Потяните вверх для отмены","松开手指 取消发送":"Отпустите для отмены","此机型暂不支持复制功能":"Эта модель не поддерживает копирование","请开通翻译功能":"Включите перевод","请开通语音转文字功能":"Включите преобразование голоса","翻译中":"Перевод...","转换中":"Конвертация...","由IM提供翻译支持":"Перевод через IM","所有人":"Все","已达到表情回应上限数量":"Достигнут лимит реакций","等":"и др.","人":"чел.","返回":"Назад","关闭":"Закрыть","多选":"Выбрать","合并转发":"Объединённая пересылка","逐条转发":"Поочерёдная пересылка","未选择消息":"Сообщения не выбраны","[草稿]":"[Черновик]","[消息]":"[Сообщение]","[文本]":"[Текст]","[自定义消息]":"[Своё сообщение]","[图片]":"[Изображение]","[音频]":"[Аудио]","[语音]":"[Голосовое]","[视频]":"[Видео]","[文件]":"[Файл]","[位置]":"[Местоположение]","[地理位置]":"[Геопозиция]","[动画表情]":"[Анимированный стикер]","[群提示]":"[Групповое уведомление]","[群提示消息]":"[Групповое оповещение]","[聊天记录]":"[История чата]","[机器人自定义消息]":"[Кастомное сообщение бота]","引用内容已撤回":"Цитируемое сообщение отозвано","群聊的聊天记录":"История группового чата","和":"и","的聊天记录":"история переписки","请升级IMSDK到v2.10.1或更高版本查看此消息":"Обновите IMSDK до v2.10.1+ для просмотра","该群聊已被解散":"Группа удалена","您已被管理员移出群聊":"Администратор исключил вас из группы","您已退出该群聊":"Вы вышли из группы","您已被禁止聊天":"Вам запрещено писать","账号被强制下线":"Аккаунт был принудительно выведен","登录失败":"Вход в систему не удалось"},Component:{"图片 url 不存在":"URL изображения не существует","暂不支持下载此类型图片":"Этот тип изображения пока не поддерживается для загрузки","大图提取中":"Извлекается большое изображение","已保存至相册":"Сохранено в альбоме","图片下载失败":"Ошибка загрузки изображения"},Time:{"周":"неделя","天":"день","小时":"час","分钟":"минута","刚刚":"только что","前":"назад","昨天":"вчера","星期一":"понедельник","星期二":"вторник","星期三":"среда","星期四":"четверг","星期五":"пятница","星期六":"суббота","星期日":"воскресенье","一月":"январь","二月":"февраль","三月":"март","四月":"апрель","五月":"май","六月":"июнь","七月":"июль","八月":"август","九月":"сентябрь","十月":"октябрь","十一月":"ноябрь","十二月":"декабрь"},AIDesk:{"结束人工会话":"Завершить сеанс ручного управления","转人工服务":"Перевод на ручное обслуживание","跳转":"Прыжок","立即填写":"Заполнить сейчас","已提交":"Отправлено","提交":"Отправить","查看内容":"Просмотреть содержимое","请填写必填项":"Пожалуйста, заполните обязательные поля","Hi，我是":"Привет, я ","请输入内容":"Пожалуйста, введите содержание","如果满意请给好评哦～":"Если вы удовлетворены, пожалуйста, оставьте хороший отзыв~","请对本次服务进行评价":"Оцените обслуживание","提交评价":"Отправить оценку","服务评价":"Оценка услуги","并发限制":"В данный момент слишком много пользователей. Попробуйте позже","分支选项异常":"Содержимое аномально, пожалуйста, проверьте конфигурацию потока задач"},Emoji:Fc}}};const Ch=u({components:{TUIKit:u(e.defineComponent({__name:"index-uniapp",props:{robotLang:{default:""},userLang:{default:""},canSendAudio:{type:Boolean,default:!1},toolbarButtonList:{default:()=>[]},showAvatar:{default:1},robotAvatar:{default:""},staffAvatar:{default:""},userAvatar:{default:""},showNickName:{default:0},robotNickName:{default:""},staffNickName:{default:""},userNickName:{default:""},inputToolbarList:{default:()=>[]},showReadStatus:{default:1},showTyping:{default:0}},emits:["closeChat"],setup(t,{emit:n}){const{ref:i,onMounted:o,onUnmounted:a,computed:s}=co,r=i(),c=i("none"),u=i(),l=i(),d=i(!1),h=i(""),p=i(!1),g=Object.keys(Mh),f=t,m=e=>{if(!e)return"zh";let t=e.toLowerCase();return"zh-cn"===t||"zh_cn"===t?t="zh":"zh-tw"!==t&&"zh-hk"!==t||(t="zh_tw"),t};Qr||(()=>{let e;if(bc.i(`initLanguage ${f.userLang}`),Ys.provideLanguages({...Mh}),Ys.useI18n(),""!==f.userLang)e=m(f.userLang),g.includes(e)||(bc.w(`userLang:${f.userLang} is not supported`),e="en");else{if(ec){const{osLanguage:t}=uni.getDeviceInfo();bc.i(`initLanguage osLanguage:${t}`),e=m(t)}else Qr?e="zh":navigator&&(e=m(navigator.language));g.includes(e)||(e="en")}Ys.changeLanguage(e)})(),mu.set("avatarNickName",{showAvatar:f.showAvatar,showNickName:f.showNickName,userAvatar:f.userAvatar,staffAvatar:f.staffAvatar,robotAvatar:f.robotAvatar,userNickName:f.userNickName,staffNickName:f.staffNickName,robotNickName:f.robotNickName}),mu.set("showReadStatus",f.showReadStatus),mu.set("showTyping",f.showTyping),o((()=>{const e="CustomerServiceChat onMounted.";bc.l(`${e} engineReady:${Ks.isReady()}`),f.robotLang&&!_c(f.robotLang)&&bc.w(`${e} robotLang:${f.robotLang} is not supported`),zs.watch(To.CONV,{currentConversationID:E}),zs.watch(To.USER,{kickedOut:C})})),a((()=>{zs.unwatch(To.CONV,{currentConversationID:E}),zs.unwatch(To.USER,{kickedOut:C})}));const _=s((()=>!tc||"none"!==c.value)),v=e=>{var t;null==(t=u.value)||t.insertEmoji(e)},y=(e,t)=>{var n,i,o;if(e&&t)switch(t){case"reference":case"reply":break;case"reedit":(null==(n=null==e?void 0:e.payload)?void 0:n.text)&&(null==(o=null==u?void 0:u.value)||o.reEdit(null==(i=null==e?void 0:e.payload)?void 0:i.text))}};function I(e){c.value=c.value===e?"none":e,"none"!==c.value&&tc&&uni.$emit("scroll-to-bottom")}function M(){var e;null==(e=l.value)||e.scrollToLatestMessage()}function C(e){e&&(d.value=!0,su({message:Ys.t("TUIChat.账号被强制下线"),type:ou,duration:3e4}))}function E(e){e&&r.value!==e&&(r.value=e,Sr.callService({serviceName:cr.SERVICE.NAME,method:cr.SERVICE.METHOD.ACTIVE_CONVERSATION,params:{conversationID:e,robotLang:f.robotLang&&_c(f.robotLang)?f.robotLang:void 0}}))}function T(e){p.value=e}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tui-chat","tui-chat-h5"])},[e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-chat","tui-chat-h5"])},[e.createVNode(Qd,{ref_key:"messageListRef",ref:l,class:e.normalizeClass(["tui-chat-message-list","tui-chat-h5-message-list"]),onHandleEditor:y,onCloseInputToolBar:n[0]||(n[0]=()=>I("none")),onShowFormPopup:T},null,512),e.createVNode(Ih,{toolbarButtonList:f.toolbarButtonList},null,8,["toolbarButtonList"]),e.unref(_)?(e.openBlock(),e.createBlock(mh,{key:0,class:e.normalizeClass(["tui-chat-message-input-toolbar","tui-chat-h5-message-input-toolbar",e.unref(tc)&&"tui-chat-uni-message-input-toolbar"]),displayType:e.unref(c),onInsertEmoji:v,onChangeToolbarDisplayType:I,onScrollToLatestMessage:M},null,8,["class","displayType"])):e.createCommentVNode("",!0),e.createVNode(ch,{ref_key:"messageInputRef",ref:u,class:e.normalizeClass(["tui-chat-message-input","tui-chat-h5-message-input",e.unref(tc)&&!e.unref(Zr)&&"tui-chat-uni-message-input",e.unref(Qr)&&"tui-chat-wx-message-input",e.unref(p)&&"tui-chat-uni-message-input-hide"]),isMuted:e.unref(d),muteText:e.unref(h),canSendAudio:f.canSendAudio,placeholder:"",inputToolbarDisplayType:e.unref(c),onChangeToolbarDisplayType:I},null,8,["class","isMuted","muteText","canSendAudio","inputToolbarDisplayType"])])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-f620fcec"]])},data:()=>({userID:"customer_"+Math.floor(1e6*Math.random()),simpleConfig:{sdkAppID:1600089018,groupID:"59887"}}),computed:{userSig(){return oo(this.userID).userSig}},methods:{onMessageReceived(e){c("log","at pages-ai-desk/index/index.vue:44","收到新消息:",e),uni.vibrateShort();const t=uni.createInnerAudioContext();t.src="/static/notification.mp3",t.play()},onConversationListUpdated(e){c("log","at pages-ai-desk/index/index.vue:56","会话列表更新:",e)},onError(e){c("error","at pages-ai-desk/index/index.vue:61","TUIKit错误:",e),uni.showToast({title:"连接异常，请稍后重试",icon:"none",duration:2e3})}},onLoad(){c("log","at pages-ai-desk/index/index.vue:71","聊天页面已加载"),ku.initWithProfile({SDKAppID:this.simpleConfig.sdkAppID,userID:this.userID,userSig:this.userSig}),uni.getNetworkType({success:e=>{"none"===e.networkType&&uni.showToast({title:"网络连接已断开",icon:"none",duration:2e3})}})},onUnload(){c("log","at pages-ai-desk/index/index.vue:95","聊天页面已卸载")}},[["render",function(t,n,i,o,a,s){const r=e.resolveComponent("TUIKit");return e.openBlock(),e.createElementBlock("view",{class:"chat-container"},[e.createVNode(r,{config:a.simpleConfig,userID:a.userID,userSig:s.userSig,onOnMessageReceived:s.onMessageReceived,onOnConversationListUpdated:s.onConversationListUpdated,onOnError:s.onError},null,8,["config","userID","userSig","onOnMessageReceived","onOnConversationListUpdated","onOnError"])])}]]);__definePage("pages/index/index",l),__definePage("pages/index/course",d),__definePage("pages/index/elective",h),__definePage("pages/index/volunteer-register",p),__definePage("pages/index/mine",f),__definePage("pages/test-auth/test-auth",m),__definePage("pages/policy/policy",I),__definePage("pages/policy/detail",M),__definePage("pages/basicInfo/basicInfo",C),__definePage("pages/index/spxz/spxz",so),__definePage("pages-ai-desk/index/index",Ch);const Eh={onLaunch:function(){c("log","at App.vue:5","App Launch")},onShow:function(){c("log","at App.vue:8","App Show")},onHide:function(){c("log","at App.vue:11","App Hide")}},Th={baseUrl:"http://192.168.190.109:8080"},kh={data:()=>({}),onLoad(){this.$u.getRect=this.$uGetRect},methods:{$uGetRect(e,t){return new Promise((n=>{uni.createSelectorQuery().in(this)[t?"selectAll":"select"](e).boundingClientRect((e=>{t&&Array.isArray(e)&&e.length&&n(e),!t&&e&&n(e)})).exec()}))},getParentData(e=""){this.parent||(this.parent=!1),this.parent=this.$u.$parent.call(this,e),this.parent&&(Object.keys(this.parentData).map((e=>{this.parentData[e]=this.parent[e]})),this.parentData.value=this.parent.modelValue)},preventEvent(e){e&&e.stopPropagation&&e.stopPropagation()}},onReachBottom(){uni.$emit("uOnReachBottom")},beforeUnmount(){if(this.parent&&uni.$u.test.array(this.parent.children)){const e=this.parent.children;e.map(((t,n)=>{t===this&&e.splice(n,1)}))}}};function Sh(e){if([null,void 0,NaN,!1].includes(e))return e;if("object"!=typeof e&&"function"!=typeof e)return e;var t,n=(t=e,"[object Array]"===Object.prototype.toString.call(t)?[]:{});for(let i in e)e.hasOwnProperty(i)&&(n[i]="object"==typeof e[i]?Sh(e[i]):e[i]);return n}function Dh(e={},t={}){if("object"!=typeof(e=Sh(e))||"object"!=typeof t)return!1;for(var n in t)t.hasOwnProperty(n)&&(n in e?"object"!=typeof e[n]||"object"!=typeof t[n]?e[n]=t[n]:e[n].concat&&t[n].concat?e[n]=e[n].concat(t[n]):e[n]=Dh(e[n],t[n]):e[n]=t[n]);return e}function bh(e){return/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)}function Ah(e){switch(typeof e){case"undefined":return!0;case"string":if(0==e.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"").length)return!0;break;case"boolean":if(!e)return!0;break;case"number":if(0===e||isNaN(e))return!0;break;case"object":if(null===e||0===e.length)return!0;for(var t in e)return!1;return!0}return!1}function Lh(e){return"[object Object]"===Object.prototype.toString.call(e)}function Rh(e){return"function"==typeof e}const wh={email:function(e){return/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e)},mobile:function(e){return/^1[23456789]\d{9}$/.test(e)},url:function(e){return/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w-.\/?%&=]*)?/.test(e)},date:function(e){return!!e&&(bh(e)&&(e=+e),!/Invalid|NaN/.test(new Date(e).toString()))},dateISO:function(e){return/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:bh,digits:function(e){return/^\d+$/.test(e)},idCard:function(e){return/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(e)},carNo:function(e){const t=/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF]$)|([DF][A-HJ-NP-Z0-9][0-9]{4}$))/,n=/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1}$/;return 7===e.length?n.test(e):8===e.length&&t.test(e)},amount:function(e){return/^[1-9]\d*(,\d{3})*(\.\d{1,2})?$|^0\.\d{1,2}$/.test(e)},chinese:function(e){return/^[\u4e00-\u9fa5]+$/gi.test(e)},letter:function(e){return/^[a-zA-Z]*$/.test(e)},enOrNum:function(e){return/^[0-9a-zA-Z]*$/g.test(e)},contains:function(e,t){return e.indexOf(t)>=0},range:function(e,t){return e>=t[0]&&e<=t[1]},rangeLength:function(e,t){return e.length>=t[0]&&e.length<=t[1]},empty:Ah,isEmpty:Ah,jsonString:function(e){if("string"==typeof e)try{var t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(Ct){return!1}return!1},landline:function(e){return/^\d{3,4}-\d{7,8}(-\d{3,4})?$/.test(e)},object:Lh,array:function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},code:function(e,t=6){return new RegExp(`^\\d{${t}}$`).test(e)},func:Rh,promise:function(e){return Lh(e)&&Rh(e.then)&&Rh(e.catch)},video:function(e){const t=e.split("?")[0];return new RegExp(/\.(mp4|mpg|mpeg|dat|asf|avi|rm|rmvb|mov|wmv|flv|mkv|m3u8|3gp)$/).test(t)},image:function(e){const t=e.split("?")[0];return new RegExp(/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)$/).test(t)},regExp:function(e){return e&&"[object RegExp]"===Object.prototype.toString.call(e)},string:function(e){return"string"==typeof e}};const Oh=new class{setConfig(e){this.config=Dh(this.config,e)}request(e={}){if(this.interceptor.request&&"function"==typeof this.interceptor.request){let t=this.interceptor.request(e);if(!1===t)return new Promise((()=>{}));this.options=t}return e.dataType=e.dataType||this.config.dataType,e.responseType=e.responseType||this.config.responseType,e.url=e.url||"",e.params=e.params||{},e.header=Object.assign({},this.config.header,e.header),e.method=e.method||this.config.method,new Promise(((t,n)=>{e.complete=e=>{if(uni.hideLoading(),clearTimeout(this.config.timer),this.config.timer=null,this.config.originalData)if(this.interceptor.response&&"function"==typeof this.interceptor.response){let i=this.interceptor.response(e);!1!==i?t(i):n(e)}else t(e);else if(200==e.statusCode)if(this.interceptor.response&&"function"==typeof this.interceptor.response){let i=this.interceptor.response(e.data);!1!==i?t(i):n(e.data)}else t(e.data);else n(e)},e.url=wh.url(e.url)?e.url:this.config.baseUrl+(0==e.url.indexOf("/")?e.url:"/"+e.url),this.config.showLoading&&!this.config.timer&&(this.config.timer=setTimeout((()=>{uni.showLoading({title:this.config.loadingText,mask:this.config.loadingMask}),this.config.timer=null}),this.config.loadingTime)),uni.request(e)}))}constructor(){this.config={baseUrl:"",header:{},method:"POST",dataType:"json",responseType:"text",showLoading:!0,loadingText:"请求中...",loadingTime:800,timer:null,originalData:!1,loadingMask:!0},this.interceptor={request:null,response:null},this.get=(e,t={},n={})=>this.request({method:"GET",url:e,header:n,data:t}),this.post=(e,t={},n={})=>this.request({url:e,method:"POST",header:n,data:t}),this.put=(e,t={},n={})=>this.request({url:e,method:"PUT",header:n,data:t}),this.delete=(e,t={},n={})=>this.request({url:e,method:"DELETE",header:n,data:t})}};const Nh=(new class{constructor(){this.config={type:"navigateTo",url:"",delta:1,params:{},animationType:"pop-in",animationDuration:300,intercept:!1},this.route=this.route.bind(this)}addRootPath(e){return"/"===e[0]?e:`/${e}`}mixinParam(e,t){e=e&&this.addRootPath(e);let n="";return/.*\/.*\?.*=.*/.test(e)?(n=uni.$u.queryParams(t,!1),e+"&"+n):(n=uni.$u.queryParams(t),e+n)}async route(e={},t={}){let n={};if("string"==typeof e?(n.url=this.mixinParam(e,t),n.type="navigateTo"):(n=uni.$u.deepClone(e,this.config),n.url=this.mixinParam(e.url,e.params)),t.intercept&&(this.config.intercept=t.intercept),n.params=t,n=uni.$u.deepMerge(this.config,n),"function"==typeof uni.$u.routeIntercept){await new Promise(((e,t)=>{uni.$u.routeIntercept(n,e)}))&&this.openPage(n)}else this.openPage(n)}openPage(e){const{url:t,type:n,delta:i,animationType:o,animationDuration:a}=e;"navigateTo"!=e.type&&"to"!=e.type||uni.navigateTo({url:t,animationType:o,animationDuration:a}),"redirectTo"!=e.type&&"redirect"!=e.type||uni.redirectTo({url:t}),"switchTab"!=e.type&&"tab"!=e.type||uni.switchTab({url:t}),"reLaunch"!=e.type&&"launch"!=e.type||uni.reLaunch({url:t}),"navigateBack"!=e.type&&"back"!=e.type||uni.navigateBack({delta:i})}}).route;function Ph(e=null,t="yyyy-mm-dd"){e||(e=Number(new Date)),10==e.toString().length&&(e*=1e3);let n,i=new Date(e),o={"y+":i.getFullYear().toString(),"m+":(i.getMonth()+1).toString(),"d+":i.getDate().toString(),"h+":i.getHours().toString(),"M+":i.getMinutes().toString(),"s+":i.getSeconds().toString()};for(let a in o)n=new RegExp("("+a+")").exec(t),n&&(t=t.replace(n[1],1==n[1].length?o[a]:o[a].padStart(n[1].length,"0")));return t}function Uh(e,t=!0){if((e=e.toLowerCase())&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){let t="#";for(let n=1;n<4;n+=1)t+=e.slice(n,n+1).concat(e.slice(n,n+1));e=t}let n=[];for(let t=1;t<7;t+=2)n.push(parseInt("0x"+e.slice(t,t+2)));return t?`rgb(${n[0]},${n[1]},${n[2]})`:n}if(/^(rgb|RGB)/.test(e)){return e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",").map((e=>Number(e)))}return e}function Gh(e){let t=e;if(/^(rgb|RGB)/.test(t)){let e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),n="#";for(let t=0;t<e.length;t++){let i=Number(e[t]).toString(16);i=1==String(i).length?"0"+i:i,"0"===i&&(i+=i),n+=i}return 7!==n.length&&(n=t),n}if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t))return t;{let e=t.replace(/#/,"").split("");if(6===e.length)return t;if(3===e.length){let t="#";for(let n=0;n<e.length;n+=1)t+=e[n]+e[n];return t}}}String.prototype.padStart||(String.prototype.padStart=function(e,t=" "){if("[object String]"!==Object.prototype.toString.call(t))throw new TypeError("fillString must be String");let n=this;if(n.length>=e)return String(n);let i=e-n.length,o=Math.ceil(i/t.length);for(;o>>=1;)t+=t,1===o&&(t+=t);return t.slice(0,i)+n});const xh={colorGradient:function(e="rgb(0, 0, 0)",t="rgb(255, 255, 255)",n=10){let i=Uh(e,!1),o=i[0],a=i[1],s=i[2],r=Uh(t,!1),c=(r[0]-o)/n,u=(r[1]-a)/n,l=(r[2]-s)/n,d=[];for(let h=0;h<n;h++){let e=Gh("rgb("+Math.round(c*h+o)+","+Math.round(u*h+a)+","+Math.round(l*h+s)+")");d.push(e)}return d},hexToRgb:Uh,rgbToHex:Gh,colorToRgba:function(e,t=.3){let n=(e=Gh(e)).toLowerCase();if(n&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(n)){if(4===n.length){var i="#";for(let e=1;e<4;e+=1)i+=n.slice(e,e+1).concat(n.slice(e,e+1));n=i}var o=[];for(let e=1;e<7;e+=2)o.push(parseInt("0x"+n.slice(e,e+2)));return"rgba("+o.join(",")+","+t+")"}return n}};let Fh=null;let Bh=[],Vh=[];function jh(e,t="both"){return e=String(e),"both"==t?e.replace(/^\s+|\s+$/g,""):"left"==t?e.replace(/^\s*/,""):"right"==t?e.replace(/(\s*$)/g,""):"all"==t?e.replace(/\s+/g,""):e}let qh="1.10.1";const Hh={v:qh,version:qh,type:["primary","success","info","error","warning"]};const Kh={queryParams:function(e={},t=!0,n="brackets"){let i=t?"?":"",o=[];-1==["indices","brackets","repeat","comma"].indexOf(n)&&(n="brackets");for(let a in e){let t=e[a];if(!(["",void 0,null].indexOf(t)>=0))if(t.constructor===Array)switch(n){case"indices":for(let n=0;n<t.length;n++)o.push(a+"["+n+"]="+t[n]);break;case"brackets":default:t.forEach((e=>{o.push(a+"[]="+e)}));break;case"repeat":t.forEach((e=>{o.push(a+"="+e)}));break;case"comma":let e="";t.forEach((t=>{e+=(e?",":"")+t})),o.push(a+"="+e)}else o.push(a+"="+t)}return o.length?i+o.join("&"):""},route:Nh,timeFormat:Ph,date:Ph,timeFrom:function(e=null,t="yyyy-mm-dd"){e||(e=Number(new Date)),10==e.toString().length&&(e*=1e3);let n=+new Date(Number(e)),i=(Number(new Date)-n)/1e3,o="";switch(!0){case i<300:o="刚刚";break;case i>=300&&i<3600:o=parseInt(i/60)+"分钟前";break;case i>=3600&&i<86400:o=parseInt(i/3600)+"小时前";break;case i>=86400&&i<2592e3:o=parseInt(i/86400)+"天前";break;default:o=!1===t?i>=2592e3&&i<31536e3?parseInt(i/2592e3)+"个月前":parseInt(i/31536e3)+"年前":Ph(n,t)}return o},colorGradient:xh.colorGradient,colorToRgba:xh.colorToRgba,guid:function(e=32,t=!0,n=null){let i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(n=n||i.length,e)for(let a=0;a<e;a++)o[a]=i[0|Math.random()*n];else{let e;o[8]=o[13]=o[18]=o[23]="-",o[14]="4";for(let t=0;t<36;t++)o[t]||(e=0|16*Math.random(),o[t]=i[19==t?3&e|8:e])}return t?(o.shift(),"u"+o.join("")):o.join("")},color:{primary:"#2979ff",primaryDark:"#2b85e4",primaryDisabled:"#a0cfff",primaryLight:"#ecf5ff",bgColor:"#f3f4f6",info:"#909399",infoDark:"#82848a",infoDisabled:"#c8c9cc",infoLight:"#f4f4f5",warning:"#ff9900",warningDark:"#f29100",warningDisabled:"#fcbd71",warningLight:"#fdf6ec",error:"#fa3534",errorDark:"#dd6161",errorDisabled:"#fab6b6",errorLight:"#fef0f0",success:"#19be6b",successDark:"#18b566",successDisabled:"#71d5a1",successLight:"#dbf1e1",mainColor:"#303133",contentColor:"#606266",tipsColor:"#909399",lightColor:"#c0c4cc",borderColor:"#e4e7ed"},sys:function(){return uni.getSystemInfoSync()},os:function(){return uni.getSystemInfoSync().platform},type2icon:function(e="success",t=!1){-1==["primary","info","error","warning","success"].indexOf(e)&&(e="success");let n="";switch(e){case"primary":case"info":n="info-circle";break;case"error":n="close-circle";break;case"warning":n="error-circle";break;default:n="checkmark-circle"}return t&&(n+="-fill"),n},randomArray:function(e=[]){return e.sort((()=>Math.random()-.5))},wranning:function(e){},get:Oh.get,post:Oh.post,put:Oh.put,delete:Oh.delete,hexToRgb:xh.hexToRgb,rgbToHex:xh.rgbToHex,test:wh,random:function(e,t){if(e>=0&&t>0&&t>=e){let n=t-e+1;return Math.floor(Math.random()*n+e)}return 0},deepClone:Sh,deepMerge:Dh,getParent:function(e,t){let n=this.$parent;for(;n;){if(n.$options.name===e){let e={};if(Array.isArray(t))t.map((t=>{e[t]=n[t]?n[t]:""}));else for(let i in t)Array.isArray(t[i])?t[i].length?e[i]=t[i]:e[i]=n[i]:t[i].constructor===Object?Object.keys(t[i]).length?e[i]=t[i]:e[i]=n[i]:e[i]=t[i]||!1===t[i]?t[i]:n[i];return e}n=n.$parent}return{}},$parent:function(e=void 0){let t=this.$parent;for(;t;){if(!t.$options||t.$options.name===e)return t;t=t.$parent}return!1},addUnit:function(e="auto",t="rpx"){return e=String(e),wh.number(e)?`${e}${t}`:e},trim:function(e,t="both"){return"both"==t?e.replace(/^\s+|\s+$/g,""):"left"==t?e.replace(/^\s*/,""):"right"==t?e.replace(/(\s*$)/g,""):"all"==t?e.replace(/\s+/g,""):e},type:["primary","success","error","warning","info"],http:Oh,toast:function(e,t=1500){uni.showToast({title:e,icon:"none",duration:t})},config:Hh,zIndex:{toast:10090,noNetwork:10080,popup:10075,mask:10070,navbar:980,topTips:975,sticky:970,indexListSticky:965},debounce:function(e,t=500,n=!1){if(null!==Fh&&clearTimeout(Fh),n){var i=!Fh;Fh=setTimeout((function(){Fh=null}),t),i&&"function"==typeof e&&e()}else Fh=setTimeout((function(){"function"==typeof e&&e()}),t)},throttle:function(e,t=500,n=!0,i="default"){Bh[i]||(Bh[i]=null),n?Vh[i]||(Vh[i]=!0,"function"==typeof e&&e(),Bh[i]=setTimeout((()=>{Vh[i]=!1}),t)):Vh[i]||(Vh[i]=!0,Bh[i]=setTimeout((()=>{Vh[i]=!1,"function"==typeof e&&e()}),t))},addStyle:function(e,t="object"){if(wh.empty(e)||"object"==typeof e&&"object"===t||"string"===t&&"string"==typeof e)return e;if("object"===t){const t=(e=jh(e)).split(";"),n={};for(let e=0;e<t.length;e++)if(t[e]){const i=t[e].split(":");n[jh(i[0])]=jh(i[1])}return n}let n="";for(const i in e){n+=`${i.replace(/([A-Z])/g,"-$1").toLowerCase()}:${e[i]};`}return jh(n)}};uni.$u=Kh;const zh={install:e=>{e.mixin(kh),e.config.globalProperties.$u=Kh}};const{app:Yh,Vuex:$h,Pinia:Wh}=function(){const t=e.createVueApp(Eh);return t.use(zh),t.config.globalProperties.$config=Th,{app:t}}();uni.Vuex=$h,uni.Pinia=Wh,Yh.provide("__globalStyles",__uniConfig.styles),Yh._component.mpType="app",Yh._component.render=()=>{},Yh.mount("#app")}(Vue);
